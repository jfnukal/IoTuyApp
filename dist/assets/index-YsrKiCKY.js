(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function oC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Lg={exports:{}},Lu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PT;function lC(){if(PT)return Lu;PT=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var c=null;if(o!==void 0&&(c=""+o),s.key!==void 0&&(c=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:n,type:i,key:c,ref:s!==void 0?s:null,props:o}}return Lu.Fragment=e,Lu.jsx=t,Lu.jsxs=t,Lu}var UT;function cC(){return UT||(UT=1,Lg.exports=lC()),Lg.exports}var x=cC(),Og={exports:{}},It={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LT;function uC(){if(LT)return It;LT=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function y(H){return H===null||typeof H!="object"?null:(H=v&&H[v]||H["@@iterator"],typeof H=="function"?H:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,D={};function A(H,ee,ye){this.props=H,this.context=ee,this.refs=D,this.updater=ye||E}A.prototype.isReactComponent={},A.prototype.setState=function(H,ee){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ee,"setState")},A.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function T(){}T.prototype=A.prototype;function P(H,ee,ye){this.props=H,this.context=ee,this.refs=D,this.updater=ye||E}var k=P.prototype=new T;k.constructor=P,b(k,A.prototype),k.isPureReactComponent=!0;var V=Array.isArray,j={H:null,A:null,T:null,S:null,V:null},q=Object.prototype.hasOwnProperty;function U(H,ee,ye,Ee,Pe,qe){return ye=qe.ref,{$$typeof:n,type:H,key:ee,ref:ye!==void 0?ye:null,props:qe}}function N(H,ee){return U(H.type,ee,void 0,void 0,void 0,H.props)}function M(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function w(H){var ee={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ye){return ee[ye]})}var R=/\/+/g;function O(H,ee){return typeof H=="object"&&H!==null&&H.key!=null?w(""+H.key):ee.toString(36)}function L(){}function re(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(L,L):(H.status="pending",H.then(function(ee){H.status==="pending"&&(H.status="fulfilled",H.value=ee)},function(ee){H.status==="pending"&&(H.status="rejected",H.reason=ee)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function oe(H,ee,ye,Ee,Pe){var qe=typeof H;(qe==="undefined"||qe==="boolean")&&(H=null);var le=!1;if(H===null)le=!0;else switch(qe){case"bigint":case"string":case"number":le=!0;break;case"object":switch(H.$$typeof){case n:case e:le=!0;break;case g:return le=H._init,oe(le(H._payload),ee,ye,Ee,Pe)}}if(le)return Pe=Pe(H),le=Ee===""?"."+O(H,0):Ee,V(Pe)?(ye="",le!=null&&(ye=le.replace(R,"$&/")+"/"),oe(Pe,ee,ye,"",function(ht){return ht})):Pe!=null&&(M(Pe)&&(Pe=N(Pe,ye+(Pe.key==null||H&&H.key===Pe.key?"":(""+Pe.key).replace(R,"$&/")+"/")+le)),ee.push(Pe)),1;le=0;var xe=Ee===""?".":Ee+":";if(V(H))for(var Oe=0;Oe<H.length;Oe++)Ee=H[Oe],qe=xe+O(Ee,Oe),le+=oe(Ee,ee,ye,qe,Pe);else if(Oe=y(H),typeof Oe=="function")for(H=Oe.call(H),Oe=0;!(Ee=H.next()).done;)Ee=Ee.value,qe=xe+O(Ee,Oe++),le+=oe(Ee,ee,ye,qe,Pe);else if(qe==="object"){if(typeof H.then=="function")return oe(re(H),ee,ye,Ee,Pe);throw ee=String(H),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return le}function X(H,ee,ye){if(H==null)return H;var Ee=[],Pe=0;return oe(H,Ee,"","",function(qe){return ee.call(ye,qe,Pe++)}),Ee}function Z(H){if(H._status===-1){var ee=H._result;ee=ee(),ee.then(function(ye){(H._status===0||H._status===-1)&&(H._status=1,H._result=ye)},function(ye){(H._status===0||H._status===-1)&&(H._status=2,H._result=ye)}),H._status===-1&&(H._status=0,H._result=ee)}if(H._status===1)return H._result.default;throw H._result}var J=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)};function Ae(){}return It.Children={map:X,forEach:function(H,ee,ye){X(H,function(){ee.apply(this,arguments)},ye)},count:function(H){var ee=0;return X(H,function(){ee++}),ee},toArray:function(H){return X(H,function(ee){return ee})||[]},only:function(H){if(!M(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},It.Component=A,It.Fragment=t,It.Profiler=s,It.PureComponent=P,It.StrictMode=i,It.Suspense=d,It.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,It.__COMPILER_RUNTIME={__proto__:null,c:function(H){return j.H.useMemoCache(H)}},It.cache=function(H){return function(){return H.apply(null,arguments)}},It.cloneElement=function(H,ee,ye){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var Ee=b({},H.props),Pe=H.key,qe=void 0;if(ee!=null)for(le in ee.ref!==void 0&&(qe=void 0),ee.key!==void 0&&(Pe=""+ee.key),ee)!q.call(ee,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&ee.ref===void 0||(Ee[le]=ee[le]);var le=arguments.length-2;if(le===1)Ee.children=ye;else if(1<le){for(var xe=Array(le),Oe=0;Oe<le;Oe++)xe[Oe]=arguments[Oe+2];Ee.children=xe}return U(H.type,Pe,void 0,void 0,qe,Ee)},It.createContext=function(H){return H={$$typeof:c,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:o,_context:H},H},It.createElement=function(H,ee,ye){var Ee,Pe={},qe=null;if(ee!=null)for(Ee in ee.key!==void 0&&(qe=""+ee.key),ee)q.call(ee,Ee)&&Ee!=="key"&&Ee!=="__self"&&Ee!=="__source"&&(Pe[Ee]=ee[Ee]);var le=arguments.length-2;if(le===1)Pe.children=ye;else if(1<le){for(var xe=Array(le),Oe=0;Oe<le;Oe++)xe[Oe]=arguments[Oe+2];Pe.children=xe}if(H&&H.defaultProps)for(Ee in le=H.defaultProps,le)Pe[Ee]===void 0&&(Pe[Ee]=le[Ee]);return U(H,qe,void 0,void 0,null,Pe)},It.createRef=function(){return{current:null}},It.forwardRef=function(H){return{$$typeof:h,render:H}},It.isValidElement=M,It.lazy=function(H){return{$$typeof:g,_payload:{_status:-1,_result:H},_init:Z}},It.memo=function(H,ee){return{$$typeof:p,type:H,compare:ee===void 0?null:ee}},It.startTransition=function(H){var ee=j.T,ye={};j.T=ye;try{var Ee=H(),Pe=j.S;Pe!==null&&Pe(ye,Ee),typeof Ee=="object"&&Ee!==null&&typeof Ee.then=="function"&&Ee.then(Ae,J)}catch(qe){J(qe)}finally{j.T=ee}},It.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},It.use=function(H){return j.H.use(H)},It.useActionState=function(H,ee,ye){return j.H.useActionState(H,ee,ye)},It.useCallback=function(H,ee){return j.H.useCallback(H,ee)},It.useContext=function(H){return j.H.useContext(H)},It.useDebugValue=function(){},It.useDeferredValue=function(H,ee){return j.H.useDeferredValue(H,ee)},It.useEffect=function(H,ee,ye){var Ee=j.H;if(typeof ye=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Ee.useEffect(H,ee)},It.useId=function(){return j.H.useId()},It.useImperativeHandle=function(H,ee,ye){return j.H.useImperativeHandle(H,ee,ye)},It.useInsertionEffect=function(H,ee){return j.H.useInsertionEffect(H,ee)},It.useLayoutEffect=function(H,ee){return j.H.useLayoutEffect(H,ee)},It.useMemo=function(H,ee){return j.H.useMemo(H,ee)},It.useOptimistic=function(H,ee){return j.H.useOptimistic(H,ee)},It.useReducer=function(H,ee,ye){return j.H.useReducer(H,ee,ye)},It.useRef=function(H){return j.H.useRef(H)},It.useState=function(H){return j.H.useState(H)},It.useSyncExternalStore=function(H,ee,ye){return j.H.useSyncExternalStore(H,ee,ye)},It.useTransition=function(){return j.H.useTransition()},It.version="19.1.1",It}var OT;function ny(){return OT||(OT=1,Og.exports=uC()),Og.exports}var Le=ny();const _A=oC(Le);var Vg={exports:{}},Ou={},Fg={exports:{}},kg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VT;function hC(){return VT||(VT=1,(function(n){function e(X,Z){var J=X.length;X.push(Z);e:for(;0<J;){var Ae=J-1>>>1,H=X[Ae];if(0<s(H,Z))X[Ae]=Z,X[J]=H,J=Ae;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var Z=X[0],J=X.pop();if(J!==Z){X[0]=J;e:for(var Ae=0,H=X.length,ee=H>>>1;Ae<ee;){var ye=2*(Ae+1)-1,Ee=X[ye],Pe=ye+1,qe=X[Pe];if(0>s(Ee,J))Pe<H&&0>s(qe,Ee)?(X[Ae]=qe,X[Pe]=J,Ae=Pe):(X[Ae]=Ee,X[ye]=J,Ae=ye);else if(Pe<H&&0>s(qe,J))X[Ae]=qe,X[Pe]=J,Ae=Pe;else break e}}return Z}function s(X,Z){var J=X.sortIndex-Z.sortIndex;return J!==0?J:X.id-Z.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var d=[],p=[],g=1,v=null,y=3,E=!1,b=!1,D=!1,A=!1,T=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function V(X){for(var Z=t(p);Z!==null;){if(Z.callback===null)i(p);else if(Z.startTime<=X)i(p),Z.sortIndex=Z.expirationTime,e(d,Z);else break;Z=t(p)}}function j(X){if(D=!1,V(X),!b)if(t(d)!==null)b=!0,q||(q=!0,O());else{var Z=t(p);Z!==null&&oe(j,Z.startTime-X)}}var q=!1,U=-1,N=5,M=-1;function w(){return A?!0:!(n.unstable_now()-M<N)}function R(){if(A=!1,q){var X=n.unstable_now();M=X;var Z=!0;try{e:{b=!1,D&&(D=!1,P(U),U=-1),E=!0;var J=y;try{t:{for(V(X),v=t(d);v!==null&&!(v.expirationTime>X&&w());){var Ae=v.callback;if(typeof Ae=="function"){v.callback=null,y=v.priorityLevel;var H=Ae(v.expirationTime<=X);if(X=n.unstable_now(),typeof H=="function"){v.callback=H,V(X),Z=!0;break t}v===t(d)&&i(d),V(X)}else i(d);v=t(d)}if(v!==null)Z=!0;else{var ee=t(p);ee!==null&&oe(j,ee.startTime-X),Z=!1}}break e}finally{v=null,y=J,E=!1}Z=void 0}}finally{Z?O():q=!1}}}var O;if(typeof k=="function")O=function(){k(R)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,re=L.port2;L.port1.onmessage=R,O=function(){re.postMessage(null)}}else O=function(){T(R,0)};function oe(X,Z){U=T(function(){X(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(X){switch(y){case 1:case 2:case 3:var Z=3;break;default:Z=y}var J=y;y=Z;try{return X()}finally{y=J}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(X,Z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var J=y;y=X;try{return Z()}finally{y=J}},n.unstable_scheduleCallback=function(X,Z,J){var Ae=n.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?Ae+J:Ae):J=Ae,X){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=J+H,X={id:g++,callback:Z,priorityLevel:X,startTime:J,expirationTime:H,sortIndex:-1},J>Ae?(X.sortIndex=J,e(p,X),t(d)===null&&X===t(p)&&(D?(P(U),U=-1):D=!0,oe(j,J-Ae))):(X.sortIndex=H,e(d,X),b||E||(b=!0,q||(q=!0,O()))),X},n.unstable_shouldYield=w,n.unstable_wrapCallback=function(X){var Z=y;return function(){var J=y;y=Z;try{return X.apply(this,arguments)}finally{y=J}}}})(kg)),kg}var FT;function dC(){return FT||(FT=1,Fg.exports=hC()),Fg.exports}var zg={exports:{}},xi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kT;function fC(){if(kT)return xi;kT=1;var n=ny();function e(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)p+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(d,p,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:d,containerInfo:p,implementation:g}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,p){if(d==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return xi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,xi.createPortal=function(d,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(d,p,null,g)},xi.flushSync=function(d){var p=c.T,g=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=p,i.p=g,i.d.f()}},xi.preconnect=function(d,p){typeof d=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(d,p))},xi.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},xi.preinit=function(d,p){if(typeof d=="string"&&p&&typeof p.as=="string"){var g=p.as,v=h(g,p.crossOrigin),y=typeof p.integrity=="string"?p.integrity:void 0,E=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;g==="style"?i.d.S(d,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:E}):g==="script"&&i.d.X(d,{crossOrigin:v,integrity:y,fetchPriority:E,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},xi.preinitModule=function(d,p){if(typeof d=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var g=h(p.as,p.crossOrigin);i.d.M(d,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(d)},xi.preload=function(d,p){if(typeof d=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var g=p.as,v=h(g,p.crossOrigin);i.d.L(d,g,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},xi.preloadModule=function(d,p){if(typeof d=="string")if(p){var g=h(p.as,p.crossOrigin);i.d.m(d,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(d)},xi.requestFormReset=function(d){i.d.r(d)},xi.unstable_batchedUpdates=function(d,p){return d(p)},xi.useFormState=function(d,p,g){return c.H.useFormState(d,p,g)},xi.useFormStatus=function(){return c.H.useHostTransitionStatus()},xi.version="19.1.1",xi}var zT;function pC(){if(zT)return zg.exports;zT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),zg.exports=fC(),zg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BT;function mC(){if(BT)return Ou;BT=1;var n=dC(),e=ny(),t=pC();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,l=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(l=a.return),r=a.return;while(r)}return a.tag===3?l:null}function c(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(i(188))}function d(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(i(188));return a!==r?null:r}for(var l=r,u=a;;){var m=l.return;if(m===null)break;var _=m.alternate;if(_===null){if(u=m.return,u!==null){l=u;continue}break}if(m.child===_.child){for(_=m.child;_;){if(_===l)return h(m),r;if(_===u)return h(m),a;_=_.sibling}throw Error(i(188))}if(l.return!==u.return)l=m,u=_;else{for(var I=!1,z=m.child;z;){if(z===l){I=!0,l=m,u=_;break}if(z===u){I=!0,u=m,l=_;break}z=z.sibling}if(!I){for(z=_.child;z;){if(z===l){I=!0,l=_,u=m;break}if(z===u){I=!0,u=_,l=m;break}z=z.sibling}if(!I)throw Error(i(189))}}if(l.alternate!==u)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:a}function p(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=p(r),a!==null)return a;r=r.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),P=Symbol.for("react.consumer"),k=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),w=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function O(r){return r===null||typeof r!="object"?null:(r=R&&r[R]||r["@@iterator"],typeof r=="function"?r:null)}var L=Symbol.for("react.client.reference");function re(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===L?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case b:return"Fragment";case A:return"Profiler";case D:return"StrictMode";case j:return"Suspense";case q:return"SuspenseList";case M:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case E:return"Portal";case k:return(r.displayName||"Context")+".Provider";case P:return(r._context.displayName||"Context")+".Consumer";case V:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case U:return a=r.displayName||null,a!==null?a:re(r.type)||"Memo";case N:a=r._payload,r=r._init;try{return re(r(a))}catch{}}return null}var oe=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},Ae=[],H=-1;function ee(r){return{current:r}}function ye(r){0>H||(r.current=Ae[H],Ae[H]=null,H--)}function Ee(r,a){H++,Ae[H]=r.current,r.current=a}var Pe=ee(null),qe=ee(null),le=ee(null),xe=ee(null);function Oe(r,a){switch(Ee(le,a),Ee(qe,r),Ee(Pe,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?oT(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=oT(a),r=lT(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}ye(Pe),Ee(Pe,r)}function ht(){ye(Pe),ye(qe),ye(le)}function tt(r){r.memoizedState!==null&&Ee(xe,r);var a=Pe.current,l=lT(a,r.type);a!==l&&(Ee(qe,r),Ee(Pe,l))}function bt(r){qe.current===r&&(ye(Pe),ye(qe)),xe.current===r&&(ye(xe),Iu._currentValue=J)}var Mn=Object.prototype.hasOwnProperty,K=n.unstable_scheduleCallback,Zt=n.unstable_cancelCallback,vt=n.unstable_shouldYield,ft=n.unstable_requestPaint,Ke=n.unstable_now,cn=n.unstable_getCurrentPriorityLevel,Je=n.unstable_ImmediatePriority,St=n.unstable_UserBlockingPriority,yn=n.unstable_NormalPriority,xn=n.unstable_LowPriority,W=n.unstable_IdlePriority,F=n.log,ce=n.unstable_setDisableYieldValue,ge=null,Se=null;function ve(r){if(typeof F=="function"&&ce(r),Se&&typeof Se.setStrictMode=="function")try{Se.setStrictMode(ge,r)}catch{}}var Xe=Math.clz32?Math.clz32:et,Fe=Math.log,st=Math.LN2;function et(r){return r>>>=0,r===0?32:31-(Fe(r)/st|0)|0}var De=256,je=4194304;function ot(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function nt(r,a,l){var u=r.pendingLanes;if(u===0)return 0;var m=0,_=r.suspendedLanes,I=r.pingedLanes;r=r.warmLanes;var z=u&134217727;return z!==0?(u=z&~_,u!==0?m=ot(u):(I&=z,I!==0?m=ot(I):l||(l=z&~r,l!==0&&(m=ot(l))))):(z=u&~_,z!==0?m=ot(z):I!==0?m=ot(I):l||(l=u&~r,l!==0&&(m=ot(l)))),m===0?0:a!==0&&a!==m&&(a&_)===0&&(_=m&-m,l=a&-a,_>=l||_===32&&(l&4194048)!==0)?a:m}function He(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function Tt(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q(){var r=De;return De<<=1,(De&4194048)===0&&(De=256),r}function Ue(){var r=je;return je<<=1,(je&62914560)===0&&(je=4194304),r}function Ve(r){for(var a=[],l=0;31>l;l++)a.push(r);return a}function Ye(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Ie(r,a,l,u,m,_){var I=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var z=r.entanglements,Y=r.expirationTimes,ue=r.hiddenUpdates;for(l=I&~l;0<l;){var Te=31-Xe(l),Re=1<<Te;z[Te]=0,Y[Te]=-1;var de=ue[Te];if(de!==null)for(ue[Te]=null,Te=0;Te<de.length;Te++){var fe=de[Te];fe!==null&&(fe.lane&=-536870913)}l&=~Re}u!==0&&be(r,u,0),_!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=_&~(I&~a))}function be(r,a,l){r.pendingLanes|=a,r.suspendedLanes&=~a;var u=31-Xe(a);r.entangledLanes|=a,r.entanglements[u]=r.entanglements[u]|1073741824|l&4194090}function Ze(r,a){var l=r.entangledLanes|=a;for(r=r.entanglements;l;){var u=31-Xe(l),m=1<<u;m&a|r[u]&a&&(r[u]|=a),l&=~m}}function pt(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Qt(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ut(){var r=Z.p;return r!==0?r:(r=window.event,r===void 0?32:wT(r.type))}function zi(r,a){var l=Z.p;try{return Z.p=r,a()}finally{Z.p=l}}var Gt=Math.random().toString(36).slice(2),Un="__reactFiber$"+Gt,un="__reactProps$"+Gt,Si="__reactContainer$"+Gt,ta="__reactEvents$"+Gt,ol="__reactListeners$"+Gt,Ki="__reactHandles$"+Gt,to="__reactResources$"+Gt,lr="__reactMarker$"+Gt;function Cr(r){delete r[Un],delete r[un],delete r[ta],delete r[ol],delete r[Ki]}function cr(r){var a=r[Un];if(a)return a;for(var l=r.parentNode;l;){if(a=l[Si]||l[Un]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(r=dT(r);r!==null;){if(l=r[Un])return l;r=dT(r)}return a}r=l,l=r.parentNode}return null}function ur(r){if(r=r[Un]||r[Si]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function hr(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function ui(r){var a=r[to];return a||(a=r[to]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Rn(r){r[lr]=!0}var no=new Set,na={};function B(r,a){te(r,a),te(r+"Capture",a)}function te(r,a){for(na[r]=a,r=0;r<a.length;r++)no.add(a[r])}var pe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),me={},ie={};function Ne(r){return Mn.call(ie,r)?!0:Mn.call(me,r)?!1:pe.test(r)?ie[r]=!0:(me[r]=!0,!1)}function Ge(r,a,l){if(Ne(a))if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+l)}}function $e(r,a,l){if(l===null)r.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+l)}}function ze(r,a,l,u){if(u===null)r.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(a,l,""+u)}}var lt,mt;function rt(r){if(lt===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);lt=a&&a[1]||"",mt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+lt+r+mt}var wt=!1;function jt(r,a){if(!r||wt)return"";wt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(fe){var de=fe}Reflect.construct(r,[],Re)}else{try{Re.call()}catch(fe){de=fe}r.call(Re.prototype)}}else{try{throw Error()}catch(fe){de=fe}(Re=r())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(fe){if(fe&&de&&typeof fe.stack=="string")return[fe.stack,de.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=u.DetermineComponentFrameRoot(),I=_[0],z=_[1];if(I&&z){var Y=I.split(`
`),ue=z.split(`
`);for(m=u=0;u<Y.length&&!Y[u].includes("DetermineComponentFrameRoot");)u++;for(;m<ue.length&&!ue[m].includes("DetermineComponentFrameRoot");)m++;if(u===Y.length||m===ue.length)for(u=Y.length-1,m=ue.length-1;1<=u&&0<=m&&Y[u]!==ue[m];)m--;for(;1<=u&&0<=m;u--,m--)if(Y[u]!==ue[m]){if(u!==1||m!==1)do if(u--,m--,0>m||Y[u]!==ue[m]){var Te=`
`+Y[u].replace(" at new "," at ");return r.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",r.displayName)),Te}while(1<=u&&0<=m);break}}}finally{wt=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?rt(l):""}function hn(r){switch(r.tag){case 26:case 27:case 5:return rt(r.type);case 16:return rt("Lazy");case 13:return rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return jt(r.type,!1);case 11:return jt(r.type.render,!1);case 1:return jt(r.type,!0);case 31:return rt("Activity");default:return""}}function Jt(r){try{var a="";do a+=hn(r),r=r.return;while(r);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function Rt(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ct(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function _n(r){var a=ct(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),u=""+r[a];if(!r.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,_=l.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return m.call(this)},set:function(I){u=""+I,_.call(this,I)}}),Object.defineProperty(r,a,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(I){u=""+I},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Lt(r){r._valueTracker||(r._valueTracker=_n(r))}function Kn(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return r&&(u=ct(r)?r.checked?"true":"false":r.value),r=u,r!==l?(a.setValue(r),!0):!1}function Bi(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var hi=/[\n"\\]/g;function En(r){return r.replace(hi,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Ft(r,a,l,u,m,_,I,z){r.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?r.type=I:r.removeAttribute("type"),a!=null?I==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+Rt(a)):r.value!==""+Rt(a)&&(r.value=""+Rt(a)):I!=="submit"&&I!=="reset"||r.removeAttribute("value"),a!=null?Fn(r,I,Rt(a)):l!=null?Fn(r,I,Rt(l)):u!=null&&r.removeAttribute("value"),m==null&&_!=null&&(r.defaultChecked=!!_),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?r.name=""+Rt(z):r.removeAttribute("name")}function Hn(r,a,l,u,m,_,I,z){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(r.type=_),a!=null||l!=null){if(!(_!=="submit"&&_!=="reset"||a!=null))return;l=l!=null?""+Rt(l):"",a=a!=null?""+Rt(a):l,z||a===r.value||(r.value=a),r.defaultValue=a}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=z?r.checked:!!u,r.defaultChecked=!!u,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(r.name=I)}function Fn(r,a,l){a==="number"&&Bi(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function bn(r,a,l,u){if(r=r.options,a){a={};for(var m=0;m<l.length;m++)a["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=a.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&u&&(r[l].defaultSelected=!0)}else{for(l=""+Rt(l),a=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,u&&(r[m].defaultSelected=!0);return}a!==null||r[m].disabled||(a=r[m])}a!==null&&(a.selected=!0)}}function Ct(r,a,l){if(a!=null&&(a=""+Rt(a),a!==r.value&&(r.value=a),l==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=l!=null?""+Rt(l):""}function Ir(r,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(i(92));if(oe(u)){if(1<u.length)throw Error(i(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=Rt(a),r.defaultValue=l,u=r.textContent,u===l&&u!==""&&u!==null&&(r.value=u)}function Gn(r,a){if(a){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=a;return}}r.textContent=a}var io=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zh(r,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":u?r.setProperty(a,l):typeof l!="number"||l===0||io.has(a)?a==="float"?r.cssFloat=l:r[a]=(""+l).trim():r[a]=l+"px"}function zc(r,a,l){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var m in a)u=a[m],a.hasOwnProperty(m)&&l[m]!==u&&zh(r,m,u)}else for(var _ in a)a.hasOwnProperty(_)&&zh(r,_,a[_])}function Bc(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ll(r){return Hp.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var _s=null;function dr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var vs=null,ys=null;function Hc(r){var a=ur(r);if(a&&(r=a.stateNode)){var l=r[un]||null;e:switch(r=a.stateNode,a.type){case"input":if(Ft(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+En(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==r&&u.form===r.form){var m=u[un]||null;if(!m)throw Error(i(90));Ft(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===r.form&&Kn(u)}break e;case"textarea":Ct(r,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&bn(r,!!l.multiple,a,!1)}}}var Xr=!1;function Bh(r,a,l){if(Xr)return r(a,l);Xr=!0;try{var u=r(a);return u}finally{if(Xr=!1,(vs!==null||ys!==null)&&(Ud(),vs&&(a=vs,r=ys,ys=vs=null,Hc(a),r)))for(a=0;a<r.length;a++)Hc(r[a])}}function ro(r,a){var l=r.stateNode;if(l===null)return null;var u=l[un]||null;if(u===null)return null;l=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,a,typeof l));return l}var Dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fr=!1;if(Dr)try{var so={};Object.defineProperty(so,"passive",{get:function(){fr=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{fr=!1}var Yr=null,ia=null,Es=null;function Gc(){if(Es)return Es;var r,a=ia,l=a.length,u,m="value"in Yr?Yr.value:Yr.textContent,_=m.length;for(r=0;r<l&&a[r]===m[r];r++);var I=l-r;for(u=1;u<=I&&a[l-u]===m[_-u];u++);return Es=m.slice(r,1<u?1-u:void 0)}function Kr(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function $r(){return!0}function jc(){return!1}function ii(r){function a(l,u,m,_,I){this._reactName=l,this._targetInst=m,this.type=u,this.nativeEvent=_,this.target=I,this.currentTarget=null;for(var z in r)r.hasOwnProperty(z)&&(l=r[z],this[z]=l?l(_):_[z]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?$r:jc,this.isPropagationStopped=jc,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=$r)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=$r)},persist:function(){},isPersistent:$r}),a}var sn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cl=ii(sn),ao=g({},sn,{view:0,detail:0}),Hh=ii(ao),ul,hl,Qr,oo=g({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Qr&&(Qr&&r.type==="mousemove"?(ul=r.screenX-Qr.screenX,hl=r.screenY-Qr.screenY):hl=ul=0,Qr=r),ul)},movementY:function(r){return"movementY"in r?r.movementY:hl}}),pr=ii(oo),Gh=g({},oo,{dataTransfer:0}),Gp=ii(Gh),lo=g({},ao,{relatedTarget:0}),dl=ii(lo),qc=g({},sn,{animationName:0,elapsedTime:0,pseudoElement:0}),fl=ii(qc),jh=g({},sn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),pl=ii(jh),jp=g({},sn,{data:0}),Wc=ii(jp),co={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xc(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=Wh[r])?!!a[r]:!1}function uo(){return Xc}var Xh=g({},ao,{key:function(r){if(r.key){var a=co[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Kr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?qh[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uo,charCode:function(r){return r.type==="keypress"?Kr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Kr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),ml=ii(Xh),Yh=g({},oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yc=ii(Yh),Ss=g({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uo}),Kh=ii(Ss),$h=g({},sn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qh=ii($h),Zh=g({},oo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),gl=ii(Zh),Di=g({},sn,{newState:0,oldState:0}),Jh=ii(Di),ed=[9,13,27,32],Zr=Dr&&"CompositionEvent"in window,f=null;Dr&&"documentMode"in document&&(f=document.documentMode);var S=Dr&&"TextEvent"in window&&!f,C=Dr&&(!Zr||f&&8<f&&11>=f),G=" ",se=!1;function _e(r,a){switch(r){case"keyup":return ed.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ke(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Xt=!1;function $n(r,a){switch(r){case"compositionend":return ke(a);case"keypress":return a.which!==32?null:(se=!0,G);case"textInput":return r=a.data,r===G&&se?null:r;default:return null}}function Yt(r,a){if(Xt)return r==="compositionend"||!Zr&&_e(r,a)?(r=Gc(),Es=ia=Yr=null,Xt=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return C&&a.locale!=="ko"?null:a.data;default:return null}}var ri={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qn(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!ri[r.type]:a==="textarea"}function Ts(r,a,l,u){vs?ys?ys.push(u):ys=[u]:vs=u,a=zd(a,"onChange"),0<a.length&&(l=new cl("onChange","change",null,l,u),r.push({event:l,listeners:a}))}var di=null,Jr=null;function Kc(r){nT(r,0)}function td(r){var a=hr(r);if(Kn(a))return r}function x0(r,a){if(r==="change")return a}var b0=!1;if(Dr){var qp;if(Dr){var Wp="oninput"in document;if(!Wp){var A0=document.createElement("div");A0.setAttribute("oninput","return;"),Wp=typeof A0.oninput=="function"}qp=Wp}else qp=!1;b0=qp&&(!document.documentMode||9<document.documentMode)}function M0(){di&&(di.detachEvent("onpropertychange",w0),Jr=di=null)}function w0(r){if(r.propertyName==="value"&&td(Jr)){var a=[];Ts(a,Jr,r,dr(r)),Bh(Kc,a)}}function VR(r,a,l){r==="focusin"?(M0(),di=a,Jr=l,di.attachEvent("onpropertychange",w0)):r==="focusout"&&M0()}function FR(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return td(Jr)}function kR(r,a){if(r==="click")return td(a)}function zR(r,a){if(r==="input"||r==="change")return td(a)}function BR(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var $i=typeof Object.is=="function"?Object.is:BR;function $c(r,a){if($i(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var l=Object.keys(r),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var m=l[u];if(!Mn.call(a,m)||!$i(r[m],a[m]))return!1}return!0}function R0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function C0(r,a){var l=R0(r);r=0;for(var u;l;){if(l.nodeType===3){if(u=r+l.textContent.length,r<=a&&u>=a)return{node:l,offset:a-r};r=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=R0(l)}}function I0(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?I0(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function D0(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=Bi(r.document);a instanceof r.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)r=a.contentWindow;else break;a=Bi(r.document)}return a}function Xp(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var HR=Dr&&"documentMode"in document&&11>=document.documentMode,_l=null,Yp=null,Qc=null,Kp=!1;function N0(r,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Kp||_l==null||_l!==Bi(u)||(u=_l,"selectionStart"in u&&Xp(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Qc&&$c(Qc,u)||(Qc=u,u=zd(Yp,"onSelect"),0<u.length&&(a=new cl("onSelect","select",null,a,l),r.push({event:a,listeners:u}),a.target=_l)))}function ho(r,a){var l={};return l[r.toLowerCase()]=a.toLowerCase(),l["Webkit"+r]="webkit"+a,l["Moz"+r]="moz"+a,l}var vl={animationend:ho("Animation","AnimationEnd"),animationiteration:ho("Animation","AnimationIteration"),animationstart:ho("Animation","AnimationStart"),transitionrun:ho("Transition","TransitionRun"),transitionstart:ho("Transition","TransitionStart"),transitioncancel:ho("Transition","TransitionCancel"),transitionend:ho("Transition","TransitionEnd")},$p={},P0={};Dr&&(P0=document.createElement("div").style,"AnimationEvent"in window||(delete vl.animationend.animation,delete vl.animationiteration.animation,delete vl.animationstart.animation),"TransitionEvent"in window||delete vl.transitionend.transition);function fo(r){if($p[r])return $p[r];if(!vl[r])return r;var a=vl[r],l;for(l in a)if(a.hasOwnProperty(l)&&l in P0)return $p[r]=a[l];return r}var U0=fo("animationend"),L0=fo("animationiteration"),O0=fo("animationstart"),GR=fo("transitionrun"),jR=fo("transitionstart"),qR=fo("transitioncancel"),V0=fo("transitionend"),F0=new Map,Qp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qp.push("scrollEnd");function Nr(r,a){F0.set(r,a),B(a,[r])}var k0=new WeakMap;function mr(r,a){if(typeof r=="object"&&r!==null){var l=k0.get(r);return l!==void 0?l:(a={value:r,source:a,stack:Jt(a)},k0.set(r,a),a)}return{value:r,source:a,stack:Jt(a)}}var gr=[],yl=0,Zp=0;function nd(){for(var r=yl,a=Zp=yl=0;a<r;){var l=gr[a];gr[a++]=null;var u=gr[a];gr[a++]=null;var m=gr[a];gr[a++]=null;var _=gr[a];if(gr[a++]=null,u!==null&&m!==null){var I=u.pending;I===null?m.next=m:(m.next=I.next,I.next=m),u.pending=m}_!==0&&z0(l,m,_)}}function id(r,a,l,u){gr[yl++]=r,gr[yl++]=a,gr[yl++]=l,gr[yl++]=u,Zp|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function Jp(r,a,l,u){return id(r,a,l,u),rd(r)}function El(r,a){return id(r,null,null,a),rd(r)}function z0(r,a,l){r.lanes|=l;var u=r.alternate;u!==null&&(u.lanes|=l);for(var m=!1,_=r.return;_!==null;)_.childLanes|=l,u=_.alternate,u!==null&&(u.childLanes|=l),_.tag===22&&(r=_.stateNode,r===null||r._visibility&1||(m=!0)),r=_,_=_.return;return r.tag===3?(_=r.stateNode,m&&a!==null&&(m=31-Xe(l),r=_.hiddenUpdates,u=r[m],u===null?r[m]=[a]:u.push(a),a.lane=l|536870912),_):null}function rd(r){if(50<Tu)throw Tu=0,sg=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var Sl={};function WR(r,a,l,u){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qi(r,a,l,u){return new WR(r,a,l,u)}function em(r){return r=r.prototype,!(!r||!r.isReactComponent)}function xs(r,a){var l=r.alternate;return l===null?(l=Qi(r.tag,a,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=a,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,a=r.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function B0(r,a){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,a=l.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function sd(r,a,l,u,m,_){var I=0;if(u=r,typeof r=="function")em(r)&&(I=1);else if(typeof r=="string")I=Y1(r,l,Pe.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case M:return r=Qi(31,l,a,m),r.elementType=M,r.lanes=_,r;case b:return po(l.children,m,_,a);case D:I=8,m|=24;break;case A:return r=Qi(12,l,a,m|2),r.elementType=A,r.lanes=_,r;case j:return r=Qi(13,l,a,m),r.elementType=j,r.lanes=_,r;case q:return r=Qi(19,l,a,m),r.elementType=q,r.lanes=_,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case T:case k:I=10;break e;case P:I=9;break e;case V:I=11;break e;case U:I=14;break e;case N:I=16,u=null;break e}I=29,l=Error(i(130,r===null?"null":typeof r,"")),u=null}return a=Qi(I,l,a,m),a.elementType=r,a.type=u,a.lanes=_,a}function po(r,a,l,u){return r=Qi(7,r,u,a),r.lanes=l,r}function tm(r,a,l){return r=Qi(6,r,null,a),r.lanes=l,r}function nm(r,a,l){return a=Qi(4,r.children!==null?r.children:[],r.key,a),a.lanes=l,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var Tl=[],xl=0,ad=null,od=0,_r=[],vr=0,mo=null,bs=1,As="";function go(r,a){Tl[xl++]=od,Tl[xl++]=ad,ad=r,od=a}function H0(r,a,l){_r[vr++]=bs,_r[vr++]=As,_r[vr++]=mo,mo=r;var u=bs;r=As;var m=32-Xe(u)-1;u&=~(1<<m),l+=1;var _=32-Xe(a)+m;if(30<_){var I=m-m%5;_=(u&(1<<I)-1).toString(32),u>>=I,m-=I,bs=1<<32-Xe(a)+m|l<<m|u,As=_+r}else bs=1<<_|l<<m|u,As=r}function im(r){r.return!==null&&(go(r,1),H0(r,1,0))}function rm(r){for(;r===ad;)ad=Tl[--xl],Tl[xl]=null,od=Tl[--xl],Tl[xl]=null;for(;r===mo;)mo=_r[--vr],_r[vr]=null,As=_r[--vr],_r[vr]=null,bs=_r[--vr],_r[vr]=null}var Ni=null,Ln=null,rn=!1,_o=null,es=!1,sm=Error(i(519));function vo(r){var a=Error(i(418,""));throw eu(mr(a,r)),sm}function G0(r){var a=r.stateNode,l=r.type,u=r.memoizedProps;switch(a[Un]=r,a[un]=u,l){case"dialog":zt("cancel",a),zt("close",a);break;case"iframe":case"object":case"embed":zt("load",a);break;case"video":case"audio":for(l=0;l<bu.length;l++)zt(bu[l],a);break;case"source":zt("error",a);break;case"img":case"image":case"link":zt("error",a),zt("load",a);break;case"details":zt("toggle",a);break;case"input":zt("invalid",a),Hn(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Lt(a);break;case"select":zt("invalid",a);break;case"textarea":zt("invalid",a),Ir(a,u.value,u.defaultValue,u.children),Lt(a)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||aT(a.textContent,l)?(u.popover!=null&&(zt("beforetoggle",a),zt("toggle",a)),u.onScroll!=null&&zt("scroll",a),u.onScrollEnd!=null&&zt("scrollend",a),u.onClick!=null&&(a.onclick=Bd),a=!0):a=!1,a||vo(r)}function j0(r){for(Ni=r.return;Ni;)switch(Ni.tag){case 5:case 13:es=!1;return;case 27:case 3:es=!0;return;default:Ni=Ni.return}}function Zc(r){if(r!==Ni)return!1;if(!rn)return j0(r),rn=!0,!1;var a=r.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||Sg(r.type,r.memoizedProps)),l=!l),l&&Ln&&vo(r),j0(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(l=r.data,l==="/$"){if(a===0){Ln=Ur(r.nextSibling);break e}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;r=r.nextSibling}Ln=null}}else a===27?(a=Ln,ya(r.type)?(r=Ag,Ag=null,Ln=r):Ln=a):Ln=Ni?Ur(r.stateNode.nextSibling):null;return!0}function Jc(){Ln=Ni=null,rn=!1}function q0(){var r=_o;return r!==null&&(ji===null?ji=r:ji.push.apply(ji,r),_o=null),r}function eu(r){_o===null?_o=[r]:_o.push(r)}var am=ee(null),yo=null,Ms=null;function ra(r,a,l){Ee(am,a._currentValue),a._currentValue=l}function ws(r){r._currentValue=am.current,ye(am)}function om(r,a,l){for(;r!==null;){var u=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),r===l)break;r=r.return}}function lm(r,a,l,u){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var _=m.dependencies;if(_!==null){var I=m.child;_=_.firstContext;e:for(;_!==null;){var z=_;_=m;for(var Y=0;Y<a.length;Y++)if(z.context===a[Y]){_.lanes|=l,z=_.alternate,z!==null&&(z.lanes|=l),om(_.return,l,r),u||(I=null);break e}_=z.next}}else if(m.tag===18){if(I=m.return,I===null)throw Error(i(341));I.lanes|=l,_=I.alternate,_!==null&&(_.lanes|=l),om(I,l,r),I=null}else I=m.child;if(I!==null)I.return=m;else for(I=m;I!==null;){if(I===r){I=null;break}if(m=I.sibling,m!==null){m.return=I.return,I=m;break}I=I.return}m=I}}function tu(r,a,l,u){r=null;for(var m=a,_=!1;m!==null;){if(!_){if((m.flags&524288)!==0)_=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var I=m.alternate;if(I===null)throw Error(i(387));if(I=I.memoizedProps,I!==null){var z=m.type;$i(m.pendingProps.value,I.value)||(r!==null?r.push(z):r=[z])}}else if(m===xe.current){if(I=m.alternate,I===null)throw Error(i(387));I.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(Iu):r=[Iu])}m=m.return}r!==null&&lm(a,r,l,u),a.flags|=262144}function ld(r){for(r=r.firstContext;r!==null;){if(!$i(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Eo(r){yo=r,Ms=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Ti(r){return W0(yo,r)}function cd(r,a){return yo===null&&Eo(r),W0(r,a)}function W0(r,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},Ms===null){if(r===null)throw Error(i(308));Ms=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else Ms=Ms.next=a;return l}var XR=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(l,u){r.push(u)}};this.abort=function(){a.aborted=!0,r.forEach(function(l){return l()})}},YR=n.unstable_scheduleCallback,KR=n.unstable_NormalPriority,Zn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function cm(){return{controller:new XR,data:new Map,refCount:0}}function nu(r){r.refCount--,r.refCount===0&&YR(KR,function(){r.controller.abort()})}var iu=null,um=0,bl=0,Al=null;function $R(r,a){if(iu===null){var l=iu=[];um=0,bl=dg(),Al={status:"pending",value:void 0,then:function(u){l.push(u)}}}return um++,a.then(X0,X0),a}function X0(){if(--um===0&&iu!==null){Al!==null&&(Al.status="fulfilled");var r=iu;iu=null,bl=0,Al=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function QR(r,a){var l=[],u={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return r.then(function(){u.status="fulfilled",u.value=a;for(var m=0;m<l.length;m++)(0,l[m])(a)},function(m){for(u.status="rejected",u.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),u}var Y0=X.S;X.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&$R(r,a),Y0!==null&&Y0(r,a)};var So=ee(null);function hm(){var r=So.current;return r!==null?r:Sn.pooledCache}function ud(r,a){a===null?Ee(So,So.current):Ee(So,a.pool)}function K0(){var r=hm();return r===null?null:{parent:Zn._currentValue,pool:r}}var ru=Error(i(460)),$0=Error(i(474)),hd=Error(i(542)),dm={then:function(){}};function Q0(r){return r=r.status,r==="fulfilled"||r==="rejected"}function dd(){}function Z0(r,a,l){switch(l=r[l],l===void 0?r.push(a):l!==a&&(a.then(dd,dd),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,eE(r),r;default:if(typeof a.status=="string")a.then(dd,dd);else{if(r=Sn,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(u){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=u}},function(u){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,eE(r),r}throw su=a,ru}}var su=null;function J0(){if(su===null)throw Error(i(459));var r=su;return su=null,r}function eE(r){if(r===ru||r===hd)throw Error(i(483))}var sa=!1;function fm(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function pm(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function aa(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function oa(r,a,l){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(an&2)!==0){var m=u.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),u.pending=a,a=rd(r),z0(r,null,l),a}return id(r,u,a,l),rd(r)}function au(r,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,Ze(r,l)}}function mm(r,a){var l=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var m=null,_=null;if(l=l.firstBaseUpdate,l!==null){do{var I={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};_===null?m=_=I:_=_.next=I,l=l.next}while(l!==null);_===null?m=_=a:_=_.next=a}else m=_=a;l={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:_,shared:u.shared,callbacks:u.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=a:r.next=a,l.lastBaseUpdate=a}var gm=!1;function ou(){if(gm){var r=Al;if(r!==null)throw r}}function lu(r,a,l,u){gm=!1;var m=r.updateQueue;sa=!1;var _=m.firstBaseUpdate,I=m.lastBaseUpdate,z=m.shared.pending;if(z!==null){m.shared.pending=null;var Y=z,ue=Y.next;Y.next=null,I===null?_=ue:I.next=ue,I=Y;var Te=r.alternate;Te!==null&&(Te=Te.updateQueue,z=Te.lastBaseUpdate,z!==I&&(z===null?Te.firstBaseUpdate=ue:z.next=ue,Te.lastBaseUpdate=Y))}if(_!==null){var Re=m.baseState;I=0,Te=ue=Y=null,z=_;do{var de=z.lane&-536870913,fe=de!==z.lane;if(fe?(Kt&de)===de:(u&de)===de){de!==0&&de===bl&&(gm=!0),Te!==null&&(Te=Te.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var yt=r,gt=z;de=a;var pn=l;switch(gt.tag){case 1:if(yt=gt.payload,typeof yt=="function"){Re=yt.call(pn,Re,de);break e}Re=yt;break e;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=gt.payload,de=typeof yt=="function"?yt.call(pn,Re,de):yt,de==null)break e;Re=g({},Re,de);break e;case 2:sa=!0}}de=z.callback,de!==null&&(r.flags|=64,fe&&(r.flags|=8192),fe=m.callbacks,fe===null?m.callbacks=[de]:fe.push(de))}else fe={lane:de,tag:z.tag,payload:z.payload,callback:z.callback,next:null},Te===null?(ue=Te=fe,Y=Re):Te=Te.next=fe,I|=de;if(z=z.next,z===null){if(z=m.shared.pending,z===null)break;fe=z,z=fe.next,fe.next=null,m.lastBaseUpdate=fe,m.shared.pending=null}}while(!0);Te===null&&(Y=Re),m.baseState=Y,m.firstBaseUpdate=ue,m.lastBaseUpdate=Te,_===null&&(m.shared.lanes=0),ma|=I,r.lanes=I,r.memoizedState=Re}}function tE(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function nE(r,a){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)tE(l[r],a)}var Ml=ee(null),fd=ee(0);function iE(r,a){r=Us,Ee(fd,r),Ee(Ml,a),Us=r|a.baseLanes}function _m(){Ee(fd,Us),Ee(Ml,Ml.current)}function vm(){Us=fd.current,ye(Ml),ye(fd)}var la=0,Ot=null,dn=null,jn=null,pd=!1,wl=!1,To=!1,md=0,cu=0,Rl=null,ZR=0;function kn(){throw Error(i(321))}function ym(r,a){if(a===null)return!1;for(var l=0;l<a.length&&l<r.length;l++)if(!$i(r[l],a[l]))return!1;return!0}function Em(r,a,l,u,m,_){return la=_,Ot=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,X.H=r===null||r.memoizedState===null?zE:BE,To=!1,_=l(u,m),To=!1,wl&&(_=sE(a,l,u,m)),rE(r),_}function rE(r){X.H=Sd;var a=dn!==null&&dn.next!==null;if(la=0,jn=dn=Ot=null,pd=!1,cu=0,Rl=null,a)throw Error(i(300));r===null||si||(r=r.dependencies,r!==null&&ld(r)&&(si=!0))}function sE(r,a,l,u){Ot=r;var m=0;do{if(wl&&(Rl=null),cu=0,wl=!1,25<=m)throw Error(i(301));if(m+=1,jn=dn=null,r.updateQueue!=null){var _=r.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}X.H=s1,_=a(l,u)}while(wl);return _}function JR(){var r=X.H,a=r.useState()[0];return a=typeof a.then=="function"?uu(a):a,r=r.useState()[0],(dn!==null?dn.memoizedState:null)!==r&&(Ot.flags|=1024),a}function Sm(){var r=md!==0;return md=0,r}function Tm(r,a,l){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~l}function xm(r){if(pd){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}pd=!1}la=0,jn=dn=Ot=null,wl=!1,cu=md=0,Rl=null}function Hi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?Ot.memoizedState=jn=r:jn=jn.next=r,jn}function qn(){if(dn===null){var r=Ot.alternate;r=r!==null?r.memoizedState:null}else r=dn.next;var a=jn===null?Ot.memoizedState:jn.next;if(a!==null)jn=a,dn=r;else{if(r===null)throw Ot.alternate===null?Error(i(467)):Error(i(310));dn=r,r={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},jn===null?Ot.memoizedState=jn=r:jn=jn.next=r}return jn}function bm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function uu(r){var a=cu;return cu+=1,Rl===null&&(Rl=[]),r=Z0(Rl,r,a),a=Ot,(jn===null?a.memoizedState:jn.next)===null&&(a=a.alternate,X.H=a===null||a.memoizedState===null?zE:BE),r}function gd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return uu(r);if(r.$$typeof===k)return Ti(r)}throw Error(i(438,String(r)))}function Am(r){var a=null,l=Ot.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Ot.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=bm(),Ot.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(r),u=0;u<r;u++)l[u]=w;return a.index++,l}function Rs(r,a){return typeof a=="function"?a(r):a}function _d(r){var a=qn();return Mm(a,dn,r)}function Mm(r,a,l){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=l;var m=r.baseQueue,_=u.pending;if(_!==null){if(m!==null){var I=m.next;m.next=_.next,_.next=I}a.baseQueue=m=_,u.pending=null}if(_=r.baseState,m===null)r.memoizedState=_;else{a=m.next;var z=I=null,Y=null,ue=a,Te=!1;do{var Re=ue.lane&-536870913;if(Re!==ue.lane?(Kt&Re)===Re:(la&Re)===Re){var de=ue.revertLane;if(de===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),Re===bl&&(Te=!0);else if((la&de)===de){ue=ue.next,de===bl&&(Te=!0);continue}else Re={lane:0,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Y===null?(z=Y=Re,I=_):Y=Y.next=Re,Ot.lanes|=de,ma|=de;Re=ue.action,To&&l(_,Re),_=ue.hasEagerState?ue.eagerState:l(_,Re)}else de={lane:Re,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},Y===null?(z=Y=de,I=_):Y=Y.next=de,Ot.lanes|=Re,ma|=Re;ue=ue.next}while(ue!==null&&ue!==a);if(Y===null?I=_:Y.next=z,!$i(_,r.memoizedState)&&(si=!0,Te&&(l=Al,l!==null)))throw l;r.memoizedState=_,r.baseState=I,r.baseQueue=Y,u.lastRenderedState=_}return m===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function wm(r){var a=qn(),l=a.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var u=l.dispatch,m=l.pending,_=a.memoizedState;if(m!==null){l.pending=null;var I=m=m.next;do _=r(_,I.action),I=I.next;while(I!==m);$i(_,a.memoizedState)||(si=!0),a.memoizedState=_,a.baseQueue===null&&(a.baseState=_),l.lastRenderedState=_}return[_,u]}function aE(r,a,l){var u=Ot,m=qn(),_=rn;if(_){if(l===void 0)throw Error(i(407));l=l()}else l=a();var I=!$i((dn||m).memoizedState,l);I&&(m.memoizedState=l,si=!0),m=m.queue;var z=cE.bind(null,u,m,r);if(hu(2048,8,z,[r]),m.getSnapshot!==a||I||jn!==null&&jn.memoizedState.tag&1){if(u.flags|=2048,Cl(9,vd(),lE.bind(null,u,m,l,a),null),Sn===null)throw Error(i(349));_||(la&124)!==0||oE(u,a,l)}return l}function oE(r,a,l){r.flags|=16384,r={getSnapshot:a,value:l},a=Ot.updateQueue,a===null?(a=bm(),Ot.updateQueue=a,a.stores=[r]):(l=a.stores,l===null?a.stores=[r]:l.push(r))}function lE(r,a,l,u){a.value=l,a.getSnapshot=u,uE(a)&&hE(r)}function cE(r,a,l){return l(function(){uE(a)&&hE(r)})}function uE(r){var a=r.getSnapshot;r=r.value;try{var l=a();return!$i(r,l)}catch{return!0}}function hE(r){var a=El(r,2);a!==null&&nr(a,r,2)}function Rm(r){var a=Hi();if(typeof r=="function"){var l=r;if(r=l(),To){ve(!0);try{l()}finally{ve(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:r},a}function dE(r,a,l,u){return r.baseState=l,Mm(r,dn,typeof u=="function"?u:Rs)}function e1(r,a,l,u,m){if(Ed(r))throw Error(i(485));if(r=a.action,r!==null){var _={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){_.listeners.push(I)}};X.T!==null?l(!0):_.isTransition=!1,u(_),l=a.pending,l===null?(_.next=a.pending=_,fE(a,_)):(_.next=l.next,a.pending=l.next=_)}}function fE(r,a){var l=a.action,u=a.payload,m=r.state;if(a.isTransition){var _=X.T,I={};X.T=I;try{var z=l(m,u),Y=X.S;Y!==null&&Y(I,z),pE(r,a,z)}catch(ue){Cm(r,a,ue)}finally{X.T=_}}else try{_=l(m,u),pE(r,a,_)}catch(ue){Cm(r,a,ue)}}function pE(r,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){mE(r,a,u)},function(u){return Cm(r,a,u)}):mE(r,a,l)}function mE(r,a,l){a.status="fulfilled",a.value=l,gE(a),r.state=l,a=r.pending,a!==null&&(l=a.next,l===a?r.pending=null:(l=l.next,a.next=l,fE(r,l)))}function Cm(r,a,l){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,gE(a),a=a.next;while(a!==u)}r.action=null}function gE(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function _E(r,a){return a}function vE(r,a){if(rn){var l=Sn.formState;if(l!==null){e:{var u=Ot;if(rn){if(Ln){t:{for(var m=Ln,_=es;m.nodeType!==8;){if(!_){m=null;break t}if(m=Ur(m.nextSibling),m===null){m=null;break t}}_=m.data,m=_==="F!"||_==="F"?m:null}if(m){Ln=Ur(m.nextSibling),u=m.data==="F!";break e}}vo(u)}u=!1}u&&(a=l[0])}}return l=Hi(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_E,lastRenderedState:a},l.queue=u,l=VE.bind(null,Ot,u),u.dispatch=l,u=Rm(!1),_=Um.bind(null,Ot,!1,u.queue),u=Hi(),m={state:a,dispatch:null,action:r,pending:null},u.queue=m,l=e1.bind(null,Ot,m,_,l),m.dispatch=l,u.memoizedState=r,[a,l,!1]}function yE(r){var a=qn();return EE(a,dn,r)}function EE(r,a,l){if(a=Mm(r,a,_E)[0],r=_d(Rs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=uu(a)}catch(I){throw I===ru?hd:I}else u=a;a=qn();var m=a.queue,_=m.dispatch;return l!==a.memoizedState&&(Ot.flags|=2048,Cl(9,vd(),t1.bind(null,m,l),null)),[u,_,r]}function t1(r,a){r.action=a}function SE(r){var a=qn(),l=dn;if(l!==null)return EE(a,l,r);qn(),a=a.memoizedState,l=qn();var u=l.queue.dispatch;return l.memoizedState=r,[a,u,!1]}function Cl(r,a,l,u){return r={tag:r,create:l,deps:u,inst:a,next:null},a=Ot.updateQueue,a===null&&(a=bm(),Ot.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=r.next=r:(u=l.next,l.next=r,r.next=u,a.lastEffect=r),r}function vd(){return{destroy:void 0,resource:void 0}}function TE(){return qn().memoizedState}function yd(r,a,l,u){var m=Hi();u=u===void 0?null:u,Ot.flags|=r,m.memoizedState=Cl(1|a,vd(),l,u)}function hu(r,a,l,u){var m=qn();u=u===void 0?null:u;var _=m.memoizedState.inst;dn!==null&&u!==null&&ym(u,dn.memoizedState.deps)?m.memoizedState=Cl(a,_,l,u):(Ot.flags|=r,m.memoizedState=Cl(1|a,_,l,u))}function xE(r,a){yd(8390656,8,r,a)}function bE(r,a){hu(2048,8,r,a)}function AE(r,a){return hu(4,2,r,a)}function ME(r,a){return hu(4,4,r,a)}function wE(r,a){if(typeof a=="function"){r=r();var l=a(r);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function RE(r,a,l){l=l!=null?l.concat([r]):null,hu(4,4,wE.bind(null,a,r),l)}function Im(){}function CE(r,a){var l=qn();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&ym(a,u[1])?u[0]:(l.memoizedState=[r,a],r)}function IE(r,a){var l=qn();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&ym(a,u[1]))return u[0];if(u=r(),To){ve(!0);try{r()}finally{ve(!1)}}return l.memoizedState=[u,a],u}function Dm(r,a,l){return l===void 0||(la&1073741824)!==0?r.memoizedState=a:(r.memoizedState=l,r=PS(),Ot.lanes|=r,ma|=r,l)}function DE(r,a,l,u){return $i(l,a)?l:Ml.current!==null?(r=Dm(r,l,u),$i(r,a)||(si=!0),r):(la&42)===0?(si=!0,r.memoizedState=l):(r=PS(),Ot.lanes|=r,ma|=r,a)}function NE(r,a,l,u,m){var _=Z.p;Z.p=_!==0&&8>_?_:8;var I=X.T,z={};X.T=z,Um(r,!1,a,l);try{var Y=m(),ue=X.S;if(ue!==null&&ue(z,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var Te=QR(Y,u);du(r,a,Te,tr(r))}else du(r,a,u,tr(r))}catch(Re){du(r,a,{then:function(){},status:"rejected",reason:Re},tr())}finally{Z.p=_,X.T=I}}function n1(){}function Nm(r,a,l,u){if(r.tag!==5)throw Error(i(476));var m=PE(r).queue;NE(r,m,a,J,l===null?n1:function(){return UE(r),l(u)})}function PE(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:J},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:l},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function UE(r){var a=PE(r).next.queue;du(r,a,{},tr())}function Pm(){return Ti(Iu)}function LE(){return qn().memoizedState}function OE(){return qn().memoizedState}function i1(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var l=tr();r=aa(l);var u=oa(a,r,l);u!==null&&(nr(u,a,l),au(u,a,l)),a={cache:cm()},r.payload=a;return}a=a.return}}function r1(r,a,l){var u=tr();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Ed(r)?FE(a,l):(l=Jp(r,a,l,u),l!==null&&(nr(l,r,u),kE(l,a,u)))}function VE(r,a,l){var u=tr();du(r,a,l,u)}function du(r,a,l,u){var m={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Ed(r))FE(a,m);else{var _=r.alternate;if(r.lanes===0&&(_===null||_.lanes===0)&&(_=a.lastRenderedReducer,_!==null))try{var I=a.lastRenderedState,z=_(I,l);if(m.hasEagerState=!0,m.eagerState=z,$i(z,I))return id(r,a,m,0),Sn===null&&nd(),!1}catch{}finally{}if(l=Jp(r,a,m,u),l!==null)return nr(l,r,u),kE(l,a,u),!0}return!1}function Um(r,a,l,u){if(u={lane:2,revertLane:dg(),action:u,hasEagerState:!1,eagerState:null,next:null},Ed(r)){if(a)throw Error(i(479))}else a=Jp(r,l,u,2),a!==null&&nr(a,r,2)}function Ed(r){var a=r.alternate;return r===Ot||a!==null&&a===Ot}function FE(r,a){wl=pd=!0;var l=r.pending;l===null?a.next=a:(a.next=l.next,l.next=a),r.pending=a}function kE(r,a,l){if((l&4194048)!==0){var u=a.lanes;u&=r.pendingLanes,l|=u,a.lanes=l,Ze(r,l)}}var Sd={readContext:Ti,use:gd,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useLayoutEffect:kn,useInsertionEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useSyncExternalStore:kn,useId:kn,useHostTransitionStatus:kn,useFormState:kn,useActionState:kn,useOptimistic:kn,useMemoCache:kn,useCacheRefresh:kn},zE={readContext:Ti,use:gd,useCallback:function(r,a){return Hi().memoizedState=[r,a===void 0?null:a],r},useContext:Ti,useEffect:xE,useImperativeHandle:function(r,a,l){l=l!=null?l.concat([r]):null,yd(4194308,4,wE.bind(null,a,r),l)},useLayoutEffect:function(r,a){return yd(4194308,4,r,a)},useInsertionEffect:function(r,a){yd(4,2,r,a)},useMemo:function(r,a){var l=Hi();a=a===void 0?null:a;var u=r();if(To){ve(!0);try{r()}finally{ve(!1)}}return l.memoizedState=[u,a],u},useReducer:function(r,a,l){var u=Hi();if(l!==void 0){var m=l(a);if(To){ve(!0);try{l(a)}finally{ve(!1)}}}else m=a;return u.memoizedState=u.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},u.queue=r,r=r.dispatch=r1.bind(null,Ot,r),[u.memoizedState,r]},useRef:function(r){var a=Hi();return r={current:r},a.memoizedState=r},useState:function(r){r=Rm(r);var a=r.queue,l=VE.bind(null,Ot,a);return a.dispatch=l,[r.memoizedState,l]},useDebugValue:Im,useDeferredValue:function(r,a){var l=Hi();return Dm(l,r,a)},useTransition:function(){var r=Rm(!1);return r=NE.bind(null,Ot,r.queue,!0,!1),Hi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,l){var u=Ot,m=Hi();if(rn){if(l===void 0)throw Error(i(407));l=l()}else{if(l=a(),Sn===null)throw Error(i(349));(Kt&124)!==0||oE(u,a,l)}m.memoizedState=l;var _={value:l,getSnapshot:a};return m.queue=_,xE(cE.bind(null,u,_,r),[r]),u.flags|=2048,Cl(9,vd(),lE.bind(null,u,_,l,a),null),l},useId:function(){var r=Hi(),a=Sn.identifierPrefix;if(rn){var l=As,u=bs;l=(u&~(1<<32-Xe(u)-1)).toString(32)+l,a="«"+a+"R"+l,l=md++,0<l&&(a+="H"+l.toString(32)),a+="»"}else l=ZR++,a="«"+a+"r"+l.toString(32)+"»";return r.memoizedState=a},useHostTransitionStatus:Pm,useFormState:vE,useActionState:vE,useOptimistic:function(r){var a=Hi();a.memoizedState=a.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Um.bind(null,Ot,!0,l),l.dispatch=a,[r,a]},useMemoCache:Am,useCacheRefresh:function(){return Hi().memoizedState=i1.bind(null,Ot)}},BE={readContext:Ti,use:gd,useCallback:CE,useContext:Ti,useEffect:bE,useImperativeHandle:RE,useInsertionEffect:AE,useLayoutEffect:ME,useMemo:IE,useReducer:_d,useRef:TE,useState:function(){return _d(Rs)},useDebugValue:Im,useDeferredValue:function(r,a){var l=qn();return DE(l,dn.memoizedState,r,a)},useTransition:function(){var r=_d(Rs)[0],a=qn().memoizedState;return[typeof r=="boolean"?r:uu(r),a]},useSyncExternalStore:aE,useId:LE,useHostTransitionStatus:Pm,useFormState:yE,useActionState:yE,useOptimistic:function(r,a){var l=qn();return dE(l,dn,r,a)},useMemoCache:Am,useCacheRefresh:OE},s1={readContext:Ti,use:gd,useCallback:CE,useContext:Ti,useEffect:bE,useImperativeHandle:RE,useInsertionEffect:AE,useLayoutEffect:ME,useMemo:IE,useReducer:wm,useRef:TE,useState:function(){return wm(Rs)},useDebugValue:Im,useDeferredValue:function(r,a){var l=qn();return dn===null?Dm(l,r,a):DE(l,dn.memoizedState,r,a)},useTransition:function(){var r=wm(Rs)[0],a=qn().memoizedState;return[typeof r=="boolean"?r:uu(r),a]},useSyncExternalStore:aE,useId:LE,useHostTransitionStatus:Pm,useFormState:SE,useActionState:SE,useOptimistic:function(r,a){var l=qn();return dn!==null?dE(l,dn,r,a):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:Am,useCacheRefresh:OE},Il=null,fu=0;function Td(r){var a=fu;return fu+=1,Il===null&&(Il=[]),Z0(Il,r,a)}function pu(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function xd(r,a){throw a.$$typeof===v?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function HE(r){var a=r._init;return a(r._payload)}function GE(r){function a(ne,$){if(r){var ae=ne.deletions;ae===null?(ne.deletions=[$],ne.flags|=16):ae.push($)}}function l(ne,$){if(!r)return null;for(;$!==null;)a(ne,$),$=$.sibling;return null}function u(ne){for(var $=new Map;ne!==null;)ne.key!==null?$.set(ne.key,ne):$.set(ne.index,ne),ne=ne.sibling;return $}function m(ne,$){return ne=xs(ne,$),ne.index=0,ne.sibling=null,ne}function _(ne,$,ae){return ne.index=ae,r?(ae=ne.alternate,ae!==null?(ae=ae.index,ae<$?(ne.flags|=67108866,$):ae):(ne.flags|=67108866,$)):(ne.flags|=1048576,$)}function I(ne){return r&&ne.alternate===null&&(ne.flags|=67108866),ne}function z(ne,$,ae,Me){return $===null||$.tag!==6?($=tm(ae,ne.mode,Me),$.return=ne,$):($=m($,ae),$.return=ne,$)}function Y(ne,$,ae,Me){var it=ae.type;return it===b?Te(ne,$,ae.props.children,Me,ae.key):$!==null&&($.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===N&&HE(it)===$.type)?($=m($,ae.props),pu($,ae),$.return=ne,$):($=sd(ae.type,ae.key,ae.props,null,ne.mode,Me),pu($,ae),$.return=ne,$)}function ue(ne,$,ae,Me){return $===null||$.tag!==4||$.stateNode.containerInfo!==ae.containerInfo||$.stateNode.implementation!==ae.implementation?($=nm(ae,ne.mode,Me),$.return=ne,$):($=m($,ae.children||[]),$.return=ne,$)}function Te(ne,$,ae,Me,it){return $===null||$.tag!==7?($=po(ae,ne.mode,Me,it),$.return=ne,$):($=m($,ae),$.return=ne,$)}function Re(ne,$,ae){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=tm(""+$,ne.mode,ae),$.return=ne,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case y:return ae=sd($.type,$.key,$.props,null,ne.mode,ae),pu(ae,$),ae.return=ne,ae;case E:return $=nm($,ne.mode,ae),$.return=ne,$;case N:var Me=$._init;return $=Me($._payload),Re(ne,$,ae)}if(oe($)||O($))return $=po($,ne.mode,ae,null),$.return=ne,$;if(typeof $.then=="function")return Re(ne,Td($),ae);if($.$$typeof===k)return Re(ne,cd(ne,$),ae);xd(ne,$)}return null}function de(ne,$,ae,Me){var it=$!==null?$.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return it!==null?null:z(ne,$,""+ae,Me);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:return ae.key===it?Y(ne,$,ae,Me):null;case E:return ae.key===it?ue(ne,$,ae,Me):null;case N:return it=ae._init,ae=it(ae._payload),de(ne,$,ae,Me)}if(oe(ae)||O(ae))return it!==null?null:Te(ne,$,ae,Me,null);if(typeof ae.then=="function")return de(ne,$,Td(ae),Me);if(ae.$$typeof===k)return de(ne,$,cd(ne,ae),Me);xd(ne,ae)}return null}function fe(ne,$,ae,Me,it){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return ne=ne.get(ae)||null,z($,ne,""+Me,it);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case y:return ne=ne.get(Me.key===null?ae:Me.key)||null,Y($,ne,Me,it);case E:return ne=ne.get(Me.key===null?ae:Me.key)||null,ue($,ne,Me,it);case N:var Vt=Me._init;return Me=Vt(Me._payload),fe(ne,$,ae,Me,it)}if(oe(Me)||O(Me))return ne=ne.get(ae)||null,Te($,ne,Me,it,null);if(typeof Me.then=="function")return fe(ne,$,ae,Td(Me),it);if(Me.$$typeof===k)return fe(ne,$,ae,cd($,Me),it);xd($,Me)}return null}function yt(ne,$,ae,Me){for(var it=null,Vt=null,ut=$,_t=$=0,oi=null;ut!==null&&_t<ae.length;_t++){ut.index>_t?(oi=ut,ut=null):oi=ut.sibling;var en=de(ne,ut,ae[_t],Me);if(en===null){ut===null&&(ut=oi);break}r&&ut&&en.alternate===null&&a(ne,ut),$=_(en,$,_t),Vt===null?it=en:Vt.sibling=en,Vt=en,ut=oi}if(_t===ae.length)return l(ne,ut),rn&&go(ne,_t),it;if(ut===null){for(;_t<ae.length;_t++)ut=Re(ne,ae[_t],Me),ut!==null&&($=_(ut,$,_t),Vt===null?it=ut:Vt.sibling=ut,Vt=ut);return rn&&go(ne,_t),it}for(ut=u(ut);_t<ae.length;_t++)oi=fe(ut,ne,_t,ae[_t],Me),oi!==null&&(r&&oi.alternate!==null&&ut.delete(oi.key===null?_t:oi.key),$=_(oi,$,_t),Vt===null?it=oi:Vt.sibling=oi,Vt=oi);return r&&ut.forEach(function(ba){return a(ne,ba)}),rn&&go(ne,_t),it}function gt(ne,$,ae,Me){if(ae==null)throw Error(i(151));for(var it=null,Vt=null,ut=$,_t=$=0,oi=null,en=ae.next();ut!==null&&!en.done;_t++,en=ae.next()){ut.index>_t?(oi=ut,ut=null):oi=ut.sibling;var ba=de(ne,ut,en.value,Me);if(ba===null){ut===null&&(ut=oi);break}r&&ut&&ba.alternate===null&&a(ne,ut),$=_(ba,$,_t),Vt===null?it=ba:Vt.sibling=ba,Vt=ba,ut=oi}if(en.done)return l(ne,ut),rn&&go(ne,_t),it;if(ut===null){for(;!en.done;_t++,en=ae.next())en=Re(ne,en.value,Me),en!==null&&($=_(en,$,_t),Vt===null?it=en:Vt.sibling=en,Vt=en);return rn&&go(ne,_t),it}for(ut=u(ut);!en.done;_t++,en=ae.next())en=fe(ut,ne,_t,en.value,Me),en!==null&&(r&&en.alternate!==null&&ut.delete(en.key===null?_t:en.key),$=_(en,$,_t),Vt===null?it=en:Vt.sibling=en,Vt=en);return r&&ut.forEach(function(aC){return a(ne,aC)}),rn&&go(ne,_t),it}function pn(ne,$,ae,Me){if(typeof ae=="object"&&ae!==null&&ae.type===b&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case y:e:{for(var it=ae.key;$!==null;){if($.key===it){if(it=ae.type,it===b){if($.tag===7){l(ne,$.sibling),Me=m($,ae.props.children),Me.return=ne,ne=Me;break e}}else if($.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===N&&HE(it)===$.type){l(ne,$.sibling),Me=m($,ae.props),pu(Me,ae),Me.return=ne,ne=Me;break e}l(ne,$);break}else a(ne,$);$=$.sibling}ae.type===b?(Me=po(ae.props.children,ne.mode,Me,ae.key),Me.return=ne,ne=Me):(Me=sd(ae.type,ae.key,ae.props,null,ne.mode,Me),pu(Me,ae),Me.return=ne,ne=Me)}return I(ne);case E:e:{for(it=ae.key;$!==null;){if($.key===it)if($.tag===4&&$.stateNode.containerInfo===ae.containerInfo&&$.stateNode.implementation===ae.implementation){l(ne,$.sibling),Me=m($,ae.children||[]),Me.return=ne,ne=Me;break e}else{l(ne,$);break}else a(ne,$);$=$.sibling}Me=nm(ae,ne.mode,Me),Me.return=ne,ne=Me}return I(ne);case N:return it=ae._init,ae=it(ae._payload),pn(ne,$,ae,Me)}if(oe(ae))return yt(ne,$,ae,Me);if(O(ae)){if(it=O(ae),typeof it!="function")throw Error(i(150));return ae=it.call(ae),gt(ne,$,ae,Me)}if(typeof ae.then=="function")return pn(ne,$,Td(ae),Me);if(ae.$$typeof===k)return pn(ne,$,cd(ne,ae),Me);xd(ne,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,$!==null&&$.tag===6?(l(ne,$.sibling),Me=m($,ae),Me.return=ne,ne=Me):(l(ne,$),Me=tm(ae,ne.mode,Me),Me.return=ne,ne=Me),I(ne)):l(ne,$)}return function(ne,$,ae,Me){try{fu=0;var it=pn(ne,$,ae,Me);return Il=null,it}catch(ut){if(ut===ru||ut===hd)throw ut;var Vt=Qi(29,ut,null,ne.mode);return Vt.lanes=Me,Vt.return=ne,Vt}finally{}}}var Dl=GE(!0),jE=GE(!1),yr=ee(null),ts=null;function ca(r){var a=r.alternate;Ee(Jn,Jn.current&1),Ee(yr,r),ts===null&&(a===null||Ml.current!==null||a.memoizedState!==null)&&(ts=r)}function qE(r){if(r.tag===22){if(Ee(Jn,Jn.current),Ee(yr,r),ts===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&(ts=r)}}else ua()}function ua(){Ee(Jn,Jn.current),Ee(yr,yr.current)}function Cs(r){ye(yr),ts===r&&(ts=null),ye(Jn)}var Jn=ee(0);function bd(r){for(var a=r;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||bg(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function Lm(r,a,l,u){a=r.memoizedState,l=l(u,a),l=l==null?a:g({},a,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Om={enqueueSetState:function(r,a,l){r=r._reactInternals;var u=tr(),m=aa(u);m.payload=a,l!=null&&(m.callback=l),a=oa(r,m,u),a!==null&&(nr(a,r,u),au(a,r,u))},enqueueReplaceState:function(r,a,l){r=r._reactInternals;var u=tr(),m=aa(u);m.tag=1,m.payload=a,l!=null&&(m.callback=l),a=oa(r,m,u),a!==null&&(nr(a,r,u),au(a,r,u))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var l=tr(),u=aa(l);u.tag=2,a!=null&&(u.callback=a),a=oa(r,u,l),a!==null&&(nr(a,r,l),au(a,r,l))}};function WE(r,a,l,u,m,_,I){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,_,I):a.prototype&&a.prototype.isPureReactComponent?!$c(l,u)||!$c(m,_):!0}function XE(r,a,l,u){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==r&&Om.enqueueReplaceState(a,a.state,null)}function xo(r,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(r=r.defaultProps){l===a&&(l=g({},l));for(var m in r)l[m]===void 0&&(l[m]=r[m])}return l}var Ad=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function YE(r){Ad(r)}function KE(r){console.error(r)}function $E(r){Ad(r)}function Md(r,a){try{var l=r.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function QE(r,a,l){try{var u=r.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Vm(r,a,l){return l=aa(l),l.tag=3,l.payload={element:null},l.callback=function(){Md(r,a)},l}function ZE(r){return r=aa(r),r.tag=3,r}function JE(r,a,l,u){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var _=u.value;r.payload=function(){return m(_)},r.callback=function(){QE(a,l,u)}}var I=l.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(r.callback=function(){QE(a,l,u),typeof m!="function"&&(ga===null?ga=new Set([this]):ga.add(this));var z=u.stack;this.componentDidCatch(u.value,{componentStack:z!==null?z:""})})}function a1(r,a,l,u,m){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&tu(a,l,m,!0),l=yr.current,l!==null){switch(l.tag){case 13:return ts===null?og():l.alternate===null&&On===0&&(On=3),l.flags&=-257,l.flags|=65536,l.lanes=m,u===dm?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),cg(r,u,m)),!1;case 22:return l.flags|=65536,u===dm?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),cg(r,u,m)),!1}throw Error(i(435,l.tag))}return cg(r,u,m),og(),!1}if(rn)return a=yr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,u!==sm&&(r=Error(i(422),{cause:u}),eu(mr(r,l)))):(u!==sm&&(a=Error(i(423),{cause:u}),eu(mr(a,l))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,u=mr(u,l),m=Vm(r.stateNode,u,m),mm(r,m),On!==4&&(On=2)),!1;var _=Error(i(520),{cause:u});if(_=mr(_,l),Su===null?Su=[_]:Su.push(_),On!==4&&(On=2),a===null)return!0;u=mr(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,r=m&-m,l.lanes|=r,r=Vm(l.stateNode,u,r),mm(l,r),!1;case 1:if(a=l.type,_=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ga===null||!ga.has(_))))return l.flags|=65536,m&=-m,l.lanes|=m,m=ZE(m),JE(m,r,l,u),mm(l,m),!1}l=l.return}while(l!==null);return!1}var eS=Error(i(461)),si=!1;function fi(r,a,l,u){a.child=r===null?jE(a,null,l,u):Dl(a,r.child,l,u)}function tS(r,a,l,u,m){l=l.render;var _=a.ref;if("ref"in u){var I={};for(var z in u)z!=="ref"&&(I[z]=u[z])}else I=u;return Eo(a),u=Em(r,a,l,I,_,m),z=Sm(),r!==null&&!si?(Tm(r,a,m),Is(r,a,m)):(rn&&z&&im(a),a.flags|=1,fi(r,a,u,m),a.child)}function nS(r,a,l,u,m){if(r===null){var _=l.type;return typeof _=="function"&&!em(_)&&_.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=_,iS(r,a,_,u,m)):(r=sd(l.type,null,u,a,a.mode,m),r.ref=a.ref,r.return=a,a.child=r)}if(_=r.child,!qm(r,m)){var I=_.memoizedProps;if(l=l.compare,l=l!==null?l:$c,l(I,u)&&r.ref===a.ref)return Is(r,a,m)}return a.flags|=1,r=xs(_,u),r.ref=a.ref,r.return=a,a.child=r}function iS(r,a,l,u,m){if(r!==null){var _=r.memoizedProps;if($c(_,u)&&r.ref===a.ref)if(si=!1,a.pendingProps=u=_,qm(r,m))(r.flags&131072)!==0&&(si=!0);else return a.lanes=r.lanes,Is(r,a,m)}return Fm(r,a,l,u,m)}function rS(r,a,l){var u=a.pendingProps,m=u.children,_=r!==null?r.memoizedState:null;if(u.mode==="hidden"){if((a.flags&128)!==0){if(u=_!==null?_.baseLanes|l:l,r!==null){for(m=a.child=r.child,_=0;m!==null;)_=_|m.lanes|m.childLanes,m=m.sibling;a.childLanes=_&~u}else a.childLanes=0,a.child=null;return sS(r,a,u,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&ud(a,_!==null?_.cachePool:null),_!==null?iE(a,_):_m(),qE(a);else return a.lanes=a.childLanes=536870912,sS(r,a,_!==null?_.baseLanes|l:l,l)}else _!==null?(ud(a,_.cachePool),iE(a,_),ua(),a.memoizedState=null):(r!==null&&ud(a,null),_m(),ua());return fi(r,a,m,l),a.child}function sS(r,a,l,u){var m=hm();return m=m===null?null:{parent:Zn._currentValue,pool:m},a.memoizedState={baseLanes:l,cachePool:m},r!==null&&ud(a,null),_m(),qE(a),r!==null&&tu(r,a,u,!0),null}function wd(r,a){var l=a.ref;if(l===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(a.flags|=4194816)}}function Fm(r,a,l,u,m){return Eo(a),l=Em(r,a,l,u,void 0,m),u=Sm(),r!==null&&!si?(Tm(r,a,m),Is(r,a,m)):(rn&&u&&im(a),a.flags|=1,fi(r,a,l,m),a.child)}function aS(r,a,l,u,m,_){return Eo(a),a.updateQueue=null,l=sE(a,u,l,m),rE(r),u=Sm(),r!==null&&!si?(Tm(r,a,_),Is(r,a,_)):(rn&&u&&im(a),a.flags|=1,fi(r,a,l,_),a.child)}function oS(r,a,l,u,m){if(Eo(a),a.stateNode===null){var _=Sl,I=l.contextType;typeof I=="object"&&I!==null&&(_=Ti(I)),_=new l(u,_),a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Om,a.stateNode=_,_._reactInternals=a,_=a.stateNode,_.props=u,_.state=a.memoizedState,_.refs={},fm(a),I=l.contextType,_.context=typeof I=="object"&&I!==null?Ti(I):Sl,_.state=a.memoizedState,I=l.getDerivedStateFromProps,typeof I=="function"&&(Lm(a,l,I,u),_.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(I=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),I!==_.state&&Om.enqueueReplaceState(_,_.state,null),lu(a,u,_,m),ou(),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(r===null){_=a.stateNode;var z=a.memoizedProps,Y=xo(l,z);_.props=Y;var ue=_.context,Te=l.contextType;I=Sl,typeof Te=="object"&&Te!==null&&(I=Ti(Te));var Re=l.getDerivedStateFromProps;Te=typeof Re=="function"||typeof _.getSnapshotBeforeUpdate=="function",z=a.pendingProps!==z,Te||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(z||ue!==I)&&XE(a,_,u,I),sa=!1;var de=a.memoizedState;_.state=de,lu(a,u,_,m),ou(),ue=a.memoizedState,z||de!==ue||sa?(typeof Re=="function"&&(Lm(a,l,Re,u),ue=a.memoizedState),(Y=sa||WE(a,l,Y,u,de,ue,I))?(Te||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(a.flags|=4194308)):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=ue),_.props=u,_.state=ue,_.context=I,u=Y):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{_=a.stateNode,pm(r,a),I=a.memoizedProps,Te=xo(l,I),_.props=Te,Re=a.pendingProps,de=_.context,ue=l.contextType,Y=Sl,typeof ue=="object"&&ue!==null&&(Y=Ti(ue)),z=l.getDerivedStateFromProps,(ue=typeof z=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(I!==Re||de!==Y)&&XE(a,_,u,Y),sa=!1,de=a.memoizedState,_.state=de,lu(a,u,_,m),ou();var fe=a.memoizedState;I!==Re||de!==fe||sa||r!==null&&r.dependencies!==null&&ld(r.dependencies)?(typeof z=="function"&&(Lm(a,l,z,u),fe=a.memoizedState),(Te=sa||WE(a,l,Te,u,de,fe,Y)||r!==null&&r.dependencies!==null&&ld(r.dependencies))?(ue||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(u,fe,Y),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(u,fe,Y)),typeof _.componentDidUpdate=="function"&&(a.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof _.componentDidUpdate!="function"||I===r.memoizedProps&&de===r.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===r.memoizedProps&&de===r.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=fe),_.props=u,_.state=fe,_.context=Y,u=Te):(typeof _.componentDidUpdate!="function"||I===r.memoizedProps&&de===r.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===r.memoizedProps&&de===r.memoizedState||(a.flags|=1024),u=!1)}return _=u,wd(r,a),u=(a.flags&128)!==0,_||u?(_=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:_.render(),a.flags|=1,r!==null&&u?(a.child=Dl(a,r.child,null,m),a.child=Dl(a,null,l,m)):fi(r,a,l,m),a.memoizedState=_.state,r=a.child):r=Is(r,a,m),r}function lS(r,a,l,u){return Jc(),a.flags|=256,fi(r,a,l,u),a.child}var km={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zm(r){return{baseLanes:r,cachePool:K0()}}function Bm(r,a,l){return r=r!==null?r.childLanes&~l:0,a&&(r|=Er),r}function cS(r,a,l){var u=a.pendingProps,m=!1,_=(a.flags&128)!==0,I;if((I=_)||(I=r!==null&&r.memoizedState===null?!1:(Jn.current&2)!==0),I&&(m=!0,a.flags&=-129),I=(a.flags&32)!==0,a.flags&=-33,r===null){if(rn){if(m?ca(a):ua(),rn){var z=Ln,Y;if(Y=z){e:{for(Y=z,z=es;Y.nodeType!==8;){if(!z){z=null;break e}if(Y=Ur(Y.nextSibling),Y===null){z=null;break e}}z=Y}z!==null?(a.memoizedState={dehydrated:z,treeContext:mo!==null?{id:bs,overflow:As}:null,retryLane:536870912,hydrationErrors:null},Y=Qi(18,null,null,0),Y.stateNode=z,Y.return=a,a.child=Y,Ni=a,Ln=null,Y=!0):Y=!1}Y||vo(a)}if(z=a.memoizedState,z!==null&&(z=z.dehydrated,z!==null))return bg(z)?a.lanes=32:a.lanes=536870912,null;Cs(a)}return z=u.children,u=u.fallback,m?(ua(),m=a.mode,z=Rd({mode:"hidden",children:z},m),u=po(u,m,l,null),z.return=a,u.return=a,z.sibling=u,a.child=z,m=a.child,m.memoizedState=zm(l),m.childLanes=Bm(r,I,l),a.memoizedState=km,u):(ca(a),Hm(a,z))}if(Y=r.memoizedState,Y!==null&&(z=Y.dehydrated,z!==null)){if(_)a.flags&256?(ca(a),a.flags&=-257,a=Gm(r,a,l)):a.memoizedState!==null?(ua(),a.child=r.child,a.flags|=128,a=null):(ua(),m=u.fallback,z=a.mode,u=Rd({mode:"visible",children:u.children},z),m=po(m,z,l,null),m.flags|=2,u.return=a,m.return=a,u.sibling=m,a.child=u,Dl(a,r.child,null,l),u=a.child,u.memoizedState=zm(l),u.childLanes=Bm(r,I,l),a.memoizedState=km,a=m);else if(ca(a),bg(z)){if(I=z.nextSibling&&z.nextSibling.dataset,I)var ue=I.dgst;I=ue,u=Error(i(419)),u.stack="",u.digest=I,eu({value:u,source:null,stack:null}),a=Gm(r,a,l)}else if(si||tu(r,a,l,!1),I=(l&r.childLanes)!==0,si||I){if(I=Sn,I!==null&&(u=l&-l,u=(u&42)!==0?1:pt(u),u=(u&(I.suspendedLanes|l))!==0?0:u,u!==0&&u!==Y.retryLane))throw Y.retryLane=u,El(r,u),nr(I,r,u),eS;z.data==="$?"||og(),a=Gm(r,a,l)}else z.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=Y.treeContext,Ln=Ur(z.nextSibling),Ni=a,rn=!0,_o=null,es=!1,r!==null&&(_r[vr++]=bs,_r[vr++]=As,_r[vr++]=mo,bs=r.id,As=r.overflow,mo=a),a=Hm(a,u.children),a.flags|=4096);return a}return m?(ua(),m=u.fallback,z=a.mode,Y=r.child,ue=Y.sibling,u=xs(Y,{mode:"hidden",children:u.children}),u.subtreeFlags=Y.subtreeFlags&65011712,ue!==null?m=xs(ue,m):(m=po(m,z,l,null),m.flags|=2),m.return=a,u.return=a,u.sibling=m,a.child=u,u=m,m=a.child,z=r.child.memoizedState,z===null?z=zm(l):(Y=z.cachePool,Y!==null?(ue=Zn._currentValue,Y=Y.parent!==ue?{parent:ue,pool:ue}:Y):Y=K0(),z={baseLanes:z.baseLanes|l,cachePool:Y}),m.memoizedState=z,m.childLanes=Bm(r,I,l),a.memoizedState=km,u):(ca(a),l=r.child,r=l.sibling,l=xs(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,r!==null&&(I=a.deletions,I===null?(a.deletions=[r],a.flags|=16):I.push(r)),a.child=l,a.memoizedState=null,l)}function Hm(r,a){return a=Rd({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Rd(r,a){return r=Qi(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function Gm(r,a,l){return Dl(a,r.child,null,l),r=Hm(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function uS(r,a,l){r.lanes|=a;var u=r.alternate;u!==null&&(u.lanes|=a),om(r.return,a,l)}function jm(r,a,l,u,m){var _=r.memoizedState;_===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:m}:(_.isBackwards=a,_.rendering=null,_.renderingStartTime=0,_.last=u,_.tail=l,_.tailMode=m)}function hS(r,a,l){var u=a.pendingProps,m=u.revealOrder,_=u.tail;if(fi(r,a,u.children,l),u=Jn.current,(u&2)!==0)u=u&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&uS(r,l,a);else if(r.tag===19)uS(r,l,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}u&=1}switch(Ee(Jn,u),m){case"forwards":for(l=a.child,m=null;l!==null;)r=l.alternate,r!==null&&bd(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=a.child,a.child=null):(m=l.sibling,l.sibling=null),jm(a,!1,m,l,_);break;case"backwards":for(l=null,m=a.child,a.child=null;m!==null;){if(r=m.alternate,r!==null&&bd(r)===null){a.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}jm(a,!0,l,null,_);break;case"together":jm(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Is(r,a,l){if(r!==null&&(a.dependencies=r.dependencies),ma|=a.lanes,(l&a.childLanes)===0)if(r!==null){if(tu(r,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,l=xs(r,r.pendingProps),a.child=l,l.return=a;r.sibling!==null;)r=r.sibling,l=l.sibling=xs(r,r.pendingProps),l.return=a;l.sibling=null}return a.child}function qm(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&ld(r)))}function o1(r,a,l){switch(a.tag){case 3:Oe(a,a.stateNode.containerInfo),ra(a,Zn,r.memoizedState.cache),Jc();break;case 27:case 5:tt(a);break;case 4:Oe(a,a.stateNode.containerInfo);break;case 10:ra(a,a.type,a.memoizedProps.value);break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(ca(a),a.flags|=128,null):(l&a.child.childLanes)!==0?cS(r,a,l):(ca(a),r=Is(r,a,l),r!==null?r.sibling:null);ca(a);break;case 19:var m=(r.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(tu(r,a,l,!1),u=(l&a.childLanes)!==0),m){if(u)return hS(r,a,l);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Ee(Jn,Jn.current),u)break;return null;case 22:case 23:return a.lanes=0,rS(r,a,l);case 24:ra(a,Zn,r.memoizedState.cache)}return Is(r,a,l)}function dS(r,a,l){if(r!==null)if(r.memoizedProps!==a.pendingProps)si=!0;else{if(!qm(r,l)&&(a.flags&128)===0)return si=!1,o1(r,a,l);si=(r.flags&131072)!==0}else si=!1,rn&&(a.flags&1048576)!==0&&H0(a,od,a.index);switch(a.lanes=0,a.tag){case 16:e:{r=a.pendingProps;var u=a.elementType,m=u._init;if(u=m(u._payload),a.type=u,typeof u=="function")em(u)?(r=xo(u,r),a.tag=1,a=oS(null,a,u,r,l)):(a.tag=0,a=Fm(null,a,u,r,l));else{if(u!=null){if(m=u.$$typeof,m===V){a.tag=11,a=tS(null,a,u,r,l);break e}else if(m===U){a.tag=14,a=nS(null,a,u,r,l);break e}}throw a=re(u)||u,Error(i(306,a,""))}}return a;case 0:return Fm(r,a,a.type,a.pendingProps,l);case 1:return u=a.type,m=xo(u,a.pendingProps),oS(r,a,u,m,l);case 3:e:{if(Oe(a,a.stateNode.containerInfo),r===null)throw Error(i(387));u=a.pendingProps;var _=a.memoizedState;m=_.element,pm(r,a),lu(a,u,null,l);var I=a.memoizedState;if(u=I.cache,ra(a,Zn,u),u!==_.cache&&lm(a,[Zn],l,!0),ou(),u=I.element,_.isDehydrated)if(_={element:u,isDehydrated:!1,cache:I.cache},a.updateQueue.baseState=_,a.memoizedState=_,a.flags&256){a=lS(r,a,u,l);break e}else if(u!==m){m=mr(Error(i(424)),a),eu(m),a=lS(r,a,u,l);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Ln=Ur(r.firstChild),Ni=a,rn=!0,_o=null,es=!0,l=jE(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Jc(),u===m){a=Is(r,a,l);break e}fi(r,a,u,l)}a=a.child}return a;case 26:return wd(r,a),r===null?(l=gT(a.type,null,a.pendingProps,null))?a.memoizedState=l:rn||(l=a.type,r=a.pendingProps,u=Hd(le.current).createElement(l),u[Un]=a,u[un]=r,mi(u,l,r),Rn(u),a.stateNode=u):a.memoizedState=gT(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return tt(a),r===null&&rn&&(u=a.stateNode=fT(a.type,a.pendingProps,le.current),Ni=a,es=!0,m=Ln,ya(a.type)?(Ag=m,Ln=Ur(u.firstChild)):Ln=m),fi(r,a,a.pendingProps.children,l),wd(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&rn&&((m=u=Ln)&&(u=L1(u,a.type,a.pendingProps,es),u!==null?(a.stateNode=u,Ni=a,Ln=Ur(u.firstChild),es=!1,m=!0):m=!1),m||vo(a)),tt(a),m=a.type,_=a.pendingProps,I=r!==null?r.memoizedProps:null,u=_.children,Sg(m,_)?u=null:I!==null&&Sg(m,I)&&(a.flags|=32),a.memoizedState!==null&&(m=Em(r,a,JR,null,null,l),Iu._currentValue=m),wd(r,a),fi(r,a,u,l),a.child;case 6:return r===null&&rn&&((r=l=Ln)&&(l=O1(l,a.pendingProps,es),l!==null?(a.stateNode=l,Ni=a,Ln=null,r=!0):r=!1),r||vo(a)),null;case 13:return cS(r,a,l);case 4:return Oe(a,a.stateNode.containerInfo),u=a.pendingProps,r===null?a.child=Dl(a,null,u,l):fi(r,a,u,l),a.child;case 11:return tS(r,a,a.type,a.pendingProps,l);case 7:return fi(r,a,a.pendingProps,l),a.child;case 8:return fi(r,a,a.pendingProps.children,l),a.child;case 12:return fi(r,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,ra(a,a.type,u.value),fi(r,a,u.children,l),a.child;case 9:return m=a.type._context,u=a.pendingProps.children,Eo(a),m=Ti(m),u=u(m),a.flags|=1,fi(r,a,u,l),a.child;case 14:return nS(r,a,a.type,a.pendingProps,l);case 15:return iS(r,a,a.type,a.pendingProps,l);case 19:return hS(r,a,l);case 31:return u=a.pendingProps,l=a.mode,u={mode:u.mode,children:u.children},r===null?(l=Rd(u,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=xs(r.child,u),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return rS(r,a,l);case 24:return Eo(a),u=Ti(Zn),r===null?(m=hm(),m===null&&(m=Sn,_=cm(),m.pooledCache=_,_.refCount++,_!==null&&(m.pooledCacheLanes|=l),m=_),a.memoizedState={parent:u,cache:m},fm(a),ra(a,Zn,m)):((r.lanes&l)!==0&&(pm(r,a),lu(a,null,null,l),ou()),m=r.memoizedState,_=a.memoizedState,m.parent!==u?(m={parent:u,cache:u},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),ra(a,Zn,u)):(u=_.cache,ra(a,Zn,u),u!==m.cache&&lm(a,[Zn],l,!0))),fi(r,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Ds(r){r.flags|=4}function fS(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!ST(a)){if(a=yr.current,a!==null&&((Kt&4194048)===Kt?ts!==null:(Kt&62914560)!==Kt&&(Kt&536870912)===0||a!==ts))throw su=dm,$0;r.flags|=8192}}function Cd(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?Ue():536870912,r.lanes|=a,Ll|=a)}function mu(r,a){if(!rn)switch(r.tailMode){case"hidden":a=r.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function Cn(r){var a=r.alternate!==null&&r.alternate.child===r.child,l=0,u=0;if(a)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=u,r.childLanes=l,a}function l1(r,a,l){var u=a.pendingProps;switch(rm(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cn(a),null;case 1:return Cn(a),null;case 3:return l=a.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),ws(Zn),ht(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(Zc(a)?Ds(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,q0())),Cn(a),null;case 26:return l=a.memoizedState,r===null?(Ds(a),l!==null?(Cn(a),fS(a,l)):(Cn(a),a.flags&=-16777217)):l?l!==r.memoizedState?(Ds(a),Cn(a),fS(a,l)):(Cn(a),a.flags&=-16777217):(r.memoizedProps!==u&&Ds(a),Cn(a),a.flags&=-16777217),null;case 27:bt(a),l=le.current;var m=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==u&&Ds(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return Cn(a),null}r=Pe.current,Zc(a)?G0(a):(r=fT(m,u,l),a.stateNode=r,Ds(a))}return Cn(a),null;case 5:if(bt(a),l=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==u&&Ds(a);else{if(!u){if(a.stateNode===null)throw Error(i(166));return Cn(a),null}if(r=Pe.current,Zc(a))G0(a);else{switch(m=Hd(le.current),r){case 1:r=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:r=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":r=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":r=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":r=m.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?r.multiple=!0:u.size&&(r.size=u.size);break;default:r=typeof u.is=="string"?m.createElement(l,{is:u.is}):m.createElement(l)}}r[Un]=a,r[un]=u;e:for(m=a.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===a)break e;for(;m.sibling===null;){if(m.return===null||m.return===a)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}a.stateNode=r;e:switch(mi(r,l,u),l){case"button":case"input":case"select":case"textarea":r=!!u.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Ds(a)}}return Cn(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==u&&Ds(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(i(166));if(r=le.current,Zc(a)){if(r=a.stateNode,l=a.memoizedProps,u=null,m=Ni,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}r[Un]=a,r=!!(r.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||aT(r.nodeValue,l)),r||vo(a)}else r=Hd(r).createTextNode(u),r[Un]=a,a.stateNode=r}return Cn(a),null;case 13:if(u=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=Zc(a),u!==null&&u.dehydrated!==null){if(r===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Un]=a}else Jc(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Cn(a),m=!1}else m=q0(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Cs(a),a):(Cs(a),null)}if(Cs(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=u!==null,r=r!==null&&r.memoizedState!==null,l){u=a.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var _=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(_=u.memoizedState.cachePool.pool),_!==m&&(u.flags|=2048)}return l!==r&&l&&(a.child.flags|=8192),Cd(a,a.updateQueue),Cn(a),null;case 4:return ht(),r===null&&gg(a.stateNode.containerInfo),Cn(a),null;case 10:return ws(a.type),Cn(a),null;case 19:if(ye(Jn),m=a.memoizedState,m===null)return Cn(a),null;if(u=(a.flags&128)!==0,_=m.rendering,_===null)if(u)mu(m,!1);else{if(On!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(_=bd(r),_!==null){for(a.flags|=128,mu(m,!1),r=_.updateQueue,a.updateQueue=r,Cd(a,r),a.subtreeFlags=0,r=l,l=a.child;l!==null;)B0(l,r),l=l.sibling;return Ee(Jn,Jn.current&1|2),a.child}r=r.sibling}m.tail!==null&&Ke()>Nd&&(a.flags|=128,u=!0,mu(m,!1),a.lanes=4194304)}else{if(!u)if(r=bd(_),r!==null){if(a.flags|=128,u=!0,r=r.updateQueue,a.updateQueue=r,Cd(a,r),mu(m,!0),m.tail===null&&m.tailMode==="hidden"&&!_.alternate&&!rn)return Cn(a),null}else 2*Ke()-m.renderingStartTime>Nd&&l!==536870912&&(a.flags|=128,u=!0,mu(m,!1),a.lanes=4194304);m.isBackwards?(_.sibling=a.child,a.child=_):(r=m.last,r!==null?r.sibling=_:a.child=_,m.last=_)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=Ke(),a.sibling=null,r=Jn.current,Ee(Jn,u?r&1|2:r&1),a):(Cn(a),null);case 22:case 23:return Cs(a),vm(),u=a.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(Cn(a),a.subtreeFlags&6&&(a.flags|=8192)):Cn(a),l=a.updateQueue,l!==null&&Cd(a,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),r!==null&&ye(So),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),ws(Zn),Cn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function c1(r,a){switch(rm(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return ws(Zn),ht(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return bt(a),null;case 13:if(Cs(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Jc()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return ye(Jn),null;case 4:return ht(),null;case 10:return ws(a.type),null;case 22:case 23:return Cs(a),vm(),r!==null&&ye(So),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return ws(Zn),null;case 25:return null;default:return null}}function pS(r,a){switch(rm(a),a.tag){case 3:ws(Zn),ht();break;case 26:case 27:case 5:bt(a);break;case 4:ht();break;case 13:Cs(a);break;case 19:ye(Jn);break;case 10:ws(a.type);break;case 22:case 23:Cs(a),vm(),r!==null&&ye(So);break;case 24:ws(Zn)}}function gu(r,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var m=u.next;l=m;do{if((l.tag&r)===r){u=void 0;var _=l.create,I=l.inst;u=_(),I.destroy=u}l=l.next}while(l!==m)}}catch(z){vn(a,a.return,z)}}function ha(r,a,l){try{var u=a.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var _=m.next;u=_;do{if((u.tag&r)===r){var I=u.inst,z=I.destroy;if(z!==void 0){I.destroy=void 0,m=a;var Y=l,ue=z;try{ue()}catch(Te){vn(m,Y,Te)}}}u=u.next}while(u!==_)}}catch(Te){vn(a,a.return,Te)}}function mS(r){var a=r.updateQueue;if(a!==null){var l=r.stateNode;try{nE(a,l)}catch(u){vn(r,r.return,u)}}}function gS(r,a,l){l.props=xo(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(u){vn(r,a,u)}}function _u(r,a){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof l=="function"?r.refCleanup=l(u):l.current=u}}catch(m){vn(r,a,m)}}function ns(r,a){var l=r.ref,u=r.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(m){vn(r,a,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){vn(r,a,m)}else l.current=null}function _S(r){var a=r.type,l=r.memoizedProps,u=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(m){vn(r,r.return,m)}}function Wm(r,a,l){try{var u=r.stateNode;I1(u,r.type,l,a),u[un]=a}catch(m){vn(r,r.return,m)}}function vS(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ya(r.type)||r.tag===4}function Xm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||vS(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ya(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ym(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(r),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Bd));else if(u!==4&&(u===27&&ya(r.type)&&(l=r.stateNode,a=null),r=r.child,r!==null))for(Ym(r,a,l),r=r.sibling;r!==null;)Ym(r,a,l),r=r.sibling}function Id(r,a,l){var u=r.tag;if(u===5||u===6)r=r.stateNode,a?l.insertBefore(r,a):l.appendChild(r);else if(u!==4&&(u===27&&ya(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(Id(r,a,l),r=r.sibling;r!==null;)Id(r,a,l),r=r.sibling}function yS(r){var a=r.stateNode,l=r.memoizedProps;try{for(var u=r.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);mi(a,u,l),a[Un]=r,a[un]=l}catch(_){vn(r,r.return,_)}}var Ns=!1,zn=!1,Km=!1,ES=typeof WeakSet=="function"?WeakSet:Set,ai=null;function u1(r,a){if(r=r.containerInfo,yg=Yd,r=D0(r),Xp(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var m=u.anchorOffset,_=u.focusNode;u=u.focusOffset;try{l.nodeType,_.nodeType}catch{l=null;break e}var I=0,z=-1,Y=-1,ue=0,Te=0,Re=r,de=null;t:for(;;){for(var fe;Re!==l||m!==0&&Re.nodeType!==3||(z=I+m),Re!==_||u!==0&&Re.nodeType!==3||(Y=I+u),Re.nodeType===3&&(I+=Re.nodeValue.length),(fe=Re.firstChild)!==null;)de=Re,Re=fe;for(;;){if(Re===r)break t;if(de===l&&++ue===m&&(z=I),de===_&&++Te===u&&(Y=I),(fe=Re.nextSibling)!==null)break;Re=de,de=Re.parentNode}Re=fe}l=z===-1||Y===-1?null:{start:z,end:Y}}else l=null}l=l||{start:0,end:0}}else l=null;for(Eg={focusedElem:r,selectionRange:l},Yd=!1,ai=a;ai!==null;)if(a=ai,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,ai=r;else for(;ai!==null;){switch(a=ai,_=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&_!==null){r=void 0,l=a,m=_.memoizedProps,_=_.memoizedState,u=l.stateNode;try{var yt=xo(l.type,m,l.elementType===l.type);r=u.getSnapshotBeforeUpdate(yt,_),u.__reactInternalSnapshotBeforeUpdate=r}catch(gt){vn(l,l.return,gt)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,l=r.nodeType,l===9)xg(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":xg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,ai=r;break}ai=a.return}}function SS(r,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:da(r,l),u&4&&gu(5,l);break;case 1:if(da(r,l),u&4)if(r=l.stateNode,a===null)try{r.componentDidMount()}catch(I){vn(l,l.return,I)}else{var m=xo(l.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(m,a,r.__reactInternalSnapshotBeforeUpdate)}catch(I){vn(l,l.return,I)}}u&64&&mS(l),u&512&&_u(l,l.return);break;case 3:if(da(r,l),u&64&&(r=l.updateQueue,r!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{nE(r,a)}catch(I){vn(l,l.return,I)}}break;case 27:a===null&&u&4&&yS(l);case 26:case 5:da(r,l),a===null&&u&4&&_S(l),u&512&&_u(l,l.return);break;case 12:da(r,l);break;case 13:da(r,l),u&4&&bS(r,l),u&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=y1.bind(null,l),V1(r,l))));break;case 22:if(u=l.memoizedState!==null||Ns,!u){a=a!==null&&a.memoizedState!==null||zn,m=Ns;var _=zn;Ns=u,(zn=a)&&!_?fa(r,l,(l.subtreeFlags&8772)!==0):da(r,l),Ns=m,zn=_}break;case 30:break;default:da(r,l)}}function TS(r){var a=r.alternate;a!==null&&(r.alternate=null,TS(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&Cr(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var wn=null,Gi=!1;function Ps(r,a,l){for(l=l.child;l!==null;)xS(r,a,l),l=l.sibling}function xS(r,a,l){if(Se&&typeof Se.onCommitFiberUnmount=="function")try{Se.onCommitFiberUnmount(ge,l)}catch{}switch(l.tag){case 26:zn||ns(l,a),Ps(r,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:zn||ns(l,a);var u=wn,m=Gi;ya(l.type)&&(wn=l.stateNode,Gi=!1),Ps(r,a,l),Mu(l.stateNode),wn=u,Gi=m;break;case 5:zn||ns(l,a);case 6:if(u=wn,m=Gi,wn=null,Ps(r,a,l),wn=u,Gi=m,wn!==null)if(Gi)try{(wn.nodeType===9?wn.body:wn.nodeName==="HTML"?wn.ownerDocument.body:wn).removeChild(l.stateNode)}catch(_){vn(l,a,_)}else try{wn.removeChild(l.stateNode)}catch(_){vn(l,a,_)}break;case 18:wn!==null&&(Gi?(r=wn,hT(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),Uu(r)):hT(wn,l.stateNode));break;case 4:u=wn,m=Gi,wn=l.stateNode.containerInfo,Gi=!0,Ps(r,a,l),wn=u,Gi=m;break;case 0:case 11:case 14:case 15:zn||ha(2,l,a),zn||ha(4,l,a),Ps(r,a,l);break;case 1:zn||(ns(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&gS(l,a,u)),Ps(r,a,l);break;case 21:Ps(r,a,l);break;case 22:zn=(u=zn)||l.memoizedState!==null,Ps(r,a,l),zn=u;break;default:Ps(r,a,l)}}function bS(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Uu(r)}catch(l){vn(a,a.return,l)}}function h1(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new ES),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new ES),a;default:throw Error(i(435,r.tag))}}function $m(r,a){var l=h1(r);a.forEach(function(u){var m=E1.bind(null,r,u);l.has(u)||(l.add(u),u.then(m,m))})}function Zi(r,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var m=l[u],_=r,I=a,z=I;e:for(;z!==null;){switch(z.tag){case 27:if(ya(z.type)){wn=z.stateNode,Gi=!1;break e}break;case 5:wn=z.stateNode,Gi=!1;break e;case 3:case 4:wn=z.stateNode.containerInfo,Gi=!0;break e}z=z.return}if(wn===null)throw Error(i(160));xS(_,I,m),wn=null,Gi=!1,_=m.alternate,_!==null&&(_.return=null),m.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)AS(a,r),a=a.sibling}var Pr=null;function AS(r,a){var l=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Zi(a,r),Ji(r),u&4&&(ha(3,r,r.return),gu(3,r),ha(5,r,r.return));break;case 1:Zi(a,r),Ji(r),u&512&&(zn||l===null||ns(l,l.return)),u&64&&Ns&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var m=Pr;if(Zi(a,r),Ji(r),u&512&&(zn||l===null||ns(l,l.return)),u&4){var _=l!==null?l.memoizedState:null;if(u=r.memoizedState,l===null)if(u===null)if(r.stateNode===null){e:{u=r.type,l=r.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":_=m.getElementsByTagName("title")[0],(!_||_[lr]||_[Un]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=m.createElement(u),m.head.insertBefore(_,m.querySelector("head > title"))),mi(_,u,l),_[Un]=r,Rn(_),u=_;break e;case"link":var I=yT("link","href",m).get(u+(l.href||""));if(I){for(var z=0;z<I.length;z++)if(_=I[z],_.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&_.getAttribute("rel")===(l.rel==null?null:l.rel)&&_.getAttribute("title")===(l.title==null?null:l.title)&&_.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){I.splice(z,1);break t}}_=m.createElement(u),mi(_,u,l),m.head.appendChild(_);break;case"meta":if(I=yT("meta","content",m).get(u+(l.content||""))){for(z=0;z<I.length;z++)if(_=I[z],_.getAttribute("content")===(l.content==null?null:""+l.content)&&_.getAttribute("name")===(l.name==null?null:l.name)&&_.getAttribute("property")===(l.property==null?null:l.property)&&_.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&_.getAttribute("charset")===(l.charSet==null?null:l.charSet)){I.splice(z,1);break t}}_=m.createElement(u),mi(_,u,l),m.head.appendChild(_);break;default:throw Error(i(468,u))}_[Un]=r,Rn(_),u=_}r.stateNode=u}else ET(m,r.type,r.stateNode);else r.stateNode=vT(m,u,r.memoizedProps);else _!==u?(_===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):_.count--,u===null?ET(m,r.type,r.stateNode):vT(m,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Wm(r,r.memoizedProps,l.memoizedProps)}break;case 27:Zi(a,r),Ji(r),u&512&&(zn||l===null||ns(l,l.return)),l!==null&&u&4&&Wm(r,r.memoizedProps,l.memoizedProps);break;case 5:if(Zi(a,r),Ji(r),u&512&&(zn||l===null||ns(l,l.return)),r.flags&32){m=r.stateNode;try{Gn(m,"")}catch(fe){vn(r,r.return,fe)}}u&4&&r.stateNode!=null&&(m=r.memoizedProps,Wm(r,m,l!==null?l.memoizedProps:m)),u&1024&&(Km=!0);break;case 6:if(Zi(a,r),Ji(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,l=r.stateNode;try{l.nodeValue=u}catch(fe){vn(r,r.return,fe)}}break;case 3:if(qd=null,m=Pr,Pr=Gd(a.containerInfo),Zi(a,r),Pr=m,Ji(r),u&4&&l!==null&&l.memoizedState.isDehydrated)try{Uu(a.containerInfo)}catch(fe){vn(r,r.return,fe)}Km&&(Km=!1,MS(r));break;case 4:u=Pr,Pr=Gd(r.stateNode.containerInfo),Zi(a,r),Ji(r),Pr=u;break;case 12:Zi(a,r),Ji(r);break;case 13:Zi(a,r),Ji(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(ng=Ke()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,$m(r,u)));break;case 22:m=r.memoizedState!==null;var Y=l!==null&&l.memoizedState!==null,ue=Ns,Te=zn;if(Ns=ue||m,zn=Te||Y,Zi(a,r),zn=Te,Ns=ue,Ji(r),u&8192)e:for(a=r.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(l===null||Y||Ns||zn||bo(r)),l=null,a=r;;){if(a.tag===5||a.tag===26){if(l===null){Y=l=a;try{if(_=Y.stateNode,m)I=_.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{z=Y.stateNode;var Re=Y.memoizedProps.style,de=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;z.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(fe){vn(Y,Y.return,fe)}}}else if(a.tag===6){if(l===null){Y=a;try{Y.stateNode.nodeValue=m?"":Y.memoizedProps}catch(fe){vn(Y,Y.return,fe)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=r.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,$m(r,l))));break;case 19:Zi(a,r),Ji(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,$m(r,u)));break;case 30:break;case 21:break;default:Zi(a,r),Ji(r)}}function Ji(r){var a=r.flags;if(a&2){try{for(var l,u=r.return;u!==null;){if(vS(u)){l=u;break}u=u.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,_=Xm(r);Id(r,_,m);break;case 5:var I=l.stateNode;l.flags&32&&(Gn(I,""),l.flags&=-33);var z=Xm(r);Id(r,z,I);break;case 3:case 4:var Y=l.stateNode.containerInfo,ue=Xm(r);Ym(r,ue,Y);break;default:throw Error(i(161))}}catch(Te){vn(r,r.return,Te)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function MS(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;MS(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function da(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)SS(r,a.alternate,a),a=a.sibling}function bo(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:ha(4,a,a.return),bo(a);break;case 1:ns(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&gS(a,a.return,l),bo(a);break;case 27:Mu(a.stateNode);case 26:case 5:ns(a,a.return),bo(a);break;case 22:a.memoizedState===null&&bo(a);break;case 30:bo(a);break;default:bo(a)}r=r.sibling}}function fa(r,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,m=r,_=a,I=_.flags;switch(_.tag){case 0:case 11:case 15:fa(m,_,l),gu(4,_);break;case 1:if(fa(m,_,l),u=_,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ue){vn(u,u.return,ue)}if(u=_,m=u.updateQueue,m!==null){var z=u.stateNode;try{var Y=m.shared.hiddenCallbacks;if(Y!==null)for(m.shared.hiddenCallbacks=null,m=0;m<Y.length;m++)tE(Y[m],z)}catch(ue){vn(u,u.return,ue)}}l&&I&64&&mS(_),_u(_,_.return);break;case 27:yS(_);case 26:case 5:fa(m,_,l),l&&u===null&&I&4&&_S(_),_u(_,_.return);break;case 12:fa(m,_,l);break;case 13:fa(m,_,l),l&&I&4&&bS(m,_);break;case 22:_.memoizedState===null&&fa(m,_,l),_u(_,_.return);break;case 30:break;default:fa(m,_,l)}a=a.sibling}}function Qm(r,a){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&nu(l))}function Zm(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&nu(r))}function is(r,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)wS(r,a,l,u),a=a.sibling}function wS(r,a,l,u){var m=a.flags;switch(a.tag){case 0:case 11:case 15:is(r,a,l,u),m&2048&&gu(9,a);break;case 1:is(r,a,l,u);break;case 3:is(r,a,l,u),m&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&nu(r)));break;case 12:if(m&2048){is(r,a,l,u),r=a.stateNode;try{var _=a.memoizedProps,I=_.id,z=_.onPostCommit;typeof z=="function"&&z(I,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(Y){vn(a,a.return,Y)}}else is(r,a,l,u);break;case 13:is(r,a,l,u);break;case 23:break;case 22:_=a.stateNode,I=a.alternate,a.memoizedState!==null?_._visibility&2?is(r,a,l,u):vu(r,a):_._visibility&2?is(r,a,l,u):(_._visibility|=2,Nl(r,a,l,u,(a.subtreeFlags&10256)!==0)),m&2048&&Qm(I,a);break;case 24:is(r,a,l,u),m&2048&&Zm(a.alternate,a);break;default:is(r,a,l,u)}}function Nl(r,a,l,u,m){for(m=m&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var _=r,I=a,z=l,Y=u,ue=I.flags;switch(I.tag){case 0:case 11:case 15:Nl(_,I,z,Y,m),gu(8,I);break;case 23:break;case 22:var Te=I.stateNode;I.memoizedState!==null?Te._visibility&2?Nl(_,I,z,Y,m):vu(_,I):(Te._visibility|=2,Nl(_,I,z,Y,m)),m&&ue&2048&&Qm(I.alternate,I);break;case 24:Nl(_,I,z,Y,m),m&&ue&2048&&Zm(I.alternate,I);break;default:Nl(_,I,z,Y,m)}a=a.sibling}}function vu(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=r,u=a,m=u.flags;switch(u.tag){case 22:vu(l,u),m&2048&&Qm(u.alternate,u);break;case 24:vu(l,u),m&2048&&Zm(u.alternate,u);break;default:vu(l,u)}a=a.sibling}}var yu=8192;function Pl(r){if(r.subtreeFlags&yu)for(r=r.child;r!==null;)RS(r),r=r.sibling}function RS(r){switch(r.tag){case 26:Pl(r),r.flags&yu&&r.memoizedState!==null&&$1(Pr,r.memoizedState,r.memoizedProps);break;case 5:Pl(r);break;case 3:case 4:var a=Pr;Pr=Gd(r.stateNode.containerInfo),Pl(r),Pr=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=yu,yu=16777216,Pl(r),yu=a):Pl(r));break;default:Pl(r)}}function CS(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function Eu(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];ai=u,DS(u,r)}CS(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)IS(r),r=r.sibling}function IS(r){switch(r.tag){case 0:case 11:case 15:Eu(r),r.flags&2048&&ha(9,r,r.return);break;case 3:Eu(r);break;case 12:Eu(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,Dd(r)):Eu(r);break;default:Eu(r)}}function Dd(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];ai=u,DS(u,r)}CS(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:ha(8,a,a.return),Dd(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,Dd(a));break;default:Dd(a)}r=r.sibling}}function DS(r,a){for(;ai!==null;){var l=ai;switch(l.tag){case 0:case 11:case 15:ha(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:nu(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,ai=u;else e:for(l=r;ai!==null;){u=ai;var m=u.sibling,_=u.return;if(TS(u),u===l){ai=null;break e}if(m!==null){m.return=_,ai=m;break e}ai=_}}}var d1={getCacheForType:function(r){var a=Ti(Zn),l=a.data.get(r);return l===void 0&&(l=r(),a.data.set(r,l)),l}},f1=typeof WeakMap=="function"?WeakMap:Map,an=0,Sn=null,kt=null,Kt=0,on=0,er=null,pa=!1,Ul=!1,Jm=!1,Us=0,On=0,ma=0,Ao=0,eg=0,Er=0,Ll=0,Su=null,ji=null,tg=!1,ng=0,Nd=1/0,Pd=null,ga=null,pi=0,_a=null,Ol=null,Vl=0,ig=0,rg=null,NS=null,Tu=0,sg=null;function tr(){if((an&2)!==0&&Kt!==0)return Kt&-Kt;if(X.T!==null){var r=bl;return r!==0?r:dg()}return Ut()}function PS(){Er===0&&(Er=(Kt&536870912)===0||rn?Q():536870912);var r=yr.current;return r!==null&&(r.flags|=32),Er}function nr(r,a,l){(r===Sn&&(on===2||on===9)||r.cancelPendingCommit!==null)&&(Fl(r,0),va(r,Kt,Er,!1)),Ye(r,l),((an&2)===0||r!==Sn)&&(r===Sn&&((an&2)===0&&(Ao|=l),On===4&&va(r,Kt,Er,!1)),rs(r))}function US(r,a,l){if((an&6)!==0)throw Error(i(327));var u=!l&&(a&124)===0&&(a&r.expiredLanes)===0||He(r,a),m=u?g1(r,a):lg(r,a,!0),_=u;do{if(m===0){Ul&&!u&&va(r,a,0,!1);break}else{if(l=r.current.alternate,_&&!p1(l)){m=lg(r,a,!1),_=!1;continue}if(m===2){if(_=a,r.errorRecoveryDisabledLanes&_)var I=0;else I=r.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){a=I;e:{var z=r;m=Su;var Y=z.current.memoizedState.isDehydrated;if(Y&&(Fl(z,I).flags|=256),I=lg(z,I,!1),I!==2){if(Jm&&!Y){z.errorRecoveryDisabledLanes|=_,Ao|=_,m=4;break e}_=ji,ji=m,_!==null&&(ji===null?ji=_:ji.push.apply(ji,_))}m=I}if(_=!1,m!==2)continue}}if(m===1){Fl(r,0),va(r,a,0,!0);break}e:{switch(u=r,_=m,_){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:va(u,a,Er,!pa);break e;case 2:ji=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=ng+300-Ke(),10<m)){if(va(u,a,Er,!pa),nt(u,0,!0)!==0)break e;u.timeoutHandle=cT(LS.bind(null,u,l,ji,Pd,tg,a,Er,Ao,Ll,pa,_,2,-0,0),m);break e}LS(u,l,ji,Pd,tg,a,Er,Ao,Ll,pa,_,0,-0,0)}}break}while(!0);rs(r)}function LS(r,a,l,u,m,_,I,z,Y,ue,Te,Re,de,fe){if(r.timeoutHandle=-1,Re=a.subtreeFlags,(Re&8192||(Re&16785408)===16785408)&&(Cu={stylesheets:null,count:0,unsuspend:K1},RS(a),Re=Q1(),Re!==null)){r.cancelPendingCommit=Re(HS.bind(null,r,a,_,l,u,m,I,z,Y,Te,1,de,fe)),va(r,_,I,!ue);return}HS(r,a,_,l,u,m,I,z,Y)}function p1(r){for(var a=r;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var m=l[u],_=m.getSnapshot;m=m.value;try{if(!$i(_(),m))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function va(r,a,l,u){a&=~eg,a&=~Ao,r.suspendedLanes|=a,r.pingedLanes&=~a,u&&(r.warmLanes|=a),u=r.expirationTimes;for(var m=a;0<m;){var _=31-Xe(m),I=1<<_;u[_]=-1,m&=~I}l!==0&&be(r,l,a)}function Ud(){return(an&6)===0?(xu(0),!1):!0}function ag(){if(kt!==null){if(on===0)var r=kt.return;else r=kt,Ms=yo=null,xm(r),Il=null,fu=0,r=kt;for(;r!==null;)pS(r.alternate,r),r=r.return;kt=null}}function Fl(r,a){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,N1(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),ag(),Sn=r,kt=l=xs(r.current,null),Kt=a,on=0,er=null,pa=!1,Ul=He(r,a),Jm=!1,Ll=Er=eg=Ao=ma=On=0,ji=Su=null,tg=!1,(a&8)!==0&&(a|=a&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=a;0<u;){var m=31-Xe(u),_=1<<m;a|=r[m],u&=~_}return Us=a,nd(),l}function OS(r,a){Ot=null,X.H=Sd,a===ru||a===hd?(a=J0(),on=3):a===$0?(a=J0(),on=4):on=a===eS?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,er=a,kt===null&&(On=1,Md(r,mr(a,r.current)))}function VS(){var r=X.H;return X.H=Sd,r===null?Sd:r}function FS(){var r=X.A;return X.A=d1,r}function og(){On=4,pa||(Kt&4194048)!==Kt&&yr.current!==null||(Ul=!0),(ma&134217727)===0&&(Ao&134217727)===0||Sn===null||va(Sn,Kt,Er,!1)}function lg(r,a,l){var u=an;an|=2;var m=VS(),_=FS();(Sn!==r||Kt!==a)&&(Pd=null,Fl(r,a)),a=!1;var I=On;e:do try{if(on!==0&&kt!==null){var z=kt,Y=er;switch(on){case 8:ag(),I=6;break e;case 3:case 2:case 9:case 6:yr.current===null&&(a=!0);var ue=on;if(on=0,er=null,kl(r,z,Y,ue),l&&Ul){I=0;break e}break;default:ue=on,on=0,er=null,kl(r,z,Y,ue)}}m1(),I=On;break}catch(Te){OS(r,Te)}while(!0);return a&&r.shellSuspendCounter++,Ms=yo=null,an=u,X.H=m,X.A=_,kt===null&&(Sn=null,Kt=0,nd()),I}function m1(){for(;kt!==null;)kS(kt)}function g1(r,a){var l=an;an|=2;var u=VS(),m=FS();Sn!==r||Kt!==a?(Pd=null,Nd=Ke()+500,Fl(r,a)):Ul=He(r,a);e:do try{if(on!==0&&kt!==null){a=kt;var _=er;t:switch(on){case 1:on=0,er=null,kl(r,a,_,1);break;case 2:case 9:if(Q0(_)){on=0,er=null,zS(a);break}a=function(){on!==2&&on!==9||Sn!==r||(on=7),rs(r)},_.then(a,a);break e;case 3:on=7;break e;case 4:on=5;break e;case 7:Q0(_)?(on=0,er=null,zS(a)):(on=0,er=null,kl(r,a,_,7));break;case 5:var I=null;switch(kt.tag){case 26:I=kt.memoizedState;case 5:case 27:var z=kt;if(!I||ST(I)){on=0,er=null;var Y=z.sibling;if(Y!==null)kt=Y;else{var ue=z.return;ue!==null?(kt=ue,Ld(ue)):kt=null}break t}}on=0,er=null,kl(r,a,_,5);break;case 6:on=0,er=null,kl(r,a,_,6);break;case 8:ag(),On=6;break e;default:throw Error(i(462))}}_1();break}catch(Te){OS(r,Te)}while(!0);return Ms=yo=null,X.H=u,X.A=m,an=l,kt!==null?0:(Sn=null,Kt=0,nd(),On)}function _1(){for(;kt!==null&&!vt();)kS(kt)}function kS(r){var a=dS(r.alternate,r,Us);r.memoizedProps=r.pendingProps,a===null?Ld(r):kt=a}function zS(r){var a=r,l=a.alternate;switch(a.tag){case 15:case 0:a=aS(l,a,a.pendingProps,a.type,void 0,Kt);break;case 11:a=aS(l,a,a.pendingProps,a.type.render,a.ref,Kt);break;case 5:xm(a);default:pS(l,a),a=kt=B0(a,Us),a=dS(l,a,Us)}r.memoizedProps=r.pendingProps,a===null?Ld(r):kt=a}function kl(r,a,l,u){Ms=yo=null,xm(a),Il=null,fu=0;var m=a.return;try{if(a1(r,m,a,l,Kt)){On=1,Md(r,mr(l,r.current)),kt=null;return}}catch(_){if(m!==null)throw kt=m,_;On=1,Md(r,mr(l,r.current)),kt=null;return}a.flags&32768?(rn||u===1?r=!0:Ul||(Kt&536870912)!==0?r=!1:(pa=r=!0,(u===2||u===9||u===3||u===6)&&(u=yr.current,u!==null&&u.tag===13&&(u.flags|=16384))),BS(a,r)):Ld(a)}function Ld(r){var a=r;do{if((a.flags&32768)!==0){BS(a,pa);return}r=a.return;var l=l1(a.alternate,a,Us);if(l!==null){kt=l;return}if(a=a.sibling,a!==null){kt=a;return}kt=a=r}while(a!==null);On===0&&(On=5)}function BS(r,a){do{var l=c1(r.alternate,r);if(l!==null){l.flags&=32767,kt=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(r=r.sibling,r!==null)){kt=r;return}kt=r=l}while(r!==null);On=6,kt=null}function HS(r,a,l,u,m,_,I,z,Y){r.cancelPendingCommit=null;do Od();while(pi!==0);if((an&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(_=a.lanes|a.childLanes,_|=Zp,Ie(r,l,_,I,z,Y),r===Sn&&(kt=Sn=null,Kt=0),Ol=a,_a=r,Vl=l,ig=_,rg=m,NS=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,S1(yn,function(){return XS(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=X.T,X.T=null,m=Z.p,Z.p=2,I=an,an|=4;try{u1(r,a,l)}finally{an=I,Z.p=m,X.T=u}}pi=1,GS(),jS(),qS()}}function GS(){if(pi===1){pi=0;var r=_a,a=Ol,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=X.T,X.T=null;var u=Z.p;Z.p=2;var m=an;an|=4;try{AS(a,r);var _=Eg,I=D0(r.containerInfo),z=_.focusedElem,Y=_.selectionRange;if(I!==z&&z&&z.ownerDocument&&I0(z.ownerDocument.documentElement,z)){if(Y!==null&&Xp(z)){var ue=Y.start,Te=Y.end;if(Te===void 0&&(Te=ue),"selectionStart"in z)z.selectionStart=ue,z.selectionEnd=Math.min(Te,z.value.length);else{var Re=z.ownerDocument||document,de=Re&&Re.defaultView||window;if(de.getSelection){var fe=de.getSelection(),yt=z.textContent.length,gt=Math.min(Y.start,yt),pn=Y.end===void 0?gt:Math.min(Y.end,yt);!fe.extend&&gt>pn&&(I=pn,pn=gt,gt=I);var ne=C0(z,gt),$=C0(z,pn);if(ne&&$&&(fe.rangeCount!==1||fe.anchorNode!==ne.node||fe.anchorOffset!==ne.offset||fe.focusNode!==$.node||fe.focusOffset!==$.offset)){var ae=Re.createRange();ae.setStart(ne.node,ne.offset),fe.removeAllRanges(),gt>pn?(fe.addRange(ae),fe.extend($.node,$.offset)):(ae.setEnd($.node,$.offset),fe.addRange(ae))}}}}for(Re=[],fe=z;fe=fe.parentNode;)fe.nodeType===1&&Re.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<Re.length;z++){var Me=Re[z];Me.element.scrollLeft=Me.left,Me.element.scrollTop=Me.top}}Yd=!!yg,Eg=yg=null}finally{an=m,Z.p=u,X.T=l}}r.current=a,pi=2}}function jS(){if(pi===2){pi=0;var r=_a,a=Ol,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=X.T,X.T=null;var u=Z.p;Z.p=2;var m=an;an|=4;try{SS(r,a.alternate,a)}finally{an=m,Z.p=u,X.T=l}}pi=3}}function qS(){if(pi===4||pi===3){pi=0,ft();var r=_a,a=Ol,l=Vl,u=NS;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?pi=5:(pi=0,Ol=_a=null,WS(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(ga=null),Qt(l),a=a.stateNode,Se&&typeof Se.onCommitFiberRoot=="function")try{Se.onCommitFiberRoot(ge,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=X.T,m=Z.p,Z.p=2,X.T=null;try{for(var _=r.onRecoverableError,I=0;I<u.length;I++){var z=u[I];_(z.value,{componentStack:z.stack})}}finally{X.T=a,Z.p=m}}(Vl&3)!==0&&Od(),rs(r),m=r.pendingLanes,(l&4194090)!==0&&(m&42)!==0?r===sg?Tu++:(Tu=0,sg=r):Tu=0,xu(0)}}function WS(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,nu(a)))}function Od(r){return GS(),jS(),qS(),XS()}function XS(){if(pi!==5)return!1;var r=_a,a=ig;ig=0;var l=Qt(Vl),u=X.T,m=Z.p;try{Z.p=32>l?32:l,X.T=null,l=rg,rg=null;var _=_a,I=Vl;if(pi=0,Ol=_a=null,Vl=0,(an&6)!==0)throw Error(i(331));var z=an;if(an|=4,IS(_.current),wS(_,_.current,I,l),an=z,xu(0,!1),Se&&typeof Se.onPostCommitFiberRoot=="function")try{Se.onPostCommitFiberRoot(ge,_)}catch{}return!0}finally{Z.p=m,X.T=u,WS(r,a)}}function YS(r,a,l){a=mr(l,a),a=Vm(r.stateNode,a,2),r=oa(r,a,2),r!==null&&(Ye(r,2),rs(r))}function vn(r,a,l){if(r.tag===3)YS(r,r,l);else for(;a!==null;){if(a.tag===3){YS(a,r,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ga===null||!ga.has(u))){r=mr(l,r),l=ZE(2),u=oa(a,l,2),u!==null&&(JE(l,u,a,r),Ye(u,2),rs(u));break}}a=a.return}}function cg(r,a,l){var u=r.pingCache;if(u===null){u=r.pingCache=new f1;var m=new Set;u.set(a,m)}else m=u.get(a),m===void 0&&(m=new Set,u.set(a,m));m.has(l)||(Jm=!0,m.add(l),r=v1.bind(null,r,a,l),a.then(r,r))}function v1(r,a,l){var u=r.pingCache;u!==null&&u.delete(a),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,Sn===r&&(Kt&l)===l&&(On===4||On===3&&(Kt&62914560)===Kt&&300>Ke()-ng?(an&2)===0&&Fl(r,0):eg|=l,Ll===Kt&&(Ll=0)),rs(r)}function KS(r,a){a===0&&(a=Ue()),r=El(r,a),r!==null&&(Ye(r,a),rs(r))}function y1(r){var a=r.memoizedState,l=0;a!==null&&(l=a.retryLane),KS(r,l)}function E1(r,a){var l=0;switch(r.tag){case 13:var u=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(a),KS(r,l)}function S1(r,a){return K(r,a)}var Vd=null,zl=null,ug=!1,Fd=!1,hg=!1,Mo=0;function rs(r){r!==zl&&r.next===null&&(zl===null?Vd=zl=r:zl=zl.next=r),Fd=!0,ug||(ug=!0,x1())}function xu(r,a){if(!hg&&Fd){hg=!0;do for(var l=!1,u=Vd;u!==null;){if(r!==0){var m=u.pendingLanes;if(m===0)var _=0;else{var I=u.suspendedLanes,z=u.pingedLanes;_=(1<<31-Xe(42|r)+1)-1,_&=m&~(I&~z),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(l=!0,JS(u,_))}else _=Kt,_=nt(u,u===Sn?_:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(_&3)===0||He(u,_)||(l=!0,JS(u,_));u=u.next}while(l);hg=!1}}function T1(){$S()}function $S(){Fd=ug=!1;var r=0;Mo!==0&&(D1()&&(r=Mo),Mo=0);for(var a=Ke(),l=null,u=Vd;u!==null;){var m=u.next,_=QS(u,a);_===0?(u.next=null,l===null?Vd=m:l.next=m,m===null&&(zl=l)):(l=u,(r!==0||(_&3)!==0)&&(Fd=!0)),u=m}xu(r)}function QS(r,a){for(var l=r.suspendedLanes,u=r.pingedLanes,m=r.expirationTimes,_=r.pendingLanes&-62914561;0<_;){var I=31-Xe(_),z=1<<I,Y=m[I];Y===-1?((z&l)===0||(z&u)!==0)&&(m[I]=Tt(z,a)):Y<=a&&(r.expiredLanes|=z),_&=~z}if(a=Sn,l=Kt,l=nt(r,r===a?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,l===0||r===a&&(on===2||on===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Zt(u),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||He(r,l)){if(a=l&-l,a===r.callbackPriority)return a;switch(u!==null&&Zt(u),Qt(l)){case 2:case 8:l=St;break;case 32:l=yn;break;case 268435456:l=W;break;default:l=yn}return u=ZS.bind(null,r),l=K(l,u),r.callbackPriority=a,r.callbackNode=l,a}return u!==null&&u!==null&&Zt(u),r.callbackPriority=2,r.callbackNode=null,2}function ZS(r,a){if(pi!==0&&pi!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(Od()&&r.callbackNode!==l)return null;var u=Kt;return u=nt(r,r===Sn?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(US(r,u,a),QS(r,Ke()),r.callbackNode!=null&&r.callbackNode===l?ZS.bind(null,r):null)}function JS(r,a){if(Od())return null;US(r,a,!0)}function x1(){P1(function(){(an&6)!==0?K(Je,T1):$S()})}function dg(){return Mo===0&&(Mo=Q()),Mo}function eT(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:ll(""+r)}function tT(r,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,r.id&&l.setAttribute("form",r.id),a.parentNode.insertBefore(l,a),r=new FormData(r),l.parentNode.removeChild(l),r}function b1(r,a,l,u,m){if(a==="submit"&&l&&l.stateNode===m){var _=eT((m[un]||null).action),I=u.submitter;I&&(a=(a=I[un]||null)?eT(a.formAction):I.getAttribute("formAction"),a!==null&&(_=a,I=null));var z=new cl("action","action",null,u,m);r.push({event:z,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Mo!==0){var Y=I?tT(m,I):new FormData(m);Nm(l,{pending:!0,data:Y,method:m.method,action:_},null,Y)}}else typeof _=="function"&&(z.preventDefault(),Y=I?tT(m,I):new FormData(m),Nm(l,{pending:!0,data:Y,method:m.method,action:_},_,Y))},currentTarget:m}]})}}for(var fg=0;fg<Qp.length;fg++){var pg=Qp[fg],A1=pg.toLowerCase(),M1=pg[0].toUpperCase()+pg.slice(1);Nr(A1,"on"+M1)}Nr(U0,"onAnimationEnd"),Nr(L0,"onAnimationIteration"),Nr(O0,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(GR,"onTransitionRun"),Nr(jR,"onTransitionStart"),Nr(qR,"onTransitionCancel"),Nr(V0,"onTransitionEnd"),te("onMouseEnter",["mouseout","mouseover"]),te("onMouseLeave",["mouseout","mouseover"]),te("onPointerEnter",["pointerout","pointerover"]),te("onPointerLeave",["pointerout","pointerover"]),B("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),B("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),B("onBeforeInput",["compositionend","keypress","textInput","paste"]),B("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),B("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),B("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bu));function nT(r,a){a=(a&4)!==0;for(var l=0;l<r.length;l++){var u=r[l],m=u.event;u=u.listeners;e:{var _=void 0;if(a)for(var I=u.length-1;0<=I;I--){var z=u[I],Y=z.instance,ue=z.currentTarget;if(z=z.listener,Y!==_&&m.isPropagationStopped())break e;_=z,m.currentTarget=ue;try{_(m)}catch(Te){Ad(Te)}m.currentTarget=null,_=Y}else for(I=0;I<u.length;I++){if(z=u[I],Y=z.instance,ue=z.currentTarget,z=z.listener,Y!==_&&m.isPropagationStopped())break e;_=z,m.currentTarget=ue;try{_(m)}catch(Te){Ad(Te)}m.currentTarget=null,_=Y}}}}function zt(r,a){var l=a[ta];l===void 0&&(l=a[ta]=new Set);var u=r+"__bubble";l.has(u)||(iT(a,r,2,!1),l.add(u))}function mg(r,a,l){var u=0;a&&(u|=4),iT(l,r,u,a)}var kd="_reactListening"+Math.random().toString(36).slice(2);function gg(r){if(!r[kd]){r[kd]=!0,no.forEach(function(l){l!=="selectionchange"&&(w1.has(l)||mg(l,!1,r),mg(l,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[kd]||(a[kd]=!0,mg("selectionchange",!1,a))}}function iT(r,a,l,u){switch(wT(a)){case 2:var m=eC;break;case 8:m=tC;break;default:m=Ig}l=m.bind(null,a,l,r),m=void 0,!fr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),u?m!==void 0?r.addEventListener(a,l,{capture:!0,passive:m}):r.addEventListener(a,l,!0):m!==void 0?r.addEventListener(a,l,{passive:m}):r.addEventListener(a,l,!1)}function _g(r,a,l,u,m){var _=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var I=u.tag;if(I===3||I===4){var z=u.stateNode.containerInfo;if(z===m)break;if(I===4)for(I=u.return;I!==null;){var Y=I.tag;if((Y===3||Y===4)&&I.stateNode.containerInfo===m)return;I=I.return}for(;z!==null;){if(I=cr(z),I===null)return;if(Y=I.tag,Y===5||Y===6||Y===26||Y===27){u=_=I;continue e}z=z.parentNode}}u=u.return}Bh(function(){var ue=_,Te=dr(l),Re=[];e:{var de=F0.get(r);if(de!==void 0){var fe=cl,yt=r;switch(r){case"keypress":if(Kr(l)===0)break e;case"keydown":case"keyup":fe=ml;break;case"focusin":yt="focus",fe=dl;break;case"focusout":yt="blur",fe=dl;break;case"beforeblur":case"afterblur":fe=dl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=pr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Gp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=Kh;break;case U0:case L0:case O0:fe=fl;break;case V0:fe=Qh;break;case"scroll":case"scrollend":fe=Hh;break;case"wheel":fe=gl;break;case"copy":case"cut":case"paste":fe=pl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Yc;break;case"toggle":case"beforetoggle":fe=Jh}var gt=(a&4)!==0,pn=!gt&&(r==="scroll"||r==="scrollend"),ne=gt?de!==null?de+"Capture":null:de;gt=[];for(var $=ue,ae;$!==null;){var Me=$;if(ae=Me.stateNode,Me=Me.tag,Me!==5&&Me!==26&&Me!==27||ae===null||ne===null||(Me=ro($,ne),Me!=null&&gt.push(Au($,Me,ae))),pn)break;$=$.return}0<gt.length&&(de=new fe(de,yt,null,l,Te),Re.push({event:de,listeners:gt}))}}if((a&7)===0){e:{if(de=r==="mouseover"||r==="pointerover",fe=r==="mouseout"||r==="pointerout",de&&l!==_s&&(yt=l.relatedTarget||l.fromElement)&&(cr(yt)||yt[Si]))break e;if((fe||de)&&(de=Te.window===Te?Te:(de=Te.ownerDocument)?de.defaultView||de.parentWindow:window,fe?(yt=l.relatedTarget||l.toElement,fe=ue,yt=yt?cr(yt):null,yt!==null&&(pn=o(yt),gt=yt.tag,yt!==pn||gt!==5&&gt!==27&&gt!==6)&&(yt=null)):(fe=null,yt=ue),fe!==yt)){if(gt=pr,Me="onMouseLeave",ne="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(gt=Yc,Me="onPointerLeave",ne="onPointerEnter",$="pointer"),pn=fe==null?de:hr(fe),ae=yt==null?de:hr(yt),de=new gt(Me,$+"leave",fe,l,Te),de.target=pn,de.relatedTarget=ae,Me=null,cr(Te)===ue&&(gt=new gt(ne,$+"enter",yt,l,Te),gt.target=ae,gt.relatedTarget=pn,Me=gt),pn=Me,fe&&yt)t:{for(gt=fe,ne=yt,$=0,ae=gt;ae;ae=Bl(ae))$++;for(ae=0,Me=ne;Me;Me=Bl(Me))ae++;for(;0<$-ae;)gt=Bl(gt),$--;for(;0<ae-$;)ne=Bl(ne),ae--;for(;$--;){if(gt===ne||ne!==null&&gt===ne.alternate)break t;gt=Bl(gt),ne=Bl(ne)}gt=null}else gt=null;fe!==null&&rT(Re,de,fe,gt,!1),yt!==null&&pn!==null&&rT(Re,pn,yt,gt,!0)}}e:{if(de=ue?hr(ue):window,fe=de.nodeName&&de.nodeName.toLowerCase(),fe==="select"||fe==="input"&&de.type==="file")var it=x0;else if(Qn(de))if(b0)it=zR;else{it=FR;var Vt=VR}else fe=de.nodeName,!fe||fe.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ue&&Bc(ue.elementType)&&(it=x0):it=kR;if(it&&(it=it(r,ue))){Ts(Re,it,l,Te);break e}Vt&&Vt(r,de,ue),r==="focusout"&&ue&&de.type==="number"&&ue.memoizedProps.value!=null&&Fn(de,"number",de.value)}switch(Vt=ue?hr(ue):window,r){case"focusin":(Qn(Vt)||Vt.contentEditable==="true")&&(_l=Vt,Yp=ue,Qc=null);break;case"focusout":Qc=Yp=_l=null;break;case"mousedown":Kp=!0;break;case"contextmenu":case"mouseup":case"dragend":Kp=!1,N0(Re,l,Te);break;case"selectionchange":if(HR)break;case"keydown":case"keyup":N0(Re,l,Te)}var ut;if(Zr)e:{switch(r){case"compositionstart":var _t="onCompositionStart";break e;case"compositionend":_t="onCompositionEnd";break e;case"compositionupdate":_t="onCompositionUpdate";break e}_t=void 0}else Xt?_e(r,l)&&(_t="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(_t="onCompositionStart");_t&&(C&&l.locale!=="ko"&&(Xt||_t!=="onCompositionStart"?_t==="onCompositionEnd"&&Xt&&(ut=Gc()):(Yr=Te,ia="value"in Yr?Yr.value:Yr.textContent,Xt=!0)),Vt=zd(ue,_t),0<Vt.length&&(_t=new Wc(_t,r,null,l,Te),Re.push({event:_t,listeners:Vt}),ut?_t.data=ut:(ut=ke(l),ut!==null&&(_t.data=ut)))),(ut=S?$n(r,l):Yt(r,l))&&(_t=zd(ue,"onBeforeInput"),0<_t.length&&(Vt=new Wc("onBeforeInput","beforeinput",null,l,Te),Re.push({event:Vt,listeners:_t}),Vt.data=ut)),b1(Re,r,ue,l,Te)}nT(Re,a)})}function Au(r,a,l){return{instance:r,listener:a,currentTarget:l}}function zd(r,a){for(var l=a+"Capture",u=[];r!==null;){var m=r,_=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||_===null||(m=ro(r,l),m!=null&&u.unshift(Au(r,m,_)),m=ro(r,a),m!=null&&u.push(Au(r,m,_))),r.tag===3)return u;r=r.return}return[]}function Bl(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function rT(r,a,l,u,m){for(var _=a._reactName,I=[];l!==null&&l!==u;){var z=l,Y=z.alternate,ue=z.stateNode;if(z=z.tag,Y!==null&&Y===u)break;z!==5&&z!==26&&z!==27||ue===null||(Y=ue,m?(ue=ro(l,_),ue!=null&&I.unshift(Au(l,ue,Y))):m||(ue=ro(l,_),ue!=null&&I.push(Au(l,ue,Y)))),l=l.return}I.length!==0&&r.push({event:a,listeners:I})}var R1=/\r\n?/g,C1=/\u0000|\uFFFD/g;function sT(r){return(typeof r=="string"?r:""+r).replace(R1,`
`).replace(C1,"")}function aT(r,a){return a=sT(a),sT(r)===a}function Bd(){}function fn(r,a,l,u,m,_){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||Gn(r,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&Gn(r,""+u);break;case"className":$e(r,"class",u);break;case"tabIndex":$e(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":$e(r,l,u);break;case"style":zc(r,u,_);break;case"data":if(a!=="object"){$e(r,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){r.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=ll(""+u),r.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(l==="formAction"?(a!=="input"&&fn(r,a,"name",m.name,m,null),fn(r,a,"formEncType",m.formEncType,m,null),fn(r,a,"formMethod",m.formMethod,m,null),fn(r,a,"formTarget",m.formTarget,m,null)):(fn(r,a,"encType",m.encType,m,null),fn(r,a,"method",m.method,m,null),fn(r,a,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(l);break}u=ll(""+u),r.setAttribute(l,u);break;case"onClick":u!=null&&(r.onclick=Bd);break;case"onScroll":u!=null&&zt("scroll",r);break;case"onScrollEnd":u!=null&&zt("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}l=ll(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""+u):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":u===!0?r.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(l,u):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(l,u):r.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(l):r.setAttribute(l,u);break;case"popover":zt("beforetoggle",r),zt("toggle",r),Ge(r,"popover",u);break;case"xlinkActuate":ze(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":ze(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":ze(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":ze(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":ze(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":ze(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":ze(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":ze(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":ze(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ge(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Bp.get(l)||l,Ge(r,l,u))}}function vg(r,a,l,u,m,_){switch(l){case"style":zc(r,u,_);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(l=u.__html,l!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof u=="string"?Gn(r,u):(typeof u=="number"||typeof u=="bigint")&&Gn(r,""+u);break;case"onScroll":u!=null&&zt("scroll",r);break;case"onScrollEnd":u!=null&&zt("scrollend",r);break;case"onClick":u!=null&&(r.onclick=Bd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!na.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),a=l.slice(2,m?l.length-7:void 0),_=r[un]||null,_=_!=null?_[l]:null,typeof _=="function"&&r.removeEventListener(a,_,m),typeof u=="function")){typeof _!="function"&&_!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(a,u,m);break e}l in r?r[l]=u:u===!0?r.setAttribute(l,""):Ge(r,l,u)}}}function mi(r,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",r),zt("load",r);var u=!1,m=!1,_;for(_ in l)if(l.hasOwnProperty(_)){var I=l[_];if(I!=null)switch(_){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:fn(r,a,_,I,l,null)}}m&&fn(r,a,"srcSet",l.srcSet,l,null),u&&fn(r,a,"src",l.src,l,null);return;case"input":zt("invalid",r);var z=_=I=m=null,Y=null,ue=null;for(u in l)if(l.hasOwnProperty(u)){var Te=l[u];if(Te!=null)switch(u){case"name":m=Te;break;case"type":I=Te;break;case"checked":Y=Te;break;case"defaultChecked":ue=Te;break;case"value":_=Te;break;case"defaultValue":z=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(i(137,a));break;default:fn(r,a,u,Te,l,null)}}Hn(r,_,z,Y,ue,I,m,!1),Lt(r);return;case"select":zt("invalid",r),u=I=_=null;for(m in l)if(l.hasOwnProperty(m)&&(z=l[m],z!=null))switch(m){case"value":_=z;break;case"defaultValue":I=z;break;case"multiple":u=z;default:fn(r,a,m,z,l,null)}a=_,l=I,r.multiple=!!u,a!=null?bn(r,!!u,a,!1):l!=null&&bn(r,!!u,l,!0);return;case"textarea":zt("invalid",r),_=m=u=null;for(I in l)if(l.hasOwnProperty(I)&&(z=l[I],z!=null))switch(I){case"value":u=z;break;case"defaultValue":m=z;break;case"children":_=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(i(91));break;default:fn(r,a,I,z,l,null)}Ir(r,u,m,_),Lt(r);return;case"option":for(Y in l)if(l.hasOwnProperty(Y)&&(u=l[Y],u!=null))switch(Y){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:fn(r,a,Y,u,l,null)}return;case"dialog":zt("beforetoggle",r),zt("toggle",r),zt("cancel",r),zt("close",r);break;case"iframe":case"object":zt("load",r);break;case"video":case"audio":for(u=0;u<bu.length;u++)zt(bu[u],r);break;case"image":zt("error",r),zt("load",r);break;case"details":zt("toggle",r);break;case"embed":case"source":case"link":zt("error",r),zt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in l)if(l.hasOwnProperty(ue)&&(u=l[ue],u!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:fn(r,a,ue,u,l,null)}return;default:if(Bc(a)){for(Te in l)l.hasOwnProperty(Te)&&(u=l[Te],u!==void 0&&vg(r,a,Te,u,l,void 0));return}}for(z in l)l.hasOwnProperty(z)&&(u=l[z],u!=null&&fn(r,a,z,u,l,null))}function I1(r,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,_=null,I=null,z=null,Y=null,ue=null,Te=null;for(fe in l){var Re=l[fe];if(l.hasOwnProperty(fe)&&Re!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":Y=Re;default:u.hasOwnProperty(fe)||fn(r,a,fe,null,u,Re)}}for(var de in u){var fe=u[de];if(Re=l[de],u.hasOwnProperty(de)&&(fe!=null||Re!=null))switch(de){case"type":_=fe;break;case"name":m=fe;break;case"checked":ue=fe;break;case"defaultChecked":Te=fe;break;case"value":I=fe;break;case"defaultValue":z=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,a));break;default:fe!==Re&&fn(r,a,de,fe,u,Re)}}Ft(r,I,z,Y,ue,Te,_,m);return;case"select":fe=I=z=de=null;for(_ in l)if(Y=l[_],l.hasOwnProperty(_)&&Y!=null)switch(_){case"value":break;case"multiple":fe=Y;default:u.hasOwnProperty(_)||fn(r,a,_,null,u,Y)}for(m in u)if(_=u[m],Y=l[m],u.hasOwnProperty(m)&&(_!=null||Y!=null))switch(m){case"value":de=_;break;case"defaultValue":z=_;break;case"multiple":I=_;default:_!==Y&&fn(r,a,m,_,u,Y)}a=z,l=I,u=fe,de!=null?bn(r,!!l,de,!1):!!u!=!!l&&(a!=null?bn(r,!!l,a,!0):bn(r,!!l,l?[]:"",!1));return;case"textarea":fe=de=null;for(z in l)if(m=l[z],l.hasOwnProperty(z)&&m!=null&&!u.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:fn(r,a,z,null,u,m)}for(I in u)if(m=u[I],_=l[I],u.hasOwnProperty(I)&&(m!=null||_!=null))switch(I){case"value":de=m;break;case"defaultValue":fe=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==_&&fn(r,a,I,m,u,_)}Ct(r,de,fe);return;case"option":for(var yt in l)if(de=l[yt],l.hasOwnProperty(yt)&&de!=null&&!u.hasOwnProperty(yt))switch(yt){case"selected":r.selected=!1;break;default:fn(r,a,yt,null,u,de)}for(Y in u)if(de=u[Y],fe=l[Y],u.hasOwnProperty(Y)&&de!==fe&&(de!=null||fe!=null))switch(Y){case"selected":r.selected=de&&typeof de!="function"&&typeof de!="symbol";break;default:fn(r,a,Y,de,u,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var gt in l)de=l[gt],l.hasOwnProperty(gt)&&de!=null&&!u.hasOwnProperty(gt)&&fn(r,a,gt,null,u,de);for(ue in u)if(de=u[ue],fe=l[ue],u.hasOwnProperty(ue)&&de!==fe&&(de!=null||fe!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,a));break;default:fn(r,a,ue,de,u,fe)}return;default:if(Bc(a)){for(var pn in l)de=l[pn],l.hasOwnProperty(pn)&&de!==void 0&&!u.hasOwnProperty(pn)&&vg(r,a,pn,void 0,u,de);for(Te in u)de=u[Te],fe=l[Te],!u.hasOwnProperty(Te)||de===fe||de===void 0&&fe===void 0||vg(r,a,Te,de,u,fe);return}}for(var ne in l)de=l[ne],l.hasOwnProperty(ne)&&de!=null&&!u.hasOwnProperty(ne)&&fn(r,a,ne,null,u,de);for(Re in u)de=u[Re],fe=l[Re],!u.hasOwnProperty(Re)||de===fe||de==null&&fe==null||fn(r,a,Re,de,u,fe)}var yg=null,Eg=null;function Hd(r){return r.nodeType===9?r:r.ownerDocument}function oT(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lT(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function Sg(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Tg=null;function D1(){var r=window.event;return r&&r.type==="popstate"?r===Tg?!1:(Tg=r,!0):(Tg=null,!1)}var cT=typeof setTimeout=="function"?setTimeout:void 0,N1=typeof clearTimeout=="function"?clearTimeout:void 0,uT=typeof Promise=="function"?Promise:void 0,P1=typeof queueMicrotask=="function"?queueMicrotask:typeof uT<"u"?function(r){return uT.resolve(null).then(r).catch(U1)}:cT;function U1(r){setTimeout(function(){throw r})}function ya(r){return r==="head"}function hT(r,a){var l=a,u=0,m=0;do{var _=l.nextSibling;if(r.removeChild(l),_&&_.nodeType===8)if(l=_.data,l==="/$"){if(0<u&&8>u){l=u;var I=r.ownerDocument;if(l&1&&Mu(I.documentElement),l&2&&Mu(I.body),l&4)for(l=I.head,Mu(l),I=l.firstChild;I;){var z=I.nextSibling,Y=I.nodeName;I[lr]||Y==="SCRIPT"||Y==="STYLE"||Y==="LINK"&&I.rel.toLowerCase()==="stylesheet"||l.removeChild(I),I=z}}if(m===0){r.removeChild(_),Uu(a);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:u=l.charCodeAt(0)-48;else u=0;l=_}while(l);Uu(a)}function xg(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":xg(l),Cr(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function L1(r,a,l,u){for(;r.nodeType===1;){var m=l;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[lr])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(_=r.getAttribute("rel"),_==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(_!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(_=r.getAttribute("src"),(_!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&_&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var _=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===_)return r}else return r;if(r=Ur(r.nextSibling),r===null)break}return null}function O1(r,a,l){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Ur(r.nextSibling),r===null))return null;return r}function bg(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function V1(r,a){var l=r.ownerDocument;if(r.data!=="$?"||l.readyState==="complete")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function Ur(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var Ag=null;function dT(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return r;a--}else l==="/$"&&a++}r=r.previousSibling}return null}function fT(r,a,l){switch(a=Hd(l),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Mu(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);Cr(r)}var Sr=new Map,pT=new Set;function Gd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ls=Z.d;Z.d={f:F1,r:k1,D:z1,C:B1,L:H1,m:G1,X:q1,S:j1,M:W1};function F1(){var r=Ls.f(),a=Ud();return r||a}function k1(r){var a=ur(r);a!==null&&a.tag===5&&a.type==="form"?UE(a):Ls.r(r)}var Hl=typeof document>"u"?null:document;function mT(r,a,l){var u=Hl;if(u&&typeof a=="string"&&a){var m=En(a);m='link[rel="'+r+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),pT.has(m)||(pT.add(m),r={rel:r,crossOrigin:l,href:a},u.querySelector(m)===null&&(a=u.createElement("link"),mi(a,"link",r),Rn(a),u.head.appendChild(a)))}}function z1(r){Ls.D(r),mT("dns-prefetch",r,null)}function B1(r,a){Ls.C(r,a),mT("preconnect",r,a)}function H1(r,a,l){Ls.L(r,a,l);var u=Hl;if(u&&r&&a){var m='link[rel="preload"][as="'+En(a)+'"]';a==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+En(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+En(l.imageSizes)+'"]')):m+='[href="'+En(r)+'"]';var _=m;switch(a){case"style":_=Gl(r);break;case"script":_=jl(r)}Sr.has(_)||(r=g({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:r,as:a},l),Sr.set(_,r),u.querySelector(m)!==null||a==="style"&&u.querySelector(wu(_))||a==="script"&&u.querySelector(Ru(_))||(a=u.createElement("link"),mi(a,"link",r),Rn(a),u.head.appendChild(a)))}}function G1(r,a){Ls.m(r,a);var l=Hl;if(l&&r){var u=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+En(u)+'"][href="'+En(r)+'"]',_=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=jl(r)}if(!Sr.has(_)&&(r=g({rel:"modulepreload",href:r},a),Sr.set(_,r),l.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ru(_)))return}u=l.createElement("link"),mi(u,"link",r),Rn(u),l.head.appendChild(u)}}}function j1(r,a,l){Ls.S(r,a,l);var u=Hl;if(u&&r){var m=ui(u).hoistableStyles,_=Gl(r);a=a||"default";var I=m.get(_);if(!I){var z={loading:0,preload:null};if(I=u.querySelector(wu(_)))z.loading=5;else{r=g({rel:"stylesheet",href:r,"data-precedence":a},l),(l=Sr.get(_))&&Mg(r,l);var Y=I=u.createElement("link");Rn(Y),mi(Y,"link",r),Y._p=new Promise(function(ue,Te){Y.onload=ue,Y.onerror=Te}),Y.addEventListener("load",function(){z.loading|=1}),Y.addEventListener("error",function(){z.loading|=2}),z.loading|=4,jd(I,a,u)}I={type:"stylesheet",instance:I,count:1,state:z},m.set(_,I)}}}function q1(r,a){Ls.X(r,a);var l=Hl;if(l&&r){var u=ui(l).hoistableScripts,m=jl(r),_=u.get(m);_||(_=l.querySelector(Ru(m)),_||(r=g({src:r,async:!0},a),(a=Sr.get(m))&&wg(r,a),_=l.createElement("script"),Rn(_),mi(_,"link",r),l.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},u.set(m,_))}}function W1(r,a){Ls.M(r,a);var l=Hl;if(l&&r){var u=ui(l).hoistableScripts,m=jl(r),_=u.get(m);_||(_=l.querySelector(Ru(m)),_||(r=g({src:r,async:!0,type:"module"},a),(a=Sr.get(m))&&wg(r,a),_=l.createElement("script"),Rn(_),mi(_,"link",r),l.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},u.set(m,_))}}function gT(r,a,l,u){var m=(m=le.current)?Gd(m):null;if(!m)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Gl(l.href),l=ui(m).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=Gl(l.href);var _=ui(m).hoistableStyles,I=_.get(r);if(I||(m=m.ownerDocument||m,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(r,I),(_=m.querySelector(wu(r)))&&!_._p&&(I.instance=_,I.state.loading=5),Sr.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Sr.set(r,l),_||X1(m,r,l,I.state))),a&&u===null)throw Error(i(528,""));return I}if(a&&u!==null)throw Error(i(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=jl(l),l=ui(m).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Gl(r){return'href="'+En(r)+'"'}function wu(r){return'link[rel="stylesheet"]['+r+"]"}function _T(r){return g({},r,{"data-precedence":r.precedence,precedence:null})}function X1(r,a,l,u){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=r.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),mi(a,"link",l),Rn(a),r.head.appendChild(a))}function jl(r){return'[src="'+En(r)+'"]'}function Ru(r){return"script[async]"+r}function vT(r,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=r.querySelector('style[data-href~="'+En(l.href)+'"]');if(u)return a.instance=u,Rn(u),u;var m=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Rn(u),mi(u,"style",m),jd(u,l.precedence,r),a.instance=u;case"stylesheet":m=Gl(l.href);var _=r.querySelector(wu(m));if(_)return a.state.loading|=4,a.instance=_,Rn(_),_;u=_T(l),(m=Sr.get(m))&&Mg(u,m),_=(r.ownerDocument||r).createElement("link"),Rn(_);var I=_;return I._p=new Promise(function(z,Y){I.onload=z,I.onerror=Y}),mi(_,"link",u),a.state.loading|=4,jd(_,l.precedence,r),a.instance=_;case"script":return _=jl(l.src),(m=r.querySelector(Ru(_)))?(a.instance=m,Rn(m),m):(u=l,(m=Sr.get(_))&&(u=g({},l),wg(u,m)),r=r.ownerDocument||r,m=r.createElement("script"),Rn(m),mi(m,"link",u),r.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,jd(u,l.precedence,r));return a.instance}function jd(r,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,_=m,I=0;I<u.length;I++){var z=u[I];if(z.dataset.precedence===a)_=z;else if(_!==m)break}_?_.parentNode.insertBefore(r,_.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(r,a.firstChild))}function Mg(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function wg(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var qd=null;function yT(r,a,l){if(qd===null){var u=new Map,m=qd=new Map;m.set(l,u)}else m=qd,u=m.get(l),u||(u=new Map,m.set(l,u));if(u.has(r))return u;for(u.set(r,null),l=l.getElementsByTagName(r),m=0;m<l.length;m++){var _=l[m];if(!(_[lr]||_[Un]||r==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var I=_.getAttribute(a)||"";I=r+I;var z=u.get(I);z?z.push(_):u.set(I,[_])}}return u}function ET(r,a,l){r=r.ownerDocument||r,r.head.insertBefore(l,a==="title"?r.querySelector("head > title"):null)}function Y1(r,a,l){if(l===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function ST(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var Cu=null;function K1(){}function $1(r,a,l){if(Cu===null)throw Error(i(475));var u=Cu;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var m=Gl(l.href),_=r.querySelector(wu(m));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(u.count++,u=Wd.bind(u),r.then(u,u)),a.state.loading|=4,a.instance=_,Rn(_);return}_=r.ownerDocument||r,l=_T(l),(m=Sr.get(m))&&Mg(l,m),_=_.createElement("link"),Rn(_);var I=_;I._p=new Promise(function(z,Y){I.onload=z,I.onerror=Y}),mi(_,"link",l),a.instance=_}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(u.count++,a=Wd.bind(u),r.addEventListener("load",a),r.addEventListener("error",a))}}function Q1(){if(Cu===null)throw Error(i(475));var r=Cu;return r.stylesheets&&r.count===0&&Rg(r,r.stylesheets),0<r.count?function(a){var l=setTimeout(function(){if(r.stylesheets&&Rg(r,r.stylesheets),r.unsuspend){var u=r.unsuspend;r.unsuspend=null,u()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(l)}}:null}function Wd(){if(this.count--,this.count===0){if(this.stylesheets)Rg(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Xd=null;function Rg(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Xd=new Map,a.forEach(Z1,r),Xd=null,Wd.call(r))}function Z1(r,a){if(!(a.state.loading&4)){var l=Xd.get(r);if(l)var u=l.get(null);else{l=new Map,Xd.set(r,l);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<m.length;_++){var I=m[_];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(l.set(I.dataset.precedence,I),u=I)}u&&l.set(null,u)}m=a.instance,I=m.getAttribute("data-precedence"),_=l.get(I)||u,_===u&&l.set(null,m),l.set(I,m),this.count++,u=Wd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),_?_.parentNode.insertBefore(m,_.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),a.state.loading|=4}}var Iu={$$typeof:k,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function J1(r,a,l,u,m,_,I,z){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ve(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ve(0),this.hiddenUpdates=Ve(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=_,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function TT(r,a,l,u,m,_,I,z,Y,ue,Te,Re){return r=new J1(r,a,l,I,z,Y,ue,Re),a=1,_===!0&&(a|=24),_=Qi(3,null,null,a),r.current=_,_.stateNode=r,a=cm(),a.refCount++,r.pooledCache=a,a.refCount++,_.memoizedState={element:u,isDehydrated:l,cache:a},fm(_),r}function xT(r){return r?(r=Sl,r):Sl}function bT(r,a,l,u,m,_){m=xT(m),u.context===null?u.context=m:u.pendingContext=m,u=aa(a),u.payload={element:l},_=_===void 0?null:_,_!==null&&(u.callback=_),l=oa(r,u,a),l!==null&&(nr(l,r,a),au(l,r,a))}function AT(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<a?l:a}}function Cg(r,a){AT(r,a),(r=r.alternate)&&AT(r,a)}function MT(r){if(r.tag===13){var a=El(r,67108864);a!==null&&nr(a,r,67108864),Cg(r,67108864)}}var Yd=!0;function eC(r,a,l,u){var m=X.T;X.T=null;var _=Z.p;try{Z.p=2,Ig(r,a,l,u)}finally{Z.p=_,X.T=m}}function tC(r,a,l,u){var m=X.T;X.T=null;var _=Z.p;try{Z.p=8,Ig(r,a,l,u)}finally{Z.p=_,X.T=m}}function Ig(r,a,l,u){if(Yd){var m=Dg(u);if(m===null)_g(r,a,u,Kd,l),RT(r,u);else if(iC(m,r,a,l,u))u.stopPropagation();else if(RT(r,u),a&4&&-1<nC.indexOf(r)){for(;m!==null;){var _=ur(m);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var I=ot(_.pendingLanes);if(I!==0){var z=_;for(z.pendingLanes|=2,z.entangledLanes|=2;I;){var Y=1<<31-Xe(I);z.entanglements[1]|=Y,I&=~Y}rs(_),(an&6)===0&&(Nd=Ke()+500,xu(0))}}break;case 13:z=El(_,2),z!==null&&nr(z,_,2),Ud(),Cg(_,2)}if(_=Dg(u),_===null&&_g(r,a,u,Kd,l),_===m)break;m=_}m!==null&&u.stopPropagation()}else _g(r,a,u,null,l)}}function Dg(r){return r=dr(r),Ng(r)}var Kd=null;function Ng(r){if(Kd=null,r=cr(r),r!==null){var a=o(r);if(a===null)r=null;else{var l=a.tag;if(l===13){if(r=c(a),r!==null)return r;r=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Kd=r,null}function wT(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(cn()){case Je:return 2;case St:return 8;case yn:case xn:return 32;case W:return 268435456;default:return 32}default:return 32}}var Pg=!1,Ea=null,Sa=null,Ta=null,Du=new Map,Nu=new Map,xa=[],nC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function RT(r,a){switch(r){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":Sa=null;break;case"mouseover":case"mouseout":Ta=null;break;case"pointerover":case"pointerout":Du.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nu.delete(a.pointerId)}}function Pu(r,a,l,u,m,_){return r===null||r.nativeEvent!==_?(r={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:_,targetContainers:[m]},a!==null&&(a=ur(a),a!==null&&MT(a)),r):(r.eventSystemFlags|=u,a=r.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),r)}function iC(r,a,l,u,m){switch(a){case"focusin":return Ea=Pu(Ea,r,a,l,u,m),!0;case"dragenter":return Sa=Pu(Sa,r,a,l,u,m),!0;case"mouseover":return Ta=Pu(Ta,r,a,l,u,m),!0;case"pointerover":var _=m.pointerId;return Du.set(_,Pu(Du.get(_)||null,r,a,l,u,m)),!0;case"gotpointercapture":return _=m.pointerId,Nu.set(_,Pu(Nu.get(_)||null,r,a,l,u,m)),!0}return!1}function CT(r){var a=cr(r.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){r.blockedOn=a,zi(r.priority,function(){if(l.tag===13){var u=tr();u=pt(u);var m=El(l,u);m!==null&&nr(m,l,u),Cg(l,u)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function $d(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var l=Dg(r.nativeEvent);if(l===null){l=r.nativeEvent;var u=new l.constructor(l.type,l);_s=u,l.target.dispatchEvent(u),_s=null}else return a=ur(l),a!==null&&MT(a),r.blockedOn=l,!1;a.shift()}return!0}function IT(r,a,l){$d(r)&&l.delete(a)}function rC(){Pg=!1,Ea!==null&&$d(Ea)&&(Ea=null),Sa!==null&&$d(Sa)&&(Sa=null),Ta!==null&&$d(Ta)&&(Ta=null),Du.forEach(IT),Nu.forEach(IT)}function Qd(r,a){r.blockedOn===a&&(r.blockedOn=null,Pg||(Pg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,rC)))}var Zd=null;function DT(r){Zd!==r&&(Zd=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Zd===r&&(Zd=null);for(var a=0;a<r.length;a+=3){var l=r[a],u=r[a+1],m=r[a+2];if(typeof u!="function"){if(Ng(u||l)===null)continue;break}var _=ur(l);_!==null&&(r.splice(a,3),a-=3,Nm(_,{pending:!0,data:m,method:l.method,action:u},u,m))}}))}function Uu(r){function a(Y){return Qd(Y,r)}Ea!==null&&Qd(Ea,r),Sa!==null&&Qd(Sa,r),Ta!==null&&Qd(Ta,r),Du.forEach(a),Nu.forEach(a);for(var l=0;l<xa.length;l++){var u=xa[l];u.blockedOn===r&&(u.blockedOn=null)}for(;0<xa.length&&(l=xa[0],l.blockedOn===null);)CT(l),l.blockedOn===null&&xa.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var m=l[u],_=l[u+1],I=m[un]||null;if(typeof _=="function")I||DT(l);else if(I){var z=null;if(_&&_.hasAttribute("formAction")){if(m=_,I=_[un]||null)z=I.formAction;else if(Ng(m)!==null)continue}else z=I.action;typeof z=="function"?l[u+1]=z:(l.splice(u,3),u-=3),DT(l)}}}function Ug(r){this._internalRoot=r}Jd.prototype.render=Ug.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var l=a.current,u=tr();bT(l,u,r,a,null,null)},Jd.prototype.unmount=Ug.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;bT(r.current,2,null,r,null,null),Ud(),a[Si]=null}};function Jd(r){this._internalRoot=r}Jd.prototype.unstable_scheduleHydration=function(r){if(r){var a=Ut();r={blockedOn:null,target:r,priority:a};for(var l=0;l<xa.length&&a!==0&&a<xa[l].priority;l++);xa.splice(l,0,r),l===0&&CT(r)}};var NT=e.version;if(NT!=="19.1.1")throw Error(i(527,NT,"19.1.1"));Z.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=d(a),r=r!==null?p(r):null,r=r===null?null:r.stateNode,r};var sC={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ef=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ef.isDisabled&&ef.supportsFiber)try{ge=ef.inject(sC),Se=ef}catch{}}return Ou.createRoot=function(r,a){if(!s(r))throw Error(i(299));var l=!1,u="",m=YE,_=KE,I=$E,z=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(_=a.onCaughtError),a.onRecoverableError!==void 0&&(I=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(z=a.unstable_transitionCallbacks)),a=TT(r,1,!1,null,null,l,u,m,_,I,z,null),r[Si]=a.current,gg(r),new Ug(a)},Ou.hydrateRoot=function(r,a,l){if(!s(r))throw Error(i(299));var u=!1,m="",_=YE,I=KE,z=$E,Y=null,ue=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(_=l.onUncaughtError),l.onCaughtError!==void 0&&(I=l.onCaughtError),l.onRecoverableError!==void 0&&(z=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(Y=l.unstable_transitionCallbacks),l.formState!==void 0&&(ue=l.formState)),a=TT(r,1,!0,a,l??null,u,m,_,I,z,Y,ue),a.context=xT(null),l=a.current,u=tr(),u=pt(u),m=aa(u),m.callback=null,oa(l,m,u),l=u,a.current.lanes=l,Ye(a,l),rs(a),r[Si]=a.current,gg(r),new Jd(a)},Ou.version="19.1.1",Ou}var HT;function gC(){if(HT)return Vg.exports;HT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Vg.exports=mC(),Vg.exports}var _C=gC(),GT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},vC=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],c=n[t++],h=n[t++],d=((s&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(d>>10)),e[i++]=String.fromCharCode(56320+(d&1023))}else{const o=n[t++],c=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return e.join("")},yA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],c=s+1<n.length,h=c?n[s+1]:0,d=s+2<n.length,p=d?n[s+2]:0,g=o>>2,v=(o&3)<<4|h>>4;let y=(h&15)<<2|p>>6,E=p&63;d||(E=64,c||(y=64)),i.push(t[g],t[v],t[y],t[E])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vA(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):vC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],h=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const v=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||h==null||p==null||v==null)throw new yC;const y=o<<2|h>>4;if(i.push(y),p!==64){const E=h<<4&240|p>>2;if(i.push(E),v!==64){const b=p<<6&192|v;i.push(b)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const EC=function(n){const e=vA(n);return yA.encodeByteArray(e,!0)},Xf=function(n){return EC(n).replace(/\./g,"")},EA=function(n){try{return yA.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=()=>SC().__FIREBASE_DEFAULTS__,xC=()=>{if(typeof process>"u"||typeof GT>"u")return;const n=GT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},bC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&EA(n[1]);return e&&JSON.parse(e)},mp=()=>{try{return TC()||xC()||bC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},SA=n=>{var e,t;return(t=(e=mp())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},AC=n=>{const e=SA(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},TA=()=>{var n;return(n=mp())===null||n===void 0?void 0:n.config},xA=n=>{var e;return(e=mp())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Xf(JSON.stringify(t)),Xf(JSON.stringify(c)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ii())}function CC(){var n;const e=(n=mp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function IC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function DC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NC(){const n=Ii();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function PC(){return!CC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function AA(){try{return typeof indexedDB=="object"}catch{return!1}}function MA(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}function UC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="FirebaseError";class Wr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=LC,Object.setPrototypeOf(this,Wr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nl.prototype.create)}}class nl{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],c=o?OC(o,i):"Error",h=`${this.serviceName}: ${c} (${s}).`;return new Wr(s,h,i)}}function OC(n,e){return n.replace(VC,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const VC=/\{\$([^}]+)}/g;function FC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function sh(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],c=e[s];if(jT(o)&&jT(c)){if(!sh(o,c))return!1}else if(o!==c)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function jT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Wu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function Xu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function kC(n,e){const t=new zC(n,e);return t.subscribe.bind(t)}class zC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");BC(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=Bg),s.error===void 0&&(s.error=Bg),s.complete===void 0&&(s.complete=Bg);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function BC(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Bg(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=1e3,GC=2,jC=14400*1e3,qC=.5;function qT(n,e=HC,t=GC){const i=e*Math.pow(t,n),s=Math.round(qC*i*(Math.random()-.5)*2);return Math.min(jC,i+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(n){return n&&n._delegate?n._delegate:n}class Gr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new MC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),s=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(YC(e))try{this.getOrInitializeService({instanceIdentifier:Lo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=Lo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Lo){return this.instances.has(e)}getOptions(e=Lo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);i===h&&c.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:XC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Lo){return this.component?this.component.multipleInstances?e:Lo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XC(n){return n===Lo?void 0:n}function YC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new WC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(qt||(qt={}));const $C={debug:qt.DEBUG,verbose:qt.VERBOSE,info:qt.INFO,warn:qt.WARN,error:qt.ERROR,silent:qt.SILENT},QC=qt.INFO,ZC={[qt.DEBUG]:"log",[qt.VERBOSE]:"log",[qt.INFO]:"info",[qt.WARN]:"warn",[qt.ERROR]:"error"},JC=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=ZC[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gp{constructor(e){this.name=e,this._logLevel=QC,this._logHandler=JC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$C[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qt.DEBUG,...e),this._logHandler(this,qt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qt.VERBOSE,...e),this._logHandler(this,qt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qt.INFO,...e),this._logHandler(this,qt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qt.WARN,...e),this._logHandler(this,qt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qt.ERROR,...e),this._logHandler(this,qt.ERROR,...e)}}const eI=(n,e)=>e.some(t=>n instanceof t);let WT,XT;function tI(){return WT||(WT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nI(){return XT||(XT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wA=new WeakMap,k_=new WeakMap,RA=new WeakMap,Hg=new WeakMap,iy=new WeakMap;function iI(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(ka(n.result)),s()},c=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&wA.set(t,n)}).catch(()=>{}),iy.set(e,n),e}function rI(n){if(k_.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),s()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});k_.set(n,e)}let z_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return k_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||RA.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ka(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function sI(n){z_=n(z_)}function aI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Gg(this),e,...t);return RA.set(i,e.sort?e.sort():[e]),ka(i)}:nI().includes(n)?function(...e){return n.apply(Gg(this),e),ka(wA.get(this))}:function(...e){return ka(n.apply(Gg(this),e))}}function oI(n){return typeof n=="function"?aI(n):(n instanceof IDBTransaction&&rI(n),eI(n,tI())?new Proxy(n,z_):n)}function ka(n){if(n instanceof IDBRequest)return iI(n);if(Hg.has(n))return Hg.get(n);const e=oI(n);return e!==n&&(Hg.set(n,e),iy.set(e,n)),e}const Gg=n=>iy.get(n);function CA(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const c=indexedDB.open(n,e),h=ka(c);return i&&c.addEventListener("upgradeneeded",d=>{i(ka(c.result),d.oldVersion,d.newVersion,ka(c.transaction),d)}),t&&c.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const lI=["get","getKey","getAll","getAllKeys","count"],cI=["put","add","delete","clear"],jg=new Map;function YT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(jg.get(e))return jg.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=cI.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||lI.includes(t)))return;const o=async function(c,...h){const d=this.transaction(c,s?"readwrite":"readonly");let p=d.store;return i&&(p=p.index(h.shift())),(await Promise.all([p[t](...h),s&&d.done]))[0]};return jg.set(e,o),o}sI(n=>({...n,get:(e,t,i)=>YT(e,t)||n.get(e,t,i),has:(e,t)=>!!YT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(hI(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function hI(n){const e=n.getComponent();return e?.type==="VERSION"}const B_="@firebase/app",KT="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=new gp("@firebase/app"),dI="@firebase/app-compat",fI="@firebase/analytics-compat",pI="@firebase/analytics",mI="@firebase/app-check-compat",gI="@firebase/app-check",_I="@firebase/auth",vI="@firebase/auth-compat",yI="@firebase/database",EI="@firebase/data-connect",SI="@firebase/database-compat",TI="@firebase/functions",xI="@firebase/functions-compat",bI="@firebase/installations",AI="@firebase/installations-compat",MI="@firebase/messaging",wI="@firebase/messaging-compat",RI="@firebase/performance",CI="@firebase/performance-compat",II="@firebase/remote-config",DI="@firebase/remote-config-compat",NI="@firebase/storage",PI="@firebase/storage-compat",UI="@firebase/firestore",LI="@firebase/vertexai-preview",OI="@firebase/firestore-compat",VI="firebase",FI="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_="[DEFAULT]",kI={[B_]:"fire-core",[dI]:"fire-core-compat",[pI]:"fire-analytics",[fI]:"fire-analytics-compat",[gI]:"fire-app-check",[mI]:"fire-app-check-compat",[_I]:"fire-auth",[vI]:"fire-auth-compat",[yI]:"fire-rtdb",[EI]:"fire-data-connect",[SI]:"fire-rtdb-compat",[TI]:"fire-fn",[xI]:"fire-fn-compat",[bI]:"fire-iid",[AI]:"fire-iid-compat",[MI]:"fire-fcm",[wI]:"fire-fcm-compat",[RI]:"fire-perf",[CI]:"fire-perf-compat",[II]:"fire-rc",[DI]:"fire-rc-compat",[NI]:"fire-gcs",[PI]:"fire-gcs-compat",[UI]:"fire-fst",[OI]:"fire-fst-compat",[LI]:"fire-vertex","fire-js":"fire-js",[VI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf=new Map,zI=new Map,G_=new Map;function $T(n,e){try{n.container.addComponent(e)}catch(t){Qs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ds(n){const e=n.name;if(G_.has(e))return Qs.debug(`There were multiple attempts to register component ${e}.`),!1;G_.set(e,n);for(const t of Yf.values())$T(t,n);for(const t of zI.values())$T(t,n);return!0}function il(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Fr(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},za=new nl("app","Firebase",BI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Gr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw za.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=FI;function IA(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:H_,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw za.create("bad-app-name",{appName:String(s)});if(t||(t=TA()),!t)throw za.create("no-options");const o=Yf.get(s);if(o){if(sh(t,o.options)&&sh(i,o.config))return o;throw za.create("duplicate-app",{appName:s})}const c=new KC(s);for(const d of G_.values())c.addComponent(d);const h=new HI(t,i,c);return Yf.set(s,h),h}function ry(n=H_){const e=Yf.get(n);if(!e&&n===H_&&TA())return IA();if(!e)throw za.create("no-app",{appName:n});return e}function wr(n,e,t){var i;let s=(i=kI[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const h=[`Unable to register library "${s}" with version "${e}":`];o&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&h.push("and"),c&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qs.warn(h.join(" "));return}ds(new Gr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI="firebase-heartbeat-database",jI=1,ah="firebase-heartbeat-store";let qg=null;function DA(){return qg||(qg=CA(GI,jI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ah)}catch(t){console.warn(t)}}}}).catch(n=>{throw za.create("idb-open",{originalErrorMessage:n.message})})),qg}async function qI(n){try{const t=(await DA()).transaction(ah),i=await t.objectStore(ah).get(NA(n));return await t.done,i}catch(e){if(e instanceof Wr)Qs.warn(e.message);else{const t=za.create("idb-get",{originalErrorMessage:e?.message});Qs.warn(t.message)}}}async function QT(n,e){try{const i=(await DA()).transaction(ah,"readwrite");await i.objectStore(ah).put(e,NA(n)),await i.done}catch(t){if(t instanceof Wr)Qs.warn(t.message);else{const i=za.create("idb-set",{originalErrorMessage:t?.message});Qs.warn(i.message)}}}function NA(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=1024,XI=720*60*60*1e3;class YI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new $I(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=ZT();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const h=new Date(c.date).valueOf();return Date.now()-h<=XI}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Qs.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ZT(),{heartbeatsToSend:i,unsentEntries:s}=KI(this._heartbeatsCache.heartbeats),o=Xf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Qs.warn(t),""}}}function ZT(){return new Date().toISOString().substring(0,10)}function KI(n,e=WI){const t=[];let i=n.slice();for(const s of n){const o=t.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),JT(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),JT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class $I{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return AA()?MA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await qI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return QT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return QT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function JT(n){return Xf(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(n){ds(new Gr("platform-logger",e=>new uI(e),"PRIVATE")),ds(new Gr("heartbeat",e=>new YI(e),"PRIVATE")),wr(B_,KT,n),wr(B_,KT,"esm2017"),wr("fire-js","")}QI("");function sy(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function PA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZI=PA,UA=new nl("auth","Firebase",PA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf=new gp("@firebase/auth");function JI(n,...e){Kf.logLevel<=qt.WARN&&Kf.warn(`Auth (${Dc}): ${n}`,...e)}function Pf(n,...e){Kf.logLevel<=qt.ERROR&&Kf.error(`Auth (${Dc}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(n,...e){throw oy(n,...e)}function zr(n,...e){return oy(n,...e)}function ay(n,e,t){const i=Object.assign(Object.assign({},ZI()),{[e]:t});return new nl("auth","Firebase",i).create(e,{appName:n.name})}function Ys(n){return ay(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function eD(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Rr(n,"argument-error"),ay(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function oy(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return UA.create(n,...e)}function Et(n,e,...t){if(!n)throw oy(e,...t)}function js(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Pf(e),new Error(e)}function Zs(n,e){n||js(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function tD(){return ex()==="http:"||ex()==="https:"}function ex(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tD()||bA()||"connection"in navigator)?navigator.onLine:!0}function iD(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zs(t>e,"Short delay should be less than long delay!"),this.isMobile=RC()||DC()}get(){return nD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(n,e){Zs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LA{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;js("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;js("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;js("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=new Th(3e4,6e4);function $a(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Qa(n,e,t,i,s={}){return OA(n,s,async()=>{let o={},c={};i&&(e==="GET"?c=i:o={body:JSON.stringify(i)});const h=Sh(Object.assign({key:n.config.apiKey},c)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const p=Object.assign({method:e,headers:d},o);return IC()||(p.referrerPolicy="no-referrer"),LA.fetch()(VA(n,n.config.apiHost,t,h),p)})}async function OA(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},rD),e);try{const s=new oD(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw tf(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const h=o.ok?c.errorMessage:c.error.message,[d,p]=h.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw tf(n,"credential-already-in-use",c);if(d==="EMAIL_EXISTS")throw tf(n,"email-already-in-use",c);if(d==="USER_DISABLED")throw tf(n,"user-disabled",c);const g=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw ay(n,g,p);Rr(n,g)}}catch(s){if(s instanceof Wr)throw s;Rr(n,"network-request-failed",{message:String(s)})}}async function xh(n,e,t,i,s={}){const o=await Qa(n,e,t,i,s);return"mfaPendingCredential"in o&&Rr(n,"multi-factor-auth-required",{_serverResponse:o}),o}function VA(n,e,t,i){const s=`${e}${t}?${i}`;return n.config.emulator?ly(n.config,s):`${n.config.apiScheme}://${s}`}function aD(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class oD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(zr(this.auth,"network-request-failed")),sD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function tf(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=zr(n,e,i);return s.customData._tokenResponse=t,s}function tx(n){return n!==void 0&&n.enterprise!==void 0}class lD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return aD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function cD(n,e){return Qa(n,"GET","/v2/recaptchaConfig",$a(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uD(n,e){return Qa(n,"POST","/v1/accounts:delete",e)}async function FA(n,e){return Qa(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hD(n,e=!1){const t=Nn(n),i=await t.getIdToken(e),s=cy(i);Et(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,c=o?.sign_in_provider;return{claims:s,token:i,authTime:Ju(Wg(s.auth_time)),issuedAtTime:Ju(Wg(s.iat)),expirationTime:Ju(Wg(s.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Wg(n){return Number(n)*1e3}function cy(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Pf("JWT malformed, contained fewer than 3 sections"),null;try{const s=EA(t);return s?JSON.parse(s):(Pf("Failed to decode base64 JWT payload"),null)}catch(s){return Pf("Caught error parsing JWT payload as JSON",s?.toString()),null}}function nx(n){const e=cy(n);return Et(e,"internal-error"),Et(typeof e.exp<"u","internal-error"),Et(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oh(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Wr&&dD(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function dD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ju(this.lastLoginAt),this.creationTime=Ju(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $f(n){var e;const t=n.auth,i=await n.getIdToken(),s=await oh(n,FA(t,{idToken:i}));Et(s?.users.length,t,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?kA(o.providerUserInfo):[],h=mD(n.providerData,c),d=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!h?.length,g=d?p:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new q_(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(n,v)}async function pD(n){const e=Nn(n);await $f(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mD(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function kA(n){return n.map(e=>{var{providerId:t}=e,i=sy(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gD(n,e){const t=await OA(n,{},async()=>{const i=Sh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,c=VA(n,s,"/v1/token",`key=${o}`),h=await n._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",LA.fetch()(c,{method:"POST",headers:h,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function _D(n,e){return Qa(n,"POST","/v2/accounts:revokeToken",$a(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Et(e.idToken,"internal-error"),Et(typeof e.idToken<"u","internal-error"),Et(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Et(e.length!==0,"internal-error");const t=nx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Et(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:o}=await gD(e,t);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:o}=t,c=new fc;return i&&(Et(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),s&&(Et(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),o&&(Et(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fc,this.toJSON())}_performRefresh(){return js("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(n,e){Et(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class qs{constructor(e){var{uid:t,auth:i,stsTokenManager:s}=e,o=sy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new q_(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await oh(this,this.stsTokenManager.getToken(this.auth,e));return Et(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return hD(this,e)}reload(){return pD(this)}_assign(e){this!==e&&(Et(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new qs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await $f(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fr(this.auth.app))return Promise.reject(Ys(this.auth));const e=await this.getIdToken();return await oh(this,uD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,s,o,c,h,d,p,g;const v=(i=t.displayName)!==null&&i!==void 0?i:void 0,y=(s=t.email)!==null&&s!==void 0?s:void 0,E=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,b=(c=t.photoURL)!==null&&c!==void 0?c:void 0,D=(h=t.tenantId)!==null&&h!==void 0?h:void 0,A=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,T=(p=t.createdAt)!==null&&p!==void 0?p:void 0,P=(g=t.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:k,emailVerified:V,isAnonymous:j,providerData:q,stsTokenManager:U}=t;Et(k&&U,e,"internal-error");const N=fc.fromJSON(this.name,U);Et(typeof k=="string",e,"internal-error"),Aa(v,e.name),Aa(y,e.name),Et(typeof V=="boolean",e,"internal-error"),Et(typeof j=="boolean",e,"internal-error"),Aa(E,e.name),Aa(b,e.name),Aa(D,e.name),Aa(A,e.name),Aa(T,e.name),Aa(P,e.name);const M=new qs({uid:k,auth:e,email:y,emailVerified:V,displayName:v,isAnonymous:j,photoURL:b,phoneNumber:E,tenantId:D,stsTokenManager:N,createdAt:T,lastLoginAt:P});return q&&Array.isArray(q)&&(M.providerData=q.map(w=>Object.assign({},w))),A&&(M._redirectEventId=A),M}static async _fromIdTokenResponse(e,t,i=!1){const s=new fc;s.updateFromServerResponse(t);const o=new qs({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await $f(o),o}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];Et(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?kA(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!o?.length,h=new fc;h.updateFromIdToken(i);const d=new qs({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:c}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new q_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(d,p),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix=new Map;function Ws(n){Zs(n instanceof Function,"Expected a class definition");let e=ix.get(n);return e?(Zs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ix.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}zA.type="NONE";const rx=zA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uf(n,e,t){return`firebase:${n}:${e}:${t}`}class pc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=Uf(this.userKey,s.apiKey,o),this.fullPersistenceKey=Uf("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new pc(Ws(rx),e,i);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=s[0]||Ws(rx);const c=Uf(i,e.config.apiKey,e.name);let h=null;for(const p of t)try{const g=await p._get(c);if(g){const v=qs._fromJSON(e,g);p!==o&&(h=v),o=p;break}}catch{}const d=s.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new pc(o,e,i):(o=d[0],h&&await o._set(c,h.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(c)}catch{}})),new pc(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(BA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(WA(e))return"Blackberry";if(XA(e))return"Webos";if(HA(e))return"Safari";if((e.includes("chrome/")||GA(e))&&!e.includes("edge/"))return"Chrome";if(qA(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function BA(n=Ii()){return/firefox\//i.test(n)}function HA(n=Ii()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function GA(n=Ii()){return/crios\//i.test(n)}function jA(n=Ii()){return/iemobile/i.test(n)}function qA(n=Ii()){return/android/i.test(n)}function WA(n=Ii()){return/blackberry/i.test(n)}function XA(n=Ii()){return/webos/i.test(n)}function uy(n=Ii()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function vD(n=Ii()){var e;return uy(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function yD(){return NC()&&document.documentMode===10}function YA(n=Ii()){return uy(n)||qA(n)||XA(n)||WA(n)||/windows phone/i.test(n)||jA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(n,e=[]){let t;switch(n){case"Browser":t=sx(Ii());break;case"Worker":t=`${sx(Ii())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Dc}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((c,h)=>{try{const d=e(o);c(d)}catch(d){h(d)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SD(n,e={}){return Qa(n,"GET","/v2/passwordPolicy",$a(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=6;class xD{constructor(e){var t,i,s,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:TD,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,s,o,c,h;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(i=d.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(s=d.containsLowercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(c=d.containsNumericCharacter)!==null&&c!==void 0?c:!0),d.isValid&&(d.isValid=(h=d.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),d}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ax(this),this.idTokenSubscription=new ax(this),this.beforeStateQueue=new ED(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=UA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ws(t)),this._initializationPromise=this.queue(async()=>{var i,s;if(!this._deleted&&(this.persistenceManager=await pc.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await FA(this,{idToken:e}),i=await qs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Fr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(h,h))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,h=s?._redirectEventId,d=await this.tryRedirectSignIn(e);(!c||c===h)&&d?.user&&(s=d.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Et(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $f(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fr(this.app))return Promise.reject(Ys(this));const t=e?Nn(e):null;return t&&Et(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Et(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fr(this.app)?Promise.reject(Ys(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fr(this.app)?Promise.reject(Ys(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ws(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await SD(this),t=new xD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new nl("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await _D(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ws(e)||this._popupRedirectResolver;Et(t,this,"argument-error"),this.redirectPersistenceManager=await pc.create(this,[Ws(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Et(h,this,"internal-error"),h.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,i,s);return()=>{c=!0,d()}}else{const d=e.addObserver(t);return()=>{c=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=KA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&JI(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Za(n){return Nn(n)}class ax{constructor(e){this.auth=e,this.observer=null,this.addObserver=kC(t=>this.observer=t)}get next(){return Et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _p={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function AD(n){_p=n}function $A(n){return _p.loadJS(n)}function MD(){return _p.recaptchaEnterpriseScript}function wD(){return _p.gapiScript}function RD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const CD="recaptcha-enterprise",ID="NO_RECAPTCHA";class DD{constructor(e){this.type=CD,this.auth=Za(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,h)=>{cD(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new lD(d);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,c(p.siteKey)}}).catch(d=>{h(d)})})}function s(o,c,h){const d=window.grecaptcha;tx(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(p=>{c(p)}).catch(()=>{c(ID)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,c)=>{i(this.auth).then(h=>{if(!t&&tx(window.grecaptcha))s(h,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let d=MD();d.length!==0&&(d+=h),$A(d).then(()=>{s(h,o,c)}).catch(p=>{c(p)})}}).catch(h=>{c(h)})})}}async function ox(n,e,t,i=!1){const s=new DD(n);let o;try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const c=Object.assign({},e);return i?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function W_(n,e,t,i){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await ox(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await ox(n,e,t,t==="getOobCode");return i(n,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(n,e){const t=il(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(sh(o,e??{}))return s;Rr(s,"already-initialized")}return t.initialize({options:e})}function PD(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Ws);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function UD(n,e,t){const i=Za(n);Et(i._canInitEmulator,i,"emulator-config-failed"),Et(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,o=QA(e),{host:c,port:h}=LD(e),d=h===null?"":`:${h}`;i.config.emulator={url:`${o}//${c}${d}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:c,port:h,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})}),OD()}function QA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function LD(n){const e=QA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:lx(i.substr(o.length+1))}}else{const[o,c]=i.split(":");return{host:o,port:lx(c)}}}function lx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function OD(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return js("not implemented")}_getIdTokenResponse(e){return js("not implemented")}_linkToIdToken(e,t){return js("not implemented")}_getReauthenticationResolver(e){return js("not implemented")}}async function VD(n,e){return Qa(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FD(n,e){return xh(n,"POST","/v1/accounts:signInWithPassword",$a(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kD(n,e){return xh(n,"POST","/v1/accounts:signInWithEmailLink",$a(n,e))}async function zD(n,e){return xh(n,"POST","/v1/accounts:signInWithEmailLink",$a(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh extends hy{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new lh(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new lh(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return W_(e,t,"signInWithPassword",FD);case"emailLink":return kD(e,{email:this._email,oobCode:this._password});default:Rr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return W_(e,i,"signUpPassword",VD);case"emailLink":return zD(e,{idToken:t,email:this._email,oobCode:this._password});default:Rr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mc(n,e){return xh(n,"POST","/v1/accounts:signInWithIdp",$a(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD="http://localhost";class Wo extends hy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Rr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s}=t,o=sy(t,["providerId","signInMethod"]);if(!i||!s)return null;const c=new Wo(i,s);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return mc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,mc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mc(e,t)}buildRequest(){const e={requestUri:BD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Sh(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function GD(n){const e=Wu(Xu(n)).link,t=e?Wu(Xu(e)).deep_link_id:null,i=Wu(Xu(n)).deep_link_id;return(i?Wu(Xu(i)).link:null)||i||t||e||n}class dy{constructor(e){var t,i,s,o,c,h;const d=Wu(Xu(e)),p=(t=d.apiKey)!==null&&t!==void 0?t:null,g=(i=d.oobCode)!==null&&i!==void 0?i:null,v=HD((s=d.mode)!==null&&s!==void 0?s:null);Et(p&&g&&v,"argument-error"),this.apiKey=p,this.operation=v,this.code=g,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=d.languageCode)!==null&&c!==void 0?c:null,this.tenantId=(h=d.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const t=GD(e);try{return new dy(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(){this.providerId=Nc.PROVIDER_ID}static credential(e,t){return lh._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=dy.parseLink(t);return Et(i,"argument-error"),lh._fromEmailAndCode(e,i.code,i.tenantId)}}Nc.PROVIDER_ID="password";Nc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Nc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh extends fy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa extends bh{constructor(){super("facebook.com")}static credential(e){return Wo._fromParams({providerId:Pa.PROVIDER_ID,signInMethod:Pa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pa.credentialFromTaggedObject(e)}static credentialFromError(e){return Pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pa.credential(e.oauthAccessToken)}catch{return null}}}Pa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Pa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs extends bh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wo._fromParams({providerId:Hs.PROVIDER_ID,signInMethod:Hs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Hs.credentialFromTaggedObject(e)}static credentialFromError(e){return Hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Hs.credential(t,i)}catch{return null}}}Hs.GOOGLE_SIGN_IN_METHOD="google.com";Hs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends bh{constructor(){super("github.com")}static credential(e){return Wo._fromParams({providerId:Ua.PROVIDER_ID,signInMethod:Ua.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ua.credentialFromTaggedObject(e)}static credentialFromError(e){return Ua.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ua.credential(e.oauthAccessToken)}catch{return null}}}Ua.GITHUB_SIGN_IN_METHOD="github.com";Ua.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends bh{constructor(){super("twitter.com")}static credential(e,t){return Wo._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return La.credentialFromTaggedObject(e)}static credentialFromError(e){return La.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return La.credential(t,i)}catch{return null}}}La.TWITTER_SIGN_IN_METHOD="twitter.com";La.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jD(n,e){return xh(n,"POST","/v1/accounts:signUp",$a(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const o=await qs._fromIdTokenResponse(e,i,s),c=cx(i);return new Xo({user:o,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=cx(i);return new Xo({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function cx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf extends Wr{constructor(e,t,i,s){var o;super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Qf.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new Qf(e,t,i,s)}}function ZA(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Qf._fromErrorAndOperation(n,o,e,i):o})}async function qD(n,e,t=!1){const i=await oh(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Xo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD(n,e,t=!1){const{auth:i}=n;if(Fr(i.app))return Promise.reject(Ys(i));const s="reauthenticate";try{const o=await oh(n,ZA(i,s,e,n),t);Et(o.idToken,i,"internal-error");const c=cy(o.idToken);Et(c,i,"internal-error");const{sub:h}=c;return Et(n.uid===h,i,"user-mismatch"),Xo._forOperation(n,s,o)}catch(o){throw o?.code==="auth/user-not-found"&&Rr(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JA(n,e,t=!1){if(Fr(n.app))return Promise.reject(Ys(n));const i="signIn",s=await ZA(n,i,e),o=await Xo._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(o.user),o}async function XD(n,e){return JA(Za(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eM(n){const e=Za(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function YD(n,e,t){if(Fr(n.app))return Promise.reject(Ys(n));const i=Za(n),c=await W_(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jD).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&eM(n),d}),h=await Xo._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(h.user),h}function KD(n,e,t){return Fr(n.app)?Promise.reject(Ys(n)):XD(Nn(n),Nc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&eM(n),i})}function $D(n,e,t,i){return Nn(n).onIdTokenChanged(e,t,i)}function QD(n,e,t){return Nn(n).beforeAuthStateChanged(e,t)}function ZD(n,e,t,i){return Nn(n).onAuthStateChanged(e,t,i)}function JD(n){return Nn(n).signOut()}const Zf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Zf,"1"),this.storage.removeItem(Zf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN=1e3,tN=10;class nM extends tM{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=YA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,h,d)=>{this.notifyListeners(c,d)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},o=this.storage.getItem(i);yD()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,tN):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},eN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}nM.type="LOCAL";const nN=nM;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM extends tM{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}iM.type="SESSION";const rM=iM;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new vp(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:o}=t.data,c=this.handlersMap[s];if(!c?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const h=Array.from(c).map(async p=>p(t.origin,o)),d=await iN(h);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,c;return new Promise((h,d)=>{const p=py("",20);s.port1.start();const g=setTimeout(()=>{d(new Error("unsupported_event"))},i);c={messageChannel:s,onMessage(v){const y=v;if(y.data.eventId===p)switch(y.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),h(y.data.response);break;default:clearTimeout(g),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(c),s.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(){return window}function sN(n){cs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sM(){return typeof cs().WorkerGlobalScope<"u"&&typeof cs().importScripts=="function"}async function aN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oN(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function lN(){return sM()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aM="firebaseLocalStorageDb",cN=1,Jf="firebaseLocalStorage",oM="fbase_key";class Ah{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function yp(n,e){return n.transaction([Jf],e?"readwrite":"readonly").objectStore(Jf)}function uN(){const n=indexedDB.deleteDatabase(aM);return new Ah(n).toPromise()}function X_(){const n=indexedDB.open(aM,cN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Jf,{keyPath:oM})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Jf)?e(i):(i.close(),await uN(),e(await X_()))})})}async function ux(n,e,t){const i=yp(n,!0).put({[oM]:e,value:t});return new Ah(i).toPromise()}async function hN(n,e){const t=yp(n,!1).get(e),i=await new Ah(t).toPromise();return i===void 0?null:i.value}function hx(n,e){const t=yp(n,!0).delete(e);return new Ah(t).toPromise()}const dN=800,fN=3;class lM{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await X_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>fN)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sM()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vp._getInstance(lN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await aN(),!this.activeServiceWorker)return;this.sender=new rN(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await X_();return await ux(e,Zf,"1"),await hx(e,Zf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ux(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>hN(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>hx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=yp(s,!1).getAll();return new Ah(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lM.type="LOCAL";const pN=lM;new Th(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(n,e){return e?Ws(e):(Et(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my extends hy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function mN(n){return JA(n.auth,new my(n),n.bypassAuthState)}function gN(n){const{auth:e,user:t}=n;return Et(t,e,"internal-error"),WD(t,new my(n),n.bypassAuthState)}async function _N(n){const{auth:e,user:t}=n;return Et(t,e,"internal-error"),qD(t,new my(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e,t,i,s,o=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:o,error:c,type:h}=e;if(c){this.reject(c);return}const d={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(d))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return mN;case"linkViaPopup":case"linkViaRedirect":return _N;case"reauthViaPopup":case"reauthViaRedirect":return gN;default:Rr(this.auth,"internal-error")}}resolve(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN=new Th(2e3,1e4);async function yN(n,e,t){if(Fr(n.app))return Promise.reject(zr(n,"operation-not-supported-in-this-environment"));const i=Za(n);eD(n,e,fy);const s=cM(i,t);return new zo(i,"signInViaPopup",e,s).executeNotNull()}class zo extends uM{constructor(e,t,i,s,o){super(e,t,s,o),this.provider=i,this.authWindow=null,this.pollId=null,zo.currentPopupAction&&zo.currentPopupAction.cancel(),zo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Et(e,this.auth,"internal-error"),e}async onExecution(){Zs(this.filter.length===1,"Popup operations only handle one event");const e=py();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(zr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(zr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(zr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,vN.get())};e()}}zo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN="pendingRedirect",Lf=new Map;class SN extends uM{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Lf.get(this.auth._key());if(!e){try{const i=await TN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Lf.set(this.auth._key(),e)}return this.bypassAuthState||Lf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function TN(n,e){const t=AN(e),i=bN(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function xN(n,e){Lf.set(n._key(),e)}function bN(n){return Ws(n._redirectPersistence)}function AN(n){return Uf(EN,n.config.apiKey,n.name)}async function MN(n,e,t=!1){if(Fr(n.app))return Promise.reject(Ys(n));const i=Za(n),s=cM(i,e),c=await new SN(i,s,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wN=600*1e3;class RN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!CN(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!hM(e)){const s=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(zr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wN&&this.cachedEventUids.clear(),this.cachedEventUids.has(dx(e))}saveEventToCache(e){this.cachedEventUids.add(dx(e)),this.lastProcessedEventTime=Date.now()}}function dx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function hM({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function CN(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hM(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IN(n,e={}){return Qa(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,NN=/^https?/;async function PN(n){if(n.config.emulator)return;const{authorizedDomains:e}=await IN(n);for(const t of e)try{if(UN(t))return}catch{}Rr(n,"unauthorized-domain")}function UN(n){const e=j_(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!NN.test(t))return!1;if(DN.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=new Th(3e4,6e4);function fx(){const n=cs().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ON(n){return new Promise((e,t)=>{var i,s,o;function c(){fx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fx(),t(zr(n,"network-request-failed"))},timeout:LN.get()})}if(!((s=(i=cs().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=cs().gapi)===null||o===void 0)&&o.load)c();else{const h=RD("iframefcb");return cs()[h]=()=>{gapi.load?c():t(zr(n,"network-request-failed"))},$A(`${wD()}?onload=${h}`).catch(d=>t(d))}}).catch(e=>{throw Of=null,e})}let Of=null;function VN(n){return Of=Of||ON(n),Of}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=new Th(5e3,15e3),kN="__/auth/iframe",zN="emulator/auth/iframe",BN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GN(n){const e=n.config;Et(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ly(e,zN):`https://${n.config.authDomain}/${kN}`,i={apiKey:e.apiKey,appName:n.name,v:Dc},s=HN.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Sh(i).slice(1)}`}async function jN(n){const e=await VN(n),t=cs().gapi;return Et(t,n,"internal-error"),e.open({where:document.body,url:GN(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:BN,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const c=zr(n,"network-request-failed"),h=cs().setTimeout(()=>{o(c)},FN.get());function d(){cs().clearTimeout(h),s(i)}i.ping(d).then(d,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},WN=500,XN=600,YN="_blank",KN="http://localhost";class px{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $N(n,e,t,i=WN,s=XN){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const d=Object.assign(Object.assign({},qN),{width:i.toString(),height:s.toString(),top:o,left:c}),p=Ii().toLowerCase();t&&(h=GA(p)?YN:t),BA(p)&&(e=e||KN,d.scrollbars="yes");const g=Object.entries(d).reduce((y,[E,b])=>`${y}${E}=${b},`,"");if(vD(p)&&h!=="_self")return QN(e||"",h),new px(null);const v=window.open(e||"",h,g);Et(v,n,"popup-blocked");try{v.focus()}catch{}return new px(v)}function QN(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZN="__/auth/handler",JN="emulator/auth/handler",e2=encodeURIComponent("fac");async function mx(n,e,t,i,s,o){Et(n.config.authDomain,n,"auth-domain-config-required"),Et(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Dc,eventId:s};if(e instanceof fy){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",FC(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,v]of Object.entries({}))c[g]=v}if(e instanceof bh){const g=e.getScopes().filter(v=>v!=="");g.length>0&&(c.scopes=g.join(","))}n.tenantId&&(c.tid=n.tenantId);const h=c;for(const g of Object.keys(h))h[g]===void 0&&delete h[g];const d=await n._getAppCheckToken(),p=d?`#${e2}=${encodeURIComponent(d)}`:"";return`${t2(n)}?${Sh(h).slice(1)}${p}`}function t2({config:n}){return n.emulator?ly(n,JN):`https://${n.authDomain}/${ZN}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="webStorageSupport";class n2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rM,this._completeRedirectFn=MN,this._overrideRedirectResult=xN}async _openPopup(e,t,i,s){var o;Zs((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await mx(e,t,i,j_(),s);return $N(e,c,py())}async _openRedirect(e,t,i,s){await this._originValidation(e);const o=await mx(e,t,i,j_(),s);return sN(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Zs(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await jN(e),i=new RN(e);return t.register("authEvent",s=>(Et(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Xg,{type:Xg},s=>{var o;const c=(o=s?.[0])===null||o===void 0?void 0:o[Xg];c!==void 0&&t(!!c),Rr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=PN(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return YA()||HA()||uy()}}const i2=n2;var gx="@firebase/auth",_x="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s2(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function a2(n){ds(new Gr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;Et(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const d={apiKey:c,authDomain:h,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:KA(n)},p=new bD(i,s,o,d);return PD(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ds(new Gr("auth-internal",e=>{const t=Za(e.getProvider("auth").getImmediate());return(i=>new r2(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),wr(gx,_x,s2(n)),wr(gx,_x,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2=300,l2=xA("authIdTokenMaxAge")||o2;let vx=null;const c2=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>l2)return;const s=t?.token;vx!==s&&(vx=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function u2(n=ry()){const e=il(n,"auth");if(e.isInitialized())return e.getImmediate();const t=ND(n,{popupRedirectResolver:i2,persistence:[pN,nN,rM]}),i=xA("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const c=c2(o.toString());QD(t,c,()=>c(t.currentUser)),$D(t,h=>c(h))}}const s=SA("auth");return s&&UD(t,`http://${s}`),t}function h2(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}AD({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const o=zr("internal-error");o.customData=s,t(o)},i.type="text/javascript",i.charset="UTF-8",h2().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});a2("Browser");var d2="firebase",f2="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wr(d2,f2,"app");var yx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qo,dM;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(U,N){function M(){}M.prototype=N.prototype,U.D=N.prototype,U.prototype=new M,U.prototype.constructor=U,U.C=function(w,R,O){for(var L=Array(arguments.length-2),re=2;re<arguments.length;re++)L[re-2]=arguments[re];return N.prototype[R].apply(w,L)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(U,N,M){M||(M=0);var w=Array(16);if(typeof N=="string")for(var R=0;16>R;++R)w[R]=N.charCodeAt(M++)|N.charCodeAt(M++)<<8|N.charCodeAt(M++)<<16|N.charCodeAt(M++)<<24;else for(R=0;16>R;++R)w[R]=N[M++]|N[M++]<<8|N[M++]<<16|N[M++]<<24;N=U.g[0],M=U.g[1],R=U.g[2];var O=U.g[3],L=N+(O^M&(R^O))+w[0]+3614090360&4294967295;N=M+(L<<7&4294967295|L>>>25),L=O+(R^N&(M^R))+w[1]+3905402710&4294967295,O=N+(L<<12&4294967295|L>>>20),L=R+(M^O&(N^M))+w[2]+606105819&4294967295,R=O+(L<<17&4294967295|L>>>15),L=M+(N^R&(O^N))+w[3]+3250441966&4294967295,M=R+(L<<22&4294967295|L>>>10),L=N+(O^M&(R^O))+w[4]+4118548399&4294967295,N=M+(L<<7&4294967295|L>>>25),L=O+(R^N&(M^R))+w[5]+1200080426&4294967295,O=N+(L<<12&4294967295|L>>>20),L=R+(M^O&(N^M))+w[6]+2821735955&4294967295,R=O+(L<<17&4294967295|L>>>15),L=M+(N^R&(O^N))+w[7]+4249261313&4294967295,M=R+(L<<22&4294967295|L>>>10),L=N+(O^M&(R^O))+w[8]+1770035416&4294967295,N=M+(L<<7&4294967295|L>>>25),L=O+(R^N&(M^R))+w[9]+2336552879&4294967295,O=N+(L<<12&4294967295|L>>>20),L=R+(M^O&(N^M))+w[10]+4294925233&4294967295,R=O+(L<<17&4294967295|L>>>15),L=M+(N^R&(O^N))+w[11]+2304563134&4294967295,M=R+(L<<22&4294967295|L>>>10),L=N+(O^M&(R^O))+w[12]+1804603682&4294967295,N=M+(L<<7&4294967295|L>>>25),L=O+(R^N&(M^R))+w[13]+4254626195&4294967295,O=N+(L<<12&4294967295|L>>>20),L=R+(M^O&(N^M))+w[14]+2792965006&4294967295,R=O+(L<<17&4294967295|L>>>15),L=M+(N^R&(O^N))+w[15]+1236535329&4294967295,M=R+(L<<22&4294967295|L>>>10),L=N+(R^O&(M^R))+w[1]+4129170786&4294967295,N=M+(L<<5&4294967295|L>>>27),L=O+(M^R&(N^M))+w[6]+3225465664&4294967295,O=N+(L<<9&4294967295|L>>>23),L=R+(N^M&(O^N))+w[11]+643717713&4294967295,R=O+(L<<14&4294967295|L>>>18),L=M+(O^N&(R^O))+w[0]+3921069994&4294967295,M=R+(L<<20&4294967295|L>>>12),L=N+(R^O&(M^R))+w[5]+3593408605&4294967295,N=M+(L<<5&4294967295|L>>>27),L=O+(M^R&(N^M))+w[10]+38016083&4294967295,O=N+(L<<9&4294967295|L>>>23),L=R+(N^M&(O^N))+w[15]+3634488961&4294967295,R=O+(L<<14&4294967295|L>>>18),L=M+(O^N&(R^O))+w[4]+3889429448&4294967295,M=R+(L<<20&4294967295|L>>>12),L=N+(R^O&(M^R))+w[9]+568446438&4294967295,N=M+(L<<5&4294967295|L>>>27),L=O+(M^R&(N^M))+w[14]+3275163606&4294967295,O=N+(L<<9&4294967295|L>>>23),L=R+(N^M&(O^N))+w[3]+4107603335&4294967295,R=O+(L<<14&4294967295|L>>>18),L=M+(O^N&(R^O))+w[8]+1163531501&4294967295,M=R+(L<<20&4294967295|L>>>12),L=N+(R^O&(M^R))+w[13]+2850285829&4294967295,N=M+(L<<5&4294967295|L>>>27),L=O+(M^R&(N^M))+w[2]+4243563512&4294967295,O=N+(L<<9&4294967295|L>>>23),L=R+(N^M&(O^N))+w[7]+1735328473&4294967295,R=O+(L<<14&4294967295|L>>>18),L=M+(O^N&(R^O))+w[12]+2368359562&4294967295,M=R+(L<<20&4294967295|L>>>12),L=N+(M^R^O)+w[5]+4294588738&4294967295,N=M+(L<<4&4294967295|L>>>28),L=O+(N^M^R)+w[8]+2272392833&4294967295,O=N+(L<<11&4294967295|L>>>21),L=R+(O^N^M)+w[11]+1839030562&4294967295,R=O+(L<<16&4294967295|L>>>16),L=M+(R^O^N)+w[14]+4259657740&4294967295,M=R+(L<<23&4294967295|L>>>9),L=N+(M^R^O)+w[1]+2763975236&4294967295,N=M+(L<<4&4294967295|L>>>28),L=O+(N^M^R)+w[4]+1272893353&4294967295,O=N+(L<<11&4294967295|L>>>21),L=R+(O^N^M)+w[7]+4139469664&4294967295,R=O+(L<<16&4294967295|L>>>16),L=M+(R^O^N)+w[10]+3200236656&4294967295,M=R+(L<<23&4294967295|L>>>9),L=N+(M^R^O)+w[13]+681279174&4294967295,N=M+(L<<4&4294967295|L>>>28),L=O+(N^M^R)+w[0]+3936430074&4294967295,O=N+(L<<11&4294967295|L>>>21),L=R+(O^N^M)+w[3]+3572445317&4294967295,R=O+(L<<16&4294967295|L>>>16),L=M+(R^O^N)+w[6]+76029189&4294967295,M=R+(L<<23&4294967295|L>>>9),L=N+(M^R^O)+w[9]+3654602809&4294967295,N=M+(L<<4&4294967295|L>>>28),L=O+(N^M^R)+w[12]+3873151461&4294967295,O=N+(L<<11&4294967295|L>>>21),L=R+(O^N^M)+w[15]+530742520&4294967295,R=O+(L<<16&4294967295|L>>>16),L=M+(R^O^N)+w[2]+3299628645&4294967295,M=R+(L<<23&4294967295|L>>>9),L=N+(R^(M|~O))+w[0]+4096336452&4294967295,N=M+(L<<6&4294967295|L>>>26),L=O+(M^(N|~R))+w[7]+1126891415&4294967295,O=N+(L<<10&4294967295|L>>>22),L=R+(N^(O|~M))+w[14]+2878612391&4294967295,R=O+(L<<15&4294967295|L>>>17),L=M+(O^(R|~N))+w[5]+4237533241&4294967295,M=R+(L<<21&4294967295|L>>>11),L=N+(R^(M|~O))+w[12]+1700485571&4294967295,N=M+(L<<6&4294967295|L>>>26),L=O+(M^(N|~R))+w[3]+2399980690&4294967295,O=N+(L<<10&4294967295|L>>>22),L=R+(N^(O|~M))+w[10]+4293915773&4294967295,R=O+(L<<15&4294967295|L>>>17),L=M+(O^(R|~N))+w[1]+2240044497&4294967295,M=R+(L<<21&4294967295|L>>>11),L=N+(R^(M|~O))+w[8]+1873313359&4294967295,N=M+(L<<6&4294967295|L>>>26),L=O+(M^(N|~R))+w[15]+4264355552&4294967295,O=N+(L<<10&4294967295|L>>>22),L=R+(N^(O|~M))+w[6]+2734768916&4294967295,R=O+(L<<15&4294967295|L>>>17),L=M+(O^(R|~N))+w[13]+1309151649&4294967295,M=R+(L<<21&4294967295|L>>>11),L=N+(R^(M|~O))+w[4]+4149444226&4294967295,N=M+(L<<6&4294967295|L>>>26),L=O+(M^(N|~R))+w[11]+3174756917&4294967295,O=N+(L<<10&4294967295|L>>>22),L=R+(N^(O|~M))+w[2]+718787259&4294967295,R=O+(L<<15&4294967295|L>>>17),L=M+(O^(R|~N))+w[9]+3951481745&4294967295,U.g[0]=U.g[0]+N&4294967295,U.g[1]=U.g[1]+(R+(L<<21&4294967295|L>>>11))&4294967295,U.g[2]=U.g[2]+R&4294967295,U.g[3]=U.g[3]+O&4294967295}i.prototype.u=function(U,N){N===void 0&&(N=U.length);for(var M=N-this.blockSize,w=this.B,R=this.h,O=0;O<N;){if(R==0)for(;O<=M;)s(this,U,O),O+=this.blockSize;if(typeof U=="string"){for(;O<N;)if(w[R++]=U.charCodeAt(O++),R==this.blockSize){s(this,w),R=0;break}}else for(;O<N;)if(w[R++]=U[O++],R==this.blockSize){s(this,w),R=0;break}}this.h=R,this.o+=N},i.prototype.v=function(){var U=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);U[0]=128;for(var N=1;N<U.length-8;++N)U[N]=0;var M=8*this.o;for(N=U.length-8;N<U.length;++N)U[N]=M&255,M/=256;for(this.u(U),U=Array(16),N=M=0;4>N;++N)for(var w=0;32>w;w+=8)U[M++]=this.g[N]>>>w&255;return U};function o(U,N){var M=h;return Object.prototype.hasOwnProperty.call(M,U)?M[U]:M[U]=N(U)}function c(U,N){this.h=N;for(var M=[],w=!0,R=U.length-1;0<=R;R--){var O=U[R]|0;w&&O==N||(M[R]=O,w=!1)}this.g=M}var h={};function d(U){return-128<=U&&128>U?o(U,function(N){return new c([N|0],0>N?-1:0)}):new c([U|0],0>U?-1:0)}function p(U){if(isNaN(U)||!isFinite(U))return v;if(0>U)return A(p(-U));for(var N=[],M=1,w=0;U>=M;w++)N[w]=U/M|0,M*=4294967296;return new c(N,0)}function g(U,N){if(U.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(U.charAt(0)=="-")return A(g(U.substring(1),N));if(0<=U.indexOf("-"))throw Error('number format error: interior "-" character');for(var M=p(Math.pow(N,8)),w=v,R=0;R<U.length;R+=8){var O=Math.min(8,U.length-R),L=parseInt(U.substring(R,R+O),N);8>O?(O=p(Math.pow(N,O)),w=w.j(O).add(p(L))):(w=w.j(M),w=w.add(p(L)))}return w}var v=d(0),y=d(1),E=d(16777216);n=c.prototype,n.m=function(){if(D(this))return-A(this).m();for(var U=0,N=1,M=0;M<this.g.length;M++){var w=this.i(M);U+=(0<=w?w:4294967296+w)*N,N*=4294967296}return U},n.toString=function(U){if(U=U||10,2>U||36<U)throw Error("radix out of range: "+U);if(b(this))return"0";if(D(this))return"-"+A(this).toString(U);for(var N=p(Math.pow(U,6)),M=this,w="";;){var R=V(M,N).g;M=T(M,R.j(N));var O=((0<M.g.length?M.g[0]:M.h)>>>0).toString(U);if(M=R,b(M))return O+w;for(;6>O.length;)O="0"+O;w=O+w}},n.i=function(U){return 0>U?0:U<this.g.length?this.g[U]:this.h};function b(U){if(U.h!=0)return!1;for(var N=0;N<U.g.length;N++)if(U.g[N]!=0)return!1;return!0}function D(U){return U.h==-1}n.l=function(U){return U=T(this,U),D(U)?-1:b(U)?0:1};function A(U){for(var N=U.g.length,M=[],w=0;w<N;w++)M[w]=~U.g[w];return new c(M,~U.h).add(y)}n.abs=function(){return D(this)?A(this):this},n.add=function(U){for(var N=Math.max(this.g.length,U.g.length),M=[],w=0,R=0;R<=N;R++){var O=w+(this.i(R)&65535)+(U.i(R)&65535),L=(O>>>16)+(this.i(R)>>>16)+(U.i(R)>>>16);w=L>>>16,O&=65535,L&=65535,M[R]=L<<16|O}return new c(M,M[M.length-1]&-2147483648?-1:0)};function T(U,N){return U.add(A(N))}n.j=function(U){if(b(this)||b(U))return v;if(D(this))return D(U)?A(this).j(A(U)):A(A(this).j(U));if(D(U))return A(this.j(A(U)));if(0>this.l(E)&&0>U.l(E))return p(this.m()*U.m());for(var N=this.g.length+U.g.length,M=[],w=0;w<2*N;w++)M[w]=0;for(w=0;w<this.g.length;w++)for(var R=0;R<U.g.length;R++){var O=this.i(w)>>>16,L=this.i(w)&65535,re=U.i(R)>>>16,oe=U.i(R)&65535;M[2*w+2*R]+=L*oe,P(M,2*w+2*R),M[2*w+2*R+1]+=O*oe,P(M,2*w+2*R+1),M[2*w+2*R+1]+=L*re,P(M,2*w+2*R+1),M[2*w+2*R+2]+=O*re,P(M,2*w+2*R+2)}for(w=0;w<N;w++)M[w]=M[2*w+1]<<16|M[2*w];for(w=N;w<2*N;w++)M[w]=0;return new c(M,0)};function P(U,N){for(;(U[N]&65535)!=U[N];)U[N+1]+=U[N]>>>16,U[N]&=65535,N++}function k(U,N){this.g=U,this.h=N}function V(U,N){if(b(N))throw Error("division by zero");if(b(U))return new k(v,v);if(D(U))return N=V(A(U),N),new k(A(N.g),A(N.h));if(D(N))return N=V(U,A(N)),new k(A(N.g),N.h);if(30<U.g.length){if(D(U)||D(N))throw Error("slowDivide_ only works with positive integers.");for(var M=y,w=N;0>=w.l(U);)M=j(M),w=j(w);var R=q(M,1),O=q(w,1);for(w=q(w,2),M=q(M,2);!b(w);){var L=O.add(w);0>=L.l(U)&&(R=R.add(M),O=L),w=q(w,1),M=q(M,1)}return N=T(U,R.j(N)),new k(R,N)}for(R=v;0<=U.l(N);){for(M=Math.max(1,Math.floor(U.m()/N.m())),w=Math.ceil(Math.log(M)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),O=p(M),L=O.j(N);D(L)||0<L.l(U);)M-=w,O=p(M),L=O.j(N);b(O)&&(O=y),R=R.add(O),U=T(U,L)}return new k(R,U)}n.A=function(U){return V(this,U).h},n.and=function(U){for(var N=Math.max(this.g.length,U.g.length),M=[],w=0;w<N;w++)M[w]=this.i(w)&U.i(w);return new c(M,this.h&U.h)},n.or=function(U){for(var N=Math.max(this.g.length,U.g.length),M=[],w=0;w<N;w++)M[w]=this.i(w)|U.i(w);return new c(M,this.h|U.h)},n.xor=function(U){for(var N=Math.max(this.g.length,U.g.length),M=[],w=0;w<N;w++)M[w]=this.i(w)^U.i(w);return new c(M,this.h^U.h)};function j(U){for(var N=U.g.length+1,M=[],w=0;w<N;w++)M[w]=U.i(w)<<1|U.i(w-1)>>>31;return new c(M,U.h)}function q(U,N){var M=N>>5;N%=32;for(var w=U.g.length-M,R=[],O=0;O<w;O++)R[O]=0<N?U.i(O+M)>>>N|U.i(O+M+1)<<32-N:U.i(O+M);return new c(R,U.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,dM=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=g,qo=c}).apply(typeof yx<"u"?yx:typeof self<"u"?self:typeof window<"u"?window:{});var nf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fM,Yu,pM,Vf,Y_,mM,gM,_M;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,S,C){return f==Array.prototype||f==Object.prototype||(f[S]=C.value),f};function t(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof nf=="object"&&nf];for(var S=0;S<f.length;++S){var C=f[S];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var i=t(this);function s(f,S){if(S)e:{var C=i;f=f.split(".");for(var G=0;G<f.length-1;G++){var se=f[G];if(!(se in C))break e;C=C[se]}f=f[f.length-1],G=C[f],S=S(G),S!=G&&S!=null&&e(C,f,{configurable:!0,writable:!0,value:S})}}function o(f,S){f instanceof String&&(f+="");var C=0,G=!1,se={next:function(){if(!G&&C<f.length){var _e=C++;return{value:S(_e,f[_e]),done:!1}}return G=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}s("Array.prototype.values",function(f){return f||function(){return o(this,function(S,C){return C})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},h=this||self;function d(f){var S=typeof f;return S=S!="object"?S:f?Array.isArray(f)?"array":S:"null",S=="array"||S=="object"&&typeof f.length=="number"}function p(f){var S=typeof f;return S=="object"&&f!=null||S=="function"}function g(f,S,C){return f.call.apply(f.bind,arguments)}function v(f,S,C){if(!f)throw Error();if(2<arguments.length){var G=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,G),f.apply(S,se)}}return function(){return f.apply(S,arguments)}}function y(f,S,C){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:v,y.apply(null,arguments)}function E(f,S){var C=Array.prototype.slice.call(arguments,1);return function(){var G=C.slice();return G.push.apply(G,arguments),f.apply(this,G)}}function b(f,S){function C(){}C.prototype=S.prototype,f.aa=S.prototype,f.prototype=new C,f.prototype.constructor=f,f.Qb=function(G,se,_e){for(var ke=Array(arguments.length-2),Xt=2;Xt<arguments.length;Xt++)ke[Xt-2]=arguments[Xt];return S.prototype[se].apply(G,ke)}}function D(f){const S=f.length;if(0<S){const C=Array(S);for(let G=0;G<S;G++)C[G]=f[G];return C}return[]}function A(f,S){for(let C=1;C<arguments.length;C++){const G=arguments[C];if(d(G)){const se=f.length||0,_e=G.length||0;f.length=se+_e;for(let ke=0;ke<_e;ke++)f[se+ke]=G[ke]}else f.push(G)}}class T{constructor(S,C){this.i=S,this.j=C,this.h=0,this.g=null}get(){let S;return 0<this.h?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function P(f){return/^[\s\xa0]*$/.test(f)}function k(){var f=h.navigator;return f&&(f=f.userAgent)?f:""}function V(f){return V[" "](f),f}V[" "]=function(){};var j=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function q(f,S,C){for(const G in f)S.call(C,f[G],G,f)}function U(f,S){for(const C in f)S.call(void 0,f[C],C,f)}function N(f){const S={};for(const C in f)S[C]=f[C];return S}const M="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(f,S){let C,G;for(let se=1;se<arguments.length;se++){G=arguments[se];for(C in G)f[C]=G[C];for(let _e=0;_e<M.length;_e++)C=M[_e],Object.prototype.hasOwnProperty.call(G,C)&&(f[C]=G[C])}}function R(f){var S=1;f=f.split(":");const C=[];for(;0<S&&f.length;)C.push(f.shift()),S--;return f.length&&C.push(f.join(":")),C}function O(f){h.setTimeout(()=>{throw f},0)}function L(){var f=Ae;let S=null;return f.g&&(S=f.g,f.g=f.g.next,f.g||(f.h=null),S.next=null),S}class re{constructor(){this.h=this.g=null}add(S,C){const G=oe.get();G.set(S,C),this.h?this.h.next=G:this.g=G,this.h=G}}var oe=new T(()=>new X,f=>f.reset());class X{constructor(){this.next=this.g=this.h=null}set(S,C){this.h=S,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,J=!1,Ae=new re,H=()=>{const f=h.Promise.resolve(void 0);Z=()=>{f.then(ee)}};var ee=()=>{for(var f;f=L();){try{f.h.call(f.g)}catch(C){O(C)}var S=oe;S.j(f),100>S.h&&(S.h++,f.next=S.g,S.g=f)}J=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ee(f,S){this.type=f,this.g=this.target=S,this.defaultPrevented=!1}Ee.prototype.h=function(){this.defaultPrevented=!0};var Pe=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var f=!1,S=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const C=()=>{};h.addEventListener("test",C,S),h.removeEventListener("test",C,S)}catch{}return f})();function qe(f,S){if(Ee.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var C=this.type=f.type,G=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=S,S=f.relatedTarget){if(j){e:{try{V(S.nodeName);var se=!0;break e}catch{}se=!1}se||(S=null)}}else C=="mouseover"?S=f.fromElement:C=="mouseout"&&(S=f.toElement);this.relatedTarget=S,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:le[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&qe.aa.h.call(this)}}b(qe,Ee);var le={2:"touch",3:"pen",4:"mouse"};qe.prototype.h=function(){qe.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),Oe=0;function ht(f,S,C,G,se){this.listener=f,this.proxy=null,this.src=S,this.type=C,this.capture=!!G,this.ha=se,this.key=++Oe,this.da=this.fa=!1}function tt(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function bt(f){this.src=f,this.g={},this.h=0}bt.prototype.add=function(f,S,C,G,se){var _e=f.toString();f=this.g[_e],f||(f=this.g[_e]=[],this.h++);var ke=K(f,S,G,se);return-1<ke?(S=f[ke],C||(S.fa=!1)):(S=new ht(S,this.src,_e,!!G,se),S.fa=C,f.push(S)),S};function Mn(f,S){var C=S.type;if(C in f.g){var G=f.g[C],se=Array.prototype.indexOf.call(G,S,void 0),_e;(_e=0<=se)&&Array.prototype.splice.call(G,se,1),_e&&(tt(S),f.g[C].length==0&&(delete f.g[C],f.h--))}}function K(f,S,C,G){for(var se=0;se<f.length;++se){var _e=f[se];if(!_e.da&&_e.listener==S&&_e.capture==!!C&&_e.ha==G)return se}return-1}var Zt="closure_lm_"+(1e6*Math.random()|0),vt={};function ft(f,S,C,G,se){if(Array.isArray(S)){for(var _e=0;_e<S.length;_e++)ft(f,S[_e],C,G,se);return null}return C=ce(C),f&&f[xe]?f.K(S,C,p(G)?!!G.capture:!1,se):Ke(f,S,C,!1,G,se)}function Ke(f,S,C,G,se,_e){if(!S)throw Error("Invalid event type");var ke=p(se)?!!se.capture:!!se,Xt=W(f);if(Xt||(f[Zt]=Xt=new bt(f)),C=Xt.add(S,C,G,ke,_e),C.proxy)return C;if(G=cn(),C.proxy=G,G.src=f,G.listener=C,f.addEventListener)Pe||(se=ke),se===void 0&&(se=!1),f.addEventListener(S.toString(),G,se);else if(f.attachEvent)f.attachEvent(yn(S.toString()),G);else if(f.addListener&&f.removeListener)f.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return C}function cn(){function f(C){return S.call(f.src,f.listener,C)}const S=xn;return f}function Je(f,S,C,G,se){if(Array.isArray(S))for(var _e=0;_e<S.length;_e++)Je(f,S[_e],C,G,se);else G=p(G)?!!G.capture:!!G,C=ce(C),f&&f[xe]?(f=f.i,S=String(S).toString(),S in f.g&&(_e=f.g[S],C=K(_e,C,G,se),-1<C&&(tt(_e[C]),Array.prototype.splice.call(_e,C,1),_e.length==0&&(delete f.g[S],f.h--)))):f&&(f=W(f))&&(S=f.g[S.toString()],f=-1,S&&(f=K(S,C,G,se)),(C=-1<f?S[f]:null)&&St(C))}function St(f){if(typeof f!="number"&&f&&!f.da){var S=f.src;if(S&&S[xe])Mn(S.i,f);else{var C=f.type,G=f.proxy;S.removeEventListener?S.removeEventListener(C,G,f.capture):S.detachEvent?S.detachEvent(yn(C),G):S.addListener&&S.removeListener&&S.removeListener(G),(C=W(S))?(Mn(C,f),C.h==0&&(C.src=null,S[Zt]=null)):tt(f)}}}function yn(f){return f in vt?vt[f]:vt[f]="on"+f}function xn(f,S){if(f.da)f=!0;else{S=new qe(S,this);var C=f.listener,G=f.ha||f.src;f.fa&&St(f),f=C.call(G,S)}return f}function W(f){return f=f[Zt],f instanceof bt?f:null}var F="__closure_events_fn_"+(1e9*Math.random()>>>0);function ce(f){return typeof f=="function"?f:(f[F]||(f[F]=function(S){return f.handleEvent(S)}),f[F])}function ge(){ye.call(this),this.i=new bt(this),this.M=this,this.F=null}b(ge,ye),ge.prototype[xe]=!0,ge.prototype.removeEventListener=function(f,S,C,G){Je(this,f,S,C,G)};function Se(f,S){var C,G=f.F;if(G)for(C=[];G;G=G.F)C.push(G);if(f=f.M,G=S.type||S,typeof S=="string")S=new Ee(S,f);else if(S instanceof Ee)S.target=S.target||f;else{var se=S;S=new Ee(G,f),w(S,se)}if(se=!0,C)for(var _e=C.length-1;0<=_e;_e--){var ke=S.g=C[_e];se=ve(ke,G,!0,S)&&se}if(ke=S.g=f,se=ve(ke,G,!0,S)&&se,se=ve(ke,G,!1,S)&&se,C)for(_e=0;_e<C.length;_e++)ke=S.g=C[_e],se=ve(ke,G,!1,S)&&se}ge.prototype.N=function(){if(ge.aa.N.call(this),this.i){var f=this.i,S;for(S in f.g){for(var C=f.g[S],G=0;G<C.length;G++)tt(C[G]);delete f.g[S],f.h--}}this.F=null},ge.prototype.K=function(f,S,C,G){return this.i.add(String(f),S,!1,C,G)},ge.prototype.L=function(f,S,C,G){return this.i.add(String(f),S,!0,C,G)};function ve(f,S,C,G){if(S=f.i.g[String(S)],!S)return!0;S=S.concat();for(var se=!0,_e=0;_e<S.length;++_e){var ke=S[_e];if(ke&&!ke.da&&ke.capture==C){var Xt=ke.listener,$n=ke.ha||ke.src;ke.fa&&Mn(f.i,ke),se=Xt.call($n,G)!==!1&&se}}return se&&!G.defaultPrevented}function Xe(f,S,C){if(typeof f=="function")C&&(f=y(f,C));else if(f&&typeof f.handleEvent=="function")f=y(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(S)?-1:h.setTimeout(f,S||0)}function Fe(f){f.g=Xe(()=>{f.g=null,f.i&&(f.i=!1,Fe(f))},f.l);const S=f.h;f.h=null,f.m.apply(null,S)}class st extends ye{constructor(S,C){super(),this.m=S,this.l=C,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Fe(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function et(f){ye.call(this),this.h=f,this.g={}}b(et,ye);var De=[];function je(f){q(f.g,function(S,C){this.g.hasOwnProperty(C)&&St(S)},f),f.g={}}et.prototype.N=function(){et.aa.N.call(this),je(this)},et.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ot=h.JSON.stringify,nt=h.JSON.parse,He=class{stringify(f){return h.JSON.stringify(f,void 0)}parse(f){return h.JSON.parse(f,void 0)}};function Tt(){}Tt.prototype.h=null;function Q(f){return f.h||(f.h=f.i())}function Ue(){}var Ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ye(){Ee.call(this,"d")}b(Ye,Ee);function Ie(){Ee.call(this,"c")}b(Ie,Ee);var be={},Ze=null;function pt(){return Ze=Ze||new ge}be.La="serverreachability";function Qt(f){Ee.call(this,be.La,f)}b(Qt,Ee);function Ut(f){const S=pt();Se(S,new Qt(S))}be.STAT_EVENT="statevent";function zi(f,S){Ee.call(this,be.STAT_EVENT,f),this.stat=S}b(zi,Ee);function Gt(f){const S=pt();Se(S,new zi(S,f))}be.Ma="timingevent";function Un(f,S){Ee.call(this,be.Ma,f),this.size=S}b(Un,Ee);function un(f,S){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){f()},S)}function Si(){this.g=!0}Si.prototype.xa=function(){this.g=!1};function ta(f,S,C,G,se,_e){f.info(function(){if(f.g)if(_e)for(var ke="",Xt=_e.split("&"),$n=0;$n<Xt.length;$n++){var Yt=Xt[$n].split("=");if(1<Yt.length){var ri=Yt[0];Yt=Yt[1];var Qn=ri.split("_");ke=2<=Qn.length&&Qn[1]=="type"?ke+(ri+"="+Yt+"&"):ke+(ri+"=redacted&")}}else ke=null;else ke=_e;return"XMLHTTP REQ ("+G+") [attempt "+se+"]: "+S+`
`+C+`
`+ke})}function ol(f,S,C,G,se,_e,ke){f.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+se+"]: "+S+`
`+C+`
`+_e+" "+ke})}function Ki(f,S,C,G){f.info(function(){return"XMLHTTP TEXT ("+S+"): "+lr(f,C)+(G?" "+G:"")})}function to(f,S){f.info(function(){return"TIMEOUT: "+S})}Si.prototype.info=function(){};function lr(f,S){if(!f.g)return S;if(!S)return null;try{var C=JSON.parse(S);if(C){for(f=0;f<C.length;f++)if(Array.isArray(C[f])){var G=C[f];if(!(2>G.length)){var se=G[1];if(Array.isArray(se)&&!(1>se.length)){var _e=se[0];if(_e!="noop"&&_e!="stop"&&_e!="close")for(var ke=1;ke<se.length;ke++)se[ke]=""}}}}return ot(C)}catch{return S}}var Cr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},cr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ur;function hr(){}b(hr,Tt),hr.prototype.g=function(){return new XMLHttpRequest},hr.prototype.i=function(){return{}},ur=new hr;function ui(f,S,C,G){this.j=f,this.i=S,this.l=C,this.R=G||1,this.U=new et(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Rn}function Rn(){this.i=null,this.g="",this.h=!1}var no={},na={};function B(f,S,C){f.L=1,f.v=Ir(Ft(S)),f.m=C,f.P=!0,te(f,null)}function te(f,S){f.F=Date.now(),ie(f),f.A=Ft(f.v);var C=f.A,G=f.R;Array.isArray(G)||(G=[String(G)]),Hc(C.i,"t",G),f.C=0,C=f.j.J,f.h=new Rn,f.g=Qh(f.j,C?S:null,!f.m),0<f.O&&(f.M=new st(y(f.Y,f,f.g),f.O)),S=f.U,C=f.g,G=f.ca;var se="readystatechange";Array.isArray(se)||(se&&(De[0]=se.toString()),se=De);for(var _e=0;_e<se.length;_e++){var ke=ft(C,se[_e],G||S.handleEvent,!1,S.h||S);if(!ke)break;S.g[ke.key]=ke}S=f.H?N(f.H):{},f.m?(f.u||(f.u="POST"),S["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,S)):(f.u="GET",f.g.ea(f.A,f.u,null,S)),Ut(),ta(f.i,f.u,f.A,f.l,f.R,f.m)}ui.prototype.ca=function(f){f=f.target;const S=this.M;S&&pr(f)==3?S.j():this.Y(f)},ui.prototype.Y=function(f){try{if(f==this.g)e:{const Qn=pr(this.g);var S=this.g.Ba();const Ts=this.g.Z();if(!(3>Qn)&&(Qn!=3||this.g&&(this.h.h||this.g.oa()||Gh(this.g)))){this.J||Qn!=4||S==7||(S==8||0>=Ts?Ut(3):Ut(2)),Ge(this);var C=this.g.Z();this.X=C;t:if(pe(this)){var G=Gh(this.g);f="";var se=G.length,_e=pr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ze(this),$e(this);var ke="";break t}this.h.i=new h.TextDecoder}for(S=0;S<se;S++)this.h.h=!0,f+=this.h.i.decode(G[S],{stream:!(_e&&S==se-1)});G.length=0,this.h.g+=f,this.C=0,ke=this.h.g}else ke=this.g.oa();if(this.o=C==200,ol(this.i,this.u,this.A,this.l,this.R,Qn,C),this.o){if(this.T&&!this.K){t:{if(this.g){var Xt,$n=this.g;if((Xt=$n.g?$n.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(Xt)){var Yt=Xt;break t}}Yt=null}if(C=Yt)Ki(this.i,this.l,C,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,lt(this,C);else{this.o=!1,this.s=3,Gt(12),ze(this),$e(this);break e}}if(this.P){C=!0;let di;for(;!this.J&&this.C<ke.length;)if(di=me(this,ke),di==na){Qn==4&&(this.s=4,Gt(14),C=!1),Ki(this.i,this.l,null,"[Incomplete Response]");break}else if(di==no){this.s=4,Gt(15),Ki(this.i,this.l,ke,"[Invalid Chunk]"),C=!1;break}else Ki(this.i,this.l,di,null),lt(this,di);if(pe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Qn!=4||ke.length!=0||this.h.h||(this.s=1,Gt(16),C=!1),this.o=this.o&&C,!C)Ki(this.i,this.l,ke,"[Invalid Chunked Response]"),ze(this),$e(this);else if(0<ke.length&&!this.W){this.W=!0;var ri=this.j;ri.g==this&&ri.ba&&!ri.M&&(ri.j.info("Great, no buffering proxy detected. Bytes received: "+ke.length),uo(ri),ri.M=!0,Gt(11))}}else Ki(this.i,this.l,ke,null),lt(this,ke);Qn==4&&ze(this),this.o&&!this.J&&(Qn==4?Yh(this.j,this):(this.o=!1,ie(this)))}else Gp(this.g),C==400&&0<ke.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),ze(this),$e(this)}}}catch{}finally{}};function pe(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function me(f,S){var C=f.C,G=S.indexOf(`
`,C);return G==-1?na:(C=Number(S.substring(C,G)),isNaN(C)?no:(G+=1,G+C>S.length?na:(S=S.slice(G,G+C),f.C=G+C,S)))}ui.prototype.cancel=function(){this.J=!0,ze(this)};function ie(f){f.S=Date.now()+f.I,Ne(f,f.I)}function Ne(f,S){if(f.B!=null)throw Error("WatchDog timer not null");f.B=un(y(f.ba,f),S)}function Ge(f){f.B&&(h.clearTimeout(f.B),f.B=null)}ui.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(to(this.i,this.A),this.L!=2&&(Ut(),Gt(17)),ze(this),this.s=2,$e(this)):Ne(this,this.S-f)};function $e(f){f.j.G==0||f.J||Yh(f.j,f)}function ze(f){Ge(f);var S=f.M;S&&typeof S.ma=="function"&&S.ma(),f.M=null,je(f.U),f.g&&(S=f.g,f.g=null,S.abort(),S.ma())}function lt(f,S){try{var C=f.j;if(C.G!=0&&(C.g==f||hn(C.h,f))){if(!f.K&&hn(C.h,f)&&C.G==3){try{var G=C.Da.g.parse(S)}catch{G=null}if(Array.isArray(G)&&G.length==3){var se=G;if(se[0]==0){e:if(!C.u){if(C.g)if(C.g.F+3e3<f.F)ml(C),fl(C);else break e;Xc(C),Gt(18)}}else C.za=se[1],0<C.za-C.T&&37500>se[2]&&C.F&&C.v==0&&!C.C&&(C.C=un(y(C.Za,C),6e3));if(1>=jt(C.h)&&C.ca){try{C.ca()}catch{}C.ca=void 0}}else Ss(C,11)}else if((f.K||C.g==f)&&ml(C),!P(S))for(se=C.Da.g.parse(S),S=0;S<se.length;S++){let Yt=se[S];if(C.T=Yt[0],Yt=Yt[1],C.G==2)if(Yt[0]=="c"){C.K=Yt[1],C.ia=Yt[2];const ri=Yt[3];ri!=null&&(C.la=ri,C.j.info("VER="+C.la));const Qn=Yt[4];Qn!=null&&(C.Aa=Qn,C.j.info("SVER="+C.Aa));const Ts=Yt[5];Ts!=null&&typeof Ts=="number"&&0<Ts&&(G=1.5*Ts,C.L=G,C.j.info("backChannelRequestTimeoutMs_="+G)),G=C;const di=f.g;if(di){const Jr=di.g?di.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jr){var _e=G.h;_e.g||Jr.indexOf("spdy")==-1&&Jr.indexOf("quic")==-1&&Jr.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(Jt(_e,_e.h),_e.h=null))}if(G.D){const Kc=di.g?di.g.getResponseHeader("X-HTTP-Session-Id"):null;Kc&&(G.ya=Kc,Ct(G.I,G.D,Kc))}}C.G=3,C.l&&C.l.ua(),C.ba&&(C.R=Date.now()-f.F,C.j.info("Handshake RTT: "+C.R+"ms")),G=C;var ke=f;if(G.qa=$h(G,G.J?G.ia:null,G.W),ke.K){Rt(G.h,ke);var Xt=ke,$n=G.L;$n&&(Xt.I=$n),Xt.B&&(Ge(Xt),ie(Xt)),G.g=ke}else Wh(G);0<C.i.length&&pl(C)}else Yt[0]!="stop"&&Yt[0]!="close"||Ss(C,7);else C.G==3&&(Yt[0]=="stop"||Yt[0]=="close"?Yt[0]=="stop"?Ss(C,7):qc(C):Yt[0]!="noop"&&C.l&&C.l.ta(Yt),C.v=0)}}Ut(4)}catch{}}var mt=class{constructor(f,S){this.g=f,this.map=S}};function rt(f){this.l=f||10,h.PerformanceNavigationTiming?(f=h.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function wt(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function jt(f){return f.h?1:f.g?f.g.size:0}function hn(f,S){return f.h?f.h==S:f.g?f.g.has(S):!1}function Jt(f,S){f.g?f.g.add(S):f.h=S}function Rt(f,S){f.h&&f.h==S?f.h=null:f.g&&f.g.has(S)&&f.g.delete(S)}rt.prototype.cancel=function(){if(this.i=ct(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function ct(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let S=f.i;for(const C of f.g.values())S=S.concat(C.D);return S}return D(f.i)}function _n(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(d(f)){for(var S=[],C=f.length,G=0;G<C;G++)S.push(f[G]);return S}S=[],C=0;for(G in f)S[C++]=f[G];return S}function Lt(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(d(f)||typeof f=="string"){var S=[];f=f.length;for(var C=0;C<f;C++)S.push(C);return S}S=[],C=0;for(const G in f)S[C++]=G;return S}}}function Kn(f,S){if(f.forEach&&typeof f.forEach=="function")f.forEach(S,void 0);else if(d(f)||typeof f=="string")Array.prototype.forEach.call(f,S,void 0);else for(var C=Lt(f),G=_n(f),se=G.length,_e=0;_e<se;_e++)S.call(void 0,G[_e],C&&C[_e],f)}var Bi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hi(f,S){if(f){f=f.split("&");for(var C=0;C<f.length;C++){var G=f[C].indexOf("="),se=null;if(0<=G){var _e=f[C].substring(0,G);se=f[C].substring(G+1)}else _e=f[C];S(_e,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function En(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof En){this.h=f.h,Hn(this,f.j),this.o=f.o,this.g=f.g,Fn(this,f.s),this.l=f.l;var S=f.i,C=new _s;C.i=S.i,S.g&&(C.g=new Map(S.g),C.h=S.h),bn(this,C),this.m=f.m}else f&&(S=String(f).match(Bi))?(this.h=!1,Hn(this,S[1]||"",!0),this.o=Gn(S[2]||""),this.g=Gn(S[3]||"",!0),Fn(this,S[4]),this.l=Gn(S[5]||"",!0),bn(this,S[6]||"",!0),this.m=Gn(S[7]||"")):(this.h=!1,this.i=new _s(null,this.h))}En.prototype.toString=function(){var f=[],S=this.j;S&&f.push(io(S,zc,!0),":");var C=this.g;return(C||S=="file")&&(f.push("//"),(S=this.o)&&f.push(io(S,zc,!0),"@"),f.push(encodeURIComponent(String(C)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.s,C!=null&&f.push(":",String(C))),(C=this.l)&&(this.g&&C.charAt(0)!="/"&&f.push("/"),f.push(io(C,C.charAt(0)=="/"?Bp:Bc,!0))),(C=this.i.toString())&&f.push("?",C),(C=this.m)&&f.push("#",io(C,ll)),f.join("")};function Ft(f){return new En(f)}function Hn(f,S,C){f.j=C?Gn(S,!0):S,f.j&&(f.j=f.j.replace(/:$/,""))}function Fn(f,S){if(S){if(S=Number(S),isNaN(S)||0>S)throw Error("Bad port number "+S);f.s=S}else f.s=null}function bn(f,S,C){S instanceof _s?(f.i=S,Bh(f.i,f.h)):(C||(S=io(S,Hp)),f.i=new _s(S,f.h))}function Ct(f,S,C){f.i.set(S,C)}function Ir(f){return Ct(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Gn(f,S){return f?S?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function io(f,S,C){return typeof f=="string"?(f=encodeURI(f).replace(S,zh),C&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function zh(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var zc=/[#\/\?@]/g,Bc=/[#\?:]/g,Bp=/[#\?]/g,Hp=/[#\?@]/g,ll=/#/g;function _s(f,S){this.h=this.g=null,this.i=f||null,this.j=!!S}function dr(f){f.g||(f.g=new Map,f.h=0,f.i&&hi(f.i,function(S,C){f.add(decodeURIComponent(S.replace(/\+/g," ")),C)}))}n=_s.prototype,n.add=function(f,S){dr(this),this.i=null,f=Xr(this,f);var C=this.g.get(f);return C||this.g.set(f,C=[]),C.push(S),this.h+=1,this};function vs(f,S){dr(f),S=Xr(f,S),f.g.has(S)&&(f.i=null,f.h-=f.g.get(S).length,f.g.delete(S))}function ys(f,S){return dr(f),S=Xr(f,S),f.g.has(S)}n.forEach=function(f,S){dr(this),this.g.forEach(function(C,G){C.forEach(function(se){f.call(S,se,G,this)},this)},this)},n.na=function(){dr(this);const f=Array.from(this.g.values()),S=Array.from(this.g.keys()),C=[];for(let G=0;G<S.length;G++){const se=f[G];for(let _e=0;_e<se.length;_e++)C.push(S[G])}return C},n.V=function(f){dr(this);let S=[];if(typeof f=="string")ys(this,f)&&(S=S.concat(this.g.get(Xr(this,f))));else{f=Array.from(this.g.values());for(let C=0;C<f.length;C++)S=S.concat(f[C])}return S},n.set=function(f,S){return dr(this),this.i=null,f=Xr(this,f),ys(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[S]),this.h+=1,this},n.get=function(f,S){return f?(f=this.V(f),0<f.length?String(f[0]):S):S};function Hc(f,S,C){vs(f,S),0<C.length&&(f.i=null,f.g.set(Xr(f,S),D(C)),f.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],S=Array.from(this.g.keys());for(var C=0;C<S.length;C++){var G=S[C];const _e=encodeURIComponent(String(G)),ke=this.V(G);for(G=0;G<ke.length;G++){var se=_e;ke[G]!==""&&(se+="="+encodeURIComponent(String(ke[G]))),f.push(se)}}return this.i=f.join("&")};function Xr(f,S){return S=String(S),f.j&&(S=S.toLowerCase()),S}function Bh(f,S){S&&!f.j&&(dr(f),f.i=null,f.g.forEach(function(C,G){var se=G.toLowerCase();G!=se&&(vs(this,G),Hc(this,se,C))},f)),f.j=S}function ro(f,S){const C=new Si;if(h.Image){const G=new Image;G.onload=E(fr,C,"TestLoadImage: loaded",!0,S,G),G.onerror=E(fr,C,"TestLoadImage: error",!1,S,G),G.onabort=E(fr,C,"TestLoadImage: abort",!1,S,G),G.ontimeout=E(fr,C,"TestLoadImage: timeout",!1,S,G),h.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=f}else S(!1)}function Dr(f,S){const C=new Si,G=new AbortController,se=setTimeout(()=>{G.abort(),fr(C,"TestPingServer: timeout",!1,S)},1e4);fetch(f,{signal:G.signal}).then(_e=>{clearTimeout(se),_e.ok?fr(C,"TestPingServer: ok",!0,S):fr(C,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(se),fr(C,"TestPingServer: error",!1,S)})}function fr(f,S,C,G,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),G(C)}catch{}}function so(){this.g=new He}function Yr(f,S,C){const G=C||"";try{Kn(f,function(se,_e){let ke=se;p(se)&&(ke=ot(se)),S.push(G+_e+"="+encodeURIComponent(ke))})}catch(se){throw S.push(G+"type="+encodeURIComponent("_badmap")),se}}function ia(f){this.l=f.Ub||null,this.j=f.eb||!1}b(ia,Tt),ia.prototype.g=function(){return new Es(this.l,this.j)},ia.prototype.i=(function(f){return function(){return f}})({});function Es(f,S){ge.call(this),this.D=f,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(Es,ge),n=Es.prototype,n.open=function(f,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=S,this.readyState=1,$r(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const S={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(S.body=f),(this.D||h).fetch(new Request(this.A,S)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,$r(this)),this.g&&(this.readyState=3,$r(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Gc(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Gc(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var S=f.value?f.value:new Uint8Array(0);(S=this.v.decode(S,{stream:!f.done}))&&(this.response=this.responseText+=S)}f.done?Kr(this):$r(this),this.readyState==3&&Gc(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,Kr(this))},n.Qa=function(f){this.g&&(this.response=f,Kr(this))},n.ga=function(){this.g&&Kr(this)};function Kr(f){f.readyState=4,f.l=null,f.j=null,f.v=null,$r(f)}n.setRequestHeader=function(f,S){this.u.append(f,S)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],S=this.h.entries();for(var C=S.next();!C.done;)C=C.value,f.push(C[0]+": "+C[1]),C=S.next();return f.join(`\r
`)};function $r(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Es.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function jc(f){let S="";return q(f,function(C,G){S+=G,S+=":",S+=C,S+=`\r
`}),S}function ii(f,S,C){e:{for(G in C){var G=!1;break e}G=!0}G||(C=jc(C),typeof f=="string"?C!=null&&encodeURIComponent(String(C)):Ct(f,S,C))}function sn(f){ge.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(sn,ge);var cl=/^https?$/i,ao=["POST","PUT"];n=sn.prototype,n.Ha=function(f){this.J=f},n.ea=function(f,S,C,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);S=S?S.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ur.g(),this.v=this.o?Q(this.o):Q(ur),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(S,String(f),!0),this.B=!1}catch(_e){Hh(this,_e);return}if(f=C||"",C=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var se in G)C.set(se,G[se]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const _e of G.keys())C.set(_e,G.get(_e));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(C.keys()).find(_e=>_e.toLowerCase()=="content-type"),se=h.FormData&&f instanceof h.FormData,!(0<=Array.prototype.indexOf.call(ao,S,void 0))||G||se||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,ke]of C)this.g.setRequestHeader(_e,ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{oo(this),this.u=!0,this.g.send(f),this.u=!1}catch(_e){Hh(this,_e)}};function Hh(f,S){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=S,f.m=5,ul(f),Qr(f)}function ul(f){f.A||(f.A=!0,Se(f,"complete"),Se(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Se(this,"complete"),Se(this,"abort"),Qr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qr(this,!0)),sn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?hl(this):this.bb())},n.bb=function(){hl(this)};function hl(f){if(f.h&&typeof c<"u"&&(!f.v[1]||pr(f)!=4||f.Z()!=2)){if(f.u&&pr(f)==4)Xe(f.Ea,0,f);else if(Se(f,"readystatechange"),pr(f)==4){f.h=!1;try{const ke=f.Z();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var C;if(!(C=S)){var G;if(G=ke===0){var se=String(f.D).match(Bi)[1]||null;!se&&h.self&&h.self.location&&(se=h.self.location.protocol.slice(0,-1)),G=!cl.test(se?se.toLowerCase():"")}C=G}if(C)Se(f,"complete"),Se(f,"success");else{f.m=6;try{var _e=2<pr(f)?f.g.statusText:""}catch{_e=""}f.l=_e+" ["+f.Z()+"]",ul(f)}}finally{Qr(f)}}}}function Qr(f,S){if(f.g){oo(f);const C=f.g,G=f.v[0]?()=>{}:null;f.g=null,f.v=null,S||Se(f,"ready");try{C.onreadystatechange=G}catch{}}}function oo(f){f.I&&(h.clearTimeout(f.I),f.I=null)}n.isActive=function(){return!!this.g};function pr(f){return f.g?f.g.readyState:0}n.Z=function(){try{return 2<pr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var S=this.g.responseText;return f&&S.indexOf(f)==0&&(S=S.substring(f.length)),nt(S)}};function Gh(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Gp(f){const S={};f=(f.g&&2<=pr(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<f.length;G++){if(P(f[G]))continue;var C=R(f[G]);const se=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const _e=S[se]||[];S[se]=_e,_e.push(C)}U(S,function(G){return G.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function lo(f,S,C){return C&&C.internalChannelParams&&C.internalChannelParams[f]||S}function dl(f){this.Aa=0,this.i=[],this.j=new Si,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=lo("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=lo("baseRetryDelayMs",5e3,f),this.cb=lo("retryDelaySeedMs",1e4,f),this.Wa=lo("forwardChannelMaxRetries",2,f),this.wa=lo("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new rt(f&&f.concurrentRequestLimit),this.Da=new so,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=dl.prototype,n.la=8,n.G=1,n.connect=function(f,S,C,G){Gt(0),this.W=f,this.H=S||{},C&&G!==void 0&&(this.H.OSID=C,this.H.OAID=G),this.F=this.X,this.I=$h(this,null,this.W),pl(this)};function qc(f){if(jh(f),f.G==3){var S=f.U++,C=Ft(f.I);if(Ct(C,"SID",f.K),Ct(C,"RID",S),Ct(C,"TYPE","terminate"),co(f,C),S=new ui(f,f.j,S),S.L=2,S.v=Ir(Ft(C)),C=!1,h.navigator&&h.navigator.sendBeacon)try{C=h.navigator.sendBeacon(S.v.toString(),"")}catch{}!C&&h.Image&&(new Image().src=S.v,C=!0),C||(S.g=Qh(S.j,null),S.g.ea(S.v)),S.F=Date.now(),ie(S)}Kh(f)}function fl(f){f.g&&(uo(f),f.g.cancel(),f.g=null)}function jh(f){fl(f),f.u&&(h.clearTimeout(f.u),f.u=null),ml(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&h.clearTimeout(f.s),f.s=null)}function pl(f){if(!wt(f.h)&&!f.s){f.s=!0;var S=f.Ga;Z||H(),J||(Z(),J=!0),Ae.add(S,f),f.B=0}}function jp(f,S){return jt(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=S.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=un(y(f.Ga,f,S),Yc(f,f.B)),f.B++,!0)}n.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const se=new ui(this,this.j,f);let _e=this.o;if(this.S&&(_e?(_e=N(_e),w(_e,this.S)):_e=this.S),this.m!==null||this.O||(se.H=_e,_e=null),this.P)e:{for(var S=0,C=0;C<this.i.length;C++){t:{var G=this.i[C];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(S+=G,4096<S){S=C;break e}if(S===4096||C===this.i.length-1){S=C+1;break e}}S=1e3}else S=1e3;S=qh(this,se,S),C=Ft(this.I),Ct(C,"RID",f),Ct(C,"CVER",22),this.D&&Ct(C,"X-HTTP-Session-Id",this.D),co(this,C),_e&&(this.O?S="headers="+encodeURIComponent(String(jc(_e)))+"&"+S:this.m&&ii(C,this.m,_e)),Jt(this.h,se),this.Ua&&Ct(C,"TYPE","init"),this.P?(Ct(C,"$req",S),Ct(C,"SID","null"),se.T=!0,B(se,C,null)):B(se,C,S),this.G=2}}else this.G==3&&(f?Wc(this,f):this.i.length==0||wt(this.h)||Wc(this))};function Wc(f,S){var C;S?C=S.l:C=f.U++;const G=Ft(f.I);Ct(G,"SID",f.K),Ct(G,"RID",C),Ct(G,"AID",f.T),co(f,G),f.m&&f.o&&ii(G,f.m,f.o),C=new ui(f,f.j,C,f.B+1),f.m===null&&(C.H=f.o),S&&(f.i=S.D.concat(f.i)),S=qh(f,C,1e3),C.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Jt(f.h,C),B(C,G,S)}function co(f,S){f.H&&q(f.H,function(C,G){Ct(S,G,C)}),f.l&&Kn({},function(C,G){Ct(S,G,C)})}function qh(f,S,C){C=Math.min(f.i.length,C);var G=f.l?y(f.l.Na,f.l,f):null;e:{var se=f.i;let _e=-1;for(;;){const ke=["count="+C];_e==-1?0<C?(_e=se[0].g,ke.push("ofs="+_e)):_e=0:ke.push("ofs="+_e);let Xt=!0;for(let $n=0;$n<C;$n++){let Yt=se[$n].g;const ri=se[$n].map;if(Yt-=_e,0>Yt)_e=Math.max(0,se[$n].g-100),Xt=!1;else try{Yr(ri,ke,"req"+Yt+"_")}catch{G&&G(ri)}}if(Xt){G=ke.join("&");break e}}}return f=f.i.splice(0,C),S.D=f,G}function Wh(f){if(!f.g&&!f.u){f.Y=1;var S=f.Fa;Z||H(),J||(Z(),J=!0),Ae.add(S,f),f.v=0}}function Xc(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=un(y(f.Fa,f),Yc(f,f.v)),f.v++,!0)}n.Fa=function(){if(this.u=null,Xh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=un(y(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gt(10),fl(this),Xh(this))};function uo(f){f.A!=null&&(h.clearTimeout(f.A),f.A=null)}function Xh(f){f.g=new ui(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var S=Ft(f.qa);Ct(S,"RID","rpc"),Ct(S,"SID",f.K),Ct(S,"AID",f.T),Ct(S,"CI",f.F?"0":"1"),!f.F&&f.ja&&Ct(S,"TO",f.ja),Ct(S,"TYPE","xmlhttp"),co(f,S),f.m&&f.o&&ii(S,f.m,f.o),f.L&&(f.g.I=f.L);var C=f.g;f=f.ia,C.L=1,C.v=Ir(Ft(S)),C.m=null,C.P=!0,te(C,f)}n.Za=function(){this.C!=null&&(this.C=null,fl(this),Xc(this),Gt(19))};function ml(f){f.C!=null&&(h.clearTimeout(f.C),f.C=null)}function Yh(f,S){var C=null;if(f.g==S){ml(f),uo(f),f.g=null;var G=2}else if(hn(f.h,S))C=S.D,Rt(f.h,S),G=1;else return;if(f.G!=0){if(S.o)if(G==1){C=S.m?S.m.length:0,S=Date.now()-S.F;var se=f.B;G=pt(),Se(G,new Un(G,C)),pl(f)}else Wh(f);else if(se=S.s,se==3||se==0&&0<S.X||!(G==1&&jp(f,S)||G==2&&Xc(f)))switch(C&&0<C.length&&(S=f.h,S.i=S.i.concat(C)),se){case 1:Ss(f,5);break;case 4:Ss(f,10);break;case 3:Ss(f,6);break;default:Ss(f,2)}}}function Yc(f,S){let C=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(C*=2),C*S}function Ss(f,S){if(f.j.info("Error code "+S),S==2){var C=y(f.fb,f),G=f.Xa;const se=!G;G=new En(G||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Hn(G,"https"),Ir(G),se?ro(G.toString(),C):Dr(G.toString(),C)}else Gt(2);f.G=0,f.l&&f.l.sa(S),Kh(f),jh(f)}n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function Kh(f){if(f.G=0,f.ka=[],f.l){const S=ct(f.h);(S.length!=0||f.i.length!=0)&&(A(f.ka,S),A(f.ka,f.i),f.h.i.length=0,D(f.i),f.i.length=0),f.l.ra()}}function $h(f,S,C){var G=C instanceof En?Ft(C):new En(C);if(G.g!="")S&&(G.g=S+"."+G.g),Fn(G,G.s);else{var se=h.location;G=se.protocol,S=S?S+"."+se.hostname:se.hostname,se=+se.port;var _e=new En(null);G&&Hn(_e,G),S&&(_e.g=S),se&&Fn(_e,se),C&&(_e.l=C),G=_e}return C=f.D,S=f.ya,C&&S&&Ct(G,C,S),Ct(G,"VER",f.la),co(f,G),G}function Qh(f,S,C){if(S&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return S=f.Ca&&!f.pa?new sn(new ia({eb:C})):new sn(f.pa),S.Ha(f.J),S}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zh(){}n=Zh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function gl(){}gl.prototype.g=function(f,S){return new Di(f,S)};function Di(f,S){ge.call(this),this.g=new dl(S),this.l=f,this.h=S&&S.messageUrlParams||null,f=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(f?f["X-WebChannel-Content-Type"]=S.messageContentType:f={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.va&&(f?f["X-WebChannel-Client-Profile"]=S.va:f={"X-WebChannel-Client-Profile":S.va}),this.g.S=f,(f=S&&S.Sb)&&!P(f)&&(this.g.m=f),this.v=S&&S.supportsCrossDomainXhr||!1,this.u=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!P(S)&&(this.g.D=S,f=this.h,f!==null&&S in f&&(f=this.h,S in f&&delete f[S])),this.j=new Zr(this)}b(Di,ge),Di.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Di.prototype.close=function(){qc(this.g)},Di.prototype.o=function(f){var S=this.g;if(typeof f=="string"){var C={};C.__data__=f,f=C}else this.u&&(C={},C.__data__=ot(f),f=C);S.i.push(new mt(S.Ya++,f)),S.G==3&&pl(S)},Di.prototype.N=function(){this.g.l=null,delete this.j,qc(this.g),delete this.g,Di.aa.N.call(this)};function Jh(f){Ye.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var S=f.__sm__;if(S){e:{for(const C in S){f=C;break e}f=void 0}(this.i=f)&&(f=this.i,S=S!==null&&f in S?S[f]:void 0),this.data=S}else this.data=f}b(Jh,Ye);function ed(){Ie.call(this),this.status=1}b(ed,Ie);function Zr(f){this.g=f}b(Zr,Zh),Zr.prototype.ua=function(){Se(this.g,"a")},Zr.prototype.ta=function(f){Se(this.g,new Jh(f))},Zr.prototype.sa=function(f){Se(this.g,new ed)},Zr.prototype.ra=function(){Se(this.g,"b")},gl.prototype.createWebChannel=gl.prototype.g,Di.prototype.send=Di.prototype.o,Di.prototype.open=Di.prototype.m,Di.prototype.close=Di.prototype.close,_M=function(){return new gl},gM=function(){return pt()},mM=be,Y_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Cr.NO_ERROR=0,Cr.TIMEOUT=8,Cr.HTTP_ERROR=6,Vf=Cr,cr.COMPLETE="complete",pM=cr,Ue.EventType=Ve,Ve.OPEN="a",Ve.CLOSE="b",Ve.ERROR="c",Ve.MESSAGE="d",ge.prototype.listen=ge.prototype.K,Yu=Ue,sn.prototype.listenOnce=sn.prototype.L,sn.prototype.getLastError=sn.prototype.Ka,sn.prototype.getLastErrorCode=sn.prototype.Ba,sn.prototype.getStatus=sn.prototype.Z,sn.prototype.getResponseJson=sn.prototype.Oa,sn.prototype.getResponseText=sn.prototype.oa,sn.prototype.send=sn.prototype.ea,sn.prototype.setWithCredentials=sn.prototype.Ha,fM=sn}).apply(typeof nf<"u"?nf:typeof self<"u"?self:typeof window<"u"?window:{});const Ex="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wi.UNAUTHENTICATED=new wi(null),wi.GOOGLE_CREDENTIALS=new wi("google-credentials-uid"),wi.FIRST_PARTY=new wi("first-party-uid"),wi.MOCK_USER=new wi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=new gp("@firebase/firestore");function Vu(){return Yo.logLevel}function at(n,...e){if(Yo.logLevel<=qt.DEBUG){const t=e.map(gy);Yo.debug(`Firestore (${Pc}): ${n}`,...t)}}function Js(n,...e){if(Yo.logLevel<=qt.ERROR){const t=e.map(gy);Yo.error(`Firestore (${Pc}): ${n}`,...t)}}function yc(n,...e){if(Yo.logLevel<=qt.WARN){const t=e.map(gy);Yo.warn(`Firestore (${Pc}): ${n}`,...t)}}function gy(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(n="Unexpected state"){const e=`FIRESTORE (${Pc}) INTERNAL ASSERTION FAILED: `+n;throw Js(e),new Error(e)}function ln(n,e){n||xt()}function Mt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Qe extends Wr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class p2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(wi.UNAUTHENTICATED)))}shutdown(){}}class m2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class g2{constructor(e){this.t=e,this.currentUser=wi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ln(this.o===void 0);let i=this.i;const s=d=>this.i!==i?(i=this.i,t(d)):Promise.resolve();let o=new Ks;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ks,e.enqueueRetryable((()=>s(this.currentUser)))};const c=()=>{const d=o;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},h=d=>{at("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((d=>h(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?h(d):(at("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ks)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(at("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ln(typeof i.accessToken=="string"),new vM(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ln(e===null||typeof e=="string"),new wi(e)}}class _2{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=wi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class v2{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new _2(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(wi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class y2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class E2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ln(this.o===void 0);const i=o=>{o.error!=null&&at("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.R;return this.R=o.token,at("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const s=o=>{at("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?s(o):at("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ln(typeof t.token=="string"),this.R=t.token,new y2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S2(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const s=S2(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%e.length))}return i}}function nn(n,e){return n<e?-1:n>e?1:0}function Ec(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Qe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Qe(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Qe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Qe(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ei.fromMillis(Date.now())}static fromDate(e){return ei.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new ei(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?nn(this.nanoseconds,e.nanoseconds):nn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.timestamp=e}static fromTimestamp(e){return new At(e)}static min(){return new At(new ei(0,0))}static max(){return new At(new ei(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,t,i){t===void 0?t=0:t>e.length&&xt(),i===void 0?i=e.length-t:i>e.length-t&&xt(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ch.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ch?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=e.get(s),c=t.get(s);if(o<c)return-1;if(o>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class An extends ch{construct(e,t,i){return new An(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Qe(we.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new An(t)}static emptyPath(){return new An([])}}const T2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _i extends ch{construct(e,t,i){return new _i(e,t,i)}static isValidIdentifier(e){return T2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_i.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _i(["__name__"])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new Qe(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new Qe(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Qe(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=d,s+=2}else h==="`"?(c=!c,s++):h!=="."||c?(i+=h,s++):(o(),s++)}if(o(),c)throw new Qe(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _i(t)}static emptyPath(){return new _i([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.path=e}static fromPath(e){return new dt(An.fromString(e))}static fromName(e){return new dt(An.fromString(e).popFirst(5))}static empty(){return new dt(An.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&An.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return An.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dt(new An(e.slice()))}}function x2(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=At.fromTimestamp(i===1e9?new ei(t+1,0):new ei(t,i));return new qa(s,dt.empty(),e)}function b2(n){return new qa(n.readTime,n.key,-1)}class qa{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new qa(At.min(),dt.empty(),-1)}static max(){return new qa(At.max(),dt.empty(),-1)}}function A2(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=dt.comparator(n.documentKey,e.documentKey),t!==0?t:nn(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class w2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mh(n){if(n.code!==we.FAILED_PRECONDITION||n.message!==M2)throw n;at("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ce(((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ce?t:Ce.resolve(t)}catch(t){return Ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ce.reject(t)}static resolve(e){return new Ce(((t,i)=>{t(e)}))}static reject(e){return new Ce(((t,i)=>{i(e)}))}static waitFor(e){return new Ce(((t,i)=>{let s=0,o=0,c=!1;e.forEach((h=>{++s,h.next((()=>{++o,c&&o===s&&t()}),(d=>i(d)))})),c=!0,o===s&&t()}))}static or(e){let t=Ce.resolve(!1);for(const i of e)t=t.next((s=>s?Ce.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,o)=>{i.push(t.call(this,s,o))})),this.waitFor(i)}static mapArray(e,t){return new Ce(((i,s)=>{const o=e.length,c=new Array(o);let h=0;for(let d=0;d<o;d++){const p=d;t(e[p]).next((g=>{c[p]=g,++h,h===o&&i(c)}),(g=>s(g)))}}))}static doWhile(e,t){return new Ce(((i,s)=>{const o=()=>{e()===!0?t().next((()=>{o()}),s):i()};o()}))}}function R2(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function wh(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ie(i),this.se=i=>t.writeSequenceNumber(i))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}_y.oe=-1;function Ep(n){return n==null}function ep(n){return n===0&&1/n==-1/0}function C2(n){return typeof n=="number"&&Number.isInteger(n)&&!ep(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function rl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function EM(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,t){this.comparator=e,this.root=t||gi.EMPTY}insert(e,t){return new Pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,gi.BLACK,null,null))}remove(e){return new Pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rf(this.root,e,this.comparator,!1)}getReverseIterator(){return new rf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rf(this.root,e,this.comparator,!0)}}class rf{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gi{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??gi.RED,this.left=s??gi.EMPTY,this.right=o??gi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new gi(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return gi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return gi.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw xt();const e=this.left.check();if(e!==this.right.check())throw xt();return e+(this.isRed()?0:1)}}gi.EMPTY=null,gi.RED=!0,gi.BLACK=!1;gi.EMPTY=new class{constructor(){this.size=0}get key(){throw xt()}get value(){throw xt()}get color(){throw xt()}get left(){throw xt()}get right(){throw xt()}copy(e,t,i,s,o){return this}insert(e,t,i){return new gi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.comparator=e,this.data=new Pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Tx(this.data.getIterator())}getIteratorFrom(e){return new Tx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof vi)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new vi(this.comparator);return t.data=e,t}}class Tx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.fields=e,e.sort(_i.comparator)}static empty(){return new sr([])}unionWith(e){let t=new vi(_i.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new sr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ec(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new SM("Invalid base64 string: "+o):o}})(e);return new Ei(t)}static fromUint8Array(e){const t=(function(s){let o="";for(let c=0;c<s.length;++c)o+=String.fromCharCode(s[c]);return o})(e);return new Ei(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ei.EMPTY_BYTE_STRING=new Ei("");const I2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wa(n){if(ln(!!n),typeof n=="string"){let e=0;const t=I2.exec(n);if(ln(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Bn(n.seconds),nanos:Bn(n.nanos)}}function Bn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ko(n){return typeof n=="string"?Ei.fromBase64String(n):Ei.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function yy(n){const e=n.mapValue.fields.__previous_value__;return vy(e)?yy(e):e}function uh(n){const e=Wa(n.mapValue.fields.__local_write_time__.timestampValue);return new ei(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e,t,i,s,o,c,h,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=d,this.useFetchStreams=p}}class hh{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new hh("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf={mapValue:{}};function $o(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?vy(n)?4:P2(n)?9007199254740991:N2(n)?10:11:xt()}function fs(n,e){if(n===e)return!0;const t=$o(n);if(t!==$o(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return uh(n).isEqual(uh(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const c=Wa(s.timestampValue),h=Wa(o.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,o){return Ko(s.bytesValue).isEqual(Ko(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,o){return Bn(s.geoPointValue.latitude)===Bn(o.geoPointValue.latitude)&&Bn(s.geoPointValue.longitude)===Bn(o.geoPointValue.longitude)})(n,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return Bn(s.integerValue)===Bn(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const c=Bn(s.doubleValue),h=Bn(o.doubleValue);return c===h?ep(c)===ep(h):isNaN(c)&&isNaN(h)}return!1})(n,e);case 9:return Ec(n.arrayValue.values||[],e.arrayValue.values||[],fs);case 10:case 11:return(function(s,o){const c=s.mapValue.fields||{},h=o.mapValue.fields||{};if(Sx(c)!==Sx(h))return!1;for(const d in c)if(c.hasOwnProperty(d)&&(h[d]===void 0||!fs(c[d],h[d])))return!1;return!0})(n,e);default:return xt()}}function dh(n,e){return(n.values||[]).find((t=>fs(t,e)))!==void 0}function Sc(n,e){if(n===e)return 0;const t=$o(n),i=$o(e);if(t!==i)return nn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return nn(n.booleanValue,e.booleanValue);case 2:return(function(o,c){const h=Bn(o.integerValue||o.doubleValue),d=Bn(c.integerValue||c.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1})(n,e);case 3:return xx(n.timestampValue,e.timestampValue);case 4:return xx(uh(n),uh(e));case 5:return nn(n.stringValue,e.stringValue);case 6:return(function(o,c){const h=Ko(o),d=Ko(c);return h.compareTo(d)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){const h=o.split("/"),d=c.split("/");for(let p=0;p<h.length&&p<d.length;p++){const g=nn(h[p],d[p]);if(g!==0)return g}return nn(h.length,d.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){const h=nn(Bn(o.latitude),Bn(c.latitude));return h!==0?h:nn(Bn(o.longitude),Bn(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return bx(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var h,d,p,g;const v=o.fields||{},y=c.fields||{},E=(h=v.value)===null||h===void 0?void 0:h.arrayValue,b=(d=y.value)===null||d===void 0?void 0:d.arrayValue,D=nn(((p=E?.values)===null||p===void 0?void 0:p.length)||0,((g=b?.values)===null||g===void 0?void 0:g.length)||0);return D!==0?D:bx(E,b)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===sf.mapValue&&c===sf.mapValue)return 0;if(o===sf.mapValue)return 1;if(c===sf.mapValue)return-1;const h=o.fields||{},d=Object.keys(h),p=c.fields||{},g=Object.keys(p);d.sort(),g.sort();for(let v=0;v<d.length&&v<g.length;++v){const y=nn(d[v],g[v]);if(y!==0)return y;const E=Sc(h[d[v]],p[g[v]]);if(E!==0)return E}return nn(d.length,g.length)})(n.mapValue,e.mapValue);default:throw xt()}}function xx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return nn(n,e);const t=Wa(n),i=Wa(e),s=nn(t.seconds,i.seconds);return s!==0?s:nn(t.nanos,i.nanos)}function bx(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const o=Sc(t[s],i[s]);if(o)return o}return nn(t.length,i.length)}function Tc(n){return K_(n)}function K_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Wa(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ko(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return dt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const o of t.values||[])s?s=!1:i+=",",i+=K_(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const c of i)o?o=!1:s+=",",s+=`${c}:${K_(t.fields[c])}`;return s+"}"})(n.mapValue):xt()}function Ax(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function $_(n){return!!n&&"integerValue"in n}function Ey(n){return!!n&&"arrayValue"in n}function Mx(n){return!!n&&"nullValue"in n}function wx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ff(n){return!!n&&"mapValue"in n}function N2(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function eh(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return rl(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=eh(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=eh(n.arrayValue.values[t]);return e}return Object.assign({},n)}function P2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this.value=e}static empty(){return new qi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ff(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=eh(t)}setAll(e){let t=_i.emptyPath(),i={},s=[];e.forEach(((c,h)=>{if(!t.isImmediateParentOf(h)){const d=this.getFieldsMap(t);this.applyChanges(d,i,s),i={},s=[],t=h.popLast()}c?i[h.lastSegment()]=eh(c):s.push(h.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){const t=this.field(e.popLast());Ff(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return fs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Ff(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){rl(t,((s,o)=>e[s]=o));for(const s of i)delete e[s]}clone(){return new qi(eh(this.value))}}function TM(n){const e=[];return rl(n.fields,((t,i)=>{const s=new _i([t]);if(Ff(i)){const o=TM(i.mapValue).fields;if(o.length===0)e.push(s);else for(const c of o)e.push(s.child(c))}else e.push(s)})),new sr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t,i,s,o,c,h){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=c,this.documentState=h}static newInvalidDocument(e){return new Ri(e,0,At.min(),At.min(),At.min(),qi.empty(),0)}static newFoundDocument(e,t,i,s){return new Ri(e,1,t,At.min(),i,s,0)}static newNoDocument(e,t){return new Ri(e,2,t,At.min(),At.min(),qi.empty(),0)}static newUnknownDocument(e,t){return new Ri(e,3,t,At.min(),At.min(),qi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(At.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=At.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ri&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ri(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,t){this.position=e,this.inclusive=t}}function Rx(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const o=e[s],c=n.position[s];if(o.field.isKeyField()?i=dt.comparator(dt.fromName(c.referenceValue),t.key):i=Sc(c,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function Cx(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!fs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,t="asc"){this.field=e,this.dir=t}}function U2(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{}class Yn extends xM{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new O2(e,t,i):t==="array-contains"?new k2(e,i):t==="in"?new z2(e,i):t==="not-in"?new B2(e,i):t==="array-contains-any"?new H2(e,i):new Yn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new V2(e,i):new F2(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Sc(t,this.value)):t!==null&&$o(this.value)===$o(t)&&this.matchesComparison(Sc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class jr extends xM{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new jr(e,t)}matches(e){return bM(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function bM(n){return n.op==="and"}function AM(n){return L2(n)&&bM(n)}function L2(n){for(const e of n.filters)if(e instanceof jr)return!1;return!0}function Q_(n){if(n instanceof Yn)return n.field.canonicalString()+n.op.toString()+Tc(n.value);if(AM(n))return n.filters.map((e=>Q_(e))).join(",");{const e=n.filters.map((t=>Q_(t))).join(",");return`${n.op}(${e})`}}function MM(n,e){return n instanceof Yn?(function(i,s){return s instanceof Yn&&i.op===s.op&&i.field.isEqual(s.field)&&fs(i.value,s.value)})(n,e):n instanceof jr?(function(i,s){return s instanceof jr&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((o,c,h)=>o&&MM(c,s.filters[h])),!0):!1})(n,e):void xt()}function wM(n){return n instanceof Yn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Tc(t.value)}`})(n):n instanceof jr?(function(t){return t.op.toString()+" {"+t.getFilters().map(wM).join(" ,")+"}"})(n):"Filter"}class O2 extends Yn{constructor(e,t,i){super(e,t,i),this.key=dt.fromName(i.referenceValue)}matches(e){const t=dt.comparator(e.key,this.key);return this.matchesComparison(t)}}class V2 extends Yn{constructor(e,t){super(e,"in",t),this.keys=RM("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class F2 extends Yn{constructor(e,t){super(e,"not-in",t),this.keys=RM("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function RM(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((i=>dt.fromName(i.referenceValue)))}class k2 extends Yn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ey(t)&&dh(t.arrayValue,this.value)}}class z2 extends Yn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&dh(this.value.arrayValue,t)}}class B2 extends Yn{constructor(e,t){super(e,"not-in",t)}matches(e){if(dh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!dh(this.value.arrayValue,t)}}class H2 extends Yn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ey(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>dh(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t=null,i=[],s=[],o=null,c=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=c,this.endAt=h,this.ue=null}}function Ix(n,e=null,t=[],i=[],s=null,o=null,c=null){return new G2(n,e,t,i,s,o,c)}function Sy(n){const e=Mt(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Q_(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(o){return o.field.canonicalString()+o.dir})(i))).join(","),Ep(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Tc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Tc(i))).join(",")),e.ue=t}return e.ue}function Ty(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!U2(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!MM(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Cx(n.startAt,e.startAt)&&Cx(n.endAt,e.endAt)}function Z_(n){return dt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,t=null,i=[],s=[],o=null,c="F",h=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=c,this.startAt=h,this.endAt=d,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function j2(n,e,t,i,s,o,c,h){return new Uc(n,e,t,i,s,o,c,h)}function Sp(n){return new Uc(n)}function Dx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function CM(n){return n.collectionGroup!==null}function th(n){const e=Mt(n);if(e.ce===null){e.ce=[];const t=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new vi(_i.comparator);return c.filters.forEach((d=>{d.getFlattenedFilters().forEach((p=>{p.isInequality()&&(h=h.add(p.field))}))})),h})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new fh(o,i))})),t.has(_i.keyField().canonicalString())||e.ce.push(new fh(_i.keyField(),i))}return e.ce}function us(n){const e=Mt(n);return e.le||(e.le=q2(e,th(n))),e.le}function q2(n,e){if(n.limitType==="F")return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new fh(s.field,o)}));const t=n.endAt?new tp(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new tp(n.startAt.position,n.startAt.inclusive):null;return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function J_(n,e){const t=n.filters.concat([e]);return new Uc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ev(n,e,t){return new Uc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Tp(n,e){return Ty(us(n),us(e))&&n.limitType===e.limitType}function IM(n){return`${Sy(us(n))}|lt:${n.limitType}`}function cc(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>wM(s))).join(", ")}]`),Ep(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>Tc(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>Tc(s))).join(",")),`Target(${i})`})(us(n))}; limitType=${n.limitType})`}function xp(n,e){return e.isFoundDocument()&&(function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):dt.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,s){for(const o of th(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(c,h,d){const p=Rx(c,h,d);return c.inclusive?p<=0:p<0})(i.startAt,th(i),s)||i.endAt&&!(function(c,h,d){const p=Rx(c,h,d);return c.inclusive?p>=0:p>0})(i.endAt,th(i),s))})(n,e)}function W2(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function DM(n){return(e,t)=>{let i=!1;for(const s of th(n)){const o=X2(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function X2(n,e,t){const i=n.field.isKeyField()?dt.comparator(e.key,t.key):(function(o,c,h){const d=c.data.field(o),p=h.data.field(o);return d!==null&&p!==null?Sc(d,p):xt()})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return xt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){rl(this.inner,((t,i)=>{for(const[s,o]of i)e(s,o)}))}isEmpty(){return EM(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2=new Pn(dt.comparator);function ea(){return Y2}const NM=new Pn(dt.comparator);function Ku(...n){let e=NM;for(const t of n)e=e.insert(t.key,t);return e}function PM(n){let e=NM;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Bo(){return nh()}function UM(){return nh()}function nh(){return new Lc((n=>n.toString()),((n,e)=>n.isEqual(e)))}const K2=new Pn(dt.comparator),$2=new vi(dt.comparator);function Ht(...n){let e=$2;for(const t of n)e=e.add(t);return e}const Q2=new vi(nn);function Z2(){return Q2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ep(e)?"-0":e}}function LM(n){return{integerValue:""+n}}function J2(n,e){return C2(e)?LM(e):xy(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(){this._=void 0}}function eP(n,e,t){return n instanceof np?(function(s,o){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&vy(o)&&(o=yy(o)),o&&(c.fields.__previous_value__=o),{mapValue:c}})(t,e):n instanceof ph?VM(n,e):n instanceof mh?FM(n,e):(function(s,o){const c=OM(s,o),h=Nx(c)+Nx(s.Pe);return $_(c)&&$_(s.Pe)?LM(h):xy(s.serializer,h)})(n,e)}function tP(n,e,t){return n instanceof ph?VM(n,e):n instanceof mh?FM(n,e):t}function OM(n,e){return n instanceof ip?(function(i){return $_(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}class np extends bp{}class ph extends bp{constructor(e){super(),this.elements=e}}function VM(n,e){const t=kM(e);for(const i of n.elements)t.some((s=>fs(s,i)))||t.push(i);return{arrayValue:{values:t}}}class mh extends bp{constructor(e){super(),this.elements=e}}function FM(n,e){let t=kM(e);for(const i of n.elements)t=t.filter((s=>!fs(s,i)));return{arrayValue:{values:t}}}class ip extends bp{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Nx(n){return Bn(n.integerValue||n.doubleValue)}function kM(n){return Ey(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function nP(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof ph&&s instanceof ph||i instanceof mh&&s instanceof mh?Ec(i.elements,s.elements,fs):i instanceof ip&&s instanceof ip?fs(i.Pe,s.Pe):i instanceof np&&s instanceof np})(n.transform,e.transform)}class iP{constructor(e,t){this.version=e,this.transformResults=t}}class Vi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vi}static exists(e){return new Vi(void 0,e)}static updateTime(e){return new Vi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ap{}function zM(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Mp(n.key,Vi.none()):new Rh(n.key,n.data,Vi.none());{const t=n.data,i=qi.empty();let s=new vi(_i.comparator);for(let o of e.fields)if(!s.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?i.delete(o):i.set(o,c),s=s.add(o)}return new Ja(n.key,i,new sr(s.toArray()),Vi.none())}}function rP(n,e,t){n instanceof Rh?(function(s,o,c){const h=s.value.clone(),d=Ux(s.fieldTransforms,o,c.transformResults);h.setAll(d),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(n,e,t):n instanceof Ja?(function(s,o,c){if(!kf(s.precondition,o))return void o.convertToUnknownDocument(c.version);const h=Ux(s.fieldTransforms,o,c.transformResults),d=o.data;d.setAll(BM(s)),d.setAll(h),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):(function(s,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function ih(n,e,t,i){return n instanceof Rh?(function(o,c,h,d){if(!kf(o.precondition,c))return h;const p=o.value.clone(),g=Lx(o.fieldTransforms,d,c);return p.setAll(g),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof Ja?(function(o,c,h,d){if(!kf(o.precondition,c))return h;const p=Lx(o.fieldTransforms,d,c),g=c.data;return g.setAll(BM(o)),g.setAll(p),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),h===null?null:h.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(n,e,t,i):(function(o,c,h){return kf(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(n,e,t)}function sP(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),o=OM(i.transform,s||null);o!=null&&(t===null&&(t=qi.empty()),t.set(i.field,o))}return t||null}function Px(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Ec(i,s,((o,c)=>nP(o,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Rh extends Ap{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ja extends Ap{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function BM(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Ux(n,e,t){const i=new Map;ln(n.length===t.length);for(let s=0;s<t.length;s++){const o=n[s],c=o.transform,h=e.data.field(o.field);i.set(o.field,tP(c,h,t[s]))}return i}function Lx(n,e,t){const i=new Map;for(const s of n){const o=s.transform,c=t.data.field(s.field);i.set(s.field,eP(o,c,e))}return i}class Mp extends Ap{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class aP extends Ap{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&rP(o,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=ih(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=ih(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=UM();return this.mutations.forEach((s=>{const o=e.get(s.key),c=o.overlayedDocument;let h=this.applyToLocalView(c,o.mutatedFields);h=t.has(s.key)?null:h;const d=zM(c,h);d!==null&&i.set(s.key,d),c.isValidDocument()||c.convertToNoDocument(At.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ht())}isEqual(e){return this.batchId===e.batchId&&Ec(this.mutations,e.mutations,((t,i)=>Px(t,i)))&&Ec(this.baseMutations,e.baseMutations,((t,i)=>Px(t,i)))}}class by{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){ln(e.mutations.length===i.length);let s=(function(){return K2})();const o=e.mutations;for(let c=0;c<o.length;c++)s=s.insert(o[c].key,i[c].version);return new by(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xn,$t;function uP(n){switch(n){default:return xt();case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0}}function HM(n){if(n===void 0)return Js("GRPC error has no .code"),we.UNKNOWN;switch(n){case Xn.OK:return we.OK;case Xn.CANCELLED:return we.CANCELLED;case Xn.UNKNOWN:return we.UNKNOWN;case Xn.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case Xn.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case Xn.INTERNAL:return we.INTERNAL;case Xn.UNAVAILABLE:return we.UNAVAILABLE;case Xn.UNAUTHENTICATED:return we.UNAUTHENTICATED;case Xn.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case Xn.NOT_FOUND:return we.NOT_FOUND;case Xn.ALREADY_EXISTS:return we.ALREADY_EXISTS;case Xn.PERMISSION_DENIED:return we.PERMISSION_DENIED;case Xn.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case Xn.ABORTED:return we.ABORTED;case Xn.OUT_OF_RANGE:return we.OUT_OF_RANGE;case Xn.UNIMPLEMENTED:return we.UNIMPLEMENTED;case Xn.DATA_LOSS:return we.DATA_LOSS;default:return xt()}}($t=Xn||(Xn={}))[$t.OK=0]="OK",$t[$t.CANCELLED=1]="CANCELLED",$t[$t.UNKNOWN=2]="UNKNOWN",$t[$t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$t[$t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$t[$t.NOT_FOUND=5]="NOT_FOUND",$t[$t.ALREADY_EXISTS=6]="ALREADY_EXISTS",$t[$t.PERMISSION_DENIED=7]="PERMISSION_DENIED",$t[$t.UNAUTHENTICATED=16]="UNAUTHENTICATED",$t[$t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$t[$t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$t[$t.ABORTED=10]="ABORTED",$t[$t.OUT_OF_RANGE=11]="OUT_OF_RANGE",$t[$t.UNIMPLEMENTED=12]="UNIMPLEMENTED",$t[$t.INTERNAL=13]="INTERNAL",$t[$t.UNAVAILABLE=14]="UNAVAILABLE",$t[$t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP=new qo([4294967295,4294967295],0);function Ox(n){const e=hP().encode(n),t=new dM;return t.update(e),new Uint8Array(t.digest())}function Vx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new qo([t,i],0),new qo([s,o],0)]}class Ay{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new $u(`Invalid padding: ${t}`);if(i<0)throw new $u(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new $u(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new $u(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=qo.fromNumber(this.Ie)}Ee(e,t,i){let s=e.add(t.multiply(qo.fromNumber(i)));return s.compare(dP)===1&&(s=new qo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Ox(e),[i,s]=Vx(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,s,o);if(!this.de(c))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new Ay(o,s,t);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.Ie===0)return;const t=Ox(e),[i,s]=Vx(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(i,s,o);this.Ae(c)}}Ae(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class $u extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Ch.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new wp(At.min(),s,new Pn(nn),ea(),Ht())}}class Ch{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ch(i,t,Ht(),Ht(),Ht())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t,i,s){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=s}}class GM{constructor(e,t){this.targetId=e,this.me=t}}class jM{constructor(e,t,i=Ei.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class Fx{constructor(){this.fe=0,this.ge=zx(),this.pe=Ei.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ht(),t=Ht(),i=Ht();return this.ge.forEach(((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:xt()}})),new Ch(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=zx()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ln(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class fP{constructor(e){this.Le=e,this.Be=new Map,this.ke=ea(),this.qe=kx(),this.Qe=new Pn(nn)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:xt()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((i,s)=>{this.ze(s)&&t(s)}))}He(e){const t=e.targetId,i=e.me.count,s=this.Je(t);if(s){const o=s.target;if(Z_(o))if(i===0){const c=new dt(o.path);this.Ue(t,c,Ri.newNoDocument(c,At.min()))}else ln(i===1);else{const c=this.Ye(t);if(c!==i){const h=this.Ze(e),d=h?this.Xe(h,e,c):1;if(d!==0){this.je(t);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,p)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t;let c,h;try{c=Ko(i).toUint8Array()}catch(d){if(d instanceof SM)return yc("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{h=new Ay(c,s,o)}catch(d){return yc(d instanceof $u?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return h.Ie===0?null:h}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){const i=this.Le.getRemoteKeysForTarget(t);let s=0;return i.forEach((o=>{const c=this.Le.tt(),h=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(h)||(this.Ue(t,o,null),s++)})),s}rt(e){const t=new Map;this.Be.forEach(((o,c)=>{const h=this.Je(c);if(h){if(o.current&&Z_(h.target)){const d=new dt(h.target.path);this.ke.get(d)!==null||this.it(c,d)||this.Ue(c,d,Ri.newNoDocument(d,e))}o.be&&(t.set(c,o.ve()),o.Ce())}}));let i=Ht();this.qe.forEach(((o,c)=>{let h=!0;c.forEachWhile((d=>{const p=this.Je(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(o))})),this.ke.forEach(((o,c)=>c.setReadTime(e)));const s=new wp(e,t,this.Qe,this.ke,i);return this.ke=ea(),this.qe=kx(),this.Qe=new Pn(nn),s}$e(e,t){if(!this.ze(e))return;const i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Fx,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new vi(nn),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||at("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Fx),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function kx(){return new Pn(dt.comparator)}function zx(){return new Pn(dt.comparator)}const pP={asc:"ASCENDING",desc:"DESCENDING"},mP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gP={and:"AND",or:"OR"};class _P{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function tv(n,e){return n.useProto3Json||Ep(e)?e:{value:e}}function rp(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qM(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function vP(n,e){return rp(n,e.toTimestamp())}function hs(n){return ln(!!n),At.fromTimestamp((function(t){const i=Wa(t);return new ei(i.seconds,i.nanos)})(n))}function My(n,e){return nv(n,e).canonicalString()}function nv(n,e){const t=(function(s){return new An(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function WM(n){const e=An.fromString(n);return ln(QM(e)),e}function iv(n,e){return My(n.databaseId,e.path)}function Yg(n,e){const t=WM(e);if(t.get(1)!==n.databaseId.projectId)throw new Qe(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Qe(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new dt(YM(t))}function XM(n,e){return My(n.databaseId,e)}function yP(n){const e=WM(n);return e.length===4?An.emptyPath():YM(e)}function rv(n){return new An(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function YM(n){return ln(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Bx(n,e,t){return{name:iv(n,e),fields:t.value.mapValue.fields}}function EP(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:xt()})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=(function(p,g){return p.useProto3Json?(ln(g===void 0||typeof g=="string"),Ei.fromBase64String(g||"")):(ln(g===void 0||g instanceof Buffer||g instanceof Uint8Array),Ei.fromUint8Array(g||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(p){const g=p.code===void 0?we.UNKNOWN:HM(p.code);return new Qe(g,p.message||"")})(c);t=new jM(i,s,o,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Yg(n,i.document.name),o=hs(i.document.updateTime),c=i.document.createTime?hs(i.document.createTime):At.min(),h=new qi({mapValue:{fields:i.document.fields}}),d=Ri.newFoundDocument(s,o,c,h),p=i.targetIds||[],g=i.removedTargetIds||[];t=new zf(p,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Yg(n,i.document),o=i.readTime?hs(i.readTime):At.min(),c=Ri.newNoDocument(s,o),h=i.removedTargetIds||[];t=new zf([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Yg(n,i.document),o=i.removedTargetIds||[];t=new zf([],o,s,null)}else{if(!("filter"in e))return xt();{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,c=new cP(s,o),h=i.targetId;t=new GM(h,c)}}return t}function SP(n,e){let t;if(e instanceof Rh)t={update:Bx(n,e.key,e.value)};else if(e instanceof Mp)t={delete:iv(n,e.key)};else if(e instanceof Ja)t={update:Bx(n,e.key,e.data),updateMask:IP(e.fieldMask)};else{if(!(e instanceof aP))return xt();t={verify:iv(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(o,c){const h=c.transform;if(h instanceof np)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof ph)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof mh)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof ip)return{fieldPath:c.field.canonicalString(),increment:h.Pe};throw xt()})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:vP(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:xt()})(n,e.precondition)),t}function TP(n,e){return n&&n.length>0?(ln(e!==void 0),n.map((t=>(function(s,o){let c=s.updateTime?hs(s.updateTime):hs(o);return c.isEqual(At.min())&&(c=hs(o)),new iP(c,s.transformResults||[])})(t,e)))):[]}function xP(n,e){return{documents:[XM(n,e.path)]}}function bP(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=XM(n,s);const o=(function(p){if(p.length!==0)return $M(jr.create(p,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(p){if(p.length!==0)return p.map((g=>(function(y){return{field:uc(y.field),direction:wP(y.dir)}})(g)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const h=tv(n,e.limit);return h!==null&&(t.structuredQuery.limit=h),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{_t:t,parent:s}}function AP(n){let e=yP(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){ln(i===1);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let o=[];t.where&&(o=(function(v){const y=KM(v);return y instanceof jr&&AM(y)?y.getFilters():[y]})(t.where));let c=[];t.orderBy&&(c=(function(v){return v.map((y=>(function(b){return new fh(hc(b.field),(function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(b.direction))})(y)))})(t.orderBy));let h=null;t.limit&&(h=(function(v){let y;return y=typeof v=="object"?v.value:v,Ep(y)?null:y})(t.limit));let d=null;t.startAt&&(d=(function(v){const y=!!v.before,E=v.values||[];return new tp(E,y)})(t.startAt));let p=null;return t.endAt&&(p=(function(v){const y=!v.before,E=v.values||[];return new tp(E,y)})(t.endAt)),j2(e,s,c,o,h,"F",d,p)}function MP(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xt()}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function KM(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=hc(t.unaryFilter.field);return Yn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=hc(t.unaryFilter.field);return Yn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=hc(t.unaryFilter.field);return Yn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=hc(t.unaryFilter.field);return Yn.create(c,"!=",{nullValue:"NULL_VALUE"});default:return xt()}})(n):n.fieldFilter!==void 0?(function(t){return Yn.create(hc(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return xt()}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return jr.create(t.compositeFilter.filters.map((i=>KM(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return xt()}})(t.compositeFilter.op))})(n):xt()}function wP(n){return pP[n]}function RP(n){return mP[n]}function CP(n){return gP[n]}function uc(n){return{fieldPath:n.canonicalString()}}function hc(n){return _i.fromServerFormat(n.fieldPath)}function $M(n){return n instanceof Yn?(function(t){if(t.op==="=="){if(wx(t.value))return{unaryFilter:{field:uc(t.field),op:"IS_NAN"}};if(Mx(t.value))return{unaryFilter:{field:uc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(wx(t.value))return{unaryFilter:{field:uc(t.field),op:"IS_NOT_NAN"}};if(Mx(t.value))return{unaryFilter:{field:uc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uc(t.field),op:RP(t.op),value:t.value}}})(n):n instanceof jr?(function(t){const i=t.getFilters().map((s=>$M(s)));return i.length===1?i[0]:{compositeFilter:{op:CP(t.op),filters:i}}})(n):xt()}function IP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function QM(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,t,i,s,o=At.min(),c=At.min(),h=Ei.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=d}withSequenceNumber(e){return new Va(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.ct=e}}function NP(n){const e=AP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ev(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(){this.un=new UP}addToCollectionParentIndex(e,t){return this.un.add(t),Ce.resolve()}getCollectionParents(e,t){return Ce.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Ce.resolve()}deleteFieldIndex(e,t){return Ce.resolve()}deleteAllFieldIndexes(e){return Ce.resolve()}createTargetIndexes(e,t){return Ce.resolve()}getDocumentsMatchingTarget(e,t){return Ce.resolve(null)}getIndexType(e,t){return Ce.resolve(0)}getFieldIndexes(e,t){return Ce.resolve([])}getNextCollectionGroupToUpdate(e){return Ce.resolve(null)}getMinOffset(e,t){return Ce.resolve(qa.min())}getMinOffsetFromCollectionGroup(e,t){return Ce.resolve(qa.min())}updateCollectionGroup(e,t,i){return Ce.resolve()}updateIndexEntries(e,t){return Ce.resolve()}}class UP{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new vi(An.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new vi(An.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new xc(0)}static kn(){return new xc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.changes=new Lc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ri.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ce.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&ih(i.mutation,s,sr.empty(),ei.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ht()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ht()){const s=Bo();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((o=>{let c=Ku();return o.forEach(((h,d)=>{c=c.insert(h,d.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=Bo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ht())))}populateOverlays(e,t,i){const s=[];return i.forEach((o=>{t.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(e,s).next((o=>{o.forEach(((c,h)=>{t.set(c,h)}))}))}computeViews(e,t,i,s){let o=ea();const c=nh(),h=(function(){return nh()})();return t.forEach(((d,p)=>{const g=i.get(p.key);s.has(p.key)&&(g===void 0||g.mutation instanceof Ja)?o=o.insert(p.key,p):g!==void 0?(c.set(p.key,g.mutation.getFieldMask()),ih(g.mutation,p,g.mutation.getFieldMask(),ei.now())):c.set(p.key,sr.empty())})),this.recalculateAndSaveOverlays(e,o).next((d=>(d.forEach(((p,g)=>c.set(p,g))),t.forEach(((p,g)=>{var v;return h.set(p,new OP(g,(v=c.get(p))!==null&&v!==void 0?v:null))})),h)))}recalculateAndSaveOverlays(e,t){const i=nh();let s=new Pn(((c,h)=>c-h)),o=Ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const h of c)h.keys().forEach((d=>{const p=t.get(d);if(p===null)return;let g=i.get(d)||sr.empty();g=h.applyToLocalView(p,g),i.set(d,g);const v=(s.get(h.batchId)||Ht()).add(d);s=s.insert(h.batchId,v)}))})).next((()=>{const c=[],h=s.getReverseIterator();for(;h.hasNext();){const d=h.getNext(),p=d.key,g=d.value,v=UM();g.forEach((y=>{if(!o.has(y)){const E=zM(t.get(y),i.get(y));E!==null&&v.set(y,E),o=o.add(y)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,v))}return Ce.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(c){return dt.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):CM(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((o=>{const c=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):Ce.resolve(Bo());let h=-1,d=o;return c.next((p=>Ce.forEach(p,((g,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),o.get(g)?Ce.resolve():this.remoteDocumentCache.getEntry(e,g).next((y=>{d=d.insert(g,y)}))))).next((()=>this.populateOverlays(e,p,o))).next((()=>this.computeViews(e,d,p,Ht()))).next((g=>({batchId:h,changes:PM(g)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new dt(t)).next((i=>{let s=Ku();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const o=t.collectionGroup;let c=Ku();return this.indexManager.getCollectionParents(e,o).next((h=>Ce.forEach(h,(d=>{const p=(function(v,y){return new Uc(y,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,i,s).next((g=>{g.forEach(((v,y)=>{c=c.insert(v,y)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s)))).next((c=>{o.forEach(((d,p)=>{const g=p.getKey();c.get(g)===null&&(c=c.insert(g,Ri.newInvalidDocument(g)))}));let h=Ku();return c.forEach(((d,p)=>{const g=o.get(d);g!==void 0&&ih(g.mutation,p,sr.empty(),ei.now()),xp(t,p)&&(h=h.insert(d,p))})),h}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Ce.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:hs(s.createTime)}})(t)),Ce.resolve()}getNamedQuery(e,t){return Ce.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,(function(s){return{name:s.name,query:NP(s.bundledQuery),readTime:hs(s.readTime)}})(t)),Ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(){this.overlays=new Pn(dt.comparator),this.Ir=new Map}getOverlay(e,t){return Ce.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Bo();return Ce.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&i.set(s,o)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,o)=>{this.ht(e,t,o)})),Ce.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.Ir.get(i);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.Ir.delete(i)),Ce.resolve()}getOverlaysForCollection(e,t,i){const s=Bo(),o=t.length+1,c=new dt(t.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const d=h.getNext().value,p=d.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&d.largestBatchId>i&&s.set(d.getKey(),d)}return Ce.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new Pn(((p,g)=>p-g));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let g=o.get(p.largestBatchId);g===null&&(g=Bo(),o=o.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const h=Bo(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((p,g)=>h.set(p,g))),!(h.size()>=s)););return Ce.resolve(h)}ht(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const c=this.Ir.get(s.largestBatchId).delete(i.key);this.Ir.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new lP(t,i));let o=this.Ir.get(t);o===void 0&&(o=Ht(),this.Ir.set(t,o)),this.Ir.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(){this.sessionToken=Ei.EMPTY_BYTE_STRING}getSessionToken(e){return Ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(){this.Tr=new vi(ci.Er),this.dr=new vi(ci.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const i=new ci(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Vr(new ci(e,t))}mr(e,t){e.forEach((i=>this.removeReference(i,t)))}gr(e){const t=new dt(new An([])),i=new ci(t,e),s=new ci(t,e+1),o=[];return this.dr.forEachInRange([i,s],(c=>{this.Vr(c),o.push(c.key)})),o}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new dt(new An([])),i=new ci(t,e),s=new ci(t,e+1);let o=Ht();return this.dr.forEachInRange([i,s],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new ci(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class ci{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return dt.comparator(e.key,t.key)||nn(e.wr,t.wr)}static Ar(e,t){return nn(e.wr,t.wr)||dt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new vi(ci.Er)}checkEmpty(e){return Ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new oP(o,t,i,s);this.mutationQueue.push(c);for(const h of s)this.br=this.br.add(new ci(h.key,o)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return Ce.resolve(c)}lookupMutationBatch(e,t){return Ce.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.vr(i),o=s<0?0:s;return Ce.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return Ce.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new ci(t,0),s=new ci(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([i,s],(c=>{const h=this.Dr(c.wr);o.push(h)})),Ce.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new vi(nn);return t.forEach((s=>{const o=new ci(s,0),c=new ci(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,c],(h=>{i=i.add(h.wr)}))})),Ce.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let o=i;dt.isDocumentKey(o)||(o=o.child(""));const c=new ci(new dt(o),0);let h=new vi(nn);return this.br.forEachWhile((d=>{const p=d.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(h=h.add(d.wr)),!0)}),c),Ce.resolve(this.Cr(h))}Cr(e){const t=[];return e.forEach((i=>{const s=this.Dr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ln(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return Ce.forEach(t.mutations,(s=>{const o=new ci(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.br=i}))}On(e){}containsKey(e,t){const i=new ci(t,0),s=this.br.firstAfterOrEqual(i);return Ce.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ce.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.Mr=e,this.docs=(function(){return new Pn(dt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),o=s?s.size:0,c=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ce.resolve(i?i.document.mutableCopy():Ri.newInvalidDocument(t))}getEntries(e,t){let i=ea();return t.forEach((s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():Ri.newInvalidDocument(s))})),Ce.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=ea();const c=t.path,h=new dt(c.child("")),d=this.docs.getIteratorFrom(h);for(;d.hasNext();){const{key:p,value:{document:g}}=d.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||A2(b2(g),i)<=0||(s.has(g.key)||xp(t,g))&&(o=o.insert(g.key,g.mutableCopy()))}return Ce.resolve(o)}getAllFromCollectionGroup(e,t,i,s){xt()}Or(e,t){return Ce.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new GP(this)}getSize(e){return Ce.resolve(this.size)}}class GP extends LP{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(i)})),Ce.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e){this.persistence=e,this.Nr=new Lc((t=>Sy(t)),Ty),this.lastRemoteSnapshotVersion=At.min(),this.highestTargetId=0,this.Lr=0,this.Br=new wy,this.targetCount=0,this.kr=xc.Bn()}forEachTarget(e,t){return this.Nr.forEach(((i,s)=>t(s))),Ce.resolve()}getLastRemoteSnapshotVersion(e){return Ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ce.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),Ce.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new xc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Ce.resolve()}updateTargetData(e,t){return this.Kn(t),Ce.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Ce.resolve()}removeTargets(e,t,i){let s=0;const o=[];return this.Nr.forEach(((c,h)=>{h.sequenceNumber<=t&&i.get(h.targetId)===null&&(this.Nr.delete(c),o.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)})),Ce.waitFor(o).next((()=>s))}getTargetCount(e){return Ce.resolve(this.targetCount)}getTargetData(e,t){const i=this.Nr.get(t)||null;return Ce.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),Ce.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach((c=>{o.push(s.markPotentiallyOrphaned(e,c))})),Ce.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Ce.resolve()}getMatchingKeysForTargetId(e,t){const i=this.Br.yr(t);return Ce.resolve(i)}containsKey(e,t){return Ce.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,t){this.qr={},this.overlays={},this.Qr=new _y(0),this.Kr=!1,this.Kr=!0,this.$r=new zP,this.referenceDelegate=e(this),this.Ur=new jP(this),this.indexManager=new PP,this.remoteDocumentCache=(function(s){return new HP(s)})((i=>this.referenceDelegate.Wr(i))),this.serializer=new DP(t),this.Gr=new FP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new BP(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){at("MemoryPersistence","Starting transaction:",e);const s=new WP(this.Qr.next());return this.referenceDelegate.zr(),i(s).next((o=>this.referenceDelegate.jr(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Hr(e,t){return Ce.or(Object.values(this.qr).map((i=>()=>i.containsKey(e,t))))}}class WP extends w2{constructor(e){super(),this.currentSequenceNumber=e}}class Ry{constructor(e){this.persistence=e,this.Jr=new wy,this.Yr=null}static Zr(e){return new Ry(e)}get Xr(){if(this.Yr)return this.Yr;throw xt()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),Ce.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),Ce.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Ce.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((s=>this.Xr.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((o=>this.Xr.add(o.toString())))})).next((()=>i.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ce.forEach(this.Xr,(i=>{const s=dt.fromPath(i);return this.ei(e,s).next((o=>{o||t.removeEntry(s,At.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return Ce.or([()=>Ce.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=s}static Wi(e,t){let i=Ht(),s=Ht();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Cy(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return PC()?8:R2(Ii())>0?6:4})()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,s){const o={result:null};return this.Yi(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.Zi(e,t,s,i).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new XP;return this.Xi(e,t,c).next((h=>{if(o.result=h,this.zi)return this.es(e,t,c,h.size)}))})).next((()=>o.result))}es(e,t,i,s){return i.documentReadCount<this.ji?(Vu()<=qt.DEBUG&&at("QueryEngine","SDK will not create cache indexes for query:",cc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ce.resolve()):(Vu()<=qt.DEBUG&&at("QueryEngine","Query:",cc(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.Hi*s?(Vu()<=qt.DEBUG&&at("QueryEngine","The SDK decides to create cache indexes for query:",cc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,us(t))):Ce.resolve())}Yi(e,t){if(Dx(t))return Ce.resolve(null);let i=us(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=ev(t,null,"F"),i=us(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((o=>{const c=Ht(...o);return this.Ji.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((d=>{const p=this.ts(t,h);return this.ns(t,p,c,d.readTime)?this.Yi(e,ev(t,null,"F")):this.rs(e,p,t,d)}))))})))))}Zi(e,t,i,s){return Dx(t)||s.isEqual(At.min())?Ce.resolve(null):this.Ji.getDocuments(e,i).next((o=>{const c=this.ts(t,o);return this.ns(t,c,i,s)?Ce.resolve(null):(Vu()<=qt.DEBUG&&at("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),cc(t)),this.rs(e,c,t,x2(s,-1)).next((h=>h)))}))}ts(e,t){let i=new vi(DM(e));return t.forEach(((s,o)=>{xp(e,o)&&(i=i.add(o))})),i}ns(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Xi(e,t,i){return Vu()<=qt.DEBUG&&at("QueryEngine","Using full collection scan to execute query:",cc(t)),this.Ji.getDocumentsMatchingQuery(e,t,qa.min(),i)}rs(e,t,i,s){return this.Ji.getDocumentsMatchingQuery(e,i,s).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,t,i,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new Pn(nn),this._s=new Lc((o=>Sy(o)),Ty),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VP(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function $P(n,e,t,i){return new KP(n,e,t,i)}async function ZM(n,e){const t=Mt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((o=>(s=o,t.ls(e),t.mutationQueue.getAllMutationBatches(i)))).next((o=>{const c=[],h=[];let d=Ht();for(const p of s){c.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}for(const p of o){h.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}return t.localDocuments.getDocuments(i,d).next((p=>({hs:p,removedBatchIds:c,addedBatchIds:h})))}))}))}function QP(n,e){const t=Mt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return(function(h,d,p,g){const v=p.batch,y=v.keys();let E=Ce.resolve();return y.forEach((b=>{E=E.next((()=>g.getEntry(d,b))).next((D=>{const A=p.docVersions.get(b);ln(A!==null),D.version.compareTo(A)<0&&(v.applyToRemoteDocument(D,p),D.isValidDocument()&&(D.setReadTime(p.commitVersion),g.addEntry(D)))}))})),E.next((()=>h.mutationQueue.removeMutationBatch(d,v)))})(t,i,e,o).next((()=>o.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let d=Ht();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(d=d.add(h.batch.mutations[p].key));return d})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function JM(n){const e=Mt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ur.getLastRemoteSnapshotVersion(t)))}function ZP(n,e){const t=Mt(n),i=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const h=[];e.targetChanges.forEach(((g,v)=>{const y=s.get(v);if(!y)return;h.push(t.Ur.removeMatchingKeys(o,g.removedDocuments,v).next((()=>t.Ur.addMatchingKeys(o,g.addedDocuments,v))));let E=y.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(Ei.EMPTY_BYTE_STRING,At.min()).withLastLimboFreeSnapshotVersion(At.min()):g.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(g.resumeToken,i)),s=s.insert(v,E),(function(D,A,T){return D.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0})(y,E,g)&&h.push(t.Ur.updateTargetData(o,E))}));let d=ea(),p=Ht();if(e.documentUpdates.forEach((g=>{e.resolvedLimboDocuments.has(g)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(o,g))})),h.push(JP(o,c,e.documentUpdates).next((g=>{d=g.Ps,p=g.Is}))),!i.isEqual(At.min())){const g=t.Ur.getLastRemoteSnapshotVersion(o).next((v=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,i)));h.push(g)}return Ce.waitFor(h).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,d,p))).next((()=>d))})).then((o=>(t.os=s,o)))}function JP(n,e,t){let i=Ht(),s=Ht();return t.forEach((o=>i=i.add(o))),e.getEntries(n,i).next((o=>{let c=ea();return t.forEach(((h,d)=>{const p=o.get(h);d.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(h)),d.isNoDocument()&&d.version.isEqual(At.min())?(e.removeEntry(h,d.readTime),c=c.insert(h,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),c=c.insert(h,d)):at("LocalStore","Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",d.version)})),{Ps:c,Is:s}}))}function eU(n,e){const t=Mt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function tU(n,e){const t=Mt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Ur.getTargetData(i,e).next((o=>o?(s=o,Ce.resolve(s)):t.Ur.allocateTargetId(i).next((c=>(s=new Va(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.os.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i}))}async function sv(n,e,t){const i=Mt(n),s=i.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,(c=>i.persistence.referenceDelegate.removeTarget(c,s)))}catch(c){if(!wh(c))throw c;at("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}i.os=i.os.remove(e),i._s.delete(s.target)}function Hx(n,e,t){const i=Mt(n);let s=At.min(),o=Ht();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(d,p,g){const v=Mt(d),y=v._s.get(g);return y!==void 0?Ce.resolve(v.os.get(y)):v.Ur.getTargetData(p,g)})(i,c,us(e)).next((h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(c,h.targetId).next((d=>{o=d}))})).next((()=>i.ss.getDocumentsMatchingQuery(c,e,t?s:At.min(),t?o:Ht()))).next((h=>(nU(i,W2(e),h),{documents:h,Ts:o})))))}function nU(n,e,t){let i=n.us.get(e)||At.min();t.forEach(((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)})),n.us.set(e,i)}class Gx{constructor(){this.activeTargetIds=Z2()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iU{constructor(){this.so=new Gx,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Gx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){at("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){at("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let af=null;function Kg(){return af===null?af=(function(){return 268435456+Math.round(2147483648*Math.random())})():af++,"0x"+af.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="WebChannelConnection";class oU extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const i=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${s}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${o}`}get Fo(){return!1}Mo(t,i,s,o,c){const h=Kg(),d=this.xo(t,i.toUriEncodedString());at("RestConnection",`Sending RPC '${t}' ${h}:`,d,s);const p={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(p,o,c),this.No(t,d,p,s).then((g=>(at("RestConnection",`Received RPC '${t}' ${h}: `,g),g)),(g=>{throw yc("RestConnection",`RPC '${t}' ${h} failed with error: `,g,"url: ",d,"request:",s),g}))}Lo(t,i,s,o,c,h){return this.Mo(t,i,s,o,c)}Oo(t,i,s){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Pc})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach(((o,c)=>t[c]=o)),s&&s.headers.forEach(((o,c)=>t[c]=o))}xo(t,i){const s=sU[t];return`${this.Do}/v1/${i}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,s){const o=Kg();return new Promise(((c,h)=>{const d=new fM;d.setWithCredentials(!0),d.listenOnce(pM.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Vf.NO_ERROR:const g=d.getResponseJson();at(bi,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),c(g);break;case Vf.TIMEOUT:at(bi,`RPC '${e}' ${o} timed out`),h(new Qe(we.DEADLINE_EXCEEDED,"Request time out"));break;case Vf.HTTP_ERROR:const v=d.getStatus();if(at(bi,`RPC '${e}' ${o} failed with status:`,v,"response text:",d.getResponseText()),v>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const E=y?.error;if(E&&E.status&&E.message){const b=(function(A){const T=A.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(T)>=0?T:we.UNKNOWN})(E.status);h(new Qe(b,E.message))}else h(new Qe(we.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new Qe(we.UNAVAILABLE,"Connection failed."));break;default:xt()}}finally{at(bi,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(s);at(bi,`RPC '${e}' ${o} sending request:`,s),d.send(t,"POST",p,i,15)}))}Bo(e,t,i){const s=Kg(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=_M(),h=gM(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Oo(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const g=o.join("");at(bi,`Creating RPC '${e}' stream ${s}: ${g}`,d);const v=c.createWebChannel(g,d);let y=!1,E=!1;const b=new aU({Io:A=>{E?at(bi,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(y||(at(bi,`Opening RPC '${e}' stream ${s} transport.`),v.open(),y=!0),at(bi,`RPC '${e}' stream ${s} sending:`,A),v.send(A))},To:()=>v.close()}),D=(A,T,P)=>{A.listen(T,(k=>{try{P(k)}catch(V){setTimeout((()=>{throw V}),0)}}))};return D(v,Yu.EventType.OPEN,(()=>{E||(at(bi,`RPC '${e}' stream ${s} transport opened.`),b.yo())})),D(v,Yu.EventType.CLOSE,(()=>{E||(E=!0,at(bi,`RPC '${e}' stream ${s} transport closed`),b.So())})),D(v,Yu.EventType.ERROR,(A=>{E||(E=!0,yc(bi,`RPC '${e}' stream ${s} transport errored:`,A),b.So(new Qe(we.UNAVAILABLE,"The operation could not be completed")))})),D(v,Yu.EventType.MESSAGE,(A=>{var T;if(!E){const P=A.data[0];ln(!!P);const k=P,V=k.error||((T=k[0])===null||T===void 0?void 0:T.error);if(V){at(bi,`RPC '${e}' stream ${s} received error:`,V);const j=V.status;let q=(function(M){const w=Xn[M];if(w!==void 0)return HM(w)})(j),U=V.message;q===void 0&&(q=we.INTERNAL,U="Unknown error status: "+j+" with message "+V.message),E=!0,b.So(new Qe(q,U)),v.close()}else at(bi,`RPC '${e}' stream ${s} received:`,P),b.bo(P)}})),D(h,mM.STAT_EVENT,(A=>{A.stat===Y_.PROXY?at(bi,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===Y_.NOPROXY&&at(bi,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{b.wo()}),0),b}}function $g(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(n){return new _P(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e,t,i=1e3,s=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=s,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-i);s>0&&at("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,t,i,s,o,c,h,d){this.ui=e,this.Ho=i,this.Jo=s,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=d,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ew(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===we.RESOURCE_EXHAUSTED?(Js(t.toString()),Js("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===we.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.Yo===t&&this.P_(i,s)}),(i=>{e((()=>{const s=new Qe(we.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(s)}))}))}P_(e,t){const i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{i((()=>this.listener.Eo()))})),this.stream.Ro((()=>{i((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((s=>{i((()=>this.I_(s)))})),this.stream.onMessage((s=>{i((()=>++this.e_==1?this.E_(s):this.onNext(s)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return at("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(at("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lU extends tw{constructor(e,t,i,s,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,c),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=EP(this.serializer,e),i=(function(o){if(!("targetChange"in o))return At.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?At.min():c.readTime?hs(c.readTime):At.min()})(e);return this.listener.d_(t,i)}A_(e){const t={};t.database=rv(this.serializer),t.addTarget=(function(o,c){let h;const d=c.target;if(h=Z_(d)?{documents:xP(o,d)}:{query:bP(o,d)._t},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=qM(o,c.resumeToken);const p=tv(o,c.expectedCount);p!==null&&(h.expectedCount=p)}else if(c.snapshotVersion.compareTo(At.min())>0){h.readTime=rp(o,c.snapshotVersion.toTimestamp());const p=tv(o,c.expectedCount);p!==null&&(h.expectedCount=p)}return h})(this.serializer,e);const i=MP(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){const t={};t.database=rv(this.serializer),t.removeTarget=e,this.a_(t)}}class cU extends tw{constructor(e,t,i,s,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,c),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ln(!!e.streamToken),this.lastStreamToken=e.streamToken,ln(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ln(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=TP(e.writeResults,e.commitTime),i=hs(e.commitTime);return this.listener.g_(i,t)}p_(){const e={};e.database=rv(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>SP(this.serializer,i)))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU extends class{}{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Qe(we.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Mo(e,nv(t,i),s,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Qe(we.UNKNOWN,o.toString())}))}Lo(e,t,i,s,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Lo(e,nv(t,i),s,c,h,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Qe(we.UNKNOWN,c.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class hU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Js(t),this.D_=!1):at("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dU{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o((c=>{i.enqueueAndForget((async()=>{sl(this)&&(at("RemoteStore","Restarting streams for network reachability change."),await(async function(d){const p=Mt(d);p.L_.add(4),await Ih(p),p.q_.set("Unknown"),p.L_.delete(4),await Cp(p)})(this))}))})),this.q_=new hU(i,s)}}async function Cp(n){if(sl(n))for(const e of n.B_)await e(!0)}async function Ih(n){for(const e of n.B_)await e(!1)}function nw(n,e){const t=Mt(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Py(t)?Ny(t):Oc(t).r_()&&Dy(t,e))}function Iy(n,e){const t=Mt(n),i=Oc(t);t.N_.delete(e),i.r_()&&iw(t,e),t.N_.size===0&&(i.r_()?i.o_():sl(t)&&t.q_.set("Unknown"))}function Dy(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(At.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Oc(n).A_(e)}function iw(n,e){n.Q_.xe(e),Oc(n).R_(e)}function Ny(n){n.Q_=new fP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Oc(n).start(),n.q_.v_()}function Py(n){return sl(n)&&!Oc(n).n_()&&n.N_.size>0}function sl(n){return Mt(n).L_.size===0}function rw(n){n.Q_=void 0}async function fU(n){n.q_.set("Online")}async function pU(n){n.N_.forEach(((e,t)=>{Dy(n,e)}))}async function mU(n,e){rw(n),Py(n)?(n.q_.M_(e),Ny(n)):n.q_.set("Unknown")}async function gU(n,e,t){if(n.q_.set("Online"),e instanceof jM&&e.state===2&&e.cause)try{await(async function(s,o){const c=o.cause;for(const h of o.targetIds)s.N_.has(h)&&(await s.remoteSyncer.rejectListen(h,c),s.N_.delete(h),s.Q_.removeTarget(h))})(n,e)}catch(i){at("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),await sp(n,i)}else if(e instanceof zf?n.Q_.Ke(e):e instanceof GM?n.Q_.He(e):n.Q_.We(e),!t.isEqual(At.min()))try{const i=await JM(n.localStore);t.compareTo(i)>=0&&await(function(o,c){const h=o.Q_.rt(c);return h.targetChanges.forEach(((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const g=o.N_.get(p);g&&o.N_.set(p,g.withResumeToken(d.resumeToken,c))}})),h.targetMismatches.forEach(((d,p)=>{const g=o.N_.get(d);if(!g)return;o.N_.set(d,g.withResumeToken(Ei.EMPTY_BYTE_STRING,g.snapshotVersion)),iw(o,d);const v=new Va(g.target,d,p,g.sequenceNumber);Dy(o,v)})),o.remoteSyncer.applyRemoteEvent(h)})(n,t)}catch(i){at("RemoteStore","Failed to raise snapshot:",i),await sp(n,i)}}async function sp(n,e,t){if(!wh(e))throw e;n.L_.add(1),await Ih(n),n.q_.set("Offline"),t||(t=()=>JM(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{at("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Cp(n)}))}function sw(n,e){return e().catch((t=>sp(n,t,e)))}async function Ip(n){const e=Mt(n),t=Xa(e);let i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;_U(e);)try{const s=await eU(e.localStore,i);if(s===null){e.O_.length===0&&t.o_();break}i=s.batchId,vU(e,s)}catch(s){await sp(e,s)}aw(e)&&ow(e)}function _U(n){return sl(n)&&n.O_.length<10}function vU(n,e){n.O_.push(e);const t=Xa(n);t.r_()&&t.V_&&t.m_(e.mutations)}function aw(n){return sl(n)&&!Xa(n).n_()&&n.O_.length>0}function ow(n){Xa(n).start()}async function yU(n){Xa(n).p_()}async function EU(n){const e=Xa(n);for(const t of n.O_)e.m_(t.mutations)}async function SU(n,e,t){const i=n.O_.shift(),s=by.from(i,e,t);await sw(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Ip(n)}async function TU(n,e){e&&Xa(n).V_&&await(async function(i,s){if((function(c){return uP(c)&&c!==we.ABORTED})(s.code)){const o=i.O_.shift();Xa(i).s_(),await sw(i,(()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s))),await Ip(i)}})(n,e),aw(n)&&ow(n)}async function qx(n,e){const t=Mt(n);t.asyncQueue.verifyOperationInProgress(),at("RemoteStore","RemoteStore received new credentials");const i=sl(t);t.L_.add(3),await Ih(t),i&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Cp(t)}async function xU(n,e){const t=Mt(n);e?(t.L_.delete(2),await Cp(t)):e||(t.L_.add(2),await Ih(t),t.q_.set("Unknown"))}function Oc(n){return n.K_||(n.K_=(function(t,i,s){const o=Mt(t);return o.w_(),new lU(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Eo:fU.bind(null,n),Ro:pU.bind(null,n),mo:mU.bind(null,n),d_:gU.bind(null,n)}),n.B_.push((async e=>{e?(n.K_.s_(),Py(n)?Ny(n):n.q_.set("Unknown")):(await n.K_.stop(),rw(n))}))),n.K_}function Xa(n){return n.U_||(n.U_=(function(t,i,s){const o=Mt(t);return o.w_(),new cU(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:yU.bind(null,n),mo:TU.bind(null,n),f_:EU.bind(null,n),g_:SU.bind(null,n)}),n.B_.push((async e=>{e?(n.U_.s_(),await Ip(n)):(await n.U_.stop(),n.O_.length>0&&(at("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new Ks,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const c=Date.now()+i,h=new Uy(e,t,c,s,o);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Qe(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ly(n,e){if(Js("AsyncQueue",`${e}: ${n}`),wh(n))return new Qe(we.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e){this.comparator=e?(t,i)=>e(t,i)||dt.comparator(t.key,i.key):(t,i)=>dt.comparator(t.key,i.key),this.keyedMap=Ku(),this.sortedSet=new Pn(this.comparator)}static emptySet(e){return new gc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new gc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(){this.W_=new Pn(dt.comparator)}track(e){const t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):xt():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,i)=>{e.push(i)})),e}}class bc{constructor(e,t,i,s,o,c,h,d,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,s,o){const c=[];return t.forEach((h=>{c.push({type:0,doc:h})})),new bc(e,t,gc.emptySet(t),c,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bU{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class AU{constructor(){this.queries=Xx(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){const s=Mt(t),o=s.queries;s.queries=Xx(),o.forEach(((c,h)=>{for(const d of h.j_)d.onError(i)}))})(this,new Qe(we.ABORTED,"Firestore shutting down"))}}function Xx(){return new Lc((n=>IM(n)),Tp)}async function Oy(n,e){const t=Mt(n);let i=3;const s=e.query;let o=t.queries.get(s);o?!o.H_()&&e.J_()&&(i=2):(o=new bU,i=e.J_()?0:1);try{switch(i){case 0:o.z_=await t.onListen(s,!0);break;case 1:o.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(c){const h=Ly(c,`Initialization of query '${cc(e.query)}' failed`);return void e.onError(h)}t.queries.set(s,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Fy(t)}async function Vy(n,e){const t=Mt(n),i=e.query;let s=3;const o=t.queries.get(i);if(o){const c=o.j_.indexOf(e);c>=0&&(o.j_.splice(c,1),o.j_.length===0?s=e.J_()?0:1:!o.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function MU(n,e){const t=Mt(n);let i=!1;for(const s of e){const o=s.query,c=t.queries.get(o);if(c){for(const h of c.j_)h.X_(s)&&(i=!0);c.z_=s}}i&&Fy(t)}function wU(n,e,t){const i=Mt(n),s=i.queries.get(e);if(s)for(const o of s.j_)o.onError(t);i.queries.delete(e)}function Fy(n){n.Y_.forEach((e=>{e.next()}))}var av,Yx;(Yx=av||(av={})).ea="default",Yx.Cache="cache";class ky{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new bc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=bc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==av.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e){this.key=e}}class cw{constructor(e){this.key=e}}class RU{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ht(),this.mutatedKeys=Ht(),this.Aa=DM(e),this.Ra=new gc(this.Aa)}get Va(){return this.Ta}ma(e,t){const i=t?t.fa:new Wx,s=t?t.Ra:this.Ra;let o=t?t.mutatedKeys:this.mutatedKeys,c=s,h=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((g,v)=>{const y=s.get(g),E=xp(this.query,v)?v:null,b=!!y&&this.mutatedKeys.has(y.key),D=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let A=!1;y&&E?y.data.isEqual(E.data)?b!==D&&(i.track({type:3,doc:E}),A=!0):this.ga(y,E)||(i.track({type:2,doc:E}),A=!0,(d&&this.Aa(E,d)>0||p&&this.Aa(E,p)<0)&&(h=!0)):!y&&E?(i.track({type:0,doc:E}),A=!0):y&&!E&&(i.track({type:1,doc:y}),A=!0,(d||p)&&(h=!0)),A&&(E?(c=c.add(E),o=D?o.add(g):o.delete(g)):(c=c.delete(g),o=o.delete(g)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),o=o.delete(g.key),i.track({type:1,doc:g})}return{Ra:c,fa:i,ns:h,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const c=e.fa.G_();c.sort(((g,v)=>(function(E,b){const D=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xt()}};return D(E)-D(b)})(g.type,v.type)||this.Aa(g.doc,v.doc))),this.pa(i),s=s!=null&&s;const h=t&&!s?this.ya():[],d=this.da.size===0&&this.current&&!s?1:0,p=d!==this.Ea;return this.Ea=d,c.length!==0||p?{snapshot:new bc(this.query,e.Ra,o,c,e.mutatedKeys,d===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Wx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((t=>this.Ta=this.Ta.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ta=this.Ta.delete(t))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ht(),this.Ra.forEach((i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))}));const t=[];return e.forEach((i=>{this.da.has(i)||t.push(new cw(i))})),this.da.forEach((i=>{e.has(i)||t.push(new lw(i))})),t}ba(e){this.Ta=e.Ts,this.da=Ht();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return bc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class CU{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class IU{constructor(e){this.key=e,this.va=!1}}class DU{constructor(e,t,i,s,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Ca={},this.Fa=new Lc((h=>IM(h)),Tp),this.Ma=new Map,this.xa=new Set,this.Oa=new Pn(dt.comparator),this.Na=new Map,this.La=new wy,this.Ba={},this.ka=new Map,this.qa=xc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function NU(n,e,t=!0){const i=mw(n);let s;const o=i.Fa.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.Da()):s=await uw(i,e,t,!0),s}async function PU(n,e){const t=mw(n);await uw(t,e,!0,!1)}async function uw(n,e,t,i){const s=await tU(n.localStore,us(e)),o=s.targetId,c=n.sharedClientState.addLocalQueryTarget(o,t);let h;return i&&(h=await UU(n,e,o,c==="current",s.resumeToken)),n.isPrimaryClient&&t&&nw(n.remoteStore,s),h}async function UU(n,e,t,i,s){n.Ka=(v,y,E)=>(async function(D,A,T,P){let k=A.view.ma(T);k.ns&&(k=await Hx(D.localStore,A.query,!1).then((({documents:U})=>A.view.ma(U,k))));const V=P&&P.targetChanges.get(A.targetId),j=P&&P.targetMismatches.get(A.targetId)!=null,q=A.view.applyChanges(k,D.isPrimaryClient,V,j);return $x(D,A.targetId,q.wa),q.snapshot})(n,v,y,E);const o=await Hx(n.localStore,e,!0),c=new RU(e,o.Ts),h=c.ma(o.documents),d=Ch.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),p=c.applyChanges(h,n.isPrimaryClient,d);$x(n,t,p.wa);const g=new CU(e,t,c);return n.Fa.set(e,g),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),p.snapshot}async function LU(n,e,t){const i=Mt(n),s=i.Fa.get(e),o=i.Ma.get(s.targetId);if(o.length>1)return i.Ma.set(s.targetId,o.filter((c=>!Tp(c,e)))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await sv(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&Iy(i.remoteStore,s.targetId),ov(i,s.targetId)})).catch(Mh)):(ov(i,s.targetId),await sv(i.localStore,s.targetId,!0))}async function OU(n,e){const t=Mt(n),i=t.Fa.get(e),s=t.Ma.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Iy(t.remoteStore,i.targetId))}async function VU(n,e,t){const i=jU(n);try{const s=await(function(c,h){const d=Mt(c),p=ei.now(),g=h.reduce(((E,b)=>E.add(b.key)),Ht());let v,y;return d.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let b=ea(),D=Ht();return d.cs.getEntries(E,g).next((A=>{b=A,b.forEach(((T,P)=>{P.isValidDocument()||(D=D.add(T))}))})).next((()=>d.localDocuments.getOverlayedDocuments(E,b))).next((A=>{v=A;const T=[];for(const P of h){const k=sP(P,v.get(P.key).overlayedDocument);k!=null&&T.push(new Ja(P.key,k,TM(k.value.mapValue),Vi.exists(!0)))}return d.mutationQueue.addMutationBatch(E,p,T,h)})).next((A=>{y=A;const T=A.applyToLocalDocumentSet(v,D);return d.documentOverlayCache.saveOverlays(E,A.batchId,T)}))})).then((()=>({batchId:y.batchId,changes:PM(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(c,h,d){let p=c.Ba[c.currentUser.toKey()];p||(p=new Pn(nn)),p=p.insert(h,d),c.Ba[c.currentUser.toKey()]=p})(i,s.batchId,t),await Dh(i,s.changes),await Ip(i.remoteStore)}catch(s){const o=Ly(s,"Failed to persist write");t.reject(o)}}async function hw(n,e){const t=Mt(n);try{const i=await ZP(t.localStore,e);e.targetChanges.forEach(((s,o)=>{const c=t.Na.get(o);c&&(ln(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?c.va=!0:s.modifiedDocuments.size>0?ln(c.va):s.removedDocuments.size>0&&(ln(c.va),c.va=!1))})),await Dh(t,i,e)}catch(i){await Mh(i)}}function Kx(n,e,t){const i=Mt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Fa.forEach(((o,c)=>{const h=c.view.Z_(e);h.snapshot&&s.push(h.snapshot)})),(function(c,h){const d=Mt(c);d.onlineState=h;let p=!1;d.queries.forEach(((g,v)=>{for(const y of v.j_)y.Z_(h)&&(p=!0)})),p&&Fy(d)})(i.eventManager,e),s.length&&i.Ca.d_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function FU(n,e,t){const i=Mt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Na.get(e),o=s&&s.key;if(o){let c=new Pn(dt.comparator);c=c.insert(o,Ri.newNoDocument(o,At.min()));const h=Ht().add(o),d=new wp(At.min(),new Map,new Pn(nn),c,h);await hw(i,d),i.Oa=i.Oa.remove(o),i.Na.delete(e),zy(i)}else await sv(i.localStore,e,!1).then((()=>ov(i,e,t))).catch(Mh)}async function kU(n,e){const t=Mt(n),i=e.batch.batchId;try{const s=await QP(t.localStore,e);fw(t,i,null),dw(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Dh(t,s)}catch(s){await Mh(s)}}async function zU(n,e,t){const i=Mt(n);try{const s=await(function(c,h){const d=Mt(c);return d.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let g;return d.mutationQueue.lookupMutationBatch(p,h).next((v=>(ln(v!==null),g=v.keys(),d.mutationQueue.removeMutationBatch(p,v)))).next((()=>d.mutationQueue.performConsistencyCheck(p))).next((()=>d.documentOverlayCache.removeOverlaysForBatchId(p,g,h))).next((()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g))).next((()=>d.localDocuments.getDocuments(p,g)))}))})(i.localStore,e);fw(i,e,t),dw(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Dh(i,s)}catch(s){await Mh(s)}}function dw(n,e){(n.ka.get(e)||[]).forEach((t=>{t.resolve()})),n.ka.delete(e)}function fw(n,e,t){const i=Mt(n);let s=i.Ba[i.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.Ba[i.currentUser.toKey()]=s}}function ov(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach((i=>{n.La.containsKey(i)||pw(n,i)}))}function pw(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Iy(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),zy(n))}function $x(n,e,t){for(const i of t)i instanceof lw?(n.La.addReference(i.key,e),BU(n,i)):i instanceof cw?(at("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||pw(n,i.key)):xt()}function BU(n,e){const t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(at("SyncEngine","New document in limbo: "+t),n.xa.add(i),zy(n))}function zy(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new dt(An.fromString(e)),i=n.qa.next();n.Na.set(i,new IU(t)),n.Oa=n.Oa.insert(t,i),nw(n.remoteStore,new Va(us(Sp(t.path)),i,"TargetPurposeLimboResolution",_y.oe))}}async function Dh(n,e,t){const i=Mt(n),s=[],o=[],c=[];i.Fa.isEmpty()||(i.Fa.forEach(((h,d)=>{c.push(i.Ka(d,e,t).then((p=>{var g;if((p||t)&&i.isPrimaryClient){const v=p?!p.fromCache:(g=t?.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;i.sharedClientState.updateQueryState(d.targetId,v?"current":"not-current")}if(p){s.push(p);const v=Cy.Wi(d.targetId,p);o.push(v)}})))})),await Promise.all(c),i.Ca.d_(s),await(async function(d,p){const g=Mt(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>Ce.forEach(p,(y=>Ce.forEach(y.$i,(E=>g.persistence.referenceDelegate.addReference(v,y.targetId,E))).next((()=>Ce.forEach(y.Ui,(E=>g.persistence.referenceDelegate.removeReference(v,y.targetId,E)))))))))}catch(v){if(!wh(v))throw v;at("LocalStore","Failed to update sequence numbers: "+v)}for(const v of p){const y=v.targetId;if(!v.fromCache){const E=g.os.get(y),b=E.snapshotVersion,D=E.withLastLimboFreeSnapshotVersion(b);g.os=g.os.insert(y,D)}}})(i.localStore,o))}async function HU(n,e){const t=Mt(n);if(!t.currentUser.isEqual(e)){at("SyncEngine","User change. New user:",e.toKey());const i=await ZM(t.localStore,e);t.currentUser=e,(function(o,c){o.ka.forEach((h=>{h.forEach((d=>{d.reject(new Qe(we.CANCELLED,c))}))})),o.ka.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Dh(t,i.hs)}}function GU(n,e){const t=Mt(n),i=t.Na.get(e);if(i&&i.va)return Ht().add(i.key);{let s=Ht();const o=t.Ma.get(e);if(!o)return s;for(const c of o){const h=t.Fa.get(c);s=s.unionWith(h.view.Va)}return s}}function mw(n){const e=Mt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=GU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=FU.bind(null,e),e.Ca.d_=MU.bind(null,e.eventManager),e.Ca.$a=wU.bind(null,e.eventManager),e}function jU(n){const e=Mt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zU.bind(null,e),e}class ap{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Rp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return $P(this.persistence,new YP,e.initialUser,this.serializer)}Ga(e){return new qP(Ry.Zr,this.serializer)}Wa(e){return new iU}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ap.provider={build:()=>new ap};class lv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Kx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=HU.bind(null,this.syncEngine),await xU(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new AU})()}createDatastore(e){const t=Rp(e.databaseInfo.databaseId),i=(function(o){return new oU(o)})(e.databaseInfo);return(function(o,c,h,d){return new uU(o,c,h,d)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,o,c,h){return new dU(i,s,o,c,h)})(this.localStore,this.datastore,e.asyncQueue,(t=>Kx(this.syncEngine,t,0)),(function(){return jx.D()?new jx:new rU})())}createSyncEngine(e,t){return(function(s,o,c,h,d,p,g){const v=new DU(s,o,c,h,d,p);return g&&(v.Qa=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const o=Mt(s);at("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await Ih(o),o.k_.shutdown(),o.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}lv.provider={build:()=>new lv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Js("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=wi.UNAUTHENTICATED,this.clientId=yM.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,(async c=>{at("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(at("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ks;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ly(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Qg(n,e){n.asyncQueue.verifyOperationInProgress(),at("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await ZM(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Qx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await WU(n);at("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>qx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>qx(e.remoteStore,s))),n._onlineComponents=e}async function WU(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){at("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===we.FAILED_PRECONDITION||s.code===we.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;yc("Error using user provided cache. Falling back to memory cache: "+t),await Qg(n,new ap)}}else at("FirestoreClient","Using default OfflineComponentProvider"),await Qg(n,new ap);return n._offlineComponents}async function gw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(at("FirestoreClient","Using user provided OnlineComponentProvider"),await Qx(n,n._uninitializedComponentsProvider._online)):(at("FirestoreClient","Using default OnlineComponentProvider"),await Qx(n,new lv))),n._onlineComponents}function XU(n){return gw(n).then((e=>e.syncEngine))}async function op(n){const e=await gw(n),t=e.eventManager;return t.onListen=NU.bind(null,e.syncEngine),t.onUnlisten=LU.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=PU.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=OU.bind(null,e.syncEngine),t}function YU(n,e,t={}){const i=new Ks;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,p){const g=new By({next:y=>{g.Za(),c.enqueueAndForget((()=>Vy(o,v)));const E=y.docs.has(h);!E&&y.fromCache?p.reject(new Qe(we.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&y.fromCache&&d&&d.source==="server"?p.reject(new Qe(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(y)},error:y=>p.reject(y)}),v=new ky(Sp(h.path),g,{includeMetadataChanges:!0,_a:!0});return Oy(o,v)})(await op(n),n.asyncQueue,e,t,i))),i.promise}function KU(n,e,t={}){const i=new Ks;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,h,d,p){const g=new By({next:y=>{g.Za(),c.enqueueAndForget((()=>Vy(o,v))),y.fromCache&&d.source==="server"?p.reject(new Qe(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(y)},error:y=>p.reject(y)}),v=new ky(h,g,{includeMetadataChanges:!0,_a:!0});return Oy(o,v)})(await op(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(n,e,t){if(!t)throw new Qe(we.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $U(n,e,t,i){if(e===!0&&i===!0)throw new Qe(we.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Jx(n){if(!dt.isDocumentKey(n))throw new Qe(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function eb(n){if(dt.isDocumentKey(n))throw new Qe(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Dp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":xt()}function Fi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Qe(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Dp(n);throw new Qe(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new Qe(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Qe(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$U("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_w((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Qe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Qe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Qe(we.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Np{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tb({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Qe(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Qe(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tb(e),e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new p2;switch(i.type){case"firstParty":return new v2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Qe(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Zx.get(t);i&&(at("ComponentProvider","Removing Datastore"),Zx.delete(t),i.terminate())})(this),Promise.resolve()}}function QU(n,e,t,i={}){var s;const o=(n=Fi(n,Np))._getSettings(),c=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==c&&yc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),i.mockUserToken){let h,d;if(typeof i.mockUserToken=="string")h=i.mockUserToken,d=wi.MOCK_USER;else{h=wC(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Qe(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new wi(p)}n._authCredentials=new m2(new vM(h,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new eo(this.firestore,e,this._query)}}class Ci{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ba(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ci(this.firestore,e,this._key)}}class Ba extends eo{constructor(e,t,i){super(e,t,Sp(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ci(this.firestore,null,new dt(e))}withConverter(e){return new Ba(this.firestore,e,this._path)}}function Ma(n,e,...t){if(n=Nn(n),vw("collection","path",e),n instanceof Np){const i=An.fromString(e,...t);return eb(i),new Ba(n,null,i)}{if(!(n instanceof Ci||n instanceof Ba))throw new Qe(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(An.fromString(e,...t));return eb(i),new Ba(n.firestore,null,i)}}function Ui(n,e,...t){if(n=Nn(n),arguments.length===1&&(e=yM.newId()),vw("doc","path",e),n instanceof Np){const i=An.fromString(e,...t);return Jx(i),new Ci(n,null,new dt(i))}{if(!(n instanceof Ci||n instanceof Ba))throw new Qe(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(An.fromString(e,...t));return Jx(i),new Ci(n.firestore,n instanceof Ba?n.converter:null,new dt(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ew(this,"async_queue_retry"),this.Vu=()=>{const i=$g();i&&at("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;const t=$g();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=$g();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Ks;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!wh(e))throw e;at("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((i=>{this.Eu=i,this.du=!1;const s=(function(c){let h=c.message||"";return c.stack&&(h=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),h})(i);throw Js("INTERNAL UNHANDLED ERROR: ",s),i})).then((i=>(this.du=!1,i))))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=Uy.createAndSchedule(this,e,t,i,(o=>this.yu(o)));return this.Tu.push(s),s}fu(){this.Eu&&xt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function ib(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1})(n,["next","error","complete"])}class ps extends Np{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new nb,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new nb(e),this._firestoreClient=void 0,await e}}}function ZU(n,e){const t=typeof n=="object"?n:ry(),i=typeof n=="string"?n:"(default)",s=il(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=AC("firestore");o&&QU(s,...o)}return s}function Nh(n){if(n._terminated)throw new Qe(we.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||JU(n),n._firestoreClient}function JU(n){var e,t,i;const s=n._freezeSettings(),o=(function(h,d,p,g){return new D2(h,d,p,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,_w(g.experimentalLongPollingOptions),g.useFetchStreams)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new qU(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(h){const d=h?._online.build();return{_offline:h?._offline.build(d),_online:d}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ac(Ei.fromBase64String(e))}catch(t){throw new Qe(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ac(Ei.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Qe(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _i(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Qe(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Qe(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return nn(this._lat,e._lat)||nn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0})(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL=/^__.*__$/;class tL{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Ja(e,this.data,this.fieldMask,t,this.fieldTransforms):new Rh(e,this.data,t,this.fieldTransforms)}}class yw{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Ja(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ew(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xt()}}class qy{constructor(e,t,i,s,o,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new qy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.Ou(e),s}Nu(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:i,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return lp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Ew(this.Cu)&&eL.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class nL{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Rp(e)}Qu(e,t,i,s=!1){return new qy({Cu:e,methodName:t,qu:i,path:_i.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uh(n){const e=n._freezeSettings(),t=Rp(n._databaseId);return new nL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Wy(n,e,t,i,s,o={}){const c=n.Qu(o.merge||o.mergeFields?2:0,e,t,s);Xy("Data must be an object, but it was:",c,i);const h=xw(i,c);let d,p;if(o.merge)d=new sr(c.fieldMask),p=c.fieldTransforms;else if(o.mergeFields){const g=[];for(const v of o.mergeFields){const y=cv(e,v,t);if(!c.contains(y))throw new Qe(we.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Aw(g,y)||g.push(y)}d=new sr(g),p=c.fieldTransforms.filter((v=>d.covers(v.field)))}else d=null,p=c.fieldTransforms;return new tL(new qi(h),d,p)}class Pp extends Hy{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pp}}function Sw(n,e,t,i){const s=n.Qu(1,e,t);Xy("Data must be an object, but it was:",s,i);const o=[],c=qi.empty();rl(i,((d,p)=>{const g=Yy(e,d,t);p=Nn(p);const v=s.Nu(g);if(p instanceof Pp)o.push(g);else{const y=Lh(p,v);y!=null&&(o.push(g),c.set(g,y))}}));const h=new sr(o);return new yw(c,h,s.fieldTransforms)}function Tw(n,e,t,i,s,o){const c=n.Qu(1,e,t),h=[cv(e,i,t)],d=[s];if(o.length%2!=0)throw new Qe(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<o.length;y+=2)h.push(cv(e,o[y])),d.push(o[y+1]);const p=[],g=qi.empty();for(let y=h.length-1;y>=0;--y)if(!Aw(p,h[y])){const E=h[y];let b=d[y];b=Nn(b);const D=c.Nu(E);if(b instanceof Pp)p.push(E);else{const A=Lh(b,D);A!=null&&(p.push(E),g.set(E,A))}}const v=new sr(p);return new yw(g,v,c.fieldTransforms)}function iL(n,e,t,i=!1){return Lh(t,n.Qu(i?4:3,e))}function Lh(n,e){if(bw(n=Nn(n)))return Xy("Unsupported field value:",e,n),xw(n,e);if(n instanceof Hy)return(function(i,s){if(!Ew(s.Cu))throw s.Bu(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(i,s){const o=[];let c=0;for(const h of i){let d=Lh(h,s.Lu(c));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),c++}return{arrayValue:{values:o}}})(n,e)}return(function(i,s){if((i=Nn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return J2(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=ei.fromDate(i);return{timestampValue:rp(s.serializer,o)}}if(i instanceof ei){const o=new ei(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:rp(s.serializer,o)}}if(i instanceof Gy)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Ac)return{bytesValue:qM(s.serializer,i._byteString)};if(i instanceof Ci){const o=s.databaseId,c=i.firestore._databaseId;if(!c.isEqual(o))throw s.Bu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:My(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof jy)return(function(c,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map((d=>{if(typeof d!="number")throw h.Bu("VectorValues must only contain numeric values.");return xy(h.serializer,d)}))}}}}}})(i,s);throw s.Bu(`Unsupported field value: ${Dp(i)}`)})(n,e)}function xw(n,e){const t={};return EM(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):rl(n,((i,s)=>{const o=Lh(s,e.Mu(i));o!=null&&(t[i]=o)})),{mapValue:{fields:t}}}function bw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ei||n instanceof Gy||n instanceof Ac||n instanceof Ci||n instanceof Hy||n instanceof jy)}function Xy(n,e,t){if(!bw(t)||!(function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)})(t)){const i=Dp(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function cv(n,e,t){if((e=Nn(e))instanceof Ph)return e._internalPath;if(typeof e=="string")return Yy(n,e);throw lp("Field path arguments must be of type string or ",n,!1,void 0,t)}const rL=new RegExp("[~\\*/\\[\\]]");function Yy(n,e,t){if(e.search(rL)>=0)throw lp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ph(...e.split("."))._internalPath}catch{throw lp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lp(n,e,t,i,s){const o=i&&!i.isEmpty(),c=s!==void 0;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let d="";return(o||c)&&(d+=" (found",o&&(d+=` in field ${i}`),c&&(d+=` in document ${s}`),d+=")"),new Qe(we.INVALID_ARGUMENT,h+n+d)}function Aw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ci(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ky("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class sL extends Mw{data(){return super.data()}}function Ky(n,e){return typeof e=="string"?Yy(n,e):e instanceof Ph?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Qe(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $y{}class Rw extends $y{}function Zg(n,e,...t){let i=[];e instanceof $y&&i.push(e),i=i.concat(t),(function(o){const c=o.filter((d=>d instanceof Zy)).length,h=o.filter((d=>d instanceof Qy)).length;if(c>1||c>0&&h>0)throw new Qe(we.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class Qy extends Rw{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Qy(e,t,i)}_apply(e){const t=this._parse(e);return Cw(e._query,t),new eo(e.firestore,e.converter,J_(e._query,t))}_parse(e){const t=Uh(e.firestore);return(function(o,c,h,d,p,g,v){let y;if(p.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new Qe(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){sb(v,g);const E=[];for(const b of v)E.push(rb(d,o,b));y={arrayValue:{values:E}}}else y=rb(d,o,v)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||sb(v,g),y=iL(h,c,v,g==="in"||g==="not-in");return Yn.create(p,g,y)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Zy extends $y{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Zy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:jr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,o){let c=s;const h=o.getFlattenedFilters();for(const d of h)Cw(c,d),c=J_(c,d)})(e._query,t),new eo(e.firestore,e.converter,J_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Jy extends Rw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Jy(e,t)}_apply(e){const t=(function(s,o,c){if(s.startAt!==null)throw new Qe(we.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Qe(we.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fh(o,c)})(e._query,this._field,this._direction);return new eo(e.firestore,e.converter,(function(s,o){const c=s.explicitOrderBy.concat([o]);return new Uc(s.path,s.collectionGroup,c,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function Jg(n,e="asc"){const t=e,i=Ky("orderBy",n);return Jy._create(i,t)}function rb(n,e,t){if(typeof(t=Nn(t))=="string"){if(t==="")throw new Qe(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!CM(e)&&t.indexOf("/")!==-1)throw new Qe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(An.fromString(t));if(!dt.isDocumentKey(i))throw new Qe(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ax(n,new dt(i))}if(t instanceof Ci)return Ax(n,t._key);throw new Qe(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Dp(t)}.`)}function sb(n,e){if(!Array.isArray(n)||n.length===0)throw new Qe(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Cw(n,e){const t=(function(s,o){for(const c of s)for(const h of c.getFlattenedFilters())if(o.indexOf(h.op)>=0)return h.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Qe(we.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Qe(we.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class aL{convertValue(e,t="none"){switch($o(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ko(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xt()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return rl(e,((s,o)=>{i[s]=this.convertValue(o,t)})),i}convertVectorValue(e){var t,i,s;const o=(s=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map((c=>Bn(c.doubleValue)));return new jy(o)}convertGeoPoint(e){return new Gy(Bn(e.latitude),Bn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=yy(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(uh(e));default:return null}}convertTimestamp(e){const t=Wa(e);return new ei(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=An.fromString(e);ln(QM(i));const s=new hh(i.get(1),i.get(3)),o=new dt(i.popFirst(5));return s.isEqual(t)||Js(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Iw extends Mw{constructor(e,t,i,s,o,c){super(e,t,i,s,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Bf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Ky("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Bf extends Iw{data(e={}){return super.data(e)}}class Dw{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Qu(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Bf(this._firestore,this._userDataWriter,i.key,i,new Qu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Qe(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map((h=>{const d=new Bf(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Qu(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:c++}}))}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((h=>o||h.type!==3)).map((h=>{const d=new Bf(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Qu(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,g=-1;return h.type!==0&&(p=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),g=c.indexOf(h.doc.key)),{type:oL(h.type),doc:d,oldIndex:p,newIndex:g}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function oL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(n){n=Fi(n,Ci);const e=Fi(n.firestore,ps);return YU(Nh(e),n._key).then((t=>Nw(e,n,t)))}class t0 extends aL{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ac(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ci(this.firestore,null,t)}}function e_(n){n=Fi(n,eo);const e=Fi(n.firestore,ps),t=Nh(e),i=new t0(e);return ww(n._query),KU(t,n._query).then((s=>new Dw(e,i,n,s)))}function lL(n,e,t){n=Fi(n,Ci);const i=Fi(n.firestore,ps),s=e0(n.converter,e,t);return Oh(i,[Wy(Uh(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Vi.none())])}function Ro(n,e,t,...i){n=Fi(n,Ci);const s=Fi(n.firestore,ps),o=Uh(s);let c;return c=typeof(e=Nn(e))=="string"||e instanceof Ph?Tw(o,"updateDoc",n._key,e,t,i):Sw(o,"updateDoc",n._key,e),Oh(s,[c.toMutation(n._key,Vi.exists(!0))])}function cL(n){return Oh(Fi(n.firestore,ps),[new Mp(n._key,Vi.none())])}function uL(n,e){const t=Fi(n.firestore,ps),i=Ui(n),s=e0(n.converter,e);return Oh(t,[Wy(Uh(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,Vi.exists(!1))]).then((()=>i))}function of(n,...e){var t,i,s;n=Nn(n);let o={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||ib(e[c])||(o=e[c],c++);const h={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(ib(e[c])){const v=e[c];e[c]=(t=v.next)===null||t===void 0?void 0:t.bind(v),e[c+1]=(i=v.error)===null||i===void 0?void 0:i.bind(v),e[c+2]=(s=v.complete)===null||s===void 0?void 0:s.bind(v)}let d,p,g;if(n instanceof Ci)p=Fi(n.firestore,ps),g=Sp(n._key.path),d={next:v=>{e[c]&&e[c](Nw(p,n,v))},error:e[c+1],complete:e[c+2]};else{const v=Fi(n,eo);p=Fi(v.firestore,ps),g=v._query;const y=new t0(p);d={next:E=>{e[c]&&e[c](new Dw(p,y,v,E))},error:e[c+1],complete:e[c+2]},ww(n._query)}return(function(y,E,b,D){const A=new By(D),T=new ky(E,A,b);return y.asyncQueue.enqueueAndForget((async()=>Oy(await op(y),T))),()=>{A.Za(),y.asyncQueue.enqueueAndForget((async()=>Vy(await op(y),T)))}})(Nh(p),g,h,d)}function Oh(n,e){return(function(i,s){const o=new Ks;return i.asyncQueue.enqueueAndForget((async()=>VU(await XU(i),s,o))),o.promise})(Nh(n),e)}function Nw(n,e,t){const i=t.docs.get(e._key),s=new t0(n);return new Iw(n,s,e._key,i,new Qu(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Uh(e)}set(e,t,i){this._verifyNotCommitted();const s=t_(e,this._firestore),o=e0(s.converter,t,i),c=Wy(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,i);return this._mutations.push(c.toMutation(s._key,Vi.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const o=t_(e,this._firestore);let c;return c=typeof(t=Nn(t))=="string"||t instanceof Ph?Tw(this._dataReader,"WriteBatch.update",o._key,t,i,s):Sw(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(c.toMutation(o._key,Vi.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=t_(e,this._firestore);return this._mutations=this._mutations.concat(new Mp(t._key,Vi.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Qe(we.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function t_(n,e){if((n=Nn(n)).firestore!==e)throw new Qe(we.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(n){return Nh(n=Fi(n,ps)),new hL(n,(e=>Oh(n,e)))}(function(e,t=!0){(function(s){Pc=s})(Dc),ds(new Gr("firestore",((i,{instanceIdentifier:s,options:o})=>{const c=i.getProvider("app").getImmediate(),h=new ps(new g2(i.getProvider("auth-internal")),new E2(i.getProvider("app-check-internal")),(function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Qe(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hh(p.options.projectId,g)})(c,s),c);return o=Object.assign({useFetchStreams:t},o),h._setSettings(o),h}),"PUBLIC").setMultipleInstances(!0)),wr(Ex,"4.7.3",e),wr(Ex,"4.7.3","esm2017")})();const Pw="@firebase/installations",n0="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw=1e4,Lw=`w:${n0}`,Ow="FIS_v2",dL="https://firebaseinstallations.googleapis.com/v1",fL=3600*1e3,pL="installations",mL="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Qo=new nl(pL,mL,gL);function Vw(n){return n instanceof Wr&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw({projectId:n}){return`${dL}/projects/${n}/installations`}function kw(n){return{token:n.token,requestStatus:2,expiresIn:vL(n.expiresIn),creationTime:Date.now()}}async function zw(n,e){const i=(await e.json()).error;return Qo.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function Bw({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function _L(n,{refreshToken:e}){const t=Bw(n);return t.append("Authorization",yL(e)),t}async function Hw(n){const e=await n();return e.status>=500&&e.status<600?n():e}function vL(n){return Number(n.replace("s","000"))}function yL(n){return`${Ow} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EL({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=Fw(n),s=Bw(n),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const c={fid:t,authVersion:Ow,appId:n.appId,sdkVersion:Lw},h={method:"POST",headers:s,body:JSON.stringify(c)},d=await Hw(()=>fetch(i,h));if(d.ok){const p=await d.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:kw(p.authToken)}}else throw await zw("Create Installation",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL=/^[cdef][\w-]{21}$/,uv="";function xL(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=bL(n);return TL.test(t)?t:uv}catch{return uv}}function bL(n){return SL(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw=new Map;function qw(n,e){const t=Up(n);Ww(t,e),AL(t,e)}function Ww(n,e){const t=jw.get(n);if(t)for(const i of t)i(e)}function AL(n,e){const t=ML();t&&t.postMessage({key:n,fid:e}),wL()}let Ho=null;function ML(){return!Ho&&"BroadcastChannel"in self&&(Ho=new BroadcastChannel("[Firebase] FID Change"),Ho.onmessage=n=>{Ww(n.data.key,n.data.fid)}),Ho}function wL(){jw.size===0&&Ho&&(Ho.close(),Ho=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL="firebase-installations-database",CL=1,Zo="firebase-installations-store";let n_=null;function i0(){return n_||(n_=CA(RL,CL,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Zo)}}})),n_}async function cp(n,e){const t=Up(n),s=(await i0()).transaction(Zo,"readwrite"),o=s.objectStore(Zo),c=await o.get(t);return await o.put(e,t),await s.done,(!c||c.fid!==e.fid)&&qw(n,e.fid),e}async function Xw(n){const e=Up(n),i=(await i0()).transaction(Zo,"readwrite");await i.objectStore(Zo).delete(e),await i.done}async function Lp(n,e){const t=Up(n),s=(await i0()).transaction(Zo,"readwrite"),o=s.objectStore(Zo),c=await o.get(t),h=e(c);return h===void 0?await o.delete(t):await o.put(h,t),await s.done,h&&(!c||c.fid!==h.fid)&&qw(n,h.fid),h}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r0(n){let e;const t=await Lp(n.appConfig,i=>{const s=IL(i),o=DL(n,s);return e=o.registrationPromise,o.installationEntry});return t.fid===uv?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function IL(n){const e=n||{fid:xL(),registrationStatus:0};return Yw(e)}function DL(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Qo.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=NL(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:PL(n)}:{installationEntry:e}}async function NL(n,e){try{const t=await EL(n,e);return cp(n.appConfig,t)}catch(t){throw Vw(t)&&t.customData.serverCode===409?await Xw(n.appConfig):await cp(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function PL(n){let e=await ob(n.appConfig);for(;e.registrationStatus===1;)await Gw(100),e=await ob(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await r0(n);return i||t}return e}function ob(n){return Lp(n,e=>{if(!e)throw Qo.create("installation-not-found");return Yw(e)})}function Yw(n){return UL(n)?{fid:n.fid,registrationStatus:0}:n}function UL(n){return n.registrationStatus===1&&n.registrationTime+Uw<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LL({appConfig:n,heartbeatServiceProvider:e},t){const i=OL(n,t),s=_L(n,t),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const c={installation:{sdkVersion:Lw,appId:n.appId}},h={method:"POST",headers:s,body:JSON.stringify(c)},d=await Hw(()=>fetch(i,h));if(d.ok){const p=await d.json();return kw(p)}else throw await zw("Generate Auth Token",d)}function OL(n,{fid:e}){return`${Fw(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s0(n,e=!1){let t;const i=await Lp(n.appConfig,o=>{if(!Kw(o))throw Qo.create("not-registered");const c=o.authToken;if(!e&&kL(c))return o;if(c.requestStatus===1)return t=VL(n,e),o;{if(!navigator.onLine)throw Qo.create("app-offline");const h=BL(o);return t=FL(n,h),h}});return t?await t:i.authToken}async function VL(n,e){let t=await lb(n.appConfig);for(;t.authToken.requestStatus===1;)await Gw(100),t=await lb(n.appConfig);const i=t.authToken;return i.requestStatus===0?s0(n,e):i}function lb(n){return Lp(n,e=>{if(!Kw(e))throw Qo.create("not-registered");const t=e.authToken;return HL(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function FL(n,e){try{const t=await LL(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await cp(n.appConfig,i),t}catch(t){if(Vw(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await Xw(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await cp(n.appConfig,i)}throw t}}function Kw(n){return n!==void 0&&n.registrationStatus===2}function kL(n){return n.requestStatus===2&&!zL(n)}function zL(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+fL}function BL(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function HL(n){return n.requestStatus===1&&n.requestTime+Uw<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GL(n){const e=n,{installationEntry:t,registrationPromise:i}=await r0(e);return i?i.catch(console.error):s0(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jL(n,e=!1){const t=n;return await qL(t),(await s0(t,e)).token}async function qL(n){const{registrationPromise:e}=await r0(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WL(n){if(!n||!n.options)throw i_("App Configuration");if(!n.name)throw i_("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw i_(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function i_(n){return Qo.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="installations",XL="installations-internal",YL=n=>{const e=n.getProvider("app").getImmediate(),t=WL(e),i=il(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},KL=n=>{const e=n.getProvider("app").getImmediate(),t=il(e,$w).getImmediate();return{getId:()=>GL(t),getToken:s=>jL(t,s)}};function $L(){ds(new Gr($w,YL,"PUBLIC")),ds(new Gr(XL,KL,"PRIVATE"))}$L();wr(Pw,n0);wr(Pw,n0,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="analytics",QL="firebase_id",ZL="origin",JL=60*1e3,eO="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",a0="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=new gp("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ar=new nl("analytics","Analytics",tO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nO(n){if(!n.startsWith(a0)){const e=ar.create("invalid-gtag-resource",{gtagURL:n});return Xi.warn(e.message),""}return n}function Qw(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function iO(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function rO(n,e){const t=iO("firebase-js-sdk-policy",{createScriptURL:nO}),i=document.createElement("script"),s=`${a0}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function sO(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function aO(n,e,t,i,s,o){const c=i[s];try{if(c)await e[c];else{const d=(await Qw(t)).find(p=>p.measurementId===s);d&&await e[d.appId]}}catch(h){Xi.error(h)}n("config",s,o)}async function oO(n,e,t,i,s){try{let o=[];if(s&&s.send_to){let c=s.send_to;Array.isArray(c)||(c=[c]);const h=await Qw(t);for(const d of c){const p=h.find(v=>v.measurementId===d),g=p&&e[p.appId];if(g)o.push(g);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),n("event",i,s||{})}catch(o){Xi.error(o)}}function lO(n,e,t,i){async function s(o,...c){try{if(o==="event"){const[h,d]=c;await oO(n,e,t,h,d)}else if(o==="config"){const[h,d]=c;await aO(n,e,t,i,h,d)}else if(o==="consent"){const[h,d]=c;n("consent",h,d)}else if(o==="get"){const[h,d,p]=c;n("get",h,d,p)}else if(o==="set"){const[h]=c;n("set",h)}else n(o,...c)}catch(h){Xi.error(h)}}return s}function cO(n,e,t,i,s){let o=function(...c){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=lO(o,n,e,t),{gtagCore:o,wrappedGtag:window[s]}}function uO(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(a0)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=30,dO=1e3;class fO{constructor(e={},t=dO){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Zw=new fO;function pO(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function mO(n){var e;const{appId:t,apiKey:i}=n,s={method:"GET",headers:pO(i)},o=eO.replace("{app-id}",t),c=await fetch(o,s);if(c.status!==200&&c.status!==304){let h="";try{const d=await c.json();!((e=d.error)===null||e===void 0)&&e.message&&(h=d.error.message)}catch{}throw ar.create("config-fetch-failed",{httpStatus:c.status,responseMessage:h})}return c.json()}async function gO(n,e=Zw,t){const{appId:i,apiKey:s,measurementId:o}=n.options;if(!i)throw ar.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw ar.create("no-api-key")}const c=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new yO;return setTimeout(async()=>{h.abort()},JL),Jw({appId:i,apiKey:s,measurementId:o},c,h,e)}async function Jw(n,{throttleEndTimeMillis:e,backoffCount:t},i,s=Zw){var o;const{appId:c,measurementId:h}=n;try{await _O(i,e)}catch(d){if(h)return Xi.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${d?.message}]`),{appId:c,measurementId:h};throw d}try{const d=await mO(n);return s.deleteThrottleMetadata(c),d}catch(d){const p=d;if(!vO(p)){if(s.deleteThrottleMetadata(c),h)return Xi.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${h} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:c,measurementId:h};throw d}const g=Number((o=p?.customData)===null||o===void 0?void 0:o.httpStatus)===503?qT(t,s.intervalMillis,hO):qT(t,s.intervalMillis),v={throttleEndTimeMillis:Date.now()+g,backoffCount:t+1};return s.setThrottleMetadata(c,v),Xi.debug(`Calling attemptFetch again in ${g} millis`),Jw(n,v,i,s)}}function _O(n,e){return new Promise((t,i)=>{const s=Math.max(e-Date.now(),0),o=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(o),i(ar.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function vO(n){if(!(n instanceof Wr)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class yO{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function EO(n,e,t,i,s){if(s&&s.global){n("event",t,i);return}else{const o=await e,c=Object.assign(Object.assign({},i),{send_to:o});n("event",t,c)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SO(){if(AA())try{await MA()}catch(n){return Xi.warn(ar.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Xi.warn(ar.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function TO(n,e,t,i,s,o,c){var h;const d=gO(n);d.then(E=>{t[E.measurementId]=E.appId,n.options.measurementId&&E.measurementId!==n.options.measurementId&&Xi.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>Xi.error(E)),e.push(d);const p=SO().then(E=>{if(E)return i.getId()}),[g,v]=await Promise.all([d,p]);uO(o)||rO(o,g.measurementId),s("js",new Date);const y=(h=c?.config)!==null&&h!==void 0?h:{};return y[ZL]="firebase",y.update=!0,v!=null&&(y[QL]=v),s("config",g.measurementId,y),g.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e){this.app=e}_delete(){return delete rh[this.app.options.appId],Promise.resolve()}}let rh={},cb=[];const ub={};let r_="dataLayer",bO="gtag",hb,eR,db=!1;function AO(){const n=[];if(bA()&&n.push("This is a browser extension environment."),UC()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,s)=>`(${s+1}) ${i}`).join(" "),t=ar.create("invalid-analytics-context",{errorInfo:e});Xi.warn(t.message)}}function MO(n,e,t){AO();const i=n.options.appId;if(!i)throw ar.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Xi.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ar.create("no-api-key");if(rh[i]!=null)throw ar.create("already-exists",{id:i});if(!db){sO(r_);const{wrappedGtag:o,gtagCore:c}=cO(rh,cb,ub,r_,bO);eR=o,hb=c,db=!0}return rh[i]=TO(n,cb,ub,e,hb,r_,t),new xO(n)}function wO(n=ry()){n=Nn(n);const e=il(n,up);return e.isInitialized()?e.getImmediate():RO(n)}function RO(n,e={}){const t=il(n,up);if(t.isInitialized()){const s=t.getImmediate();if(sh(e,t.getOptions()))return s;throw ar.create("already-initialized")}return t.initialize({options:e})}function CO(n,e,t,i){n=Nn(n),EO(eR,rh[n.app.options.appId],e,t,i).catch(s=>Xi.error(s))}const fb="@firebase/analytics",pb="0.10.8";function IO(){ds(new Gr(up,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return MO(i,s,t)},"PUBLIC")),ds(new Gr("analytics-internal",n,"PRIVATE")),wr(fb,pb),wr(fb,pb,"esm2017");function n(e){try{const t=e.getProvider(up).getImmediate();return{logEvent:(i,s,o)=>CO(t,i,s,o)}}catch(t){throw ar.create("interop-component-reg-failed",{reason:t})}}}IO();const DO={apiKey:"AIzaSyDe3twpHJjf4-f-kPYO9_3CKYa83MY7Qoc",authDomain:"iotuyapp.firebaseapp.com",projectId:"iotuyapp",storageBucket:"iotuyapp.firebasestorage.app",messagingSenderId:"375880123616",appId:"1:375880123616:web:439082786411401f407c85",measurementId:"G-K84V8W30GP"},o0=IA(DO),Fu=u2(o0),In=ZU(o0);typeof window<"u"&&wO(o0);const tR=Le.createContext({}),Op=()=>{const n=Le.useContext(tR);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},NO=({children:n})=>{const[e,t]=Le.useState(null),[i,s]=Le.useState(!0),o=async(g,v)=>{try{await KD(Fu,g,v)}catch(y){throw console.error("Login error:",y),y}},c=async(g,v)=>{try{await YD(Fu,g,v)}catch(y){throw console.error("Register error:",y),y}},h=async()=>{try{const g=new Hs;await yN(Fu,g)}catch(g){throw console.error("Google login error:",g),g}},d=async()=>{try{await JD(Fu)}catch(g){throw console.error("Logout error:",g),g}};Le.useEffect(()=>ZD(Fu,v=>{if(v){const y={uid:v.uid,email:v.email||"",displayName:v.displayName||void 0,photoURL:v.photoURL||void 0};t(y)}else t(null);s(!1)}),[]);const p={currentUser:e,loading:i,login:o,register:c,loginWithGoogle:h,logout:d};return x.jsx(tR.Provider,{value:p,children:n})};class PO{async getUserSettings(e){try{const t=Ui(In,"userSettings",e),i=await wo(t);return i.exists()?{id:i.id,...i.data()}:null}catch(t){throw console.error("Error getting user settings:",t),new Error("Nepodařilo se načíst uživatelská nastavení")}}async createDefaultUserSettings(e){const t={uid:e,theme:"light",language:"cs",notifications:!0,createdAt:Date.now(),updatedAt:Date.now(),preferences:{autoRefreshInterval:30,showOfflineDevices:!0,defaultRoomView:"grid",soundEnabled:!0,emailNotifications:!1,showEmptyRooms:!0,roomSortOrder:"name"},tuyaConfig:{hasValidCredentials:!1,lastSync:0,deviceCount:0}};try{await this.createUserSettings(t);const i=await this.createDefaultRoom(e),s={...t.preferences,defaultRoomId:i};return await this.updateUserSettings(e,{preferences:s}),{...t,preferences:s}}catch(i){throw console.error("Error creating default user settings:",i),new Error("Nepodařilo se vytvořit výchozí nastavení")}}async createUserSettings(e){try{const t=Ui(In,"userSettings",e.uid);await lL(t,e)}catch(t){throw console.error("Error creating user settings:",t),t}}async updateUserSettings(e,t){try{const i=Ui(In,"userSettings",e);await Ro(i,{...t,updatedAt:Date.now()})}catch(i){throw console.error("Error updating user settings:",i),new Error("Nepodařilo se aktualizovat nastavení")}}async updateDocument(e,t,i){try{const s=Ui(In,e,t);await Ro(s,{...i,updatedAt:Date.now()})}catch(s){throw console.error(`Error updating document in ${e}:`,s),new Error(`Nepodařilo se aktualizovat dokument v kolekci ${e}`)}}async createDefaultRoom(e){try{const i=(await this.getUserRooms(e)).find(c=>c.isDefault);if(i)return console.log("Default room already exists:",i.id),i.id;const s={name:"Výchozí místnost",description:"Automaticky vytvořená výchozí místnost",devices:[],owner:e,createdAt:Date.now(),updatedAt:Date.now(),color:"#007bff",icon:"🏠",isDefault:!0},o=await this.createRoom(e,s);return console.log("New default room created:",o),o}catch(t){throw console.error("Error in createDefaultRoom:",t),t}}async createRoom(e,t){try{const i=Ma(In,"users",e,"rooms");return(await uL(i,{...t,owner:e,createdAt:Date.now(),updatedAt:Date.now()})).id}catch(i){throw console.error("Error creating room:",i),new Error("Nepodařilo se vytvořit místnost")}}async updateRoomLayout(e,t,i){if(!e||!t)throw new Error("User ID and Room ID are required");try{const s=Ui(In,"users",e,"rooms",t);await Ro(s,{layout:i,updatedAt:Date.now()}),console.log(`Room ${t} layout updated:`,i)}catch(s){throw console.error("Error updating room layout:",s),new Error("Failed to update room layout")}}async deleteRoom(e,t){try{const i=Ui(In,"users",e,"rooms",t),s=await wo(i);if(s.exists()&&s.data().isDefault)throw new Error("Nelze smazat výchozí místnost");await cL(i)}catch(i){throw console.error("Error deleting room:",i),i instanceof Error?i:new Error("Nepodařilo se smazat místnost")}}async saveUserDevices(e,t){try{const i=ab(In),s=Ma(In,"users",e,"devices");(await e_(s)).forEach(c=>{i.delete(c.ref)}),t.forEach(c=>{const h=Ui(s,c.id);i.set(h,{...c,lastUpdated:Date.now(),isVisible:!0})}),await i.commit()}catch(i){throw console.error("Error saving user devices:",i),new Error("Nepodařilo se uložit zařízení")}}async getUserDevices(e){try{const t=Ma(In,"users",e,"devices"),i=await e_(t),s=[];return i.forEach(o=>{s.push({id:o.id,...o.data()})}),s}catch(t){throw console.error("Error getting user devices:",t),new Error("Nepodařilo se načíst zařízení")}}async updateDevice(e,t,i){try{const s=Ui(In,"users",e,"devices",t);await Ro(s,{...i,lastUpdated:Date.now()})}catch(s){throw console.error("Error updating device:",s),new Error("Nepodařilo se aktualizovat zařízení")}}listenToUserRooms(e,t){const i=Ma(In,"users",e,"rooms"),s=Zg(i,Jg("createdAt","asc"));return of(s,o=>{const c=[];o.forEach(h=>{c.push({id:h.id,...h.data()})}),t(c)},o=>{console.error("Error listening to rooms:",o)})}listenToUserDevices(e,t){const i=Ma(In,"users",e,"devices");return of(i,s=>{const o=[];s.forEach(c=>{o.push({id:c.id,...c.data()})}),t(o)},s=>{console.error("Error listening to devices:",s)})}async moveDeviceToRoom(e,t,i,s){try{const o=ab(In),c=Ui(In,"users",e,"devices",t);if(o.update(c,{roomId:s,lastUpdated:Date.now()}),i){const p=Ui(In,"users",e,"rooms",i),g=await wo(p);if(g.exists()){const v=(g.data().devices||[]).filter(y=>y!==t);o.update(p,{devices:v,updatedAt:Date.now()})}}const h=Ui(In,"users",e,"rooms",s),d=await wo(h);if(d.exists()){const p=[...d.data().devices||[],t];o.update(h,{devices:[...new Set(p)],updatedAt:Date.now()})}await o.commit()}catch(o){throw console.error("Error moving device to room:",o),new Error("Nepodařilo se přesunout zařízení")}}async getUserRooms(e){try{const t=Ma(In,"users",e,"rooms"),i=Zg(t,Jg("createdAt","desc"));return(await e_(i)).docs.map(o=>({id:o.id,...o.data()}))}catch(t){throw console.error("Error getting user rooms:",t),new Error("Nepodařilo se načíst místnosti")}}async subscribeToUserRooms(e,t){try{const i=Ma(In,"users",e,"rooms"),s=Zg(i,Jg("createdAt","desc"));return of(s,o=>{const c=o.docs.map(h=>({id:h.id,...h.data()}));t(c)})}catch(i){throw console.error("Error subscribing to rooms:",i),i}}async addDeviceToRoom(e,t,i){try{const s=Ui(In,"users",e,"rooms",t),o=await wo(s);if(!o.exists())throw new Error("Místnost neexistuje");const h=[...o.data().devices||[]];h.includes(i)||(h.push(i),await Ro(s,{devices:h,updatedAt:Date.now()}))}catch(s){throw console.error("Error adding device to room:",s),new Error("Nepodařilo se přidat zařízení do místnosti")}}async removeDeviceFromRoom(e,t,i){try{const s=Ui(In,"users",e,"rooms",t),o=await wo(s);if(!o.exists())throw new Error("Místnost neexistuje");const h=(o.data().devices||[]).filter(d=>d!==i);await Ro(s,{devices:h,updatedAt:Date.now()})}catch(s){throw console.error("Error removing device from room:",s),new Error("Nepodařilo se odebrat zařízení z místnosti")}}async updateDevicePosition(e,t,i){if(console.log("FirestoreService.updateDevicePosition called"),console.log("Params:",{userId:e,deviceId:t,position:i}),!e||!t)throw new Error("User ID and Device ID are required");try{const s=Ui(In,"users",e,"devices",t);console.log("Document ref created:",s.path);const o=await wo(s);if(!o.exists())throw new Error(`Device ${t} not found in Firestore`);console.log("Current device data:",o.data()),await Ro(s,{position:i,updatedAt:Date.now()}),console.log(`Device ${t} position updated successfully:`,i)}catch(s){throw console.error("FirestoreService error:",s),s instanceof Error?new Error(`Failed to update device position: ${s.message}`):new Error("An unknown error occurred while updating device position.")}}getDeviceCategories(){return[{id:"switch",name:"switch",displayName:"Spínače a Zásuvky",icon:"🔌",color:"#007bff",description:"Chytré spínače, zásuvky a relé",defaultCommands:["switch_1","switch_led"]},{id:"light",name:"light",displayName:"Osvětlení",icon:"💡",color:"#ffc107",description:"LED žárovky, pásky a osvětlení",defaultCommands:["switch_led","bright_value","colour_data"]},{id:"sensor",name:"sensor",displayName:"Senzory",icon:"📡",color:"#28a745",description:"Teplotní, vlhkostní a pohybové senzory",defaultCommands:["temp_current","humidity_value"]},{id:"climate",name:"climate",displayName:"Klimatizace",icon:"❄️",color:"#17a2b8",description:"Klimatizace, ventilátory a topení",defaultCommands:["switch","temp_set","mode"]},{id:"security",name:"security",displayName:"Zabezpečení",icon:"🔒",color:"#dc3545",description:"Kamery, alarmy a bezpečnostní senzory",defaultCommands:["switch","alarm_switch"]},{id:"cover",name:"cover",displayName:"Žaluzie a Rolety",icon:"🪟",color:"#6f42c1",description:"Motorové žaluzie, rolety a markýzy",defaultCommands:["control","position"]},{id:"garden",name:"garden",displayName:"Zahrada",icon:"🌱",color:"#20c997",description:"Zavlažování, čerpadla a zahradní technika",defaultCommands:["switch_1","timer_1"]},{id:"other",name:"other",displayName:"Ostatní",icon:"⚙️",color:"#6c757d",description:"Ostatní chytrá zařízení",defaultCommands:["switch"]}]}async updateDeviceCustomization(e,t,i){try{const o=(await this.getUserDevices(e)).map(c=>c.id===t?{...c,...i,lastUpdated:Date.now()}:c);await this.saveUserDevices(e,o)}catch(s){throw console.error("Error updating device customization:",s),new Error("Nepodařilo se aktualizovat vlastní nastavení zařízení")}}async subscribeToUserDevices(e,t){try{const i=Ma(In,"users",e,"devices");return of(i,s=>{const o=[];s.forEach(c=>{o.push({id:c.id,...c.data()})}),t(o)})}catch(i){throw console.error("Error subscribing to user devices:",i),i}}}const Oi=new PO,UO=()=>{const{currentUser:n}=Op(),[e,t]=Le.useState([]),[i,s]=Le.useState(null),[o,c]=Le.useState(!0),[h,d]=Le.useState(null);return Le.useEffect(()=>{if(!n){t([]),s(null),c(!1);return}let v=null;return(async()=>{try{c(!0),d(null);let E=await Oi.getUserSettings(n.uid);E||(E=await Oi.createDefaultUserSettings(n.uid)),s(E),v=await Oi.subscribeToUserDevices(n.uid,t),c(!1)}catch(E){console.error("Error loading user data:",E),d(E.message||"Nepodařilo se načíst data"),c(!1)}})(),()=>{v?.()}},[n]),{devices:e,userSettings:i,loading:o,error:h,updateSettings:async v=>{if(!(!n||!i))try{await Oi.updateUserSettings(n.uid,v),s({...i,...v,updatedAt:Date.now()})}catch(y){throw d(y.message),y}},syncDevices:async v=>{if(!n)throw new Error("Not authenticated");try{await Oi.saveUserDevices(n.uid,v)}catch(y){throw d(y.message),y}}}},nR=()=>{const{currentUser:n}=Op(),[e,t]=Le.useState([]),[i,s]=Le.useState(null),[o,c]=Le.useState(!1),[h,d]=Le.useState(null);Le.useEffect(()=>{if(!n){t([]),s(null);return}let P=null;return(async()=>{c(!0),d(null);try{P=await Oi.subscribeToUserRooms(n.uid,V=>{t(V),s(j=>{const q=V.some(U=>U.id===j);return j&&q?j:V.length>0?(V.find(N=>N.isDefault)||V[0]).id:null}),c(!1)})}catch(V){V instanceof Error?(console.error("Error in rooms subscription:",V),d("Nepodařilo se načíst místnosti: "+V.message)):d("Nepodařilo se načíst místnosti"),c(!1)}})(),()=>{P&&P()}},[n]);const p=Le.useCallback(async P=>{if(!n)throw new Error("Uživatel není přihlášen");try{d(null);const k=await Oi.createRoom(n.uid,{...P,owner:n.uid,devices:P.devices||[],createdAt:Date.now(),updatedAt:Date.now()});return console.log("Room created successfully:",k),k}catch(k){const V=k instanceof Error?k.message:"Nepodařilo se vytvořit místnost";throw d(V),k}},[n]),g=Le.useCallback(async(P,k)=>{if(!n)throw new Error("Uživatel není přihlášen");try{d(null);const V=`users/${n.uid}/rooms`;await Oi.updateDocument(V,P,k),console.log("Room updated successfully")}catch(V){const j=V instanceof Error?V.message:"Nepodařilo se aktualizovat místnost";throw d(j),V}},[n]),v=Le.useCallback(async P=>{if(!n)throw new Error("Uživatel není přihlášen");try{if(d(null),await Oi.deleteRoom(n.uid,P),i===P){const k=e.filter(V=>V.id!==P);s(k.length>0?k[0].id:null)}console.log("Room deleted successfully")}catch(k){const V=k instanceof Error?k.message:"Nepodařilo se smazat místnost";throw d(V),k}},[n,i,e]),y=Le.useCallback(async(P,k)=>{if(!n)throw new Error("Uživatel není přihlášen");try{d(null),await Oi.addDeviceToRoom(n.uid,P,k),console.log("Device added to room successfully")}catch(V){const j=V instanceof Error?V.message:"Nepodařilo se přidat zařízení do místnosti";throw d(j),V}},[n]),E=Le.useCallback(async(P,k)=>{if(!n)throw new Error("Uživatel není přihlášen");try{d(null),await Oi.removeDeviceFromRoom(n.uid,P,k),console.log("Device removed from room successfully")}catch(V){const j=V instanceof Error?V.message:"Nepodařilo se odebrat zařízení z místnosti";throw d(j),V}},[n]),b=Le.useCallback(async(P,k,V)=>{if(!n)throw new Error("Uživatel není přihlášen");try{d(null),k&&await E(k,P),await y(V,P),await Oi.updateDevice(n.uid,P,{roomId:V}),console.log("Device moved between rooms successfully")}catch(j){const q=j instanceof Error?j.message:"Nepodařilo se přesunout zařízení";throw d(q),j}},[n,y,E]),D=e.find(P=>P.id===i)||null,A=Le.useCallback((P,k)=>{const V=e.find(j=>j.id===P);return V?k.filter(j=>V.devices.includes(j.id)||j.roomId===P):[]},[e]),T=Le.useCallback(P=>{const k=e.flatMap(V=>V.devices);return P.filter(V=>!k.includes(V.id)&&!V.roomId)},[e]);return{rooms:e,selectedRoomId:i,selectedRoom:D,loading:o,error:h,setSelectedRoomId:s,createRoom:p,updateRoom:g,deleteRoom:v,addDeviceToRoom:y,removeDeviceFromRoom:E,moveDeviceBetweenRooms:b,getRoomDevices:A,getUnassignedDevices:T,roomsCount:e.length,hasRooms:e.length>0}},LO=()=>{const[n,e]=Le.useState(""),[t,i]=Le.useState(""),[s,o]=Le.useState(!1),[c,h]=Le.useState(!1),[d,p]=Le.useState(""),{login:g,register:v,loginWithGoogle:y}=Op(),E=async D=>{if(D.preventDefault(),!n||!t){p("Vyplňte všechna pole");return}p(""),h(!0);try{s?await v(n,t):await g(n,t)}catch(A){p(A.message||"Došlo k chybě při přihlašování")}finally{h(!1)}},b=async()=>{p(""),h(!0);try{await y()}catch(D){p(D.message||"Došlo k chybě při přihlašování přes Google")}finally{h(!1)}};return x.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:x.jsxs("div",{style:{backgroundColor:"white",borderRadius:"20px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",width:"100%",maxWidth:"450px",padding:"50px 40px",textAlign:"center"},children:[x.jsxs("div",{style:{marginBottom:"40px"},children:[x.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#2d3748",margin:"0 0 10px 0"},children:"IoTuyApp"}),x.jsx("p",{style:{fontSize:"16px",color:"#718096",margin:0},children:"Správa vašich chytrých zařízení"})]}),x.jsxs("div",{style:{display:"flex",backgroundColor:"#f7fafc",borderRadius:"12px",padding:"4px",marginBottom:"30px"},children:[x.jsx("button",{type:"button",onClick:()=>o(!1),style:{flex:1,padding:"12px",backgroundColor:s?"transparent":"white",color:s?"#718096":"#2d3748",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer",boxShadow:s?"none":"0 2px 4px rgba(0,0,0,0.1)",transition:"all 0.2s ease"},children:"Přihlášení"}),x.jsx("button",{type:"button",onClick:()=>o(!0),style:{flex:1,padding:"12px",backgroundColor:s?"white":"transparent",color:s?"#2d3748":"#718096",border:"none",borderRadius:"8px",fontWeight:"600",cursor:"pointer",boxShadow:s?"0 2px 4px rgba(0,0,0,0.1)":"none",transition:"all 0.2s ease"},children:"Registrace"})]}),d&&x.jsx("div",{style:{backgroundColor:"#fed7d7",color:"#c53030",padding:"15px",borderRadius:"12px",marginBottom:"25px",fontSize:"14px",fontWeight:"500"},children:d}),x.jsxs("form",{onSubmit:E,style:{textAlign:"left"},children:[x.jsxs("div",{style:{marginBottom:"25px"},children:[x.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2d3748",fontSize:"14px"},children:"Email"}),x.jsx("input",{type:"email",value:n,onChange:D=>e(D.target.value),placeholder:"vas@email.com",required:!0,style:{width:"100%",padding:"16px",border:"2px solid #e2e8f0",borderRadius:"12px",fontSize:"16px",boxSizing:"border-box",transition:"border-color 0.2s ease",outline:"none"},onFocus:D=>D.target.style.borderColor="#667eea",onBlur:D=>D.target.style.borderColor="#e2e8f0"})]}),x.jsxs("div",{style:{marginBottom:"30px"},children:[x.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600",color:"#2d3748",fontSize:"14px"},children:"Heslo"}),x.jsx("input",{type:"password",value:t,onChange:D=>i(D.target.value),placeholder:"••••••••",required:!0,style:{width:"100%",padding:"16px",border:"2px solid #e2e8f0",borderRadius:"12px",fontSize:"16px",boxSizing:"border-box",transition:"border-color 0.2s ease",outline:"none"},onFocus:D=>D.target.style.borderColor="#667eea",onBlur:D=>D.target.style.borderColor="#e2e8f0"})]}),x.jsx("button",{type:"submit",disabled:c,style:{width:"100%",padding:"16px",background:c?"#a0aec0":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:c?"not-allowed":"pointer",marginBottom:"20px",transition:"all 0.2s ease",transform:c?"none":"translateY(0)"},onMouseEnter:D=>{c||(D.currentTarget.style.transform="translateY(-2px)",D.currentTarget.style.boxShadow="0 10px 25px rgba(0,0,0,0.2)")},onMouseLeave:D=>{c||(D.currentTarget.style.transform="translateY(0)",D.currentTarget.style.boxShadow="none")},children:c?"Zpracovávám...":s?"Vytvořit účet":"Přihlásit se"})]}),x.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"25px 0",color:"#718096",fontSize:"14px"},children:[x.jsx("div",{style:{flex:1,height:"1px",backgroundColor:"#e2e8f0"}}),x.jsx("span",{style:{padding:"0 15px"},children:"nebo"}),x.jsx("div",{style:{flex:1,height:"1px",backgroundColor:"#e2e8f0"}})]}),x.jsxs("button",{onClick:b,disabled:c,style:{width:"100%",padding:"16px",backgroundColor:"white",border:"2px solid #e2e8f0",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:c?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",color:"#2d3748",transition:"all 0.2s ease"},onMouseEnter:D=>{c||(D.currentTarget.style.borderColor="#667eea",D.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:D=>{c||(D.currentTarget.style.borderColor="#e2e8f0",D.currentTarget.style.transform="translateY(0)")},children:[x.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",children:[x.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),x.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),x.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),x.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Pokračovat s Google"]})]})})},OO=({onCreateRoom:n})=>{const{rooms:e,selectedRoomId:t,setSelectedRoomId:i,loading:s,error:o,createRoom:c,deleteRoom:h}=nR(),[d,p]=Le.useState(!1),[g,v]=Le.useState(""),[y,E]=Le.useState(!1),[b,D]=Le.useState(!1),A=async()=>{if(g.trim())try{E(!0);const T={name:g.trim(),description:"",devices:[],color:"#007bff",icon:"🏠",isDefault:!1};await c(T),v(""),p(!1),n?.()}catch(T){console.error("Error creating room:",T)}finally{E(!1)}};return s?x.jsx("div",{className:"room-selector loading",children:x.jsx("span",{children:"Načítám místnosti..."})}):o?x.jsx("div",{className:"room-selector error",children:x.jsxs("span",{children:["Chyba: ",o]})}):x.jsxs("div",{className:"room-tabs-container",children:[x.jsxs("div",{className:"room-tabs",children:[e.map(T=>x.jsxs("button",{className:`room-tab ${t===T.id?"active":""}`,onClick:()=>i(T.id),title:T.description||T.name,children:[x.jsx("span",{className:"room-tab-icon",children:T.icon||"🏠"}),x.jsx("span",{className:"room-tab-name",children:T.name}),T.devices&&T.devices.length>0&&x.jsx("span",{className:"room-device-count",children:T.devices.length})]},T.id)),t&&e.length>1&&x.jsx("button",{className:"room-tab delete-room",onClick:()=>D(!0),title:"Smazat aktuální místnost",children:x.jsxs("div",{className:"room-info",children:[x.jsx("span",{className:"room-icon-modern danger",children:"🗑️"}),x.jsxs("div",{className:"room-details",children:[x.jsx("span",{className:"room-name-modern",children:"Smazat místnost"}),x.jsx("span",{className:"room-description",children:"Aktuální místnost"})]})]})}),d?x.jsxs("div",{className:"create-room-form-modern",children:[x.jsxs("div",{className:"form-header",children:[x.jsx("span",{className:"form-icon",children:"✨"}),x.jsx("span",{className:"form-title",children:"Vytvořit místnost"})]}),x.jsx("div",{className:"form-input-group",children:x.jsx("input",{type:"text",value:g,onChange:T=>v(T.target.value),placeholder:"Název místnosti...",className:"room-input-modern",disabled:y,onKeyPress:T=>T.key==="Enter"&&A()})}),x.jsxs("div",{className:"form-actions",children:[x.jsx("button",{onClick:()=>{p(!1),v("")},className:"btn-form-cancel",disabled:y,children:"Zrušit"}),x.jsx("button",{onClick:A,className:"btn-form-create",disabled:y||!g.trim(),children:y?x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"btn-loading-spinner"}),"Vytvářím..."]}):x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"btn-icon",children:"✓"}),"Vytvořit"]})})]})]}):x.jsx("button",{className:"room-tab create-room",onClick:()=>p(!0),title:"Vytvořit novou místnost",children:x.jsxs("div",{className:"room-info",children:[x.jsx("span",{className:"room-icon-modern create",children:"➕"}),x.jsxs("div",{className:"room-details",children:[x.jsx("span",{className:"room-name-modern",children:"Nová místnost"}),x.jsx("span",{className:"room-description",children:"Klikněte pro vytvoření"})]})]})})]}),b&&x.jsx("div",{className:"modal-overlay-modern",children:x.jsxs("div",{className:"modal-modern",children:[x.jsx("div",{className:"modal-header-modern",children:x.jsxs("h4",{className:"modal-title",children:[x.jsx("span",{className:"modal-icon",children:"⚠️"}),"Smazat místnost"]})}),x.jsxs("div",{className:"modal-body-modern",children:[x.jsxs("p",{children:['Opravdu chcete smazat místnost "',e.find(T=>T.id===t)?.name,'"?']}),x.jsx("p",{className:"modal-warning",children:'Tato akce je nevratná. Všechna zařízení v této místnosti budou přesunuta do kategorie "Nepřiřazeno".'})]}),x.jsxs("div",{className:"modal-footer-modern",children:[x.jsx("button",{type:"button",className:"btn-modal-cancel",onClick:()=>D(!1),children:"Zrušit"}),x.jsxs("button",{type:"button",className:"btn-modal-delete",onClick:async()=>{try{t&&await h(t),D(!1)}catch(T){console.error("Error deleting room:",T)}},children:[x.jsx("span",{className:"btn-icon",children:"🗑️"}),"Smazat"]})]})]})})]})},VO=({device:n,isControlling:e,onControl:t,className:i="",rooms:s,onRoomChange:o})=>{const c=Oi.getDeviceCategories(),h=c.find(b=>b.name===n.category||b.id===n.category)||c.find(b=>b.id==="other"),d=n.status?.find(b=>b.code==="switch_1"||b.code==="switch"||b.code==="switch_led"),p=n.status?.find(b=>b.code==="temp_current"),g=n.status?.find(b=>b.code==="humidity_value"),v=n.status?.find(b=>b.code==="bright_value"),y=()=>{d&&t(n.id,[{code:d.code,value:!d.value}])},E=()=>n.customName||n.name||"Neznámé zařízení";return x.jsxs("article",{className:`device-modern-card ${i} ${n.online?"":"offline"} ${d?.value?"active":"inactive"}`,"data-device-id":n.id,children:[x.jsxs("header",{className:"device-modern-header",children:[x.jsxs("div",{className:"device-category-badge",style:{backgroundColor:`${h.color}15`},children:[x.jsx("span",{className:"category-icon",style:{color:h.color},children:n.customIcon||h.icon}),x.jsx("span",{className:"category-label",children:h.displayName})]}),x.jsxs("div",{className:"device-status-indicator",children:[x.jsx("div",{className:`status-dot ${n.online?"online":"offline"}`}),x.jsx("span",{className:"status-text",children:n.online?"Online":"Offline"})]})]}),x.jsxs("div",{className:"device-title-section",children:[x.jsx("h3",{className:"device-title",title:n.name,children:E()}),n.customName&&x.jsx("p",{className:"device-original-name",title:`Původní název: ${n.name}`,children:n.name})]}),x.jsxs("div",{className:"device-room-assignment",children:[x.jsx("label",{className:"room-label",children:"Místnost:"}),x.jsxs("select",{value:n.roomId||"",onChange:b=>o?.(n.id,b.target.value||null),className:"room-select modern-select",children:[x.jsx("option",{value:"",children:"Nepřiřazeno"}),s?.map(b=>x.jsxs("option",{value:b.id,children:[b.icon," ",b.name]},b.id))]})]}),d&&x.jsx("div",{className:"device-main-control",children:x.jsx("button",{onClick:y,disabled:e||!n.online,className:`main-control-button ${d.value?"on":"off"}`,style:{background:d.value?`linear-gradient(135deg, ${h.color}, ${h.color}dd)`:"linear-gradient(135deg, #e9ecef, #dee2e6)"},children:e?x.jsxs("div",{className:"control-loading",children:[x.jsx("span",{className:"loading-spinner"}),x.jsx("span",{children:"Ovládám..."})]}):x.jsxs("div",{className:"control-content",children:[x.jsx("span",{className:"control-icon",children:d.value?"🔛":"⚫"}),x.jsx("span",{className:"control-text",children:d.value?"ZAPNUTO":"VYPNUTO"})]})})}),(p||g||v)&&x.jsxs("div",{className:"device-sensor-data",children:[p&&x.jsxs("div",{className:"sensor-item temperature",children:[x.jsx("span",{className:"sensor-icon",children:"🌡️"}),x.jsxs("div",{className:"sensor-info",children:[x.jsxs("span",{className:"sensor-value",children:[p.value,"°C"]}),x.jsx("span",{className:"sensor-label",children:"Teplota"})]})]}),g&&x.jsxs("div",{className:"sensor-item humidity",children:[x.jsx("span",{className:"sensor-icon",children:"💧"}),x.jsxs("div",{className:"sensor-info",children:[x.jsxs("span",{className:"sensor-value",children:[g.value,"%"]}),x.jsx("span",{className:"sensor-label",children:"Vlhkost"})]})]}),v&&x.jsxs("div",{className:"sensor-item brightness",children:[x.jsx("span",{className:"sensor-icon",children:"☀️"}),x.jsxs("div",{className:"sensor-info",children:[x.jsxs("span",{className:"sensor-value",children:[v.value,"%"]}),x.jsx("span",{className:"sensor-label",children:"Jas"})]})]})]}),n.status&&n.status.length>0&&x.jsxs("details",{className:"device-additional-states",children:[x.jsxs("summary",{className:"states-toggle",children:[x.jsx("span",{children:"Další stavy"}),x.jsx("span",{className:"states-count",children:n.status.filter(b=>!["switch_1","switch","switch_led","temp_current","humidity_value","bright_value"].includes(b.code)).length})]}),x.jsx("div",{className:"states-list",children:n.status.filter(b=>!["switch_1","switch","switch_led","temp_current","humidity_value","bright_value"].includes(b.code)).slice(0,3).map(b=>x.jsxs("div",{className:"state-item",title:`${b.code}: ${b.value}`,children:[x.jsx("span",{className:"state-code",children:b.code}),x.jsx("span",{className:"state-value",children:typeof b.value=="boolean"?b.value?"✓":"✗":String(b.value)})]},b.code))})]}),x.jsxs("footer",{className:"device-footer",children:[x.jsxs("div",{className:"device-meta",children:[x.jsxs("span",{className:"device-id",title:`ID: ${n.id}`,children:[n.id.slice(0,8),"..."]}),n.lastUpdated&&x.jsx("time",{className:"last-updated",title:"Poslední aktualizace",children:new Date(n.lastUpdated).toLocaleTimeString("cs-CZ")})]}),n.notes&&x.jsxs("div",{className:"device-notes",title:n.notes,children:["📝 ",n.notes.slice(0,30),"..."]})]})]})},FO="_roomVisualizationModern_1tum5_5",kO="_vizHeader_1tum5_31",zO="_vizTitleSection_1tum5_49",BO="_vizTitle_1tum5_49",HO="_vizRoomIcon_1tum5_79",GO="_vizRoomName_1tum5_89",jO="_vizModeBadge_1tum5_101",qO="_vizDescription_1tum5_123",WO="_vizControls_1tum5_137",XO="_vizStats_1tum5_151",YO="_statItem_1tum5_161",KO="_statValue_1tum5_175",$O="_statLabel_1tum5_193",QO="_vizHelp_1tum5_207",ZO="_helpIcon_1tum5_231",JO="_vizCanvasContainer_1tum5_243",e3="_vizCanvas_1tum5_243",t3="_dragging_1tum5_275",n3="_vizGrid_1tum5_289",i3="_gridPattern_1tum5_307",r3="_vizDevice_1tum5_323",s3="_deviceContainer_1tum5_361",a3="_selected_1tum5_371",o3="_deviceIconWrapper_1tum5_399",l3="_online_1tum5_439",c3="_offline_1tum5_447",u3="_deviceIconViz_1tum5_457",h3="_deviceStatusRing_1tum5_469",d3="_deviceInfoIcon_1tum5_509",f3="_infoSymbol_1tum5_553",p3="_deviceInfoViz_1tum5_603",m3="_deviceNameViz_1tum5_649",g3="_deviceCategoryViz_1tum5_667",_3="_selectionIndicator_1tum5_685",v3="_selectionRing_1tum5_703",y3="_selectionHandles_1tum5_725",E3="_handle_1tum5_741",S3="_handleNw_1tum5_761",T3="_handleNe_1tum5_763",x3="_handleSw_1tum5_765",b3="_handleSe_1tum5_767",A3="_dragShadow_1tum5_775",M3="_vizEmptyState_1tum5_805",w3="_emptyIcon_1tum5_823",R3="_emptyTitle_1tum5_837",C3="_emptyDescription_1tum5_851",I3="_vizLegend_1tum5_869",D3="_legendSection_1tum5_889",N3="_legendTitle_1tum5_897",P3="_legendItems_1tum5_915",U3="_shortcutItems_1tum5_917",L3="_legendItem_1tum5_915",O3="_legendIndicator_1tum5_941",V3="_legendLabel_1tum5_993",F3="_shortcut_1tum5_917",Be={roomVisualizationModern:FO,vizHeader:kO,vizTitleSection:zO,vizTitle:BO,vizRoomIcon:HO,vizRoomName:GO,vizModeBadge:jO,vizDescription:qO,vizControls:WO,vizStats:XO,statItem:YO,statValue:KO,statLabel:$O,vizHelp:QO,helpIcon:ZO,vizCanvasContainer:JO,vizCanvas:e3,dragging:t3,vizGrid:n3,gridPattern:i3,vizDevice:r3,deviceContainer:s3,selected:a3,deviceIconWrapper:o3,online:l3,offline:c3,deviceIconViz:u3,deviceStatusRing:h3,deviceInfoIcon:d3,infoSymbol:f3,deviceInfoViz:p3,deviceNameViz:m3,deviceCategoryViz:g3,selectionIndicator:_3,selectionRing:v3,selectionHandles:y3,handle:E3,handleNw:S3,handleNe:T3,handleSw:x3,handleSe:b3,dragShadow:A3,vizEmptyState:M3,emptyIcon:w3,emptyTitle:R3,emptyDescription:C3,vizLegend:I3,legendSection:D3,legendTitle:N3,legendItems:P3,shortcutItems:U3,legendItem:L3,legendIndicator:O3,legendLabel:V3,shortcut:F3},k3="_tooltipContainer_1o11l_1",z3="_tooltip_1o11l_1",B3="_tooltipHeader_1o11l_53",H3="_deviceName_1o11l_71",G3="_statusBadge_1o11l_85",j3="_online_1o11l_103",q3="_offline_1o11l_113",W3="_tooltipContent_1o11l_123",X3="_infoRow_1o11l_135",Y3="_label_1o11l_147",K3="_value_1o11l_157",$3="_sensorSection_1o11l_169",Q3="_sensorTitle_1o11l_181",Z3="_sensorRow_1o11l_195",J3="_sensorIcon_1o11l_209",eV="_sensorLabel_1o11l_219",tV="_sensorValue_1o11l_231",nV="_timestampRow_1o11l_243",iV="_timestamp_1o11l_243",rV="_tooltipArrow_1o11l_267",Tn={tooltipContainer:k3,tooltip:z3,tooltipHeader:B3,deviceName:H3,statusBadge:G3,online:j3,offline:q3,tooltipContent:W3,infoRow:X3,label:Y3,value:K3,sensorSection:$3,sensorTitle:Q3,sensorRow:Z3,sensorIcon:J3,sensorLabel:eV,sensorValue:tV,timestampRow:nV,timestamp:iV,tooltipArrow:rV},sV=({device:n,children:e})=>{const[t,i]=Le.useState(!1),s=h=>new Date(h).toLocaleString("cs-CZ"),o=()=>{const h=n.status?.find(d=>d.code==="switch_1"||d.code==="switch"||d.code==="switch_led");return h?h.value?"Zapnuto":"Vypnuto":"N/A"},c=()=>{const h=[],d=n.status?.find(v=>v.code==="temp_current");d&&h.push({label:"Teplota",value:`${d.value}°C`,icon:"🌡️"});const p=n.status?.find(v=>v.code==="humidity_value");p&&h.push({label:"Vlhkost",value:`${p.value}%`,icon:"💧"});const g=n.status?.find(v=>v.code==="bright_value");return g&&h.push({label:"Jas",value:`${g.value}%`,icon:"☀️"}),h};return x.jsxs("div",{className:Tn.tooltipContainer,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[e,t&&x.jsxs("div",{className:Tn.tooltip,children:[x.jsxs("div",{className:Tn.tooltipHeader,children:[x.jsx("h4",{className:Tn.deviceName,children:n.customName||n.name}),x.jsx("span",{className:`${Tn.statusBadge} ${n.online?Tn.online:Tn.offline}`,children:n.online?"Online":"Offline"})]}),x.jsxs("div",{className:Tn.tooltipContent,children:[x.jsxs("div",{className:Tn.infoRow,children:[x.jsx("span",{className:Tn.label,children:"Kategorie:"}),x.jsx("span",{className:Tn.value,children:n.category})]}),x.jsxs("div",{className:Tn.infoRow,children:[x.jsx("span",{className:Tn.label,children:"Stav:"}),x.jsx("span",{className:Tn.value,children:o()})]}),x.jsxs("div",{className:Tn.infoRow,children:[x.jsx("span",{className:Tn.label,children:"Model:"}),x.jsx("span",{className:Tn.value,children:n.product_name})]}),c().length>0&&x.jsxs("div",{className:Tn.sensorSection,children:[x.jsx("div",{className:Tn.sensorTitle,children:"Senzory:"}),c().map((h,d)=>x.jsxs("div",{className:Tn.sensorRow,children:[x.jsx("span",{className:Tn.sensorIcon,children:h.icon}),x.jsxs("span",{className:Tn.sensorLabel,children:[h.label,":"]}),x.jsx("span",{className:Tn.sensorValue,children:h.value})]},d))]}),n.lastUpdated&&x.jsx("div",{className:Tn.timestampRow,children:x.jsxs("span",{className:Tn.timestamp,children:["Aktualizováno: ",s(n.lastUpdated)]})})]}),x.jsx("div",{className:Tn.tooltipArrow})]})]})},aV=({room:n,devices:e,onDevicePositionChange:t,onDeviceSelect:i,readonly:s=!1})=>{const[o,c]=Le.useState({isDragging:!1,deviceId:null,offset:{x:0,y:0},startPosition:{x:0,y:0}}),[h,d]=Le.useState(null),p=Le.useRef(null),g=n.layout?.width||600,v=n.layout?.height||400,y=e,E=P=>{const k={switch:"🔌",light:"💡",sensor:"📱",garden:"🌱",thermostat:"🌡️",camera:"📷",assistant:"🏠",default:"📱"};return k[P.category]||k.default},b=P=>{if(P.position)return P.position;const k=y.findIndex(U=>U.id===P.id),V=Math.ceil(Math.sqrt(y.length)),j=Math.floor(k/V);return{x:(k%V+.5)*(g/V),y:(j+.5)*(v/Math.ceil(y.length/V))}},D=(P,k)=>{if(s)return;P.preventDefault(),P.stopPropagation();const V=p.current?.getBoundingClientRect();if(!V)return;const j=b(k),q=P.clientX-V.left,U=P.clientY-V.top;console.log("=== MOUSE DOWN DEBUG ==="),console.log("Device:",k.id),console.log("Device position:",j),console.log("Mouse position:",{mouseX:q,mouseY:U}),console.log("Canvas rect:",V),c({isDragging:!0,deviceId:k.id,offset:{x:q-j.x,y:U-j.y},startPosition:j}),d(k.id),i?.(k)},A=P=>{if(!o.isDragging||!o.deviceId)return;const k=p.current?.getBoundingClientRect();if(!k)return;const V=P.clientX-k.left,j=P.clientY-k.top;let q=V-o.offset.x,U=j-o.offset.y;console.log("=== MOUSE MOVE DEBUG ==="),console.log("Mouse:",{mouseX:V,mouseY:j}),console.log("Offset:",o.offset),console.log("Calculated new position:",{newX:q,newY:U});const N=30;q=Math.max(N,Math.min(g-N,q)),U=Math.max(N,Math.min(v-N,U)),console.log("Clamped position:",{newX:q,newY:U}),console.log("Room bounds:",{roomWidth:g,roomHeight:v});const M=document.getElementById(`device-${o.deviceId}`);if(M&&o.isDragging&&o.deviceId){const w=`translate(${q-30}px, ${U-30}px)`;console.log("Setting transform during drag:",w),M.style.transform=w,M.style.transition="none"}},T=P=>{o.isDragging||(d(h===P.id?null:P.id),i?.(h===P.id?null:P))};return Le.useEffect(()=>{if(o.isDragging){const P=async()=>{console.log("=== GLOBAL MOUSE UP DEBUG ===");const k=o.deviceId,V=o.startPosition;if(!k)return;c({isDragging:!1,deviceId:null,offset:{x:0,y:0},startPosition:{x:0,y:0}});const j=document.getElementById(`device-${k}`);if(j){j.style.transition="";const q=j.style.transform;console.log("Global mouseUp transform:",q);const U=q.match(/translate\(([^,]+)px,\s*([^)]+)px\)/);if(U){const N={x:parseFloat(U[1])+30,y:parseFloat(U[2])+30};console.log("Global mouseUp position to save:",N);try{await t(k,N),console.log("Global position saved successfully")}catch(M){console.error("Global error updating device position:",M),j.style.transform=`translate(${V.x-30}px, ${V.y-30}px)`}}}};return document.addEventListener("mouseup",P),document.addEventListener("mouseleave",P),()=>{document.removeEventListener("mouseup",P),document.removeEventListener("mouseleave",P)}}},[o.isDragging,o.deviceId,o.startPosition,t]),Le.useEffect(()=>{const P=k=>{k.key==="Escape"&&(d(null),i?.(null),o.isDragging&&c({isDragging:!1,deviceId:null,offset:{x:0,y:0},startPosition:{x:0,y:0}}))};return document.addEventListener("keydown",P),()=>document.removeEventListener("keydown",P)},[o.isDragging,i]),console.log("RoomVisualization2D render:",{roomId:n.id,totalDevices:e.length,roomDevices:y.length,roomDeviceIds:y.map(P=>P.id)}),x.jsxs("div",{className:Be.roomVisualizationModern,children:[x.jsxs("header",{className:Be.vizHeader,children:[x.jsxs("div",{className:Be.vizTitleSection,children:[x.jsxs("h3",{className:Be.vizTitle,children:[n.icon&&x.jsx("span",{className:Be.vizRoomIcon,children:n.icon}),x.jsx("span",{className:Be.vizRoomName,children:n.name}),x.jsx("span",{className:Be.vizModeBadge,children:"2D Vizualizace"})]}),x.jsx("p",{className:Be.vizDescription,children:"Přetahování zařízení pro změnu pozice v místnosti"})]}),x.jsxs("div",{className:Be.vizControls,children:[x.jsxs("div",{className:Be.vizStats,children:[x.jsxs("div",{className:Be.statItem,children:[x.jsx("span",{className:Be.statValue,children:y.length}),x.jsx("span",{className:Be.statLabel,children:"zařízení"})]}),x.jsxs("div",{className:Be.statItem,children:[x.jsx("span",{className:Be.statValue,children:y.filter(P=>P.online).length}),x.jsx("span",{className:Be.statLabel,children:"online"})]})]}),!s&&x.jsxs("div",{className:Be.vizHelp,children:[x.jsx("span",{className:Be.helpIcon,children:"💡"}),x.jsx("span",{className:Be.helpText,children:"Drag & Drop aktivní"})]})]})]}),x.jsx("div",{className:Be.vizCanvasContainer,children:x.jsxs("div",{ref:p,className:`${Be.vizCanvas} ${o.isDragging?Be.dragging:""}`,style:{width:g,height:v,background:n.color?`linear-gradient(135deg, ${n.color}10, ${n.color}05)`:"linear-gradient(135deg, #f8f9fa, #e9ecef)"},onMouseMove:A,children:[x.jsx("div",{className:Be.vizGrid,children:x.jsx("div",{className:Be.gridPattern,style:{backgroundImage:`
                    radial-gradient(circle at 1px 1px, rgba(102,126,234,0.15) 1px, transparent 0),
                    linear-gradient(90deg, rgba(102,126,234,0.05) 1px, transparent 1px),
                    linear-gradient(rgba(102,126,234,0.05) 1px, transparent 1px)
                  `,backgroundSize:"40px 40px, 40px 40px, 40px 40px"}})}),y.map(P=>{const k=b(P),V=h===P.id,j=o.isDragging&&o.deviceId===P.id;return x.jsx("div",{id:`device-${P.id}`,className:`${Be.vizDevice} ${V?Be.selected:""} ${j?Be.dragging:""} ${P.online?Be.online:Be.offline}`,style:{transform:`translate(${k.x-30}px, ${k.y-30}px)`,zIndex:j?1e3:V?100:10},onMouseDown:q=>D(q,P),onClick:()=>T(P),title:`${P.customName||P.name}
${P.category}
${P.online?"Online":"Offline"}`,children:x.jsxs("div",{className:Be.deviceContainer,children:[x.jsxs("div",{className:Be.deviceIconWrapper,children:[x.jsx("span",{className:Be.deviceIconViz,children:E(P)}),x.jsx("div",{className:`${Be.deviceStatusRing} ${P.online?Be.online:Be.offline}`})]}),x.jsx(sV,{device:P,children:x.jsx("div",{className:Be.deviceInfoIcon,children:x.jsx("span",{className:Be.infoSymbol,children:"i"})})}),x.jsxs("div",{className:Be.deviceInfoViz,children:[x.jsx("div",{className:Be.deviceNameViz,children:P.customName||P.name}),x.jsx("div",{className:Be.deviceCategoryViz,children:P.category})]}),V&&x.jsx("div",{className:Be.selectionIndicator,children:x.jsx("div",{className:Be.selectionRing,children:x.jsxs("div",{className:Be.selectionHandles,children:[x.jsx("div",{className:`${Be.handle} ${Be.handleNw}`}),x.jsx("div",{className:`${Be.handle} ${Be.handleNe}`}),x.jsx("div",{className:`${Be.handle} ${Be.handleSw}`}),x.jsx("div",{className:`${Be.handle} ${Be.handleSe}`})]})})}),j&&x.jsx("div",{className:Be.dragShadow})]})},P.id)}),y.length===0&&x.jsxs("div",{className:Be.vizEmptyState,children:[x.jsx("div",{className:Be.emptyIcon,children:"🏠"}),x.jsx("h4",{className:Be.emptyTitle,children:"Prázdná místnost"}),x.jsxs("p",{className:Be.emptyDescription,children:["V této místnosti nejsou žádná zařízení.",x.jsx("br",{}),"Přidejte zařízení pomocí správy místností."]})]})]})}),x.jsxs("footer",{className:Be.vizLegend,children:[" ",x.jsxs("div",{className:Be.legendSection,children:[x.jsx("h4",{className:Be.legendTitle,children:"Legenda:"}),x.jsxs("div",{className:Be.legendItems,children:[x.jsxs("div",{className:Be.legendItem,children:[x.jsx("div",{className:`${Be.legendIndicator} ${Be.online}`}),x.jsx("span",{className:Be.legendLabel,children:"Online zařízení"})]}),x.jsxs("div",{className:Be.legendItem,children:[x.jsx("div",{className:`${Be.legendIndicator} ${Be.offline}`}),x.jsx("span",{className:Be.legendLabel,children:"Offline zařízení"})]}),x.jsxs("div",{className:Be.legendItem,children:[x.jsx("div",{className:`${Be.legendIndicator} ${Be.selected}`}),x.jsx("span",{className:Be.legendLabel,children:"Vybrané zařízení"})]}),!s&&x.jsxs("div",{className:Be.legendItem,children:[x.jsx("div",{className:`${Be.legendIndicator} ${Be.dragging}`}),x.jsx("span",{className:Be.legendLabel,children:"Přetahování"})]})]})]}),x.jsxs("div",{className:Be.legendShortcuts,children:[x.jsx("h4",{className:Be.legendTitle,children:"Ovládání:"}),x.jsxs("div",{className:Be.shortcutItems,children:[x.jsx("span",{className:Be.shortcut,children:"Klik = Výběr"}),!s&&x.jsx("span",{className:Be.shortcut,children:"Drag = Přesun"}),x.jsx("span",{className:Be.shortcut,children:"ESC = Zrušit výběr"})]})]})]})]})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const l0="180",oV=0,mb=1,lV=2,iR=1,rR=2,Bs=3,Ya=0,Yi=1,Gs=2,Ha=0,_c=1,gb=2,_b=3,vb=4,cV=5,Fo=100,uV=101,hV=102,dV=103,fV=104,pV=200,mV=201,gV=202,_V=203,hv=204,dv=205,vV=206,yV=207,EV=208,SV=209,TV=210,xV=211,bV=212,AV=213,MV=214,fv=0,pv=1,mv=2,Mc=3,gv=4,_v=5,vv=6,yv=7,Vp=0,wV=1,RV=2,Ga=0,CV=1,IV=2,DV=3,NV=4,PV=5,UV=6,LV=7,sR=300,wc=301,Rc=302,Ev=303,Sv=304,Fp=306,Tv=1e3,Go=1001,xv=1002,Br=1003,OV=1004,lf=1005,os=1006,s_=1007,jo=1008,ms=1009,aR=1010,oR=1011,gh=1012,c0=1013,Jo=1014,Xs=1015,Vh=1016,u0=1017,h0=1018,_h=1020,lR=35902,cR=35899,uR=1021,hR=1022,kr=1023,vh=1026,yh=1027,dR=1028,d0=1029,fR=1030,f0=1031,p0=1033,Hf=33776,Gf=33777,jf=33778,qf=33779,bv=35840,Av=35841,Mv=35842,wv=35843,Rv=36196,Cv=37492,Iv=37496,Dv=37808,Nv=37809,Pv=37810,Uv=37811,Lv=37812,Ov=37813,Vv=37814,Fv=37815,kv=37816,zv=37817,Bv=37818,Hv=37819,Gv=37820,jv=37821,qv=36492,Wv=36494,Xv=36495,Yv=36283,Kv=36284,$v=36285,Qv=36286,VV=3200,FV=3201,m0=0,kV=1,Oa="",br="srgb",Cc="srgb-linear",hp="linear",mn="srgb",ql=7680,yb=519,zV=512,BV=513,HV=514,pR=515,GV=516,jV=517,qV=518,WV=519,Zv=35044,Eb="300 es",ls=2e3,dp=2001;class Vc{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners;if(i===void 0)return;const s=i[e];if(s!==void 0){const o=s.indexOf(t);o!==-1&&s.splice(o,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const i=t[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let o=0,c=s.length;o<c;o++)s[o].call(this,e);e.target=null}}}const Ai=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],a_=Math.PI/180,Jv=180/Math.PI;function ja(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Ai[n&255]+Ai[n>>8&255]+Ai[n>>16&255]+Ai[n>>24&255]+"-"+Ai[e&255]+Ai[e>>8&255]+"-"+Ai[e>>16&15|64]+Ai[e>>24&255]+"-"+Ai[t&63|128]+Ai[t>>8&255]+"-"+Ai[t>>16&255]+Ai[t>>24&255]+Ai[i&255]+Ai[i>>8&255]+Ai[i>>16&255]+Ai[i>>24&255]).toLowerCase()}function Wt(n,e,t){return Math.max(e,Math.min(t,n))}function XV(n,e){return(n%e+e)%e}function o_(n,e,t){return(1-t)*n+t*e}function as(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function gn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}class Nt{constructor(e=0,t=0){Nt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Wt(this.x,e.x,t.x),this.y=Wt(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Wt(this.x,e,t),this.y=Wt(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Wt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Wt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),s=Math.sin(t),o=this.x-e.x,c=this.y-e.y;return this.x=o*i-c*s+e.x,this.y=o*s+c*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Fh{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,o,c,h){let d=i[s+0],p=i[s+1],g=i[s+2],v=i[s+3];const y=o[c+0],E=o[c+1],b=o[c+2],D=o[c+3];if(h===0){e[t+0]=d,e[t+1]=p,e[t+2]=g,e[t+3]=v;return}if(h===1){e[t+0]=y,e[t+1]=E,e[t+2]=b,e[t+3]=D;return}if(v!==D||d!==y||p!==E||g!==b){let A=1-h;const T=d*y+p*E+g*b+v*D,P=T>=0?1:-1,k=1-T*T;if(k>Number.EPSILON){const j=Math.sqrt(k),q=Math.atan2(j,T*P);A=Math.sin(A*q)/j,h=Math.sin(h*q)/j}const V=h*P;if(d=d*A+y*V,p=p*A+E*V,g=g*A+b*V,v=v*A+D*V,A===1-h){const j=1/Math.sqrt(d*d+p*p+g*g+v*v);d*=j,p*=j,g*=j,v*=j}}e[t]=d,e[t+1]=p,e[t+2]=g,e[t+3]=v}static multiplyQuaternionsFlat(e,t,i,s,o,c){const h=i[s],d=i[s+1],p=i[s+2],g=i[s+3],v=o[c],y=o[c+1],E=o[c+2],b=o[c+3];return e[t]=h*b+g*v+d*E-p*y,e[t+1]=d*b+g*y+p*v-h*E,e[t+2]=p*b+g*E+h*y-d*v,e[t+3]=g*b-h*v-d*y-p*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,s=e._y,o=e._z,c=e._order,h=Math.cos,d=Math.sin,p=h(i/2),g=h(s/2),v=h(o/2),y=d(i/2),E=d(s/2),b=d(o/2);switch(c){case"XYZ":this._x=y*g*v+p*E*b,this._y=p*E*v-y*g*b,this._z=p*g*b+y*E*v,this._w=p*g*v-y*E*b;break;case"YXZ":this._x=y*g*v+p*E*b,this._y=p*E*v-y*g*b,this._z=p*g*b-y*E*v,this._w=p*g*v+y*E*b;break;case"ZXY":this._x=y*g*v-p*E*b,this._y=p*E*v+y*g*b,this._z=p*g*b+y*E*v,this._w=p*g*v-y*E*b;break;case"ZYX":this._x=y*g*v-p*E*b,this._y=p*E*v+y*g*b,this._z=p*g*b-y*E*v,this._w=p*g*v+y*E*b;break;case"YZX":this._x=y*g*v+p*E*b,this._y=p*E*v+y*g*b,this._z=p*g*b-y*E*v,this._w=p*g*v-y*E*b;break;case"XZY":this._x=y*g*v-p*E*b,this._y=p*E*v-y*g*b,this._z=p*g*b+y*E*v,this._w=p*g*v+y*E*b;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],s=t[4],o=t[8],c=t[1],h=t[5],d=t[9],p=t[2],g=t[6],v=t[10],y=i+h+v;if(y>0){const E=.5/Math.sqrt(y+1);this._w=.25/E,this._x=(g-d)*E,this._y=(o-p)*E,this._z=(c-s)*E}else if(i>h&&i>v){const E=2*Math.sqrt(1+i-h-v);this._w=(g-d)/E,this._x=.25*E,this._y=(s+c)/E,this._z=(o+p)/E}else if(h>v){const E=2*Math.sqrt(1+h-i-v);this._w=(o-p)/E,this._x=(s+c)/E,this._y=.25*E,this._z=(d+g)/E}else{const E=2*Math.sqrt(1+v-i-h);this._w=(c-s)/E,this._x=(o+p)/E,this._y=(d+g)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Wt(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,s=e._y,o=e._z,c=e._w,h=t._x,d=t._y,p=t._z,g=t._w;return this._x=i*g+c*h+s*p-o*d,this._y=s*g+c*d+o*h-i*p,this._z=o*g+c*p+i*d-s*h,this._w=c*g-i*h-s*d-o*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,s=this._y,o=this._z,c=this._w;let h=c*e._w+i*e._x+s*e._y+o*e._z;if(h<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,h=-h):this.copy(e),h>=1)return this._w=c,this._x=i,this._y=s,this._z=o,this;const d=1-h*h;if(d<=Number.EPSILON){const E=1-t;return this._w=E*c+t*this._w,this._x=E*i+t*this._x,this._y=E*s+t*this._y,this._z=E*o+t*this._z,this.normalize(),this}const p=Math.sqrt(d),g=Math.atan2(p,h),v=Math.sin((1-t)*g)/p,y=Math.sin(t*g)/p;return this._w=c*v+this._w*y,this._x=i*v+this._x*y,this._y=s*v+this._y*y,this._z=o*v+this._z*y,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class he{constructor(e=0,t=0,i=0){he.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Sb.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Sb.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*s,this.y=o[1]*t+o[4]*i+o[7]*s,this.z=o[2]*t+o[5]*i+o[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,o=e.elements,c=1/(o[3]*t+o[7]*i+o[11]*s+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*s+o[12])*c,this.y=(o[1]*t+o[5]*i+o[9]*s+o[13])*c,this.z=(o[2]*t+o[6]*i+o[10]*s+o[14])*c,this}applyQuaternion(e){const t=this.x,i=this.y,s=this.z,o=e.x,c=e.y,h=e.z,d=e.w,p=2*(c*s-h*i),g=2*(h*t-o*s),v=2*(o*i-c*t);return this.x=t+d*p+c*v-h*g,this.y=i+d*g+h*p-o*v,this.z=s+d*v+o*g-c*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,s=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*s,this.y=o[1]*t+o[5]*i+o[9]*s,this.z=o[2]*t+o[6]*i+o[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Wt(this.x,e.x,t.x),this.y=Wt(this.y,e.y,t.y),this.z=Wt(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Wt(this.x,e,t),this.y=Wt(this.y,e,t),this.z=Wt(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Wt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,s=e.y,o=e.z,c=t.x,h=t.y,d=t.z;return this.x=s*d-o*h,this.y=o*c-i*d,this.z=i*h-s*c,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return l_.copy(this).projectOnVector(e),this.sub(l_)}reflect(e){return this.sub(l_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Wt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const l_=new he,Sb=new Fh;class Dt{constructor(e,t,i,s,o,c,h,d,p){Dt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,c,h,d,p)}set(e,t,i,s,o,c,h,d,p){const g=this.elements;return g[0]=e,g[1]=s,g[2]=h,g[3]=t,g[4]=o,g[5]=d,g[6]=i,g[7]=c,g[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,o=this.elements,c=i[0],h=i[3],d=i[6],p=i[1],g=i[4],v=i[7],y=i[2],E=i[5],b=i[8],D=s[0],A=s[3],T=s[6],P=s[1],k=s[4],V=s[7],j=s[2],q=s[5],U=s[8];return o[0]=c*D+h*P+d*j,o[3]=c*A+h*k+d*q,o[6]=c*T+h*V+d*U,o[1]=p*D+g*P+v*j,o[4]=p*A+g*k+v*q,o[7]=p*T+g*V+v*U,o[2]=y*D+E*P+b*j,o[5]=y*A+E*k+b*q,o[8]=y*T+E*V+b*U,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],h=e[5],d=e[6],p=e[7],g=e[8];return t*c*g-t*h*p-i*o*g+i*h*d+s*o*p-s*c*d}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],h=e[5],d=e[6],p=e[7],g=e[8],v=g*c-h*p,y=h*d-g*o,E=p*o-c*d,b=t*v+i*y+s*E;if(b===0)return this.set(0,0,0,0,0,0,0,0,0);const D=1/b;return e[0]=v*D,e[1]=(s*p-g*i)*D,e[2]=(h*i-s*c)*D,e[3]=y*D,e[4]=(g*t-s*d)*D,e[5]=(s*o-h*t)*D,e[6]=E*D,e[7]=(i*d-p*t)*D,e[8]=(c*t-i*o)*D,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,o,c,h){const d=Math.cos(o),p=Math.sin(o);return this.set(i*d,i*p,-i*(d*c+p*h)+c+e,-s*p,s*d,-s*(-p*c+d*h)+h+t,0,0,1),this}scale(e,t){return this.premultiply(c_.makeScale(e,t)),this}rotate(e){return this.premultiply(c_.makeRotation(-e)),this}translate(e,t){return this.premultiply(c_.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const c_=new Dt;function mR(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function fp(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function YV(){const n=fp("canvas");return n.style.display="block",n}const Tb={};function Eh(n){n in Tb||(Tb[n]=!0,console.warn(n))}function KV(n,e,t){return new Promise(function(i,s){function o(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:s();break;case n.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:i()}}setTimeout(o,t)})}const xb=new Dt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),bb=new Dt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function $V(){const n={enabled:!0,workingColorSpace:Cc,spaces:{},convert:function(s,o,c){return this.enabled===!1||o===c||!o||!c||(this.spaces[o].transfer===mn&&(s.r=$s(s.r),s.g=$s(s.g),s.b=$s(s.b)),this.spaces[o].primaries!==this.spaces[c].primaries&&(s.applyMatrix3(this.spaces[o].toXYZ),s.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===mn&&(s.r=vc(s.r),s.g=vc(s.g),s.b=vc(s.b))),s},workingToColorSpace:function(s,o){return this.convert(s,this.workingColorSpace,o)},colorSpaceToWorking:function(s,o){return this.convert(s,o,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Oa?hp:this.spaces[s].transfer},getToneMappingMode:function(s){return this.spaces[s].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(s,o=this.workingColorSpace){return s.fromArray(this.spaces[o].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,o,c){return s.copy(this.spaces[o].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,o){return Eh("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(s,o)},toWorkingColorSpace:function(s,o){return Eh("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(s,o)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Cc]:{primaries:e,whitePoint:i,transfer:hp,toXYZ:xb,fromXYZ:bb,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:br},outputColorSpaceConfig:{drawingBufferColorSpace:br}},[br]:{primaries:e,whitePoint:i,transfer:mn,toXYZ:xb,fromXYZ:bb,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:br}}}),n}const tn=$V();function $s(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function vc(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Wl;class QV{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Wl===void 0&&(Wl=fp("canvas")),Wl.width=e.width,Wl.height=e.height;const s=Wl.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),i=Wl}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=fp("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),o=s.data;for(let c=0;c<o.length;c++)o[c]=$s(o[c]/255)*255;return i.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor($s(t[i]/255)*255):t[i]=$s(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ZV=0;class g0{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ZV++}),this.uuid=ja(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let o;if(Array.isArray(s)){o=[];for(let c=0,h=s.length;c<h;c++)s[c].isDataTexture?o.push(u_(s[c].image)):o.push(u_(s[c]))}else o=u_(s);i.url=o}return t||(e.images[this.uuid]=i),i}}function u_(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?QV.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let JV=0;const h_=new he;class ki extends Vc{constructor(e=ki.DEFAULT_IMAGE,t=ki.DEFAULT_MAPPING,i=Go,s=Go,o=os,c=jo,h=kr,d=ms,p=ki.DEFAULT_ANISOTROPY,g=Oa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:JV++}),this.uuid=ja(),this.name="",this.source=new g0(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=o,this.minFilter=c,this.anisotropy=p,this.format=h,this.internalFormat=null,this.type=d,this.offset=new Nt(0,0),this.repeat=new Nt(1,1),this.center=new Nt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Dt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=g,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(h_).x}get height(){return this.source.getSize(h_).y}get depth(){return this.source.getSize(h_).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}s&&i&&s.isVector2&&i.isVector2||s&&i&&s.isVector3&&i.isVector3||s&&i&&s.isMatrix3&&i.isMatrix3?s.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==sR)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Tv:e.x=e.x-Math.floor(e.x);break;case Go:e.x=e.x<0?0:1;break;case xv:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Tv:e.y=e.y-Math.floor(e.y);break;case Go:e.y=e.y<0?0:1;break;case xv:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ki.DEFAULT_IMAGE=null;ki.DEFAULT_MAPPING=sR;ki.DEFAULT_ANISOTROPY=1;class Vn{constructor(e=0,t=0,i=0,s=1){Vn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,o=this.w,c=e.elements;return this.x=c[0]*t+c[4]*i+c[8]*s+c[12]*o,this.y=c[1]*t+c[5]*i+c[9]*s+c[13]*o,this.z=c[2]*t+c[6]*i+c[10]*s+c[14]*o,this.w=c[3]*t+c[7]*i+c[11]*s+c[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,o;const d=e.elements,p=d[0],g=d[4],v=d[8],y=d[1],E=d[5],b=d[9],D=d[2],A=d[6],T=d[10];if(Math.abs(g-y)<.01&&Math.abs(v-D)<.01&&Math.abs(b-A)<.01){if(Math.abs(g+y)<.1&&Math.abs(v+D)<.1&&Math.abs(b+A)<.1&&Math.abs(p+E+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(p+1)/2,V=(E+1)/2,j=(T+1)/2,q=(g+y)/4,U=(v+D)/4,N=(b+A)/4;return k>V&&k>j?k<.01?(i=0,s=.707106781,o=.707106781):(i=Math.sqrt(k),s=q/i,o=U/i):V>j?V<.01?(i=.707106781,s=0,o=.707106781):(s=Math.sqrt(V),i=q/s,o=N/s):j<.01?(i=.707106781,s=.707106781,o=0):(o=Math.sqrt(j),i=U/o,s=N/o),this.set(i,s,o,t),this}let P=Math.sqrt((A-b)*(A-b)+(v-D)*(v-D)+(y-g)*(y-g));return Math.abs(P)<.001&&(P=1),this.x=(A-b)/P,this.y=(v-D)/P,this.z=(y-g)/P,this.w=Math.acos((p+E+T-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Wt(this.x,e.x,t.x),this.y=Wt(this.y,e.y,t.y),this.z=Wt(this.z,e.z,t.z),this.w=Wt(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Wt(this.x,e,t),this.y=Wt(this.y,e,t),this.z=Wt(this.z,e,t),this.w=Wt(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Wt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class eF extends Vc{constructor(e=1,t=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:os,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth,this.scissor=new Vn(0,0,e,t),this.scissorTest=!1,this.viewport=new Vn(0,0,e,t);const s={width:e,height:t,depth:i.depth},o=new ki(s);this.textures=[];const c=i.count;for(let h=0;h<c;h++)this.textures[h]=o.clone(),this.textures[h].isRenderTargetTexture=!0,this.textures[h].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const t={minFilter:os,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let s=0,o=this.textures.length;s<o;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=i,this.textures[s].isArrayTexture=this.textures[s].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new g0(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class el extends eF{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class gR extends ki{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Br,this.minFilter=Br,this.wrapR=Go,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class tF extends ki{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Br,this.minFilter=Br,this.wrapR=Go,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class kh{constructor(e=new he(1/0,1/0,1/0),t=new he(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Lr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Lr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Lr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const o=i.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let c=0,h=o.count;c<h;c++)e.isMesh===!0?e.getVertexPosition(c,Lr):Lr.fromBufferAttribute(o,c),Lr.applyMatrix4(e.matrixWorld),this.expandByPoint(Lr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),cf.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),cf.copy(i.boundingBox)),cf.applyMatrix4(e.matrixWorld),this.union(cf)}const s=e.children;for(let o=0,c=s.length;o<c;o++)this.expandByObject(s[o],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Lr),Lr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ku),uf.subVectors(this.max,ku),Xl.subVectors(e.a,ku),Yl.subVectors(e.b,ku),Kl.subVectors(e.c,ku),wa.subVectors(Yl,Xl),Ra.subVectors(Kl,Yl),Co.subVectors(Xl,Kl);let t=[0,-wa.z,wa.y,0,-Ra.z,Ra.y,0,-Co.z,Co.y,wa.z,0,-wa.x,Ra.z,0,-Ra.x,Co.z,0,-Co.x,-wa.y,wa.x,0,-Ra.y,Ra.x,0,-Co.y,Co.x,0];return!d_(t,Xl,Yl,Kl,uf)||(t=[1,0,0,0,1,0,0,0,1],!d_(t,Xl,Yl,Kl,uf))?!1:(hf.crossVectors(wa,Ra),t=[hf.x,hf.y,hf.z],d_(t,Xl,Yl,Kl,uf))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Lr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Lr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Os[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Os[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Os[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Os[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Os[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Os[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Os[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Os[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Os),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Os=[new he,new he,new he,new he,new he,new he,new he,new he],Lr=new he,cf=new kh,Xl=new he,Yl=new he,Kl=new he,wa=new he,Ra=new he,Co=new he,ku=new he,uf=new he,hf=new he,Io=new he;function d_(n,e,t,i,s){for(let o=0,c=n.length-3;o<=c;o+=3){Io.fromArray(n,o);const h=s.x*Math.abs(Io.x)+s.y*Math.abs(Io.y)+s.z*Math.abs(Io.z),d=e.dot(Io),p=t.dot(Io),g=i.dot(Io);if(Math.max(-Math.max(d,p,g),Math.min(d,p,g))>h)return!1}return!0}const nF=new kh,zu=new he,f_=new he;class _0{constructor(e=new he,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):nF.setFromPoints(e).getCenter(i);let s=0;for(let o=0,c=e.length;o<c;o++)s=Math.max(s,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;zu.subVectors(e,this.center);const t=zu.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),s=(i-this.radius)*.5;this.center.addScaledVector(zu,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(f_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(zu.copy(e.center).add(f_)),this.expandByPoint(zu.copy(e.center).sub(f_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Vs=new he,p_=new he,df=new he,Ca=new he,m_=new he,ff=new he,g_=new he;class _R{constructor(e=new he,t=new he(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Vs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Vs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vs.copy(this.origin).addScaledVector(this.direction,t),Vs.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){p_.copy(e).add(t).multiplyScalar(.5),df.copy(t).sub(e).normalize(),Ca.copy(this.origin).sub(p_);const o=e.distanceTo(t)*.5,c=-this.direction.dot(df),h=Ca.dot(this.direction),d=-Ca.dot(df),p=Ca.lengthSq(),g=Math.abs(1-c*c);let v,y,E,b;if(g>0)if(v=c*d-h,y=c*h-d,b=o*g,v>=0)if(y>=-b)if(y<=b){const D=1/g;v*=D,y*=D,E=v*(v+c*y+2*h)+y*(c*v+y+2*d)+p}else y=o,v=Math.max(0,-(c*y+h)),E=-v*v+y*(y+2*d)+p;else y=-o,v=Math.max(0,-(c*y+h)),E=-v*v+y*(y+2*d)+p;else y<=-b?(v=Math.max(0,-(-c*o+h)),y=v>0?-o:Math.min(Math.max(-o,-d),o),E=-v*v+y*(y+2*d)+p):y<=b?(v=0,y=Math.min(Math.max(-o,-d),o),E=y*(y+2*d)+p):(v=Math.max(0,-(c*o+h)),y=v>0?o:Math.min(Math.max(-o,-d),o),E=-v*v+y*(y+2*d)+p);else y=c>0?-o:o,v=Math.max(0,-(c*y+h)),E=-v*v+y*(y+2*d)+p;return i&&i.copy(this.origin).addScaledVector(this.direction,v),s&&s.copy(p_).addScaledVector(df,y),E}intersectSphere(e,t){Vs.subVectors(e.center,this.origin);const i=Vs.dot(this.direction),s=Vs.dot(Vs)-i*i,o=e.radius*e.radius;if(s>o)return null;const c=Math.sqrt(o-s),h=i-c,d=i+c;return d<0?null:h<0?this.at(d,t):this.at(h,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,o,c,h,d;const p=1/this.direction.x,g=1/this.direction.y,v=1/this.direction.z,y=this.origin;return p>=0?(i=(e.min.x-y.x)*p,s=(e.max.x-y.x)*p):(i=(e.max.x-y.x)*p,s=(e.min.x-y.x)*p),g>=0?(o=(e.min.y-y.y)*g,c=(e.max.y-y.y)*g):(o=(e.max.y-y.y)*g,c=(e.min.y-y.y)*g),i>c||o>s||((o>i||isNaN(i))&&(i=o),(c<s||isNaN(s))&&(s=c),v>=0?(h=(e.min.z-y.z)*v,d=(e.max.z-y.z)*v):(h=(e.max.z-y.z)*v,d=(e.min.z-y.z)*v),i>d||h>s)||((h>i||i!==i)&&(i=h),(d<s||s!==s)&&(s=d),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return this.intersectBox(e,Vs)!==null}intersectTriangle(e,t,i,s,o){m_.subVectors(t,e),ff.subVectors(i,e),g_.crossVectors(m_,ff);let c=this.direction.dot(g_),h;if(c>0){if(s)return null;h=1}else if(c<0)h=-1,c=-c;else return null;Ca.subVectors(this.origin,e);const d=h*this.direction.dot(ff.crossVectors(Ca,ff));if(d<0)return null;const p=h*this.direction.dot(m_.cross(Ca));if(p<0||d+p>c)return null;const g=-h*Ca.dot(g_);return g<0?null:this.at(g/c,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Dn{constructor(e,t,i,s,o,c,h,d,p,g,v,y,E,b,D,A){Dn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,s,o,c,h,d,p,g,v,y,E,b,D,A)}set(e,t,i,s,o,c,h,d,p,g,v,y,E,b,D,A){const T=this.elements;return T[0]=e,T[4]=t,T[8]=i,T[12]=s,T[1]=o,T[5]=c,T[9]=h,T[13]=d,T[2]=p,T[6]=g,T[10]=v,T[14]=y,T[3]=E,T[7]=b,T[11]=D,T[15]=A,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Dn().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,s=1/$l.setFromMatrixColumn(e,0).length(),o=1/$l.setFromMatrixColumn(e,1).length(),c=1/$l.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*c,t[9]=i[9]*c,t[10]=i[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,s=e.y,o=e.z,c=Math.cos(i),h=Math.sin(i),d=Math.cos(s),p=Math.sin(s),g=Math.cos(o),v=Math.sin(o);if(e.order==="XYZ"){const y=c*g,E=c*v,b=h*g,D=h*v;t[0]=d*g,t[4]=-d*v,t[8]=p,t[1]=E+b*p,t[5]=y-D*p,t[9]=-h*d,t[2]=D-y*p,t[6]=b+E*p,t[10]=c*d}else if(e.order==="YXZ"){const y=d*g,E=d*v,b=p*g,D=p*v;t[0]=y+D*h,t[4]=b*h-E,t[8]=c*p,t[1]=c*v,t[5]=c*g,t[9]=-h,t[2]=E*h-b,t[6]=D+y*h,t[10]=c*d}else if(e.order==="ZXY"){const y=d*g,E=d*v,b=p*g,D=p*v;t[0]=y-D*h,t[4]=-c*v,t[8]=b+E*h,t[1]=E+b*h,t[5]=c*g,t[9]=D-y*h,t[2]=-c*p,t[6]=h,t[10]=c*d}else if(e.order==="ZYX"){const y=c*g,E=c*v,b=h*g,D=h*v;t[0]=d*g,t[4]=b*p-E,t[8]=y*p+D,t[1]=d*v,t[5]=D*p+y,t[9]=E*p-b,t[2]=-p,t[6]=h*d,t[10]=c*d}else if(e.order==="YZX"){const y=c*d,E=c*p,b=h*d,D=h*p;t[0]=d*g,t[4]=D-y*v,t[8]=b*v+E,t[1]=v,t[5]=c*g,t[9]=-h*g,t[2]=-p*g,t[6]=E*v+b,t[10]=y-D*v}else if(e.order==="XZY"){const y=c*d,E=c*p,b=h*d,D=h*p;t[0]=d*g,t[4]=-v,t[8]=p*g,t[1]=y*v+D,t[5]=c*g,t[9]=E*v-b,t[2]=b*v-E,t[6]=h*g,t[10]=D*v+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(iF,e,rF)}lookAt(e,t,i){const s=this.elements;return ir.subVectors(e,t),ir.lengthSq()===0&&(ir.z=1),ir.normalize(),Ia.crossVectors(i,ir),Ia.lengthSq()===0&&(Math.abs(i.z)===1?ir.x+=1e-4:ir.z+=1e-4,ir.normalize(),Ia.crossVectors(i,ir)),Ia.normalize(),pf.crossVectors(ir,Ia),s[0]=Ia.x,s[4]=pf.x,s[8]=ir.x,s[1]=Ia.y,s[5]=pf.y,s[9]=ir.y,s[2]=Ia.z,s[6]=pf.z,s[10]=ir.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,o=this.elements,c=i[0],h=i[4],d=i[8],p=i[12],g=i[1],v=i[5],y=i[9],E=i[13],b=i[2],D=i[6],A=i[10],T=i[14],P=i[3],k=i[7],V=i[11],j=i[15],q=s[0],U=s[4],N=s[8],M=s[12],w=s[1],R=s[5],O=s[9],L=s[13],re=s[2],oe=s[6],X=s[10],Z=s[14],J=s[3],Ae=s[7],H=s[11],ee=s[15];return o[0]=c*q+h*w+d*re+p*J,o[4]=c*U+h*R+d*oe+p*Ae,o[8]=c*N+h*O+d*X+p*H,o[12]=c*M+h*L+d*Z+p*ee,o[1]=g*q+v*w+y*re+E*J,o[5]=g*U+v*R+y*oe+E*Ae,o[9]=g*N+v*O+y*X+E*H,o[13]=g*M+v*L+y*Z+E*ee,o[2]=b*q+D*w+A*re+T*J,o[6]=b*U+D*R+A*oe+T*Ae,o[10]=b*N+D*O+A*X+T*H,o[14]=b*M+D*L+A*Z+T*ee,o[3]=P*q+k*w+V*re+j*J,o[7]=P*U+k*R+V*oe+j*Ae,o[11]=P*N+k*O+V*X+j*H,o[15]=P*M+k*L+V*Z+j*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],s=e[8],o=e[12],c=e[1],h=e[5],d=e[9],p=e[13],g=e[2],v=e[6],y=e[10],E=e[14],b=e[3],D=e[7],A=e[11],T=e[15];return b*(+o*d*v-s*p*v-o*h*y+i*p*y+s*h*E-i*d*E)+D*(+t*d*E-t*p*y+o*c*y-s*c*E+s*p*g-o*d*g)+A*(+t*p*v-t*h*E-o*c*v+i*c*E+o*h*g-i*p*g)+T*(-s*h*g-t*d*v+t*h*y+s*c*v-i*c*y+i*d*g)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],o=e[3],c=e[4],h=e[5],d=e[6],p=e[7],g=e[8],v=e[9],y=e[10],E=e[11],b=e[12],D=e[13],A=e[14],T=e[15],P=v*A*p-D*y*p+D*d*E-h*A*E-v*d*T+h*y*T,k=b*y*p-g*A*p-b*d*E+c*A*E+g*d*T-c*y*T,V=g*D*p-b*v*p+b*h*E-c*D*E-g*h*T+c*v*T,j=b*v*d-g*D*d-b*h*y+c*D*y+g*h*A-c*v*A,q=t*P+i*k+s*V+o*j;if(q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const U=1/q;return e[0]=P*U,e[1]=(D*y*o-v*A*o-D*s*E+i*A*E+v*s*T-i*y*T)*U,e[2]=(h*A*o-D*d*o+D*s*p-i*A*p-h*s*T+i*d*T)*U,e[3]=(v*d*o-h*y*o-v*s*p+i*y*p+h*s*E-i*d*E)*U,e[4]=k*U,e[5]=(g*A*o-b*y*o+b*s*E-t*A*E-g*s*T+t*y*T)*U,e[6]=(b*d*o-c*A*o-b*s*p+t*A*p+c*s*T-t*d*T)*U,e[7]=(c*y*o-g*d*o+g*s*p-t*y*p-c*s*E+t*d*E)*U,e[8]=V*U,e[9]=(b*v*o-g*D*o-b*i*E+t*D*E+g*i*T-t*v*T)*U,e[10]=(c*D*o-b*h*o+b*i*p-t*D*p-c*i*T+t*h*T)*U,e[11]=(g*h*o-c*v*o-g*i*p+t*v*p+c*i*E-t*h*E)*U,e[12]=j*U,e[13]=(g*D*s-b*v*s+b*i*y-t*D*y-g*i*A+t*v*A)*U,e[14]=(b*h*s-c*D*s-b*i*d+t*D*d+c*i*A-t*h*A)*U,e[15]=(c*v*s-g*h*s+g*i*d-t*v*d-c*i*y+t*h*y)*U,this}scale(e){const t=this.elements,i=e.x,s=e.y,o=e.z;return t[0]*=i,t[4]*=s,t[8]*=o,t[1]*=i,t[5]*=s,t[9]*=o,t[2]*=i,t[6]*=s,t[10]*=o,t[3]*=i,t[7]*=s,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,s))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),s=Math.sin(t),o=1-i,c=e.x,h=e.y,d=e.z,p=o*c,g=o*h;return this.set(p*c+i,p*h-s*d,p*d+s*h,0,p*h+s*d,g*h+i,g*d-s*c,0,p*d-s*h,g*d+s*c,o*d*d+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,o,c){return this.set(1,i,o,0,e,1,c,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){const s=this.elements,o=t._x,c=t._y,h=t._z,d=t._w,p=o+o,g=c+c,v=h+h,y=o*p,E=o*g,b=o*v,D=c*g,A=c*v,T=h*v,P=d*p,k=d*g,V=d*v,j=i.x,q=i.y,U=i.z;return s[0]=(1-(D+T))*j,s[1]=(E+V)*j,s[2]=(b-k)*j,s[3]=0,s[4]=(E-V)*q,s[5]=(1-(y+T))*q,s[6]=(A+P)*q,s[7]=0,s[8]=(b+k)*U,s[9]=(A-P)*U,s[10]=(1-(y+D))*U,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){const s=this.elements;let o=$l.set(s[0],s[1],s[2]).length();const c=$l.set(s[4],s[5],s[6]).length(),h=$l.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),e.x=s[12],e.y=s[13],e.z=s[14],Or.copy(this);const p=1/o,g=1/c,v=1/h;return Or.elements[0]*=p,Or.elements[1]*=p,Or.elements[2]*=p,Or.elements[4]*=g,Or.elements[5]*=g,Or.elements[6]*=g,Or.elements[8]*=v,Or.elements[9]*=v,Or.elements[10]*=v,t.setFromRotationMatrix(Or),i.x=o,i.y=c,i.z=h,this}makePerspective(e,t,i,s,o,c,h=ls,d=!1){const p=this.elements,g=2*o/(t-e),v=2*o/(i-s),y=(t+e)/(t-e),E=(i+s)/(i-s);let b,D;if(d)b=o/(c-o),D=c*o/(c-o);else if(h===ls)b=-(c+o)/(c-o),D=-2*c*o/(c-o);else if(h===dp)b=-c/(c-o),D=-c*o/(c-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+h);return p[0]=g,p[4]=0,p[8]=y,p[12]=0,p[1]=0,p[5]=v,p[9]=E,p[13]=0,p[2]=0,p[6]=0,p[10]=b,p[14]=D,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,i,s,o,c,h=ls,d=!1){const p=this.elements,g=2/(t-e),v=2/(i-s),y=-(t+e)/(t-e),E=-(i+s)/(i-s);let b,D;if(d)b=1/(c-o),D=c/(c-o);else if(h===ls)b=-2/(c-o),D=-(c+o)/(c-o);else if(h===dp)b=-1/(c-o),D=-o/(c-o);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+h);return p[0]=g,p[4]=0,p[8]=0,p[12]=y,p[1]=0,p[5]=v,p[9]=0,p[13]=E,p[2]=0,p[6]=0,p[10]=b,p[14]=D,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const $l=new he,Or=new Dn,iF=new he(0,0,0),rF=new he(1,1,1),Ia=new he,pf=new he,ir=new he,Ab=new Dn,Mb=new Fh;class qr{constructor(e=0,t=0,i=0,s=qr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,s=this._order){return this._x=e,this._y=t,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const s=e.elements,o=s[0],c=s[4],h=s[8],d=s[1],p=s[5],g=s[9],v=s[2],y=s[6],E=s[10];switch(t){case"XYZ":this._y=Math.asin(Wt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-g,E),this._z=Math.atan2(-c,o)):(this._x=Math.atan2(y,p),this._z=0);break;case"YXZ":this._x=Math.asin(-Wt(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(h,E),this._z=Math.atan2(d,p)):(this._y=Math.atan2(-v,o),this._z=0);break;case"ZXY":this._x=Math.asin(Wt(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-v,E),this._z=Math.atan2(-c,p)):(this._y=0,this._z=Math.atan2(d,o));break;case"ZYX":this._y=Math.asin(-Wt(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(y,E),this._z=Math.atan2(d,o)):(this._x=0,this._z=Math.atan2(-c,p));break;case"YZX":this._z=Math.asin(Wt(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-g,p),this._y=Math.atan2(-v,o)):(this._x=0,this._y=Math.atan2(h,E));break;case"XZY":this._z=Math.asin(-Wt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(y,p),this._y=Math.atan2(h,o)):(this._x=Math.atan2(-g,E),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return Ab.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ab,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Mb.setFromEuler(this),this.setFromQuaternion(Mb,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}qr.DEFAULT_ORDER="XYZ";class v0{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let sF=0;const wb=new he,Ql=new Fh,Fs=new Dn,mf=new he,Bu=new he,aF=new he,oF=new Fh,Rb=new he(1,0,0),Cb=new he(0,1,0),Ib=new he(0,0,1),Db={type:"added"},lF={type:"removed"},Zl={type:"childadded",child:null},__={type:"childremoved",child:null};class yi extends Vc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:sF++}),this.uuid=ja(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=yi.DEFAULT_UP.clone();const e=new he,t=new qr,i=new Fh,s=new he(1,1,1);function o(){i.setFromEuler(t,!1)}function c(){t.setFromQuaternion(i,void 0,!1)}t._onChange(o),i._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Dn},normalMatrix:{value:new Dt}}),this.matrix=new Dn,this.matrixWorld=new Dn,this.matrixAutoUpdate=yi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=yi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new v0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ql.setFromAxisAngle(e,t),this.quaternion.multiply(Ql),this}rotateOnWorldAxis(e,t){return Ql.setFromAxisAngle(e,t),this.quaternion.premultiply(Ql),this}rotateX(e){return this.rotateOnAxis(Rb,e)}rotateY(e){return this.rotateOnAxis(Cb,e)}rotateZ(e){return this.rotateOnAxis(Ib,e)}translateOnAxis(e,t){return wb.copy(e).applyQuaternion(this.quaternion),this.position.add(wb.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Rb,e)}translateY(e){return this.translateOnAxis(Cb,e)}translateZ(e){return this.translateOnAxis(Ib,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Fs.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?mf.copy(e):mf.set(e,t,i);const s=this.parent;this.updateWorldMatrix(!0,!1),Bu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Fs.lookAt(Bu,mf,this.up):Fs.lookAt(mf,Bu,this.up),this.quaternion.setFromRotationMatrix(Fs),s&&(Fs.extractRotation(s.matrixWorld),Ql.setFromRotationMatrix(Fs),this.quaternion.premultiply(Ql.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Db),Zl.child=e,this.dispatchEvent(Zl),Zl.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(lF),__.child=e,this.dispatchEvent(__),__.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Fs.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Fs.multiply(e.parent.matrixWorld)),e.applyMatrix4(Fs),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Db),Zl.child=e,this.dispatchEvent(Zl),Zl.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,s=this.children.length;i<s;i++){const c=this.children[i].getObjectByProperty(e,t);if(c!==void 0)return c}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const s=this.children;for(let o=0,c=s.length;o<c;o++)s[o].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Bu,e,aF),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Bu,oF,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let o=0,c=s.length;o<c;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(h=>({...h,boundingBox:h.boundingBox?h.boundingBox.toJSON():void 0,boundingSphere:h.boundingSphere?h.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(h=>({...h})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function o(h,d){return h[d.uuid]===void 0&&(h[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(e.geometries,this.geometry);const h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){const d=h.shapes;if(Array.isArray(d))for(let p=0,g=d.length;p<g;p++){const v=d[p];o(e.shapes,v)}else o(e.shapes,d)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const h=[];for(let d=0,p=this.material.length;d<p;d++)h.push(o(e.materials,this.material[d]));s.material=h}else s.material=o(e.materials,this.material);if(this.children.length>0){s.children=[];for(let h=0;h<this.children.length;h++)s.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let h=0;h<this.animations.length;h++){const d=this.animations[h];s.animations.push(o(e.animations,d))}}if(t){const h=c(e.geometries),d=c(e.materials),p=c(e.textures),g=c(e.images),v=c(e.shapes),y=c(e.skeletons),E=c(e.animations),b=c(e.nodes);h.length>0&&(i.geometries=h),d.length>0&&(i.materials=d),p.length>0&&(i.textures=p),g.length>0&&(i.images=g),v.length>0&&(i.shapes=v),y.length>0&&(i.skeletons=y),E.length>0&&(i.animations=E),b.length>0&&(i.nodes=b)}return i.object=s,i;function c(h){const d=[];for(const p in h){const g=h[p];delete g.metadata,d.push(g)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}}yi.DEFAULT_UP=new he(0,1,0);yi.DEFAULT_MATRIX_AUTO_UPDATE=!0;yi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Vr=new he,ks=new he,v_=new he,zs=new he,Jl=new he,ec=new he,Nb=new he,y_=new he,E_=new he,S_=new he,T_=new Vn,x_=new Vn,b_=new Vn;class Mr{constructor(e=new he,t=new he,i=new he){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),Vr.subVectors(e,t),s.cross(Vr);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(e,t,i,s,o){Vr.subVectors(s,t),ks.subVectors(i,t),v_.subVectors(e,t);const c=Vr.dot(Vr),h=Vr.dot(ks),d=Vr.dot(v_),p=ks.dot(ks),g=ks.dot(v_),v=c*p-h*h;if(v===0)return o.set(0,0,0),null;const y=1/v,E=(p*d-h*g)*y,b=(c*g-h*d)*y;return o.set(1-E-b,b,E)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,zs)===null?!1:zs.x>=0&&zs.y>=0&&zs.x+zs.y<=1}static getInterpolation(e,t,i,s,o,c,h,d){return this.getBarycoord(e,t,i,s,zs)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(o,zs.x),d.addScaledVector(c,zs.y),d.addScaledVector(h,zs.z),d)}static getInterpolatedAttribute(e,t,i,s,o,c){return T_.setScalar(0),x_.setScalar(0),b_.setScalar(0),T_.fromBufferAttribute(e,t),x_.fromBufferAttribute(e,i),b_.fromBufferAttribute(e,s),c.setScalar(0),c.addScaledVector(T_,o.x),c.addScaledVector(x_,o.y),c.addScaledVector(b_,o.z),c}static isFrontFacing(e,t,i,s){return Vr.subVectors(i,t),ks.subVectors(e,t),Vr.cross(ks).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Vr.subVectors(this.c,this.b),ks.subVectors(this.a,this.b),Vr.cross(ks).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Mr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Mr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,s,o){return Mr.getInterpolation(e,this.a,this.b,this.c,t,i,s,o)}containsPoint(e){return Mr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Mr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,s=this.b,o=this.c;let c,h;Jl.subVectors(s,i),ec.subVectors(o,i),y_.subVectors(e,i);const d=Jl.dot(y_),p=ec.dot(y_);if(d<=0&&p<=0)return t.copy(i);E_.subVectors(e,s);const g=Jl.dot(E_),v=ec.dot(E_);if(g>=0&&v<=g)return t.copy(s);const y=d*v-g*p;if(y<=0&&d>=0&&g<=0)return c=d/(d-g),t.copy(i).addScaledVector(Jl,c);S_.subVectors(e,o);const E=Jl.dot(S_),b=ec.dot(S_);if(b>=0&&E<=b)return t.copy(o);const D=E*p-d*b;if(D<=0&&p>=0&&b<=0)return h=p/(p-b),t.copy(i).addScaledVector(ec,h);const A=g*b-E*v;if(A<=0&&v-g>=0&&E-b>=0)return Nb.subVectors(o,s),h=(v-g)/(v-g+(E-b)),t.copy(s).addScaledVector(Nb,h);const T=1/(A+D+y);return c=D*T,h=y*T,t.copy(i).addScaledVector(Jl,c).addScaledVector(ec,h)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const vR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Da={h:0,s:0,l:0},gf={h:0,s:0,l:0};function A_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Bt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=br){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,tn.colorSpaceToWorking(this,t),this}setRGB(e,t,i,s=tn.workingColorSpace){return this.r=e,this.g=t,this.b=i,tn.colorSpaceToWorking(this,s),this}setHSL(e,t,i,s=tn.workingColorSpace){if(e=XV(e,1),t=Wt(t,0,1),i=Wt(i,0,1),t===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+t):i+t-i*t,c=2*i-o;this.r=A_(c,o,e+1/3),this.g=A_(c,o,e),this.b=A_(c,o,e-1/3)}return tn.colorSpaceToWorking(this,s),this}setStyle(e,t=br){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const c=s[1],h=s[2];switch(c){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=s[1],c=o.length;if(c===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(c===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=br){const i=vR[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=$s(e.r),this.g=$s(e.g),this.b=$s(e.b),this}copyLinearToSRGB(e){return this.r=vc(e.r),this.g=vc(e.g),this.b=vc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=br){return tn.workingToColorSpace(Mi.copy(this),e),Math.round(Wt(Mi.r*255,0,255))*65536+Math.round(Wt(Mi.g*255,0,255))*256+Math.round(Wt(Mi.b*255,0,255))}getHexString(e=br){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=tn.workingColorSpace){tn.workingToColorSpace(Mi.copy(this),t);const i=Mi.r,s=Mi.g,o=Mi.b,c=Math.max(i,s,o),h=Math.min(i,s,o);let d,p;const g=(h+c)/2;if(h===c)d=0,p=0;else{const v=c-h;switch(p=g<=.5?v/(c+h):v/(2-c-h),c){case i:d=(s-o)/v+(s<o?6:0);break;case s:d=(o-i)/v+2;break;case o:d=(i-s)/v+4;break}d/=6}return e.h=d,e.s=p,e.l=g,e}getRGB(e,t=tn.workingColorSpace){return tn.workingToColorSpace(Mi.copy(this),t),e.r=Mi.r,e.g=Mi.g,e.b=Mi.b,e}getStyle(e=br){tn.workingToColorSpace(Mi.copy(this),e);const t=Mi.r,i=Mi.g,s=Mi.b;return e!==br?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,t,i){return this.getHSL(Da),this.setHSL(Da.h+e,Da.s+t,Da.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Da),e.getHSL(gf);const i=o_(Da.h,gf.h,t),s=o_(Da.s,gf.s,t),o=o_(Da.l,gf.l,t);return this.setHSL(i,s,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,s=this.b,o=e.elements;return this.r=o[0]*t+o[3]*i+o[6]*s,this.g=o[1]*t+o[4]*i+o[7]*s,this.b=o[2]*t+o[5]*i+o[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Mi=new Bt;Bt.NAMES=vR;let cF=0;class al extends Vc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:cF++}),this.uuid=ja(),this.name="",this.type="Material",this.blending=_c,this.side=Ya,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=hv,this.blendDst=dv,this.blendEquation=Fo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Bt(0,0,0),this.blendAlpha=0,this.depthFunc=Mc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=yb,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ql,this.stencilZFail=ql,this.stencilZPass=ql,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==_c&&(i.blending=this.blending),this.side!==Ya&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==hv&&(i.blendSrc=this.blendSrc),this.blendDst!==dv&&(i.blendDst=this.blendDst),this.blendEquation!==Fo&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Mc&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==yb&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ql&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ql&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ql&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(o){const c=[];for(const h in o){const d=o[h];delete d.metadata,c.push(d)}return c}if(t){const o=s(e.textures),c=s(e.images);o.length>0&&(i.textures=o),c.length>0&&(i.images=c)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const s=t.length;i=new Array(s);for(let o=0;o!==s;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class yR extends al{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Bt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new qr,this.combine=Vp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Wn=new he,_f=new Nt;let uF=0;class Hr{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:uF++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Zv,this.updateRanges=[],this.gpuType=Xs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)_f.fromBufferAttribute(this,t),_f.applyMatrix3(e),this.setXY(t,_f.x,_f.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Wn.fromBufferAttribute(this,t),Wn.applyMatrix3(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Wn.fromBufferAttribute(this,t),Wn.applyMatrix4(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Wn.fromBufferAttribute(this,t),Wn.applyNormalMatrix(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Wn.fromBufferAttribute(this,t),Wn.transformDirection(e),this.setXYZ(t,Wn.x,Wn.y,Wn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=as(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=gn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=as(t,this.array)),t}setX(e,t){return this.normalized&&(t=gn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=as(t,this.array)),t}setY(e,t){return this.normalized&&(t=gn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=as(t,this.array)),t}setZ(e,t){return this.normalized&&(t=gn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=as(t,this.array)),t}setW(e,t){return this.normalized&&(t=gn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=gn(t,this.array),i=gn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=gn(t,this.array),i=gn(i,this.array),s=gn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,o){return e*=this.itemSize,this.normalized&&(t=gn(t,this.array),i=gn(i,this.array),s=gn(s,this.array),o=gn(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Zv&&(e.usage=this.usage),e}}class ER extends Hr{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class SR extends Hr{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class or extends Hr{constructor(e,t,i){super(new Float32Array(e),t,i)}}let hF=0;const Tr=new Dn,M_=new yi,tc=new he,rr=new kh,Hu=new kh,li=new he;class gs extends Vc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:hF++}),this.uuid=ja(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(mR(e)?SR:ER)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Dt().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Tr.makeRotationFromQuaternion(e),this.applyMatrix4(Tr),this}rotateX(e){return Tr.makeRotationX(e),this.applyMatrix4(Tr),this}rotateY(e){return Tr.makeRotationY(e),this.applyMatrix4(Tr),this}rotateZ(e){return Tr.makeRotationZ(e),this.applyMatrix4(Tr),this}translate(e,t,i){return Tr.makeTranslation(e,t,i),this.applyMatrix4(Tr),this}scale(e,t,i){return Tr.makeScale(e,t,i),this.applyMatrix4(Tr),this}lookAt(e){return M_.lookAt(e),M_.updateMatrix(),this.applyMatrix4(M_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(tc).negate(),this.translate(tc.x,tc.y,tc.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let s=0,o=e.length;s<o;s++){const c=e[s];i.push(c.x,c.y,c.z||0)}this.setAttribute("position",new or(i,3))}else{const i=Math.min(e.length,t.count);for(let s=0;s<i;s++){const o=e[s];t.setXYZ(s,o.x,o.y,o.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new kh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new he(-1/0,-1/0,-1/0),new he(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++){const o=t[i];rr.setFromBufferAttribute(o),this.morphTargetsRelative?(li.addVectors(this.boundingBox.min,rr.min),this.boundingBox.expandByPoint(li),li.addVectors(this.boundingBox.max,rr.max),this.boundingBox.expandByPoint(li)):(this.boundingBox.expandByPoint(rr.min),this.boundingBox.expandByPoint(rr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new _0);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new he,1/0);return}if(e){const i=this.boundingSphere.center;if(rr.setFromBufferAttribute(e),t)for(let o=0,c=t.length;o<c;o++){const h=t[o];Hu.setFromBufferAttribute(h),this.morphTargetsRelative?(li.addVectors(rr.min,Hu.min),rr.expandByPoint(li),li.addVectors(rr.max,Hu.max),rr.expandByPoint(li)):(rr.expandByPoint(Hu.min),rr.expandByPoint(Hu.max))}rr.getCenter(i);let s=0;for(let o=0,c=e.count;o<c;o++)li.fromBufferAttribute(e,o),s=Math.max(s,i.distanceToSquared(li));if(t)for(let o=0,c=t.length;o<c;o++){const h=t[o],d=this.morphTargetsRelative;for(let p=0,g=h.count;p<g;p++)li.fromBufferAttribute(h,p),d&&(tc.fromBufferAttribute(e,p),li.add(tc)),s=Math.max(s,i.distanceToSquared(li))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,s=t.normal,o=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Hr(new Float32Array(4*i.count),4));const c=this.getAttribute("tangent"),h=[],d=[];for(let N=0;N<i.count;N++)h[N]=new he,d[N]=new he;const p=new he,g=new he,v=new he,y=new Nt,E=new Nt,b=new Nt,D=new he,A=new he;function T(N,M,w){p.fromBufferAttribute(i,N),g.fromBufferAttribute(i,M),v.fromBufferAttribute(i,w),y.fromBufferAttribute(o,N),E.fromBufferAttribute(o,M),b.fromBufferAttribute(o,w),g.sub(p),v.sub(p),E.sub(y),b.sub(y);const R=1/(E.x*b.y-b.x*E.y);isFinite(R)&&(D.copy(g).multiplyScalar(b.y).addScaledVector(v,-E.y).multiplyScalar(R),A.copy(v).multiplyScalar(E.x).addScaledVector(g,-b.x).multiplyScalar(R),h[N].add(D),h[M].add(D),h[w].add(D),d[N].add(A),d[M].add(A),d[w].add(A))}let P=this.groups;P.length===0&&(P=[{start:0,count:e.count}]);for(let N=0,M=P.length;N<M;++N){const w=P[N],R=w.start,O=w.count;for(let L=R,re=R+O;L<re;L+=3)T(e.getX(L+0),e.getX(L+1),e.getX(L+2))}const k=new he,V=new he,j=new he,q=new he;function U(N){j.fromBufferAttribute(s,N),q.copy(j);const M=h[N];k.copy(M),k.sub(j.multiplyScalar(j.dot(M))).normalize(),V.crossVectors(q,M);const R=V.dot(d[N])<0?-1:1;c.setXYZW(N,k.x,k.y,k.z,R)}for(let N=0,M=P.length;N<M;++N){const w=P[N],R=w.start,O=w.count;for(let L=R,re=R+O;L<re;L+=3)U(e.getX(L+0)),U(e.getX(L+1)),U(e.getX(L+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Hr(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let y=0,E=i.count;y<E;y++)i.setXYZ(y,0,0,0);const s=new he,o=new he,c=new he,h=new he,d=new he,p=new he,g=new he,v=new he;if(e)for(let y=0,E=e.count;y<E;y+=3){const b=e.getX(y+0),D=e.getX(y+1),A=e.getX(y+2);s.fromBufferAttribute(t,b),o.fromBufferAttribute(t,D),c.fromBufferAttribute(t,A),g.subVectors(c,o),v.subVectors(s,o),g.cross(v),h.fromBufferAttribute(i,b),d.fromBufferAttribute(i,D),p.fromBufferAttribute(i,A),h.add(g),d.add(g),p.add(g),i.setXYZ(b,h.x,h.y,h.z),i.setXYZ(D,d.x,d.y,d.z),i.setXYZ(A,p.x,p.y,p.z)}else for(let y=0,E=t.count;y<E;y+=3)s.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),c.fromBufferAttribute(t,y+2),g.subVectors(c,o),v.subVectors(s,o),g.cross(v),i.setXYZ(y+0,g.x,g.y,g.z),i.setXYZ(y+1,g.x,g.y,g.z),i.setXYZ(y+2,g.x,g.y,g.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)li.fromBufferAttribute(e,t),li.normalize(),e.setXYZ(t,li.x,li.y,li.z)}toNonIndexed(){function e(h,d){const p=h.array,g=h.itemSize,v=h.normalized,y=new p.constructor(d.length*g);let E=0,b=0;for(let D=0,A=d.length;D<A;D++){h.isInterleavedBufferAttribute?E=d[D]*h.data.stride+h.offset:E=d[D]*g;for(let T=0;T<g;T++)y[b++]=p[E++]}return new Hr(y,g,v)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new gs,i=this.index.array,s=this.attributes;for(const h in s){const d=s[h],p=e(d,i);t.setAttribute(h,p)}const o=this.morphAttributes;for(const h in o){const d=[],p=o[h];for(let g=0,v=p.length;g<v;g++){const y=p[g],E=e(y,i);d.push(E)}t.morphAttributes[h]=d}t.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let h=0,d=c.length;h<d;h++){const p=c[h];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const p in d)d[p]!==void 0&&(e[p]=d[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const d in i){const p=i[d];e.data.attributes[d]=p.toJSON(e.data)}const s={};let o=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],g=[];for(let v=0,y=p.length;v<y;v++){const E=p[v];g.push(E.toJSON(e.data))}g.length>0&&(s[d]=g,o=!0)}o&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const h=this.boundingSphere;return h!==null&&(e.data.boundingSphere=h.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const s=e.attributes;for(const p in s){const g=s[p];this.setAttribute(p,g.clone(t))}const o=e.morphAttributes;for(const p in o){const g=[],v=o[p];for(let y=0,E=v.length;y<E;y++)g.push(v[y].clone(t));this.morphAttributes[p]=g}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let p=0,g=c.length;p<g;p++){const v=c[p];this.addGroup(v.start,v.count,v.materialIndex)}const h=e.boundingBox;h!==null&&(this.boundingBox=h.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Pb=new Dn,Do=new _R,vf=new _0,Ub=new he,yf=new he,Ef=new he,Sf=new he,w_=new he,Tf=new he,Lb=new he,xf=new he;class Wi extends yi{constructor(e=new gs,t=new yR){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,c=s.length;o<c;o++){const h=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=o}}}}getVertexPosition(e,t){const i=this.geometry,s=i.attributes.position,o=i.morphAttributes.position,c=i.morphTargetsRelative;t.fromBufferAttribute(s,e);const h=this.morphTargetInfluences;if(o&&h){Tf.set(0,0,0);for(let d=0,p=o.length;d<p;d++){const g=h[d],v=o[d];g!==0&&(w_.fromBufferAttribute(v,e),c?Tf.addScaledVector(w_,g):Tf.addScaledVector(w_.sub(t),g))}t.add(Tf)}return t}raycast(e,t){const i=this.geometry,s=this.material,o=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),vf.copy(i.boundingSphere),vf.applyMatrix4(o),Do.copy(e.ray).recast(e.near),!(vf.containsPoint(Do.origin)===!1&&(Do.intersectSphere(vf,Ub)===null||Do.origin.distanceToSquared(Ub)>(e.far-e.near)**2))&&(Pb.copy(o).invert(),Do.copy(e.ray).applyMatrix4(Pb),!(i.boundingBox!==null&&Do.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Do)))}_computeIntersections(e,t,i){let s;const o=this.geometry,c=this.material,h=o.index,d=o.attributes.position,p=o.attributes.uv,g=o.attributes.uv1,v=o.attributes.normal,y=o.groups,E=o.drawRange;if(h!==null)if(Array.isArray(c))for(let b=0,D=y.length;b<D;b++){const A=y[b],T=c[A.materialIndex],P=Math.max(A.start,E.start),k=Math.min(h.count,Math.min(A.start+A.count,E.start+E.count));for(let V=P,j=k;V<j;V+=3){const q=h.getX(V),U=h.getX(V+1),N=h.getX(V+2);s=bf(this,T,e,i,p,g,v,q,U,N),s&&(s.faceIndex=Math.floor(V/3),s.face.materialIndex=A.materialIndex,t.push(s))}}else{const b=Math.max(0,E.start),D=Math.min(h.count,E.start+E.count);for(let A=b,T=D;A<T;A+=3){const P=h.getX(A),k=h.getX(A+1),V=h.getX(A+2);s=bf(this,c,e,i,p,g,v,P,k,V),s&&(s.faceIndex=Math.floor(A/3),t.push(s))}}else if(d!==void 0)if(Array.isArray(c))for(let b=0,D=y.length;b<D;b++){const A=y[b],T=c[A.materialIndex],P=Math.max(A.start,E.start),k=Math.min(d.count,Math.min(A.start+A.count,E.start+E.count));for(let V=P,j=k;V<j;V+=3){const q=V,U=V+1,N=V+2;s=bf(this,T,e,i,p,g,v,q,U,N),s&&(s.faceIndex=Math.floor(V/3),s.face.materialIndex=A.materialIndex,t.push(s))}}else{const b=Math.max(0,E.start),D=Math.min(d.count,E.start+E.count);for(let A=b,T=D;A<T;A+=3){const P=A,k=A+1,V=A+2;s=bf(this,c,e,i,p,g,v,P,k,V),s&&(s.faceIndex=Math.floor(A/3),t.push(s))}}}}function dF(n,e,t,i,s,o,c,h){let d;if(e.side===Yi?d=i.intersectTriangle(c,o,s,!0,h):d=i.intersectTriangle(s,o,c,e.side===Ya,h),d===null)return null;xf.copy(h),xf.applyMatrix4(n.matrixWorld);const p=t.ray.origin.distanceTo(xf);return p<t.near||p>t.far?null:{distance:p,point:xf.clone(),object:n}}function bf(n,e,t,i,s,o,c,h,d,p){n.getVertexPosition(h,yf),n.getVertexPosition(d,Ef),n.getVertexPosition(p,Sf);const g=dF(n,e,t,i,yf,Ef,Sf,Lb);if(g){const v=new he;Mr.getBarycoord(Lb,yf,Ef,Sf,v),s&&(g.uv=Mr.getInterpolatedAttribute(s,h,d,p,v,new Nt)),o&&(g.uv1=Mr.getInterpolatedAttribute(o,h,d,p,v,new Nt)),c&&(g.normal=Mr.getInterpolatedAttribute(c,h,d,p,v,new he),g.normal.dot(i.direction)>0&&g.normal.multiplyScalar(-1));const y={a:h,b:d,c:p,normal:new he,materialIndex:0};Mr.getNormal(yf,Ef,Sf,y.normal),g.face=y,g.barycoord=v}return g}class tl extends gs{constructor(e=1,t=1,i=1,s=1,o=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:o,depthSegments:c};const h=this;s=Math.floor(s),o=Math.floor(o),c=Math.floor(c);const d=[],p=[],g=[],v=[];let y=0,E=0;b("z","y","x",-1,-1,i,t,e,c,o,0),b("z","y","x",1,-1,i,t,-e,c,o,1),b("x","z","y",1,1,e,i,t,s,c,2),b("x","z","y",1,-1,e,i,-t,s,c,3),b("x","y","z",1,-1,e,t,i,s,o,4),b("x","y","z",-1,-1,e,t,-i,s,o,5),this.setIndex(d),this.setAttribute("position",new or(p,3)),this.setAttribute("normal",new or(g,3)),this.setAttribute("uv",new or(v,2));function b(D,A,T,P,k,V,j,q,U,N,M){const w=V/U,R=j/N,O=V/2,L=j/2,re=q/2,oe=U+1,X=N+1;let Z=0,J=0;const Ae=new he;for(let H=0;H<X;H++){const ee=H*R-L;for(let ye=0;ye<oe;ye++){const Ee=ye*w-O;Ae[D]=Ee*P,Ae[A]=ee*k,Ae[T]=re,p.push(Ae.x,Ae.y,Ae.z),Ae[D]=0,Ae[A]=0,Ae[T]=q>0?1:-1,g.push(Ae.x,Ae.y,Ae.z),v.push(ye/U),v.push(1-H/N),Z+=1}}for(let H=0;H<N;H++)for(let ee=0;ee<U;ee++){const ye=y+ee+oe*H,Ee=y+ee+oe*(H+1),Pe=y+(ee+1)+oe*(H+1),qe=y+(ee+1)+oe*H;d.push(ye,Ee,qe),d.push(Ee,Pe,qe),J+=6}h.addGroup(E,J,M),E+=J,y+=Z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ic(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const s=n[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():Array.isArray(s)?e[t][i]=s.slice():e[t][i]=s}}return e}function Li(n){const e={};for(let t=0;t<n.length;t++){const i=Ic(n[t]);for(const s in i)e[s]=i[s]}return e}function fF(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function TR(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:tn.workingColorSpace}const pF={clone:Ic,merge:Li};var mF=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,gF=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ka extends al{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=mF,this.fragmentShader=gF,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ic(e.uniforms),this.uniformsGroups=fF(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const c=this.uniforms[s].value;c&&c.isTexture?t.uniforms[s]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?t.uniforms[s]={type:"c",value:c.getHex()}:c&&c.isVector2?t.uniforms[s]={type:"v2",value:c.toArray()}:c&&c.isVector3?t.uniforms[s]={type:"v3",value:c.toArray()}:c&&c.isVector4?t.uniforms[s]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?t.uniforms[s]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?t.uniforms[s]={type:"m4",value:c.toArray()}:t.uniforms[s]={value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class xR extends yi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Dn,this.projectionMatrix=new Dn,this.projectionMatrixInverse=new Dn,this.coordinateSystem=ls,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Na=new he,Ob=new Nt,Vb=new Nt;class Ar extends xR{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Jv*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(a_*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Jv*2*Math.atan(Math.tan(a_*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Na.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Na.x,Na.y).multiplyScalar(-e/Na.z),Na.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Na.x,Na.y).multiplyScalar(-e/Na.z)}getViewSize(e,t){return this.getViewBounds(e,Ob,Vb),t.subVectors(Vb,Ob)}setViewOffset(e,t,i,s,o,c){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(a_*.5*this.fov)/this.zoom,i=2*t,s=this.aspect*i,o=-.5*s;const c=this.view;if(this.view!==null&&this.view.enabled){const d=c.fullWidth,p=c.fullHeight;o+=c.offsetX*s/d,t-=c.offsetY*i/p,s*=c.width/d,i*=c.height/p}const h=this.filmOffset;h!==0&&(o+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,t,t-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const nc=-90,ic=1;class _F extends yi{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Ar(nc,ic,e,t);s.layers=this.layers,this.add(s);const o=new Ar(nc,ic,e,t);o.layers=this.layers,this.add(o);const c=new Ar(nc,ic,e,t);c.layers=this.layers,this.add(c);const h=new Ar(nc,ic,e,t);h.layers=this.layers,this.add(h);const d=new Ar(nc,ic,e,t);d.layers=this.layers,this.add(d);const p=new Ar(nc,ic,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,s,o,c,h,d]=t;for(const p of t)this.remove(p);if(e===ls)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),h.up.set(0,1,0),h.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===dp)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),h.up.set(0,-1,0),h.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,c,h,d,p,g]=this.children,v=e.getRenderTarget(),y=e.getActiveCubeFace(),E=e.getActiveMipmapLevel(),b=e.xr.enabled;e.xr.enabled=!1;const D=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(t,o),e.setRenderTarget(i,1,s),e.render(t,c),e.setRenderTarget(i,2,s),e.render(t,h),e.setRenderTarget(i,3,s),e.render(t,d),e.setRenderTarget(i,4,s),e.render(t,p),i.texture.generateMipmaps=D,e.setRenderTarget(i,5,s),e.render(t,g),e.setRenderTarget(v,y,E),e.xr.enabled=b,i.texture.needsPMREMUpdate=!0}}class bR extends ki{constructor(e=[],t=wc,i,s,o,c,h,d,p,g){super(e,t,i,s,o,c,h,d,p,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class vF extends el{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];this.texture=new bR(s),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new tl(5,5,5),o=new Ka({name:"CubemapFromEquirect",uniforms:Ic(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Yi,blending:Ha});o.uniforms.tEquirect.value=t;const c=new Wi(s,o),h=t.minFilter;return t.minFilter===jo&&(t.minFilter=os),new _F(1,10,this).update(e,c),t.minFilter=h,c.geometry.dispose(),c.material.dispose(),this}clear(e,t=!0,i=!0,s=!0){const o=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,i,s);e.setRenderTarget(o)}}class Af extends yi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const yF={type:"move"};class R_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Af,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Af,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new he,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new he),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Af,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new he,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new he),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let s=null,o=null,c=null;const h=this._targetRay,d=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){c=!0;for(const D of e.hand.values()){const A=t.getJointPose(D,i),T=this._getHandJoint(p,D);A!==null&&(T.matrix.fromArray(A.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=A.radius),T.visible=A!==null}const g=p.joints["index-finger-tip"],v=p.joints["thumb-tip"],y=g.position.distanceTo(v.position),E=.02,b=.005;p.inputState.pinching&&y>E+b?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&y<=E-b&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(d.matrix.fromArray(o.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,o.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(o.linearVelocity)):d.hasLinearVelocity=!1,o.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(o.angularVelocity)):d.hasAngularVelocity=!1));h!==null&&(s=t.getPose(e.targetRaySpace,i),s===null&&o!==null&&(s=o),s!==null&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(yF)))}return h!==null&&(h.visible=s!==null),d!==null&&(d.visible=o!==null),p!==null&&(p.visible=c!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Af;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class EF extends yi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new qr,this.environmentIntensity=1,this.environmentRotation=new qr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class SF{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Zv,this.updateRanges=[],this.version=0,this.uuid=ja()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let s=0,o=this.stride;s<o;s++)this.array[e+s]=t.array[i+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ja()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ja()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Pi=new he;class pp{constructor(e,t,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyMatrix4(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.applyNormalMatrix(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Pi.fromBufferAttribute(this,t),Pi.transformDirection(e),this.setXYZ(t,Pi.x,Pi.y,Pi.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=as(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=gn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=gn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=gn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=gn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=gn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=as(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=as(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=as(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=as(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=gn(t,this.array),i=gn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=gn(t,this.array),i=gn(i,this.array),s=gn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,t,i,s,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=gn(t,this.array),i=gn(i,this.array),s=gn(s,this.array),o=gn(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[s+o])}return new Hr(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new pp(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class AR extends al{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Bt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let rc;const Gu=new he,sc=new he,ac=new he,oc=new Nt,ju=new Nt,MR=new Dn,Mf=new he,qu=new he,wf=new he,Fb=new Nt,C_=new Nt,kb=new Nt;class TF extends yi{constructor(e=new AR){if(super(),this.isSprite=!0,this.type="Sprite",rc===void 0){rc=new gs;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new SF(t,5);rc.setIndex([0,1,2,0,2,3]),rc.setAttribute("position",new pp(i,3,0,!1)),rc.setAttribute("uv",new pp(i,2,3,!1))}this.geometry=rc,this.material=e,this.center=new Nt(.5,.5),this.count=1}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),sc.setFromMatrixScale(this.matrixWorld),MR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ac.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&sc.multiplyScalar(-ac.z);const i=this.material.rotation;let s,o;i!==0&&(o=Math.cos(i),s=Math.sin(i));const c=this.center;Rf(Mf.set(-.5,-.5,0),ac,c,sc,s,o),Rf(qu.set(.5,-.5,0),ac,c,sc,s,o),Rf(wf.set(.5,.5,0),ac,c,sc,s,o),Fb.set(0,0),C_.set(1,0),kb.set(1,1);let h=e.ray.intersectTriangle(Mf,qu,wf,!1,Gu);if(h===null&&(Rf(qu.set(-.5,.5,0),ac,c,sc,s,o),C_.set(0,1),h=e.ray.intersectTriangle(Mf,wf,qu,!1,Gu),h===null))return;const d=e.ray.origin.distanceTo(Gu);d<e.near||d>e.far||t.push({distance:d,point:Gu.clone(),uv:Mr.getInterpolation(Gu,Mf,qu,wf,Fb,C_,kb,new Nt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Rf(n,e,t,i,s,o){oc.subVectors(n,t).addScalar(.5).multiply(i),s!==void 0?(ju.x=o*oc.x-s*oc.y,ju.y=s*oc.x+o*oc.y):ju.copy(oc),n.copy(e),n.x+=ju.x,n.y+=ju.y,n.applyMatrix4(MR)}const I_=new he,xF=new he,bF=new Dt;class Oo{constructor(e=new he(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const s=I_.subVectors(i,t).cross(xF.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(I_),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||bF.getNormalMatrix(e),s=this.coplanarPoint(I_).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const No=new _0,AF=new Nt(.5,.5),Cf=new he;class y0{constructor(e=new Oo,t=new Oo,i=new Oo,s=new Oo,o=new Oo,c=new Oo){this.planes=[e,t,i,s,o,c]}set(e,t,i,s,o,c){const h=this.planes;return h[0].copy(e),h[1].copy(t),h[2].copy(i),h[3].copy(s),h[4].copy(o),h[5].copy(c),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ls,i=!1){const s=this.planes,o=e.elements,c=o[0],h=o[1],d=o[2],p=o[3],g=o[4],v=o[5],y=o[6],E=o[7],b=o[8],D=o[9],A=o[10],T=o[11],P=o[12],k=o[13],V=o[14],j=o[15];if(s[0].setComponents(p-c,E-g,T-b,j-P).normalize(),s[1].setComponents(p+c,E+g,T+b,j+P).normalize(),s[2].setComponents(p+h,E+v,T+D,j+k).normalize(),s[3].setComponents(p-h,E-v,T-D,j-k).normalize(),i)s[4].setComponents(d,y,A,V).normalize(),s[5].setComponents(p-d,E-y,T-A,j-V).normalize();else if(s[4].setComponents(p-d,E-y,T-A,j-V).normalize(),t===ls)s[5].setComponents(p+d,E+y,T+A,j+V).normalize();else if(t===dp)s[5].setComponents(d,y,A,V).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),No.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),No.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(No)}intersectsSprite(e){No.center.set(0,0,0);const t=AF.distanceTo(e.center);return No.radius=.7071067811865476+t,No.applyMatrix4(e.matrixWorld),this.intersectsSphere(No)}intersectsSphere(e){const t=this.planes,i=e.center,s=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const s=t[i];if(Cf.x=s.normal.x>0?e.max.x:e.min.x,Cf.y=s.normal.y>0?e.max.y:e.min.y,Cf.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Cf)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class MF extends ki{constructor(e,t,i,s,o,c,h,d,p){super(e,t,i,s,o,c,h,d,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class wR extends ki{constructor(e,t,i=Jo,s,o,c,h=Br,d=Br,p,g=vh,v=1){if(g!==vh&&g!==yh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const y={width:e,height:t,depth:v};super(y,s,o,c,h,d,g,i,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new g0(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class RR extends ki{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class kp extends gs{constructor(e=1,t=1,i=1,s=32,o=1,c=!1,h=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:s,heightSegments:o,openEnded:c,thetaStart:h,thetaLength:d};const p=this;s=Math.floor(s),o=Math.floor(o);const g=[],v=[],y=[],E=[];let b=0;const D=[],A=i/2;let T=0;P(),c===!1&&(e>0&&k(!0),t>0&&k(!1)),this.setIndex(g),this.setAttribute("position",new or(v,3)),this.setAttribute("normal",new or(y,3)),this.setAttribute("uv",new or(E,2));function P(){const V=new he,j=new he;let q=0;const U=(t-e)/i;for(let N=0;N<=o;N++){const M=[],w=N/o,R=w*(t-e)+e;for(let O=0;O<=s;O++){const L=O/s,re=L*d+h,oe=Math.sin(re),X=Math.cos(re);j.x=R*oe,j.y=-w*i+A,j.z=R*X,v.push(j.x,j.y,j.z),V.set(oe,U,X).normalize(),y.push(V.x,V.y,V.z),E.push(L,1-w),M.push(b++)}D.push(M)}for(let N=0;N<s;N++)for(let M=0;M<o;M++){const w=D[M][N],R=D[M+1][N],O=D[M+1][N+1],L=D[M][N+1];(e>0||M!==0)&&(g.push(w,R,L),q+=3),(t>0||M!==o-1)&&(g.push(R,O,L),q+=3)}p.addGroup(T,q,0),T+=q}function k(V){const j=b,q=new Nt,U=new he;let N=0;const M=V===!0?e:t,w=V===!0?1:-1;for(let O=1;O<=s;O++)v.push(0,A*w,0),y.push(0,w,0),E.push(.5,.5),b++;const R=b;for(let O=0;O<=s;O++){const re=O/s*d+h,oe=Math.cos(re),X=Math.sin(re);U.x=M*X,U.y=A*w,U.z=M*oe,v.push(U.x,U.y,U.z),y.push(0,w,0),q.x=oe*.5+.5,q.y=X*.5*w+.5,E.push(q.x,q.y),b++}for(let O=0;O<s;O++){const L=j+O,re=R+O;V===!0?g.push(re,re+1,L):g.push(re+1,re,L),N+=3}p.addGroup(T,N,V===!0?1:2),T+=N}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kp(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class E0 extends kp{constructor(e=1,t=1,i=32,s=1,o=!1,c=0,h=Math.PI*2){super(0,e,t,i,s,o,c,h),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:c,thetaLength:h}}static fromJSON(e){return new E0(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Fa extends gs{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};const o=e/2,c=t/2,h=Math.floor(i),d=Math.floor(s),p=h+1,g=d+1,v=e/h,y=t/d,E=[],b=[],D=[],A=[];for(let T=0;T<g;T++){const P=T*y-c;for(let k=0;k<p;k++){const V=k*v-o;b.push(V,-P,0),D.push(0,0,1),A.push(k/h),A.push(1-T/d)}}for(let T=0;T<d;T++)for(let P=0;P<h;P++){const k=P+p*T,V=P+p*(T+1),j=P+1+p*(T+1),q=P+1+p*T;E.push(k,V,q),E.push(V,j,q)}this.setIndex(E),this.setAttribute("position",new or(b,3)),this.setAttribute("normal",new or(D,3)),this.setAttribute("uv",new or(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fa(e.width,e.height,e.widthSegments,e.heightSegments)}}class S0 extends gs{constructor(e=1,t=32,i=16,s=0,o=Math.PI*2,c=0,h=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:s,phiLength:o,thetaStart:c,thetaLength:h},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const d=Math.min(c+h,Math.PI);let p=0;const g=[],v=new he,y=new he,E=[],b=[],D=[],A=[];for(let T=0;T<=i;T++){const P=[],k=T/i;let V=0;T===0&&c===0?V=.5/t:T===i&&d===Math.PI&&(V=-.5/t);for(let j=0;j<=t;j++){const q=j/t;v.x=-e*Math.cos(s+q*o)*Math.sin(c+k*h),v.y=e*Math.cos(c+k*h),v.z=e*Math.sin(s+q*o)*Math.sin(c+k*h),b.push(v.x,v.y,v.z),y.copy(v).normalize(),D.push(y.x,y.y,y.z),A.push(q+V,1-k),P.push(p++)}g.push(P)}for(let T=0;T<i;T++)for(let P=0;P<t;P++){const k=g[T][P+1],V=g[T][P],j=g[T+1][P],q=g[T+1][P+1];(T!==0||c>0)&&E.push(k,V,q),(T!==i-1||d<Math.PI)&&E.push(V,j,q)}this.setIndex(E),this.setAttribute("position",new or(b,3)),this.setAttribute("normal",new or(D,3)),this.setAttribute("uv",new or(A,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new S0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class zb extends al{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Bt(16777215),this.specular=new Bt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Bt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=m0,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new qr,this.combine=Vp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bb extends al{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Bt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Bt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=m0,this.normalScale=new Nt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new qr,this.combine=Vp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class wF extends al{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=VV,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class RF extends al{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class CR extends yi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Bt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}const D_=new Dn,Hb=new he,Gb=new he;class CF{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Nt(512,512),this.mapType=ms,this.map=null,this.mapPass=null,this.matrix=new Dn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new y0,this._frameExtents=new Nt(1,1),this._viewportCount=1,this._viewports=[new Vn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;Hb.setFromMatrixPosition(e.matrixWorld),t.position.copy(Hb),Gb.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Gb),t.updateMatrixWorld(),D_.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(D_,t.coordinateSystem,t.reversedDepth),t.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(D_)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class IR extends xR{constructor(e=-1,t=1,i=1,s=-1,o=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=o,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,o,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=i-e,c=i+e,h=s+t,d=s-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=p*this.view.offsetX,c=o+p*this.view.width,h-=g*this.view.offsetY,d=h-g*this.view.height}this.projectionMatrix.makeOrthographic(o,c,h,d,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class IF extends CF{constructor(){super(new IR(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DF extends CR{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(yi.DEFAULT_UP),this.updateMatrix(),this.target=new yi,this.shadow=new IF}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class NF extends CR{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class PF extends Ar{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}const jb=new Dn;class UF{constructor(e,t,i=0,s=1/0){this.ray=new _R(e,t),this.near=i,this.far=s,this.camera=null,this.layers=new v0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return jb.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(jb),this}intersectObject(e,t=!0,i=[]){return ey(e,this,i,t),i.sort(qb),i}intersectObjects(e,t=!0,i=[]){for(let s=0,o=e.length;s<o;s++)ey(e[s],this,i,t);return i.sort(qb),i}}function qb(n,e){return n.distance-e.distance}function ey(n,e,t,i){let s=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(s=!1),s===!0&&i===!0){const o=n.children;for(let c=0,h=o.length;c<h;c++)ey(o[c],e,t,!0)}}function Wb(n,e,t,i){const s=LF(i);switch(t){case uR:return n*e;case dR:return n*e/s.components*s.byteLength;case d0:return n*e/s.components*s.byteLength;case fR:return n*e*2/s.components*s.byteLength;case f0:return n*e*2/s.components*s.byteLength;case hR:return n*e*3/s.components*s.byteLength;case kr:return n*e*4/s.components*s.byteLength;case p0:return n*e*4/s.components*s.byteLength;case Hf:case Gf:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case jf:case qf:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Av:case wv:return Math.max(n,16)*Math.max(e,8)/4;case bv:case Mv:return Math.max(n,8)*Math.max(e,8)/2;case Rv:case Cv:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Iv:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Dv:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Nv:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case Pv:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case Uv:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case Lv:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case Ov:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case Vv:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case Fv:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case kv:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case zv:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case Bv:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case Hv:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case Gv:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case jv:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case qv:case Wv:case Xv:return Math.ceil(n/4)*Math.ceil(e/4)*16;case Yv:case Kv:return Math.ceil(n/4)*Math.ceil(e/4)*8;case $v:case Qv:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function LF(n){switch(n){case ms:case aR:return{byteLength:1,components:1};case gh:case oR:case Vh:return{byteLength:2,components:1};case u0:case h0:return{byteLength:2,components:4};case Jo:case c0:case Xs:return{byteLength:4,components:1};case lR:case cR:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l0}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=l0);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function DR(){let n=null,e=!1,t=null,i=null;function s(o,c){t(o,c),i=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function OF(n){const e=new WeakMap;function t(h,d){const p=h.array,g=h.usage,v=p.byteLength,y=n.createBuffer();n.bindBuffer(d,y),n.bufferData(d,p,g),h.onUploadCallback();let E;if(p instanceof Float32Array)E=n.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)E=n.HALF_FLOAT;else if(p instanceof Uint16Array)h.isFloat16BufferAttribute?E=n.HALF_FLOAT:E=n.UNSIGNED_SHORT;else if(p instanceof Int16Array)E=n.SHORT;else if(p instanceof Uint32Array)E=n.UNSIGNED_INT;else if(p instanceof Int32Array)E=n.INT;else if(p instanceof Int8Array)E=n.BYTE;else if(p instanceof Uint8Array)E=n.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)E=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:y,type:E,bytesPerElement:p.BYTES_PER_ELEMENT,version:h.version,size:v}}function i(h,d,p){const g=d.array,v=d.updateRanges;if(n.bindBuffer(p,h),v.length===0)n.bufferSubData(p,0,g);else{v.sort((E,b)=>E.start-b.start);let y=0;for(let E=1;E<v.length;E++){const b=v[y],D=v[E];D.start<=b.start+b.count+1?b.count=Math.max(b.count,D.start+D.count-b.start):(++y,v[y]=D)}v.length=y+1;for(let E=0,b=v.length;E<b;E++){const D=v[E];n.bufferSubData(p,D.start*g.BYTES_PER_ELEMENT,g,D.start,D.count)}d.clearUpdateRanges()}d.onUploadCallback()}function s(h){return h.isInterleavedBufferAttribute&&(h=h.data),e.get(h)}function o(h){h.isInterleavedBufferAttribute&&(h=h.data);const d=e.get(h);d&&(n.deleteBuffer(d.buffer),e.delete(h))}function c(h,d){if(h.isInterleavedBufferAttribute&&(h=h.data),h.isGLBufferAttribute){const g=e.get(h);(!g||g.version<h.version)&&e.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}const p=e.get(h);if(p===void 0)e.set(h,t(h,d));else if(p.version<h.version){if(p.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(p.buffer,h,d),p.version=h.version}}return{get:s,remove:o,update:c}}var VF=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,FF=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,kF=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,zF=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,BF=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,HF=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,GF=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,jF=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,qF=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,WF=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,XF=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,YF=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,KF=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,$F=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,QF=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,ZF=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,JF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,ek=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,tk=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,nk=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,ik=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,rk=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,sk=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,ak=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,ok=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,lk=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,ck=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,uk=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,hk=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,dk=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,fk="gl_FragColor = linearToOutputTexel( gl_FragColor );",pk=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,mk=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,gk=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,_k=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,vk=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,yk=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Ek=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Sk=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Tk=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,xk=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,bk=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Ak=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Mk=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,wk=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Rk=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Ck=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Ik=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Dk=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Nk=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Pk=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Uk=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Lk=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Ok=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Vk=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Fk=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,kk=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,zk=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Bk=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Hk=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Gk=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,jk=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,qk=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Wk=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Xk=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Yk=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Kk=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,$k=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Qk=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Zk=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Jk=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,ez=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,tz=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,nz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,iz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,rz=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,sz=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,az=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,oz=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,lz=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,cz=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,uz=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,hz=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,dz=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,fz=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,pz=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,mz=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,gz=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,_z=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,vz=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare, distribution.x );
		#endif
		if ( hard_shadow != 1.0 ) {
			float distance = compare - distribution.x;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,yz=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Ez=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Sz=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Tz=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,xz=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,bz=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Az=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Mz=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wz=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Rz=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Cz=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Iz=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Dz=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Nz=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Pz=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Uz=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Lz=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Oz=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Vz=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Fz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,kz=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Bz=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Hz=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Gz=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,jz=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,qz=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Wz=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Xz=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Yz=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Kz=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$z=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Qz=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zz=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Jz=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eB=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,tB=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nB=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,iB=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,rB=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sB=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aB=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,oB=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lB=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cB=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uB=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,hB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,dB=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fB=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,pB=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,mB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pt={alphahash_fragment:VF,alphahash_pars_fragment:FF,alphamap_fragment:kF,alphamap_pars_fragment:zF,alphatest_fragment:BF,alphatest_pars_fragment:HF,aomap_fragment:GF,aomap_pars_fragment:jF,batching_pars_vertex:qF,batching_vertex:WF,begin_vertex:XF,beginnormal_vertex:YF,bsdfs:KF,iridescence_fragment:$F,bumpmap_pars_fragment:QF,clipping_planes_fragment:ZF,clipping_planes_pars_fragment:JF,clipping_planes_pars_vertex:ek,clipping_planes_vertex:tk,color_fragment:nk,color_pars_fragment:ik,color_pars_vertex:rk,color_vertex:sk,common:ak,cube_uv_reflection_fragment:ok,defaultnormal_vertex:lk,displacementmap_pars_vertex:ck,displacementmap_vertex:uk,emissivemap_fragment:hk,emissivemap_pars_fragment:dk,colorspace_fragment:fk,colorspace_pars_fragment:pk,envmap_fragment:mk,envmap_common_pars_fragment:gk,envmap_pars_fragment:_k,envmap_pars_vertex:vk,envmap_physical_pars_fragment:Ck,envmap_vertex:yk,fog_vertex:Ek,fog_pars_vertex:Sk,fog_fragment:Tk,fog_pars_fragment:xk,gradientmap_pars_fragment:bk,lightmap_pars_fragment:Ak,lights_lambert_fragment:Mk,lights_lambert_pars_fragment:wk,lights_pars_begin:Rk,lights_toon_fragment:Ik,lights_toon_pars_fragment:Dk,lights_phong_fragment:Nk,lights_phong_pars_fragment:Pk,lights_physical_fragment:Uk,lights_physical_pars_fragment:Lk,lights_fragment_begin:Ok,lights_fragment_maps:Vk,lights_fragment_end:Fk,logdepthbuf_fragment:kk,logdepthbuf_pars_fragment:zk,logdepthbuf_pars_vertex:Bk,logdepthbuf_vertex:Hk,map_fragment:Gk,map_pars_fragment:jk,map_particle_fragment:qk,map_particle_pars_fragment:Wk,metalnessmap_fragment:Xk,metalnessmap_pars_fragment:Yk,morphinstance_vertex:Kk,morphcolor_vertex:$k,morphnormal_vertex:Qk,morphtarget_pars_vertex:Zk,morphtarget_vertex:Jk,normal_fragment_begin:ez,normal_fragment_maps:tz,normal_pars_fragment:nz,normal_pars_vertex:iz,normal_vertex:rz,normalmap_pars_fragment:sz,clearcoat_normal_fragment_begin:az,clearcoat_normal_fragment_maps:oz,clearcoat_pars_fragment:lz,iridescence_pars_fragment:cz,opaque_fragment:uz,packing:hz,premultiplied_alpha_fragment:dz,project_vertex:fz,dithering_fragment:pz,dithering_pars_fragment:mz,roughnessmap_fragment:gz,roughnessmap_pars_fragment:_z,shadowmap_pars_fragment:vz,shadowmap_pars_vertex:yz,shadowmap_vertex:Ez,shadowmask_pars_fragment:Sz,skinbase_vertex:Tz,skinning_pars_vertex:xz,skinning_vertex:bz,skinnormal_vertex:Az,specularmap_fragment:Mz,specularmap_pars_fragment:wz,tonemapping_fragment:Rz,tonemapping_pars_fragment:Cz,transmission_fragment:Iz,transmission_pars_fragment:Dz,uv_pars_fragment:Nz,uv_pars_vertex:Pz,uv_vertex:Uz,worldpos_vertex:Lz,background_vert:Oz,background_frag:Vz,backgroundCube_vert:Fz,backgroundCube_frag:kz,cube_vert:zz,cube_frag:Bz,depth_vert:Hz,depth_frag:Gz,distanceRGBA_vert:jz,distanceRGBA_frag:qz,equirect_vert:Wz,equirect_frag:Xz,linedashed_vert:Yz,linedashed_frag:Kz,meshbasic_vert:$z,meshbasic_frag:Qz,meshlambert_vert:Zz,meshlambert_frag:Jz,meshmatcap_vert:eB,meshmatcap_frag:tB,meshnormal_vert:nB,meshnormal_frag:iB,meshphong_vert:rB,meshphong_frag:sB,meshphysical_vert:aB,meshphysical_frag:oB,meshtoon_vert:lB,meshtoon_frag:cB,points_vert:uB,points_frag:hB,shadow_vert:dB,shadow_frag:fB,sprite_vert:pB,sprite_frag:mB},We={common:{diffuse:{value:new Bt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Dt},alphaMap:{value:null},alphaMapTransform:{value:new Dt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Dt}},envmap:{envMap:{value:null},envMapRotation:{value:new Dt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Dt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Dt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Dt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Dt},normalScale:{value:new Nt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Dt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Dt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Dt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Dt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Bt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Bt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Dt},alphaTest:{value:0},uvTransform:{value:new Dt}},sprite:{diffuse:{value:new Bt(16777215)},opacity:{value:1},center:{value:new Nt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Dt},alphaMap:{value:null},alphaMapTransform:{value:new Dt},alphaTest:{value:0}}},ss={basic:{uniforms:Li([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.fog]),vertexShader:Pt.meshbasic_vert,fragmentShader:Pt.meshbasic_frag},lambert:{uniforms:Li([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.fog,We.lights,{emissive:{value:new Bt(0)}}]),vertexShader:Pt.meshlambert_vert,fragmentShader:Pt.meshlambert_frag},phong:{uniforms:Li([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.fog,We.lights,{emissive:{value:new Bt(0)},specular:{value:new Bt(1118481)},shininess:{value:30}}]),vertexShader:Pt.meshphong_vert,fragmentShader:Pt.meshphong_frag},standard:{uniforms:Li([We.common,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.roughnessmap,We.metalnessmap,We.fog,We.lights,{emissive:{value:new Bt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag},toon:{uniforms:Li([We.common,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.gradientmap,We.fog,We.lights,{emissive:{value:new Bt(0)}}]),vertexShader:Pt.meshtoon_vert,fragmentShader:Pt.meshtoon_frag},matcap:{uniforms:Li([We.common,We.bumpmap,We.normalmap,We.displacementmap,We.fog,{matcap:{value:null}}]),vertexShader:Pt.meshmatcap_vert,fragmentShader:Pt.meshmatcap_frag},points:{uniforms:Li([We.points,We.fog]),vertexShader:Pt.points_vert,fragmentShader:Pt.points_frag},dashed:{uniforms:Li([We.common,We.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pt.linedashed_vert,fragmentShader:Pt.linedashed_frag},depth:{uniforms:Li([We.common,We.displacementmap]),vertexShader:Pt.depth_vert,fragmentShader:Pt.depth_frag},normal:{uniforms:Li([We.common,We.bumpmap,We.normalmap,We.displacementmap,{opacity:{value:1}}]),vertexShader:Pt.meshnormal_vert,fragmentShader:Pt.meshnormal_frag},sprite:{uniforms:Li([We.sprite,We.fog]),vertexShader:Pt.sprite_vert,fragmentShader:Pt.sprite_frag},background:{uniforms:{uvTransform:{value:new Dt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pt.background_vert,fragmentShader:Pt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Dt}},vertexShader:Pt.backgroundCube_vert,fragmentShader:Pt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pt.cube_vert,fragmentShader:Pt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pt.equirect_vert,fragmentShader:Pt.equirect_frag},distanceRGBA:{uniforms:Li([We.common,We.displacementmap,{referencePosition:{value:new he},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pt.distanceRGBA_vert,fragmentShader:Pt.distanceRGBA_frag},shadow:{uniforms:Li([We.lights,We.fog,{color:{value:new Bt(0)},opacity:{value:1}}]),vertexShader:Pt.shadow_vert,fragmentShader:Pt.shadow_frag}};ss.physical={uniforms:Li([ss.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Dt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Dt},clearcoatNormalScale:{value:new Nt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Dt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Dt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Dt},sheen:{value:0},sheenColor:{value:new Bt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Dt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Dt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Dt},transmissionSamplerSize:{value:new Nt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Dt},attenuationDistance:{value:0},attenuationColor:{value:new Bt(0)},specularColor:{value:new Bt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Dt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Dt},anisotropyVector:{value:new Nt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Dt}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag};const If={r:0,b:0,g:0},Po=new qr,gB=new Dn;function _B(n,e,t,i,s,o,c){const h=new Bt(0);let d=o===!0?0:1,p,g,v=null,y=0,E=null;function b(k){let V=k.isScene===!0?k.background:null;return V&&V.isTexture&&(V=(k.backgroundBlurriness>0?t:e).get(V)),V}function D(k){let V=!1;const j=b(k);j===null?T(h,d):j&&j.isColor&&(T(j,1),V=!0);const q=n.xr.getEnvironmentBlendMode();q==="additive"?i.buffers.color.setClear(0,0,0,1,c):q==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,c),(n.autoClear||V)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function A(k,V){const j=b(V);j&&(j.isCubeTexture||j.mapping===Fp)?(g===void 0&&(g=new Wi(new tl(1,1,1),new Ka({name:"BackgroundCubeMaterial",uniforms:Ic(ss.backgroundCube.uniforms),vertexShader:ss.backgroundCube.vertexShader,fragmentShader:ss.backgroundCube.fragmentShader,side:Yi,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),g.geometry.deleteAttribute("normal"),g.geometry.deleteAttribute("uv"),g.onBeforeRender=function(q,U,N){this.matrixWorld.copyPosition(N.matrixWorld)},Object.defineProperty(g.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(g)),Po.copy(V.backgroundRotation),Po.x*=-1,Po.y*=-1,Po.z*=-1,j.isCubeTexture&&j.isRenderTargetTexture===!1&&(Po.y*=-1,Po.z*=-1),g.material.uniforms.envMap.value=j,g.material.uniforms.flipEnvMap.value=j.isCubeTexture&&j.isRenderTargetTexture===!1?-1:1,g.material.uniforms.backgroundBlurriness.value=V.backgroundBlurriness,g.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,g.material.uniforms.backgroundRotation.value.setFromMatrix4(gB.makeRotationFromEuler(Po)),g.material.toneMapped=tn.getTransfer(j.colorSpace)!==mn,(v!==j||y!==j.version||E!==n.toneMapping)&&(g.material.needsUpdate=!0,v=j,y=j.version,E=n.toneMapping),g.layers.enableAll(),k.unshift(g,g.geometry,g.material,0,0,null)):j&&j.isTexture&&(p===void 0&&(p=new Wi(new Fa(2,2),new Ka({name:"BackgroundMaterial",uniforms:Ic(ss.background.uniforms),vertexShader:ss.background.vertexShader,fragmentShader:ss.background.fragmentShader,side:Ya,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(p)),p.material.uniforms.t2D.value=j,p.material.uniforms.backgroundIntensity.value=V.backgroundIntensity,p.material.toneMapped=tn.getTransfer(j.colorSpace)!==mn,j.matrixAutoUpdate===!0&&j.updateMatrix(),p.material.uniforms.uvTransform.value.copy(j.matrix),(v!==j||y!==j.version||E!==n.toneMapping)&&(p.material.needsUpdate=!0,v=j,y=j.version,E=n.toneMapping),p.layers.enableAll(),k.unshift(p,p.geometry,p.material,0,0,null))}function T(k,V){k.getRGB(If,TR(n)),i.buffers.color.setClear(If.r,If.g,If.b,V,c)}function P(){g!==void 0&&(g.geometry.dispose(),g.material.dispose(),g=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return h},setClearColor:function(k,V=1){h.set(k),d=V,T(h,d)},getClearAlpha:function(){return d},setClearAlpha:function(k){d=k,T(h,d)},render:D,addToRenderList:A,dispose:P}}function vB(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},s=y(null);let o=s,c=!1;function h(w,R,O,L,re){let oe=!1;const X=v(L,O,R);o!==X&&(o=X,p(o.object)),oe=E(w,L,O,re),oe&&b(w,L,O,re),re!==null&&e.update(re,n.ELEMENT_ARRAY_BUFFER),(oe||c)&&(c=!1,V(w,R,O,L),re!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(re).buffer))}function d(){return n.createVertexArray()}function p(w){return n.bindVertexArray(w)}function g(w){return n.deleteVertexArray(w)}function v(w,R,O){const L=O.wireframe===!0;let re=i[w.id];re===void 0&&(re={},i[w.id]=re);let oe=re[R.id];oe===void 0&&(oe={},re[R.id]=oe);let X=oe[L];return X===void 0&&(X=y(d()),oe[L]=X),X}function y(w){const R=[],O=[],L=[];for(let re=0;re<t;re++)R[re]=0,O[re]=0,L[re]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:R,enabledAttributes:O,attributeDivisors:L,object:w,attributes:{},index:null}}function E(w,R,O,L){const re=o.attributes,oe=R.attributes;let X=0;const Z=O.getAttributes();for(const J in Z)if(Z[J].location>=0){const H=re[J];let ee=oe[J];if(ee===void 0&&(J==="instanceMatrix"&&w.instanceMatrix&&(ee=w.instanceMatrix),J==="instanceColor"&&w.instanceColor&&(ee=w.instanceColor)),H===void 0||H.attribute!==ee||ee&&H.data!==ee.data)return!0;X++}return o.attributesNum!==X||o.index!==L}function b(w,R,O,L){const re={},oe=R.attributes;let X=0;const Z=O.getAttributes();for(const J in Z)if(Z[J].location>=0){let H=oe[J];H===void 0&&(J==="instanceMatrix"&&w.instanceMatrix&&(H=w.instanceMatrix),J==="instanceColor"&&w.instanceColor&&(H=w.instanceColor));const ee={};ee.attribute=H,H&&H.data&&(ee.data=H.data),re[J]=ee,X++}o.attributes=re,o.attributesNum=X,o.index=L}function D(){const w=o.newAttributes;for(let R=0,O=w.length;R<O;R++)w[R]=0}function A(w){T(w,0)}function T(w,R){const O=o.newAttributes,L=o.enabledAttributes,re=o.attributeDivisors;O[w]=1,L[w]===0&&(n.enableVertexAttribArray(w),L[w]=1),re[w]!==R&&(n.vertexAttribDivisor(w,R),re[w]=R)}function P(){const w=o.newAttributes,R=o.enabledAttributes;for(let O=0,L=R.length;O<L;O++)R[O]!==w[O]&&(n.disableVertexAttribArray(O),R[O]=0)}function k(w,R,O,L,re,oe,X){X===!0?n.vertexAttribIPointer(w,R,O,re,oe):n.vertexAttribPointer(w,R,O,L,re,oe)}function V(w,R,O,L){D();const re=L.attributes,oe=O.getAttributes(),X=R.defaultAttributeValues;for(const Z in oe){const J=oe[Z];if(J.location>=0){let Ae=re[Z];if(Ae===void 0&&(Z==="instanceMatrix"&&w.instanceMatrix&&(Ae=w.instanceMatrix),Z==="instanceColor"&&w.instanceColor&&(Ae=w.instanceColor)),Ae!==void 0){const H=Ae.normalized,ee=Ae.itemSize,ye=e.get(Ae);if(ye===void 0)continue;const Ee=ye.buffer,Pe=ye.type,qe=ye.bytesPerElement,le=Pe===n.INT||Pe===n.UNSIGNED_INT||Ae.gpuType===c0;if(Ae.isInterleavedBufferAttribute){const xe=Ae.data,Oe=xe.stride,ht=Ae.offset;if(xe.isInstancedInterleavedBuffer){for(let tt=0;tt<J.locationSize;tt++)T(J.location+tt,xe.meshPerAttribute);w.isInstancedMesh!==!0&&L._maxInstanceCount===void 0&&(L._maxInstanceCount=xe.meshPerAttribute*xe.count)}else for(let tt=0;tt<J.locationSize;tt++)A(J.location+tt);n.bindBuffer(n.ARRAY_BUFFER,Ee);for(let tt=0;tt<J.locationSize;tt++)k(J.location+tt,ee/J.locationSize,Pe,H,Oe*qe,(ht+ee/J.locationSize*tt)*qe,le)}else{if(Ae.isInstancedBufferAttribute){for(let xe=0;xe<J.locationSize;xe++)T(J.location+xe,Ae.meshPerAttribute);w.isInstancedMesh!==!0&&L._maxInstanceCount===void 0&&(L._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let xe=0;xe<J.locationSize;xe++)A(J.location+xe);n.bindBuffer(n.ARRAY_BUFFER,Ee);for(let xe=0;xe<J.locationSize;xe++)k(J.location+xe,ee/J.locationSize,Pe,H,ee*qe,ee/J.locationSize*xe*qe,le)}}else if(X!==void 0){const H=X[Z];if(H!==void 0)switch(H.length){case 2:n.vertexAttrib2fv(J.location,H);break;case 3:n.vertexAttrib3fv(J.location,H);break;case 4:n.vertexAttrib4fv(J.location,H);break;default:n.vertexAttrib1fv(J.location,H)}}}}P()}function j(){N();for(const w in i){const R=i[w];for(const O in R){const L=R[O];for(const re in L)g(L[re].object),delete L[re];delete R[O]}delete i[w]}}function q(w){if(i[w.id]===void 0)return;const R=i[w.id];for(const O in R){const L=R[O];for(const re in L)g(L[re].object),delete L[re];delete R[O]}delete i[w.id]}function U(w){for(const R in i){const O=i[R];if(O[w.id]===void 0)continue;const L=O[w.id];for(const re in L)g(L[re].object),delete L[re];delete O[w.id]}}function N(){M(),c=!0,o!==s&&(o=s,p(o.object))}function M(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:h,reset:N,resetDefaultState:M,dispose:j,releaseStatesOfGeometry:q,releaseStatesOfProgram:U,initAttributes:D,enableAttribute:A,disableUnusedAttributes:P}}function yB(n,e,t){let i;function s(p){i=p}function o(p,g){n.drawArrays(i,p,g),t.update(g,i,1)}function c(p,g,v){v!==0&&(n.drawArraysInstanced(i,p,g,v),t.update(g,i,v))}function h(p,g,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,p,0,g,0,v);let E=0;for(let b=0;b<v;b++)E+=g[b];t.update(E,i,1)}function d(p,g,v,y){if(v===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let b=0;b<p.length;b++)c(p[b],g[b],y[b]);else{E.multiDrawArraysInstancedWEBGL(i,p,0,g,0,y,0,v);let b=0;for(let D=0;D<v;D++)b+=g[D]*y[D];t.update(b,i,1)}}this.setMode=s,this.render=o,this.renderInstances=c,this.renderMultiDraw=h,this.renderMultiDrawInstances=d}function EB(n,e,t,i){let s;function o(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const U=e.get("EXT_texture_filter_anisotropic");s=n.getParameter(U.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function c(U){return!(U!==kr&&i.convert(U)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function h(U){const N=U===Vh&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(U!==ms&&i.convert(U)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&U!==Xs&&!N)}function d(U){if(U==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";U="mediump"}return U==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const g=d(p);g!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",g,"instead."),p=g);const v=t.logarithmicDepthBuffer===!0,y=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),E=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),b=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),D=n.getParameter(n.MAX_TEXTURE_SIZE),A=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),T=n.getParameter(n.MAX_VERTEX_ATTRIBS),P=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),k=n.getParameter(n.MAX_VARYING_VECTORS),V=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),j=b>0,q=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:d,textureFormatReadable:c,textureTypeReadable:h,precision:p,logarithmicDepthBuffer:v,reversedDepthBuffer:y,maxTextures:E,maxVertexTextures:b,maxTextureSize:D,maxCubemapSize:A,maxAttributes:T,maxVertexUniforms:P,maxVaryings:k,maxFragmentUniforms:V,vertexTextures:j,maxSamples:q}}function SB(n){const e=this;let t=null,i=0,s=!1,o=!1;const c=new Oo,h=new Dt,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(v,y){const E=v.length!==0||y||i!==0||s;return s=y,i=v.length,E},this.beginShadows=function(){o=!0,g(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(v,y){t=g(v,y,0)},this.setState=function(v,y,E){const b=v.clippingPlanes,D=v.clipIntersection,A=v.clipShadows,T=n.get(v);if(!s||b===null||b.length===0||o&&!A)o?g(null):p();else{const P=o?0:i,k=P*4;let V=T.clippingState||null;d.value=V,V=g(b,y,k,E);for(let j=0;j!==k;++j)V[j]=t[j];T.clippingState=V,this.numIntersection=D?this.numPlanes:0,this.numPlanes+=P}};function p(){d.value!==t&&(d.value=t,d.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function g(v,y,E,b){const D=v!==null?v.length:0;let A=null;if(D!==0){if(A=d.value,b!==!0||A===null){const T=E+D*4,P=y.matrixWorldInverse;h.getNormalMatrix(P),(A===null||A.length<T)&&(A=new Float32Array(T));for(let k=0,V=E;k!==D;++k,V+=4)c.copy(v[k]).applyMatrix4(P,h),c.normal.toArray(A,V),A[V+3]=c.constant}d.value=A,d.needsUpdate=!0}return e.numPlanes=D,e.numIntersection=0,A}}function TB(n){let e=new WeakMap;function t(c,h){return h===Ev?c.mapping=wc:h===Sv&&(c.mapping=Rc),c}function i(c){if(c&&c.isTexture){const h=c.mapping;if(h===Ev||h===Sv)if(e.has(c)){const d=e.get(c).texture;return t(d,c.mapping)}else{const d=c.image;if(d&&d.height>0){const p=new vF(d.height);return p.fromEquirectangularTexture(n,c),e.set(c,p),c.addEventListener("dispose",s),t(p.texture,c.mapping)}else return null}}return c}function s(c){const h=c.target;h.removeEventListener("dispose",s);const d=e.get(h);d!==void 0&&(e.delete(h),d.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}const dc=4,Xb=[.125,.215,.35,.446,.526,.582],ko=20,N_=new IR,Yb=new Bt;let P_=null,U_=0,L_=0,O_=!1;const Vo=(1+Math.sqrt(5))/2,lc=1/Vo,Kb=[new he(-Vo,lc,0),new he(Vo,lc,0),new he(-lc,0,Vo),new he(lc,0,Vo),new he(0,Vo,-lc),new he(0,Vo,lc),new he(-1,1,-1),new he(1,1,-1),new he(-1,1,1),new he(1,1,1)],xB=new he;class $b{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,s=100,o={}){const{size:c=256,position:h=xB}=o;P_=this._renderer.getRenderTarget(),U_=this._renderer.getActiveCubeFace(),L_=this._renderer.getActiveMipmapLevel(),O_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(c);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,i,s,d,h),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Jb(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Zb(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(P_,U_,L_),this._renderer.xr.enabled=O_,e.scissorTest=!1,Df(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===wc||e.mapping===Rc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),P_=this._renderer.getRenderTarget(),U_=this._renderer.getActiveCubeFace(),L_=this._renderer.getActiveMipmapLevel(),O_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:os,minFilter:os,generateMipmaps:!1,type:Vh,format:kr,colorSpace:Cc,depthBuffer:!1},s=Qb(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Qb(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=bB(o)),this._blurMaterial=AB(o,e,t)}return s}_compileMaterial(e){const t=new Wi(this._lodPlanes[0],e);this._renderer.compile(t,N_)}_sceneToCubeUV(e,t,i,s,o){const d=new Ar(90,1,t,i),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,E=v.toneMapping;v.getClearColor(Yb),v.toneMapping=Ga,v.autoClear=!1,v.state.buffers.depth.getReversed()&&(v.setRenderTarget(s),v.clearDepth(),v.setRenderTarget(null));const D=new yR({name:"PMREM.Background",side:Yi,depthWrite:!1,depthTest:!1}),A=new Wi(new tl,D);let T=!1;const P=e.background;P?P.isColor&&(D.color.copy(P),e.background=null,T=!0):(D.color.copy(Yb),T=!0);for(let k=0;k<6;k++){const V=k%3;V===0?(d.up.set(0,p[k],0),d.position.set(o.x,o.y,o.z),d.lookAt(o.x+g[k],o.y,o.z)):V===1?(d.up.set(0,0,p[k]),d.position.set(o.x,o.y,o.z),d.lookAt(o.x,o.y+g[k],o.z)):(d.up.set(0,p[k],0),d.position.set(o.x,o.y,o.z),d.lookAt(o.x,o.y,o.z+g[k]));const j=this._cubeSize;Df(s,V*j,k>2?j:0,j,j),v.setRenderTarget(s),T&&v.render(A,d),v.render(e,d)}A.geometry.dispose(),A.material.dispose(),v.toneMapping=E,v.autoClear=y,e.background=P}_textureToCubeUV(e,t){const i=this._renderer,s=e.mapping===wc||e.mapping===Rc;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=Jb()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Zb());const o=s?this._cubemapMaterial:this._equirectMaterial,c=new Wi(this._lodPlanes[0],o),h=o.uniforms;h.envMap.value=e;const d=this._cubeSize;Df(t,0,0,3*d,2*d),i.setRenderTarget(t),i.render(c,N_)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let o=1;o<s;o++){const c=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),h=Kb[(s-o-1)%Kb.length];this._blur(e,o-1,o,c,h)}t.autoClear=i}_blur(e,t,i,s,o){const c=this._pingPongRenderTarget;this._halfBlur(e,c,t,i,s,"latitudinal",o),this._halfBlur(c,e,i,i,s,"longitudinal",o)}_halfBlur(e,t,i,s,o,c,h){const d=this._renderer,p=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const g=3,v=new Wi(this._lodPlanes[s],p),y=p.uniforms,E=this._sizeLods[i]-1,b=isFinite(o)?Math.PI/(2*E):2*Math.PI/(2*ko-1),D=o/b,A=isFinite(o)?1+Math.floor(g*D):ko;A>ko&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${A} samples when the maximum is set to ${ko}`);const T=[];let P=0;for(let U=0;U<ko;++U){const N=U/D,M=Math.exp(-N*N/2);T.push(M),U===0?P+=M:U<A&&(P+=2*M)}for(let U=0;U<T.length;U++)T[U]=T[U]/P;y.envMap.value=e.texture,y.samples.value=A,y.weights.value=T,y.latitudinal.value=c==="latitudinal",h&&(y.poleAxis.value=h);const{_lodMax:k}=this;y.dTheta.value=b,y.mipInt.value=k-i;const V=this._sizeLods[s],j=3*V*(s>k-dc?s-k+dc:0),q=4*(this._cubeSize-V);Df(t,j,q,3*V,2*V),d.setRenderTarget(t),d.render(v,N_)}}function bB(n){const e=[],t=[],i=[];let s=n;const o=n-dc+1+Xb.length;for(let c=0;c<o;c++){const h=Math.pow(2,s);t.push(h);let d=1/h;c>n-dc?d=Xb[c-n+dc-1]:c===0&&(d=0),i.push(d);const p=1/(h-2),g=-p,v=1+p,y=[g,g,v,g,v,v,g,g,v,v,g,v],E=6,b=6,D=3,A=2,T=1,P=new Float32Array(D*b*E),k=new Float32Array(A*b*E),V=new Float32Array(T*b*E);for(let q=0;q<E;q++){const U=q%3*2/3-1,N=q>2?0:-1,M=[U,N,0,U+2/3,N,0,U+2/3,N+1,0,U,N,0,U+2/3,N+1,0,U,N+1,0];P.set(M,D*b*q),k.set(y,A*b*q);const w=[q,q,q,q,q,q];V.set(w,T*b*q)}const j=new gs;j.setAttribute("position",new Hr(P,D)),j.setAttribute("uv",new Hr(k,A)),j.setAttribute("faceIndex",new Hr(V,T)),e.push(j),s>dc&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function Qb(n,e,t){const i=new el(n,e,t);return i.texture.mapping=Fp,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Df(n,e,t,i,s){n.viewport.set(e,t,i,s),n.scissor.set(e,t,i,s)}function AB(n,e,t){const i=new Float32Array(ko),s=new he(0,1,0);return new Ka({name:"SphericalGaussianBlur",defines:{n:ko,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:T0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ha,depthTest:!1,depthWrite:!1})}function Zb(){return new Ka({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:T0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ha,depthTest:!1,depthWrite:!1})}function Jb(){return new Ka({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:T0(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ha,depthTest:!1,depthWrite:!1})}function T0(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function MB(n){let e=new WeakMap,t=null;function i(h){if(h&&h.isTexture){const d=h.mapping,p=d===Ev||d===Sv,g=d===wc||d===Rc;if(p||g){let v=e.get(h);const y=v!==void 0?v.texture.pmremVersion:0;if(h.isRenderTargetTexture&&h.pmremVersion!==y)return t===null&&(t=new $b(n)),v=p?t.fromEquirectangular(h,v):t.fromCubemap(h,v),v.texture.pmremVersion=h.pmremVersion,e.set(h,v),v.texture;if(v!==void 0)return v.texture;{const E=h.image;return p&&E&&E.height>0||g&&E&&s(E)?(t===null&&(t=new $b(n)),v=p?t.fromEquirectangular(h):t.fromCubemap(h),v.texture.pmremVersion=h.pmremVersion,e.set(h,v),h.addEventListener("dispose",o),v.texture):null}}}return h}function s(h){let d=0;const p=6;for(let g=0;g<p;g++)h[g]!==void 0&&d++;return d===p}function o(h){const d=h.target;d.removeEventListener("dispose",o);const p=e.get(d);p!==void 0&&(e.delete(d),p.dispose())}function c(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:c}}function wB(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let s;switch(i){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(i)}return e[i]=s,s}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const s=t(i);return s===null&&Eh("THREE.WebGLRenderer: "+i+" extension not supported."),s}}}function RB(n,e,t,i){const s={},o=new WeakMap;function c(v){const y=v.target;y.index!==null&&e.remove(y.index);for(const b in y.attributes)e.remove(y.attributes[b]);y.removeEventListener("dispose",c),delete s[y.id];const E=o.get(y);E&&(e.remove(E),o.delete(y)),i.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function h(v,y){return s[y.id]===!0||(y.addEventListener("dispose",c),s[y.id]=!0,t.memory.geometries++),y}function d(v){const y=v.attributes;for(const E in y)e.update(y[E],n.ARRAY_BUFFER)}function p(v){const y=[],E=v.index,b=v.attributes.position;let D=0;if(E!==null){const P=E.array;D=E.version;for(let k=0,V=P.length;k<V;k+=3){const j=P[k+0],q=P[k+1],U=P[k+2];y.push(j,q,q,U,U,j)}}else if(b!==void 0){const P=b.array;D=b.version;for(let k=0,V=P.length/3-1;k<V;k+=3){const j=k+0,q=k+1,U=k+2;y.push(j,q,q,U,U,j)}}else return;const A=new(mR(y)?SR:ER)(y,1);A.version=D;const T=o.get(v);T&&e.remove(T),o.set(v,A)}function g(v){const y=o.get(v);if(y){const E=v.index;E!==null&&y.version<E.version&&p(v)}else p(v);return o.get(v)}return{get:h,update:d,getWireframeAttribute:g}}function CB(n,e,t){let i;function s(y){i=y}let o,c;function h(y){o=y.type,c=y.bytesPerElement}function d(y,E){n.drawElements(i,E,o,y*c),t.update(E,i,1)}function p(y,E,b){b!==0&&(n.drawElementsInstanced(i,E,o,y*c,b),t.update(E,i,b))}function g(y,E,b){if(b===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,E,0,o,y,0,b);let A=0;for(let T=0;T<b;T++)A+=E[T];t.update(A,i,1)}function v(y,E,b,D){if(b===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let T=0;T<y.length;T++)p(y[T]/c,E[T],D[T]);else{A.multiDrawElementsInstancedWEBGL(i,E,0,o,y,0,D,0,b);let T=0;for(let P=0;P<b;P++)T+=E[P]*D[P];t.update(T,i,1)}}this.setMode=s,this.setIndex=h,this.render=d,this.renderInstances=p,this.renderMultiDraw=g,this.renderMultiDrawInstances=v}function IB(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,c,h){switch(t.calls++,c){case n.TRIANGLES:t.triangles+=h*(o/3);break;case n.LINES:t.lines+=h*(o/2);break;case n.LINE_STRIP:t.lines+=h*(o-1);break;case n.LINE_LOOP:t.lines+=h*o;break;case n.POINTS:t.points+=h*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:i}}function DB(n,e,t){const i=new WeakMap,s=new Vn;function o(c,h,d){const p=c.morphTargetInfluences,g=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,v=g!==void 0?g.length:0;let y=i.get(h);if(y===void 0||y.count!==v){let w=function(){N.dispose(),i.delete(h),h.removeEventListener("dispose",w)};var E=w;y!==void 0&&y.texture.dispose();const b=h.morphAttributes.position!==void 0,D=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,T=h.morphAttributes.position||[],P=h.morphAttributes.normal||[],k=h.morphAttributes.color||[];let V=0;b===!0&&(V=1),D===!0&&(V=2),A===!0&&(V=3);let j=h.attributes.position.count*V,q=1;j>e.maxTextureSize&&(q=Math.ceil(j/e.maxTextureSize),j=e.maxTextureSize);const U=new Float32Array(j*q*4*v),N=new gR(U,j,q,v);N.type=Xs,N.needsUpdate=!0;const M=V*4;for(let R=0;R<v;R++){const O=T[R],L=P[R],re=k[R],oe=j*q*4*R;for(let X=0;X<O.count;X++){const Z=X*M;b===!0&&(s.fromBufferAttribute(O,X),U[oe+Z+0]=s.x,U[oe+Z+1]=s.y,U[oe+Z+2]=s.z,U[oe+Z+3]=0),D===!0&&(s.fromBufferAttribute(L,X),U[oe+Z+4]=s.x,U[oe+Z+5]=s.y,U[oe+Z+6]=s.z,U[oe+Z+7]=0),A===!0&&(s.fromBufferAttribute(re,X),U[oe+Z+8]=s.x,U[oe+Z+9]=s.y,U[oe+Z+10]=s.z,U[oe+Z+11]=re.itemSize===4?s.w:1)}}y={count:v,texture:N,size:new Nt(j,q)},i.set(h,y),h.addEventListener("dispose",w)}if(c.isInstancedMesh===!0&&c.morphTexture!==null)d.getUniforms().setValue(n,"morphTexture",c.morphTexture,t);else{let b=0;for(let A=0;A<p.length;A++)b+=p[A];const D=h.morphTargetsRelative?1:1-b;d.getUniforms().setValue(n,"morphTargetBaseInfluence",D),d.getUniforms().setValue(n,"morphTargetInfluences",p)}d.getUniforms().setValue(n,"morphTargetsTexture",y.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",y.size)}return{update:o}}function NB(n,e,t,i){let s=new WeakMap;function o(d){const p=i.render.frame,g=d.geometry,v=e.get(d,g);if(s.get(v)!==p&&(e.update(v),s.set(v,p)),d.isInstancedMesh&&(d.hasEventListener("dispose",h)===!1&&d.addEventListener("dispose",h),s.get(d)!==p&&(t.update(d.instanceMatrix,n.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,n.ARRAY_BUFFER),s.set(d,p))),d.isSkinnedMesh){const y=d.skeleton;s.get(y)!==p&&(y.update(),s.set(y,p))}return v}function c(){s=new WeakMap}function h(d){const p=d.target;p.removeEventListener("dispose",h),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:o,dispose:c}}const NR=new ki,eA=new wR(1,1),PR=new gR,UR=new tF,LR=new bR,tA=[],nA=[],iA=new Float32Array(16),rA=new Float32Array(9),sA=new Float32Array(4);function Fc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const s=e*t;let o=tA[s];if(o===void 0&&(o=new Float32Array(s),tA[s]=o),e!==0){i.toArray(o,0);for(let c=1,h=0;c!==e;++c)h+=t,n[c].toArray(o,h)}return o}function ti(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function ni(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function zp(n,e){let t=nA[e];t===void 0&&(t=new Int32Array(e),nA[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function PB(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function UB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ti(t,e))return;n.uniform2fv(this.addr,e),ni(t,e)}}function LB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ti(t,e))return;n.uniform3fv(this.addr,e),ni(t,e)}}function OB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ti(t,e))return;n.uniform4fv(this.addr,e),ni(t,e)}}function VB(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ti(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ni(t,e)}else{if(ti(t,i))return;sA.set(i),n.uniformMatrix2fv(this.addr,!1,sA),ni(t,i)}}function FB(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ti(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ni(t,e)}else{if(ti(t,i))return;rA.set(i),n.uniformMatrix3fv(this.addr,!1,rA),ni(t,i)}}function kB(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ti(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ni(t,e)}else{if(ti(t,i))return;iA.set(i),n.uniformMatrix4fv(this.addr,!1,iA),ni(t,i)}}function zB(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function BB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ti(t,e))return;n.uniform2iv(this.addr,e),ni(t,e)}}function HB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ti(t,e))return;n.uniform3iv(this.addr,e),ni(t,e)}}function GB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ti(t,e))return;n.uniform4iv(this.addr,e),ni(t,e)}}function jB(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function qB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ti(t,e))return;n.uniform2uiv(this.addr,e),ni(t,e)}}function WB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ti(t,e))return;n.uniform3uiv(this.addr,e),ni(t,e)}}function XB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ti(t,e))return;n.uniform4uiv(this.addr,e),ni(t,e)}}function YB(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s);let o;this.type===n.SAMPLER_2D_SHADOW?(eA.compareFunction=pR,o=eA):o=NR,t.setTexture2D(e||o,s)}function KB(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||UR,s)}function $B(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||LR,s)}function QB(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||PR,s)}function ZB(n){switch(n){case 5126:return PB;case 35664:return UB;case 35665:return LB;case 35666:return OB;case 35674:return VB;case 35675:return FB;case 35676:return kB;case 5124:case 35670:return zB;case 35667:case 35671:return BB;case 35668:case 35672:return HB;case 35669:case 35673:return GB;case 5125:return jB;case 36294:return qB;case 36295:return WB;case 36296:return XB;case 35678:case 36198:case 36298:case 36306:case 35682:return YB;case 35679:case 36299:case 36307:return KB;case 35680:case 36300:case 36308:case 36293:return $B;case 36289:case 36303:case 36311:case 36292:return QB}}function JB(n,e){n.uniform1fv(this.addr,e)}function e4(n,e){const t=Fc(e,this.size,2);n.uniform2fv(this.addr,t)}function t4(n,e){const t=Fc(e,this.size,3);n.uniform3fv(this.addr,t)}function n4(n,e){const t=Fc(e,this.size,4);n.uniform4fv(this.addr,t)}function i4(n,e){const t=Fc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function r4(n,e){const t=Fc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function s4(n,e){const t=Fc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function a4(n,e){n.uniform1iv(this.addr,e)}function o4(n,e){n.uniform2iv(this.addr,e)}function l4(n,e){n.uniform3iv(this.addr,e)}function c4(n,e){n.uniform4iv(this.addr,e)}function u4(n,e){n.uniform1uiv(this.addr,e)}function h4(n,e){n.uniform2uiv(this.addr,e)}function d4(n,e){n.uniform3uiv(this.addr,e)}function f4(n,e){n.uniform4uiv(this.addr,e)}function p4(n,e,t){const i=this.cache,s=e.length,o=zp(t,s);ti(i,o)||(n.uniform1iv(this.addr,o),ni(i,o));for(let c=0;c!==s;++c)t.setTexture2D(e[c]||NR,o[c])}function m4(n,e,t){const i=this.cache,s=e.length,o=zp(t,s);ti(i,o)||(n.uniform1iv(this.addr,o),ni(i,o));for(let c=0;c!==s;++c)t.setTexture3D(e[c]||UR,o[c])}function g4(n,e,t){const i=this.cache,s=e.length,o=zp(t,s);ti(i,o)||(n.uniform1iv(this.addr,o),ni(i,o));for(let c=0;c!==s;++c)t.setTextureCube(e[c]||LR,o[c])}function _4(n,e,t){const i=this.cache,s=e.length,o=zp(t,s);ti(i,o)||(n.uniform1iv(this.addr,o),ni(i,o));for(let c=0;c!==s;++c)t.setTexture2DArray(e[c]||PR,o[c])}function v4(n){switch(n){case 5126:return JB;case 35664:return e4;case 35665:return t4;case 35666:return n4;case 35674:return i4;case 35675:return r4;case 35676:return s4;case 5124:case 35670:return a4;case 35667:case 35671:return o4;case 35668:case 35672:return l4;case 35669:case 35673:return c4;case 5125:return u4;case 36294:return h4;case 36295:return d4;case 36296:return f4;case 35678:case 36198:case 36298:case 36306:case 35682:return p4;case 35679:case 36299:case 36307:return m4;case 35680:case 36300:case 36308:case 36293:return g4;case 36289:case 36303:case 36311:case 36292:return _4}}class y4{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=ZB(t.type)}}class E4{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=v4(t.type)}}class S4{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const s=this.seq;for(let o=0,c=s.length;o!==c;++o){const h=s[o];h.setValue(e,t[h.id],i)}}}const V_=/(\w+)(\])?(\[|\.)?/g;function aA(n,e){n.seq.push(e),n.map[e.id]=e}function T4(n,e,t){const i=n.name,s=i.length;for(V_.lastIndex=0;;){const o=V_.exec(i),c=V_.lastIndex;let h=o[1];const d=o[2]==="]",p=o[3];if(d&&(h=h|0),p===void 0||p==="["&&c+2===s){aA(t,p===void 0?new y4(h,n,e):new E4(h,n,e));break}else{let v=t.map[h];v===void 0&&(v=new S4(h),aA(t,v)),t=v}}}class Wf{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<i;++s){const o=e.getActiveUniform(t,s),c=e.getUniformLocation(t,o.name);T4(o,c,this)}}setValue(e,t,i,s){const o=this.map[t];o!==void 0&&o.setValue(e,i,s)}setOptional(e,t,i){const s=t[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let o=0,c=t.length;o!==c;++o){const h=t[o],d=i[h.id];d.needsUpdate!==!1&&h.setValue(e,d.value,s)}}static seqWithValue(e,t){const i=[];for(let s=0,o=e.length;s!==o;++s){const c=e[s];c.id in t&&i.push(c)}return i}}function oA(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const x4=37297;let b4=0;function A4(n,e){const t=n.split(`
`),i=[],s=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let c=s;c<o;c++){const h=c+1;i.push(`${h===e?">":" "} ${h}: ${t[c]}`)}return i.join(`
`)}const lA=new Dt;function M4(n){tn._getMatrix(lA,tn.workingColorSpace,n);const e=`mat3( ${lA.elements.map(t=>t.toFixed(4))} )`;switch(tn.getTransfer(n)){case hp:return[e,"LinearTransferOETF"];case mn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function cA(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),o=(n.getShaderInfoLog(e)||"").trim();if(i&&o==="")return"";const c=/ERROR: 0:(\d+)/.exec(o);if(c){const h=parseInt(c[1]);return t.toUpperCase()+`

`+o+`

`+A4(n.getShaderSource(e),h)}else return o}function w4(n,e){const t=M4(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function R4(n,e){let t;switch(e){case CV:t="Linear";break;case IV:t="Reinhard";break;case DV:t="Cineon";break;case NV:t="ACESFilmic";break;case UV:t="AgX";break;case LV:t="Neutral";break;case PV:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Nf=new he;function C4(){tn.getLuminanceCoefficients(Nf);const n=Nf.x.toFixed(4),e=Nf.y.toFixed(4),t=Nf.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function I4(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Zu).join(`
`)}function D4(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function N4(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const o=n.getActiveAttrib(e,s),c=o.name;let h=1;o.type===n.FLOAT_MAT2&&(h=2),o.type===n.FLOAT_MAT3&&(h=3),o.type===n.FLOAT_MAT4&&(h=4),t[c]={type:o.type,location:n.getAttribLocation(e,c),locationSize:h}}return t}function Zu(n){return n!==""}function uA(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function hA(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const P4=/^[ \t]*#include +<([\w\d./]+)>/gm;function ty(n){return n.replace(P4,L4)}const U4=new Map;function L4(n,e){let t=Pt[e];if(t===void 0){const i=U4.get(e);if(i!==void 0)t=Pt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return ty(t)}const O4=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function dA(n){return n.replace(O4,V4)}function V4(n,e,t,i){let s="";for(let o=parseInt(e);o<parseInt(t);o++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function fA(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function F4(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===iR?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===rR?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Bs&&(e="SHADOWMAP_TYPE_VSM"),e}function k4(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case wc:case Rc:e="ENVMAP_TYPE_CUBE";break;case Fp:e="ENVMAP_TYPE_CUBE_UV";break}return e}function z4(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Rc:e="ENVMAP_MODE_REFRACTION";break}return e}function B4(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Vp:e="ENVMAP_BLENDING_MULTIPLY";break;case wV:e="ENVMAP_BLENDING_MIX";break;case RV:e="ENVMAP_BLENDING_ADD";break}return e}function H4(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}function G4(n,e,t,i){const s=n.getContext(),o=t.defines;let c=t.vertexShader,h=t.fragmentShader;const d=F4(t),p=k4(t),g=z4(t),v=B4(t),y=H4(t),E=I4(t),b=D4(o),D=s.createProgram();let A,T,P=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Zu).join(`
`),A.length>0&&(A+=`
`),T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Zu).join(`
`),T.length>0&&(T+=`
`)):(A=[fA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Zu).join(`
`),T=[fA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ga?"#define TONE_MAPPING":"",t.toneMapping!==Ga?Pt.tonemapping_pars_fragment:"",t.toneMapping!==Ga?R4("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pt.colorspace_pars_fragment,w4("linearToOutputTexel",t.outputColorSpace),C4(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Zu).join(`
`)),c=ty(c),c=uA(c,t),c=hA(c,t),h=ty(h),h=uA(h,t),h=hA(h,t),c=dA(c),h=dA(h),t.isRawShaderMaterial!==!0&&(P=`#version 300 es
`,A=[E,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+A,T=["#define varying in",t.glslVersion===Eb?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Eb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const k=P+A+c,V=P+T+h,j=oA(s,s.VERTEX_SHADER,k),q=oA(s,s.FRAGMENT_SHADER,V);s.attachShader(D,j),s.attachShader(D,q),t.index0AttributeName!==void 0?s.bindAttribLocation(D,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(D,0,"position"),s.linkProgram(D);function U(R){if(n.debug.checkShaderErrors){const O=s.getProgramInfoLog(D)||"",L=s.getShaderInfoLog(j)||"",re=s.getShaderInfoLog(q)||"",oe=O.trim(),X=L.trim(),Z=re.trim();let J=!0,Ae=!0;if(s.getProgramParameter(D,s.LINK_STATUS)===!1)if(J=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,D,j,q);else{const H=cA(s,j,"vertex"),ee=cA(s,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(D,s.VALIDATE_STATUS)+`

Material Name: `+R.name+`
Material Type: `+R.type+`

Program Info Log: `+oe+`
`+H+`
`+ee)}else oe!==""?console.warn("THREE.WebGLProgram: Program Info Log:",oe):(X===""||Z==="")&&(Ae=!1);Ae&&(R.diagnostics={runnable:J,programLog:oe,vertexShader:{log:X,prefix:A},fragmentShader:{log:Z,prefix:T}})}s.deleteShader(j),s.deleteShader(q),N=new Wf(s,D),M=N4(s,D)}let N;this.getUniforms=function(){return N===void 0&&U(this),N};let M;this.getAttributes=function(){return M===void 0&&U(this),M};let w=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return w===!1&&(w=s.getProgramParameter(D,x4)),w},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(D),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=b4++,this.cacheKey=e,this.usedTimes=1,this.program=D,this.vertexShader=j,this.fragmentShader=q,this}let j4=0;class q4{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(t),o=this._getShaderStage(i),c=this._getShaderCacheForMaterial(e);return c.has(s)===!1&&(c.add(s),s.usedTimes++),c.has(o)===!1&&(c.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new W4(e),t.set(e,i)),i}}class W4{constructor(e){this.id=j4++,this.code=e,this.usedTimes=0}}function X4(n,e,t,i,s,o,c){const h=new v0,d=new q4,p=new Set,g=[],v=s.logarithmicDepthBuffer,y=s.vertexTextures;let E=s.precision;const b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function D(M){return p.add(M),M===0?"uv":`uv${M}`}function A(M,w,R,O,L){const re=O.fog,oe=L.geometry,X=M.isMeshStandardMaterial?O.environment:null,Z=(M.isMeshStandardMaterial?t:e).get(M.envMap||X),J=Z&&Z.mapping===Fp?Z.image.height:null,Ae=b[M.type];M.precision!==null&&(E=s.getMaxPrecision(M.precision),E!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",E,"instead."));const H=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,ee=H!==void 0?H.length:0;let ye=0;oe.morphAttributes.position!==void 0&&(ye=1),oe.morphAttributes.normal!==void 0&&(ye=2),oe.morphAttributes.color!==void 0&&(ye=3);let Ee,Pe,qe,le;if(Ae){const Ut=ss[Ae];Ee=Ut.vertexShader,Pe=Ut.fragmentShader}else Ee=M.vertexShader,Pe=M.fragmentShader,d.update(M),qe=d.getVertexShaderID(M),le=d.getFragmentShaderID(M);const xe=n.getRenderTarget(),Oe=n.state.buffers.depth.getReversed(),ht=L.isInstancedMesh===!0,tt=L.isBatchedMesh===!0,bt=!!M.map,Mn=!!M.matcap,K=!!Z,Zt=!!M.aoMap,vt=!!M.lightMap,ft=!!M.bumpMap,Ke=!!M.normalMap,cn=!!M.displacementMap,Je=!!M.emissiveMap,St=!!M.metalnessMap,yn=!!M.roughnessMap,xn=M.anisotropy>0,W=M.clearcoat>0,F=M.dispersion>0,ce=M.iridescence>0,ge=M.sheen>0,Se=M.transmission>0,ve=xn&&!!M.anisotropyMap,Xe=W&&!!M.clearcoatMap,Fe=W&&!!M.clearcoatNormalMap,st=W&&!!M.clearcoatRoughnessMap,et=ce&&!!M.iridescenceMap,De=ce&&!!M.iridescenceThicknessMap,je=ge&&!!M.sheenColorMap,ot=ge&&!!M.sheenRoughnessMap,nt=!!M.specularMap,He=!!M.specularColorMap,Tt=!!M.specularIntensityMap,Q=Se&&!!M.transmissionMap,Ue=Se&&!!M.thicknessMap,Ve=!!M.gradientMap,Ye=!!M.alphaMap,Ie=M.alphaTest>0,be=!!M.alphaHash,Ze=!!M.extensions;let pt=Ga;M.toneMapped&&(xe===null||xe.isXRRenderTarget===!0)&&(pt=n.toneMapping);const Qt={shaderID:Ae,shaderType:M.type,shaderName:M.name,vertexShader:Ee,fragmentShader:Pe,defines:M.defines,customVertexShaderID:qe,customFragmentShaderID:le,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:E,batching:tt,batchingColor:tt&&L._colorsTexture!==null,instancing:ht,instancingColor:ht&&L.instanceColor!==null,instancingMorph:ht&&L.morphTexture!==null,supportsVertexTextures:y,outputColorSpace:xe===null?n.outputColorSpace:xe.isXRRenderTarget===!0?xe.texture.colorSpace:Cc,alphaToCoverage:!!M.alphaToCoverage,map:bt,matcap:Mn,envMap:K,envMapMode:K&&Z.mapping,envMapCubeUVHeight:J,aoMap:Zt,lightMap:vt,bumpMap:ft,normalMap:Ke,displacementMap:y&&cn,emissiveMap:Je,normalMapObjectSpace:Ke&&M.normalMapType===kV,normalMapTangentSpace:Ke&&M.normalMapType===m0,metalnessMap:St,roughnessMap:yn,anisotropy:xn,anisotropyMap:ve,clearcoat:W,clearcoatMap:Xe,clearcoatNormalMap:Fe,clearcoatRoughnessMap:st,dispersion:F,iridescence:ce,iridescenceMap:et,iridescenceThicknessMap:De,sheen:ge,sheenColorMap:je,sheenRoughnessMap:ot,specularMap:nt,specularColorMap:He,specularIntensityMap:Tt,transmission:Se,transmissionMap:Q,thicknessMap:Ue,gradientMap:Ve,opaque:M.transparent===!1&&M.blending===_c&&M.alphaToCoverage===!1,alphaMap:Ye,alphaTest:Ie,alphaHash:be,combine:M.combine,mapUv:bt&&D(M.map.channel),aoMapUv:Zt&&D(M.aoMap.channel),lightMapUv:vt&&D(M.lightMap.channel),bumpMapUv:ft&&D(M.bumpMap.channel),normalMapUv:Ke&&D(M.normalMap.channel),displacementMapUv:cn&&D(M.displacementMap.channel),emissiveMapUv:Je&&D(M.emissiveMap.channel),metalnessMapUv:St&&D(M.metalnessMap.channel),roughnessMapUv:yn&&D(M.roughnessMap.channel),anisotropyMapUv:ve&&D(M.anisotropyMap.channel),clearcoatMapUv:Xe&&D(M.clearcoatMap.channel),clearcoatNormalMapUv:Fe&&D(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:st&&D(M.clearcoatRoughnessMap.channel),iridescenceMapUv:et&&D(M.iridescenceMap.channel),iridescenceThicknessMapUv:De&&D(M.iridescenceThicknessMap.channel),sheenColorMapUv:je&&D(M.sheenColorMap.channel),sheenRoughnessMapUv:ot&&D(M.sheenRoughnessMap.channel),specularMapUv:nt&&D(M.specularMap.channel),specularColorMapUv:He&&D(M.specularColorMap.channel),specularIntensityMapUv:Tt&&D(M.specularIntensityMap.channel),transmissionMapUv:Q&&D(M.transmissionMap.channel),thicknessMapUv:Ue&&D(M.thicknessMap.channel),alphaMapUv:Ye&&D(M.alphaMap.channel),vertexTangents:!!oe.attributes.tangent&&(Ke||xn),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,pointsUvs:L.isPoints===!0&&!!oe.attributes.uv&&(bt||Ye),fog:!!re,useFog:M.fog===!0,fogExp2:!!re&&re.isFogExp2,flatShading:M.flatShading===!0&&M.wireframe===!1,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:v,reversedDepthBuffer:Oe,skinning:L.isSkinnedMesh===!0,morphTargets:oe.morphAttributes.position!==void 0,morphNormals:oe.morphAttributes.normal!==void 0,morphColors:oe.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:ye,numDirLights:w.directional.length,numPointLights:w.point.length,numSpotLights:w.spot.length,numSpotLightMaps:w.spotLightMap.length,numRectAreaLights:w.rectArea.length,numHemiLights:w.hemi.length,numDirLightShadows:w.directionalShadowMap.length,numPointLightShadows:w.pointShadowMap.length,numSpotLightShadows:w.spotShadowMap.length,numSpotLightShadowsWithMaps:w.numSpotLightShadowsWithMaps,numLightProbes:w.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:M.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:pt,decodeVideoTexture:bt&&M.map.isVideoTexture===!0&&tn.getTransfer(M.map.colorSpace)===mn,decodeVideoTextureEmissive:Je&&M.emissiveMap.isVideoTexture===!0&&tn.getTransfer(M.emissiveMap.colorSpace)===mn,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===Gs,flipSided:M.side===Yi,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionClipCullDistance:Ze&&M.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ze&&M.extensions.multiDraw===!0||tt)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()};return Qt.vertexUv1s=p.has(1),Qt.vertexUv2s=p.has(2),Qt.vertexUv3s=p.has(3),p.clear(),Qt}function T(M){const w=[];if(M.shaderID?w.push(M.shaderID):(w.push(M.customVertexShaderID),w.push(M.customFragmentShaderID)),M.defines!==void 0)for(const R in M.defines)w.push(R),w.push(M.defines[R]);return M.isRawShaderMaterial===!1&&(P(w,M),k(w,M),w.push(n.outputColorSpace)),w.push(M.customProgramCacheKey),w.join()}function P(M,w){M.push(w.precision),M.push(w.outputColorSpace),M.push(w.envMapMode),M.push(w.envMapCubeUVHeight),M.push(w.mapUv),M.push(w.alphaMapUv),M.push(w.lightMapUv),M.push(w.aoMapUv),M.push(w.bumpMapUv),M.push(w.normalMapUv),M.push(w.displacementMapUv),M.push(w.emissiveMapUv),M.push(w.metalnessMapUv),M.push(w.roughnessMapUv),M.push(w.anisotropyMapUv),M.push(w.clearcoatMapUv),M.push(w.clearcoatNormalMapUv),M.push(w.clearcoatRoughnessMapUv),M.push(w.iridescenceMapUv),M.push(w.iridescenceThicknessMapUv),M.push(w.sheenColorMapUv),M.push(w.sheenRoughnessMapUv),M.push(w.specularMapUv),M.push(w.specularColorMapUv),M.push(w.specularIntensityMapUv),M.push(w.transmissionMapUv),M.push(w.thicknessMapUv),M.push(w.combine),M.push(w.fogExp2),M.push(w.sizeAttenuation),M.push(w.morphTargetsCount),M.push(w.morphAttributeCount),M.push(w.numDirLights),M.push(w.numPointLights),M.push(w.numSpotLights),M.push(w.numSpotLightMaps),M.push(w.numHemiLights),M.push(w.numRectAreaLights),M.push(w.numDirLightShadows),M.push(w.numPointLightShadows),M.push(w.numSpotLightShadows),M.push(w.numSpotLightShadowsWithMaps),M.push(w.numLightProbes),M.push(w.shadowMapType),M.push(w.toneMapping),M.push(w.numClippingPlanes),M.push(w.numClipIntersection),M.push(w.depthPacking)}function k(M,w){h.disableAll(),w.supportsVertexTextures&&h.enable(0),w.instancing&&h.enable(1),w.instancingColor&&h.enable(2),w.instancingMorph&&h.enable(3),w.matcap&&h.enable(4),w.envMap&&h.enable(5),w.normalMapObjectSpace&&h.enable(6),w.normalMapTangentSpace&&h.enable(7),w.clearcoat&&h.enable(8),w.iridescence&&h.enable(9),w.alphaTest&&h.enable(10),w.vertexColors&&h.enable(11),w.vertexAlphas&&h.enable(12),w.vertexUv1s&&h.enable(13),w.vertexUv2s&&h.enable(14),w.vertexUv3s&&h.enable(15),w.vertexTangents&&h.enable(16),w.anisotropy&&h.enable(17),w.alphaHash&&h.enable(18),w.batching&&h.enable(19),w.dispersion&&h.enable(20),w.batchingColor&&h.enable(21),w.gradientMap&&h.enable(22),M.push(h.mask),h.disableAll(),w.fog&&h.enable(0),w.useFog&&h.enable(1),w.flatShading&&h.enable(2),w.logarithmicDepthBuffer&&h.enable(3),w.reversedDepthBuffer&&h.enable(4),w.skinning&&h.enable(5),w.morphTargets&&h.enable(6),w.morphNormals&&h.enable(7),w.morphColors&&h.enable(8),w.premultipliedAlpha&&h.enable(9),w.shadowMapEnabled&&h.enable(10),w.doubleSided&&h.enable(11),w.flipSided&&h.enable(12),w.useDepthPacking&&h.enable(13),w.dithering&&h.enable(14),w.transmission&&h.enable(15),w.sheen&&h.enable(16),w.opaque&&h.enable(17),w.pointsUvs&&h.enable(18),w.decodeVideoTexture&&h.enable(19),w.decodeVideoTextureEmissive&&h.enable(20),w.alphaToCoverage&&h.enable(21),M.push(h.mask)}function V(M){const w=b[M.type];let R;if(w){const O=ss[w];R=pF.clone(O.uniforms)}else R=M.uniforms;return R}function j(M,w){let R;for(let O=0,L=g.length;O<L;O++){const re=g[O];if(re.cacheKey===w){R=re,++R.usedTimes;break}}return R===void 0&&(R=new G4(n,w,M,o),g.push(R)),R}function q(M){if(--M.usedTimes===0){const w=g.indexOf(M);g[w]=g[g.length-1],g.pop(),M.destroy()}}function U(M){d.remove(M)}function N(){d.dispose()}return{getParameters:A,getProgramCacheKey:T,getUniforms:V,acquireProgram:j,releaseProgram:q,releaseShaderCache:U,programs:g,dispose:N}}function Y4(){let n=new WeakMap;function e(c){return n.has(c)}function t(c){let h=n.get(c);return h===void 0&&(h={},n.set(c,h)),h}function i(c){n.delete(c)}function s(c,h,d){n.get(c)[h]=d}function o(){n=new WeakMap}return{has:e,get:t,remove:i,update:s,dispose:o}}function K4(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function pA(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function mA(){const n=[];let e=0;const t=[],i=[],s=[];function o(){e=0,t.length=0,i.length=0,s.length=0}function c(v,y,E,b,D,A){let T=n[e];return T===void 0?(T={id:v.id,object:v,geometry:y,material:E,groupOrder:b,renderOrder:v.renderOrder,z:D,group:A},n[e]=T):(T.id=v.id,T.object=v,T.geometry=y,T.material=E,T.groupOrder=b,T.renderOrder=v.renderOrder,T.z=D,T.group=A),e++,T}function h(v,y,E,b,D,A){const T=c(v,y,E,b,D,A);E.transmission>0?i.push(T):E.transparent===!0?s.push(T):t.push(T)}function d(v,y,E,b,D,A){const T=c(v,y,E,b,D,A);E.transmission>0?i.unshift(T):E.transparent===!0?s.unshift(T):t.unshift(T)}function p(v,y){t.length>1&&t.sort(v||K4),i.length>1&&i.sort(y||pA),s.length>1&&s.sort(y||pA)}function g(){for(let v=e,y=n.length;v<y;v++){const E=n[v];if(E.id===null)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}}return{opaque:t,transmissive:i,transparent:s,init:o,push:h,unshift:d,finish:g,sort:p}}function $4(){let n=new WeakMap;function e(i,s){const o=n.get(i);let c;return o===void 0?(c=new mA,n.set(i,[c])):s>=o.length?(c=new mA,o.push(c)):c=o[s],c}function t(){n=new WeakMap}return{get:e,dispose:t}}function Q4(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new he,color:new Bt};break;case"SpotLight":t={position:new he,direction:new he,color:new Bt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new he,color:new Bt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new he,skyColor:new Bt,groundColor:new Bt};break;case"RectAreaLight":t={color:new Bt,position:new he,halfWidth:new he,halfHeight:new he};break}return n[e.id]=t,t}}}function Z4(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Nt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Nt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Nt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let J4=0;function eH(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function tH(n){const e=new Q4,t=Z4(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)i.probe.push(new he);const s=new he,o=new Dn,c=new Dn;function h(p){let g=0,v=0,y=0;for(let M=0;M<9;M++)i.probe[M].set(0,0,0);let E=0,b=0,D=0,A=0,T=0,P=0,k=0,V=0,j=0,q=0,U=0;p.sort(eH);for(let M=0,w=p.length;M<w;M++){const R=p[M],O=R.color,L=R.intensity,re=R.distance,oe=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)g+=O.r*L,v+=O.g*L,y+=O.b*L;else if(R.isLightProbe){for(let X=0;X<9;X++)i.probe[X].addScaledVector(R.sh.coefficients[X],L);U++}else if(R.isDirectionalLight){const X=e.get(R);if(X.color.copy(R.color).multiplyScalar(R.intensity),R.castShadow){const Z=R.shadow,J=t.get(R);J.shadowIntensity=Z.intensity,J.shadowBias=Z.bias,J.shadowNormalBias=Z.normalBias,J.shadowRadius=Z.radius,J.shadowMapSize=Z.mapSize,i.directionalShadow[E]=J,i.directionalShadowMap[E]=oe,i.directionalShadowMatrix[E]=R.shadow.matrix,P++}i.directional[E]=X,E++}else if(R.isSpotLight){const X=e.get(R);X.position.setFromMatrixPosition(R.matrixWorld),X.color.copy(O).multiplyScalar(L),X.distance=re,X.coneCos=Math.cos(R.angle),X.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),X.decay=R.decay,i.spot[D]=X;const Z=R.shadow;if(R.map&&(i.spotLightMap[j]=R.map,j++,Z.updateMatrices(R),R.castShadow&&q++),i.spotLightMatrix[D]=Z.matrix,R.castShadow){const J=t.get(R);J.shadowIntensity=Z.intensity,J.shadowBias=Z.bias,J.shadowNormalBias=Z.normalBias,J.shadowRadius=Z.radius,J.shadowMapSize=Z.mapSize,i.spotShadow[D]=J,i.spotShadowMap[D]=oe,V++}D++}else if(R.isRectAreaLight){const X=e.get(R);X.color.copy(O).multiplyScalar(L),X.halfWidth.set(R.width*.5,0,0),X.halfHeight.set(0,R.height*.5,0),i.rectArea[A]=X,A++}else if(R.isPointLight){const X=e.get(R);if(X.color.copy(R.color).multiplyScalar(R.intensity),X.distance=R.distance,X.decay=R.decay,R.castShadow){const Z=R.shadow,J=t.get(R);J.shadowIntensity=Z.intensity,J.shadowBias=Z.bias,J.shadowNormalBias=Z.normalBias,J.shadowRadius=Z.radius,J.shadowMapSize=Z.mapSize,J.shadowCameraNear=Z.camera.near,J.shadowCameraFar=Z.camera.far,i.pointShadow[b]=J,i.pointShadowMap[b]=oe,i.pointShadowMatrix[b]=R.shadow.matrix,k++}i.point[b]=X,b++}else if(R.isHemisphereLight){const X=e.get(R);X.skyColor.copy(R.color).multiplyScalar(L),X.groundColor.copy(R.groundColor).multiplyScalar(L),i.hemi[T]=X,T++}}A>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=We.LTC_FLOAT_1,i.rectAreaLTC2=We.LTC_FLOAT_2):(i.rectAreaLTC1=We.LTC_HALF_1,i.rectAreaLTC2=We.LTC_HALF_2)),i.ambient[0]=g,i.ambient[1]=v,i.ambient[2]=y;const N=i.hash;(N.directionalLength!==E||N.pointLength!==b||N.spotLength!==D||N.rectAreaLength!==A||N.hemiLength!==T||N.numDirectionalShadows!==P||N.numPointShadows!==k||N.numSpotShadows!==V||N.numSpotMaps!==j||N.numLightProbes!==U)&&(i.directional.length=E,i.spot.length=D,i.rectArea.length=A,i.point.length=b,i.hemi.length=T,i.directionalShadow.length=P,i.directionalShadowMap.length=P,i.pointShadow.length=k,i.pointShadowMap.length=k,i.spotShadow.length=V,i.spotShadowMap.length=V,i.directionalShadowMatrix.length=P,i.pointShadowMatrix.length=k,i.spotLightMatrix.length=V+j-q,i.spotLightMap.length=j,i.numSpotLightShadowsWithMaps=q,i.numLightProbes=U,N.directionalLength=E,N.pointLength=b,N.spotLength=D,N.rectAreaLength=A,N.hemiLength=T,N.numDirectionalShadows=P,N.numPointShadows=k,N.numSpotShadows=V,N.numSpotMaps=j,N.numLightProbes=U,i.version=J4++)}function d(p,g){let v=0,y=0,E=0,b=0,D=0;const A=g.matrixWorldInverse;for(let T=0,P=p.length;T<P;T++){const k=p[T];if(k.isDirectionalLight){const V=i.directional[v];V.direction.setFromMatrixPosition(k.matrixWorld),s.setFromMatrixPosition(k.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(A),v++}else if(k.isSpotLight){const V=i.spot[E];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(A),V.direction.setFromMatrixPosition(k.matrixWorld),s.setFromMatrixPosition(k.target.matrixWorld),V.direction.sub(s),V.direction.transformDirection(A),E++}else if(k.isRectAreaLight){const V=i.rectArea[b];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(A),c.identity(),o.copy(k.matrixWorld),o.premultiply(A),c.extractRotation(o),V.halfWidth.set(k.width*.5,0,0),V.halfHeight.set(0,k.height*.5,0),V.halfWidth.applyMatrix4(c),V.halfHeight.applyMatrix4(c),b++}else if(k.isPointLight){const V=i.point[y];V.position.setFromMatrixPosition(k.matrixWorld),V.position.applyMatrix4(A),y++}else if(k.isHemisphereLight){const V=i.hemi[D];V.direction.setFromMatrixPosition(k.matrixWorld),V.direction.transformDirection(A),D++}}}return{setup:h,setupView:d,state:i}}function gA(n){const e=new tH(n),t=[],i=[];function s(g){p.camera=g,t.length=0,i.length=0}function o(g){t.push(g)}function c(g){i.push(g)}function h(){e.setup(t)}function d(g){e.setupView(t,g)}const p={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:p,setupLights:h,setupLightsView:d,pushLight:o,pushShadow:c}}function nH(n){let e=new WeakMap;function t(s,o=0){const c=e.get(s);let h;return c===void 0?(h=new gA(n),e.set(s,[h])):o>=c.length?(h=new gA(n),c.push(h)):h=c[o],h}function i(){e=new WeakMap}return{get:t,dispose:i}}const iH=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,rH=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function sH(n,e,t){let i=new y0;const s=new Nt,o=new Nt,c=new Vn,h=new wF({depthPacking:FV}),d=new RF,p={},g=t.maxTextureSize,v={[Ya]:Yi,[Yi]:Ya,[Gs]:Gs},y=new Ka({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Nt},radius:{value:4}},vertexShader:iH,fragmentShader:rH}),E=y.clone();E.defines.HORIZONTAL_PASS=1;const b=new gs;b.setAttribute("position",new Hr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const D=new Wi(b,y),A=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=iR;let T=this.type;this.render=function(q,U,N){if(A.enabled===!1||A.autoUpdate===!1&&A.needsUpdate===!1||q.length===0)return;const M=n.getRenderTarget(),w=n.getActiveCubeFace(),R=n.getActiveMipmapLevel(),O=n.state;O.setBlending(Ha),O.buffers.depth.getReversed()===!0?O.buffers.color.setClear(0,0,0,0):O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);const L=T!==Bs&&this.type===Bs,re=T===Bs&&this.type!==Bs;for(let oe=0,X=q.length;oe<X;oe++){const Z=q[oe],J=Z.shadow;if(J===void 0){console.warn("THREE.WebGLShadowMap:",Z,"has no shadow.");continue}if(J.autoUpdate===!1&&J.needsUpdate===!1)continue;s.copy(J.mapSize);const Ae=J.getFrameExtents();if(s.multiply(Ae),o.copy(J.mapSize),(s.x>g||s.y>g)&&(s.x>g&&(o.x=Math.floor(g/Ae.x),s.x=o.x*Ae.x,J.mapSize.x=o.x),s.y>g&&(o.y=Math.floor(g/Ae.y),s.y=o.y*Ae.y,J.mapSize.y=o.y)),J.map===null||L===!0||re===!0){const ee=this.type!==Bs?{minFilter:Br,magFilter:Br}:{};J.map!==null&&J.map.dispose(),J.map=new el(s.x,s.y,ee),J.map.texture.name=Z.name+".shadowMap",J.camera.updateProjectionMatrix()}n.setRenderTarget(J.map),n.clear();const H=J.getViewportCount();for(let ee=0;ee<H;ee++){const ye=J.getViewport(ee);c.set(o.x*ye.x,o.y*ye.y,o.x*ye.z,o.y*ye.w),O.viewport(c),J.updateMatrices(Z,ee),i=J.getFrustum(),V(U,N,J.camera,Z,this.type)}J.isPointLightShadow!==!0&&this.type===Bs&&P(J,N),J.needsUpdate=!1}T=this.type,A.needsUpdate=!1,n.setRenderTarget(M,w,R)};function P(q,U){const N=e.update(D);y.defines.VSM_SAMPLES!==q.blurSamples&&(y.defines.VSM_SAMPLES=q.blurSamples,E.defines.VSM_SAMPLES=q.blurSamples,y.needsUpdate=!0,E.needsUpdate=!0),q.mapPass===null&&(q.mapPass=new el(s.x,s.y)),y.uniforms.shadow_pass.value=q.map.texture,y.uniforms.resolution.value=q.mapSize,y.uniforms.radius.value=q.radius,n.setRenderTarget(q.mapPass),n.clear(),n.renderBufferDirect(U,null,N,y,D,null),E.uniforms.shadow_pass.value=q.mapPass.texture,E.uniforms.resolution.value=q.mapSize,E.uniforms.radius.value=q.radius,n.setRenderTarget(q.map),n.clear(),n.renderBufferDirect(U,null,N,E,D,null)}function k(q,U,N,M){let w=null;const R=N.isPointLight===!0?q.customDistanceMaterial:q.customDepthMaterial;if(R!==void 0)w=R;else if(w=N.isPointLight===!0?d:h,n.localClippingEnabled&&U.clipShadows===!0&&Array.isArray(U.clippingPlanes)&&U.clippingPlanes.length!==0||U.displacementMap&&U.displacementScale!==0||U.alphaMap&&U.alphaTest>0||U.map&&U.alphaTest>0||U.alphaToCoverage===!0){const O=w.uuid,L=U.uuid;let re=p[O];re===void 0&&(re={},p[O]=re);let oe=re[L];oe===void 0&&(oe=w.clone(),re[L]=oe,U.addEventListener("dispose",j)),w=oe}if(w.visible=U.visible,w.wireframe=U.wireframe,M===Bs?w.side=U.shadowSide!==null?U.shadowSide:U.side:w.side=U.shadowSide!==null?U.shadowSide:v[U.side],w.alphaMap=U.alphaMap,w.alphaTest=U.alphaToCoverage===!0?.5:U.alphaTest,w.map=U.map,w.clipShadows=U.clipShadows,w.clippingPlanes=U.clippingPlanes,w.clipIntersection=U.clipIntersection,w.displacementMap=U.displacementMap,w.displacementScale=U.displacementScale,w.displacementBias=U.displacementBias,w.wireframeLinewidth=U.wireframeLinewidth,w.linewidth=U.linewidth,N.isPointLight===!0&&w.isMeshDistanceMaterial===!0){const O=n.properties.get(w);O.light=N}return w}function V(q,U,N,M,w){if(q.visible===!1)return;if(q.layers.test(U.layers)&&(q.isMesh||q.isLine||q.isPoints)&&(q.castShadow||q.receiveShadow&&w===Bs)&&(!q.frustumCulled||i.intersectsObject(q))){q.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,q.matrixWorld);const L=e.update(q),re=q.material;if(Array.isArray(re)){const oe=L.groups;for(let X=0,Z=oe.length;X<Z;X++){const J=oe[X],Ae=re[J.materialIndex];if(Ae&&Ae.visible){const H=k(q,Ae,M,w);q.onBeforeShadow(n,q,U,N,L,H,J),n.renderBufferDirect(N,null,L,H,q,J),q.onAfterShadow(n,q,U,N,L,H,J)}}}else if(re.visible){const oe=k(q,re,M,w);q.onBeforeShadow(n,q,U,N,L,oe,null),n.renderBufferDirect(N,null,L,oe,q,null),q.onAfterShadow(n,q,U,N,L,oe,null)}}const O=q.children;for(let L=0,re=O.length;L<re;L++)V(O[L],U,N,M,w)}function j(q){q.target.removeEventListener("dispose",j);for(const N in p){const M=p[N],w=q.target.uuid;w in M&&(M[w].dispose(),delete M[w])}}}const aH={[fv]:pv,[mv]:vv,[gv]:yv,[Mc]:_v,[pv]:fv,[vv]:mv,[yv]:gv,[_v]:Mc};function oH(n,e){function t(){let Q=!1;const Ue=new Vn;let Ve=null;const Ye=new Vn(0,0,0,0);return{setMask:function(Ie){Ve!==Ie&&!Q&&(n.colorMask(Ie,Ie,Ie,Ie),Ve=Ie)},setLocked:function(Ie){Q=Ie},setClear:function(Ie,be,Ze,pt,Qt){Qt===!0&&(Ie*=pt,be*=pt,Ze*=pt),Ue.set(Ie,be,Ze,pt),Ye.equals(Ue)===!1&&(n.clearColor(Ie,be,Ze,pt),Ye.copy(Ue))},reset:function(){Q=!1,Ve=null,Ye.set(-1,0,0,0)}}}function i(){let Q=!1,Ue=!1,Ve=null,Ye=null,Ie=null;return{setReversed:function(be){if(Ue!==be){const Ze=e.get("EXT_clip_control");be?Ze.clipControlEXT(Ze.LOWER_LEFT_EXT,Ze.ZERO_TO_ONE_EXT):Ze.clipControlEXT(Ze.LOWER_LEFT_EXT,Ze.NEGATIVE_ONE_TO_ONE_EXT),Ue=be;const pt=Ie;Ie=null,this.setClear(pt)}},getReversed:function(){return Ue},setTest:function(be){be?xe(n.DEPTH_TEST):Oe(n.DEPTH_TEST)},setMask:function(be){Ve!==be&&!Q&&(n.depthMask(be),Ve=be)},setFunc:function(be){if(Ue&&(be=aH[be]),Ye!==be){switch(be){case fv:n.depthFunc(n.NEVER);break;case pv:n.depthFunc(n.ALWAYS);break;case mv:n.depthFunc(n.LESS);break;case Mc:n.depthFunc(n.LEQUAL);break;case gv:n.depthFunc(n.EQUAL);break;case _v:n.depthFunc(n.GEQUAL);break;case vv:n.depthFunc(n.GREATER);break;case yv:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Ye=be}},setLocked:function(be){Q=be},setClear:function(be){Ie!==be&&(Ue&&(be=1-be),n.clearDepth(be),Ie=be)},reset:function(){Q=!1,Ve=null,Ye=null,Ie=null,Ue=!1}}}function s(){let Q=!1,Ue=null,Ve=null,Ye=null,Ie=null,be=null,Ze=null,pt=null,Qt=null;return{setTest:function(Ut){Q||(Ut?xe(n.STENCIL_TEST):Oe(n.STENCIL_TEST))},setMask:function(Ut){Ue!==Ut&&!Q&&(n.stencilMask(Ut),Ue=Ut)},setFunc:function(Ut,zi,Gt){(Ve!==Ut||Ye!==zi||Ie!==Gt)&&(n.stencilFunc(Ut,zi,Gt),Ve=Ut,Ye=zi,Ie=Gt)},setOp:function(Ut,zi,Gt){(be!==Ut||Ze!==zi||pt!==Gt)&&(n.stencilOp(Ut,zi,Gt),be=Ut,Ze=zi,pt=Gt)},setLocked:function(Ut){Q=Ut},setClear:function(Ut){Qt!==Ut&&(n.clearStencil(Ut),Qt=Ut)},reset:function(){Q=!1,Ue=null,Ve=null,Ye=null,Ie=null,be=null,Ze=null,pt=null,Qt=null}}}const o=new t,c=new i,h=new s,d=new WeakMap,p=new WeakMap;let g={},v={},y=new WeakMap,E=[],b=null,D=!1,A=null,T=null,P=null,k=null,V=null,j=null,q=null,U=new Bt(0,0,0),N=0,M=!1,w=null,R=null,O=null,L=null,re=null;const oe=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let X=!1,Z=0;const J=n.getParameter(n.VERSION);J.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(J)[1]),X=Z>=1):J.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),X=Z>=2);let Ae=null,H={};const ee=n.getParameter(n.SCISSOR_BOX),ye=n.getParameter(n.VIEWPORT),Ee=new Vn().fromArray(ee),Pe=new Vn().fromArray(ye);function qe(Q,Ue,Ve,Ye){const Ie=new Uint8Array(4),be=n.createTexture();n.bindTexture(Q,be),n.texParameteri(Q,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Q,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ze=0;Ze<Ve;Ze++)Q===n.TEXTURE_3D||Q===n.TEXTURE_2D_ARRAY?n.texImage3D(Ue,0,n.RGBA,1,1,Ye,0,n.RGBA,n.UNSIGNED_BYTE,Ie):n.texImage2D(Ue+Ze,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ie);return be}const le={};le[n.TEXTURE_2D]=qe(n.TEXTURE_2D,n.TEXTURE_2D,1),le[n.TEXTURE_CUBE_MAP]=qe(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),le[n.TEXTURE_2D_ARRAY]=qe(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),le[n.TEXTURE_3D]=qe(n.TEXTURE_3D,n.TEXTURE_3D,1,1),o.setClear(0,0,0,1),c.setClear(1),h.setClear(0),xe(n.DEPTH_TEST),c.setFunc(Mc),ft(!1),Ke(mb),xe(n.CULL_FACE),Zt(Ha);function xe(Q){g[Q]!==!0&&(n.enable(Q),g[Q]=!0)}function Oe(Q){g[Q]!==!1&&(n.disable(Q),g[Q]=!1)}function ht(Q,Ue){return v[Q]!==Ue?(n.bindFramebuffer(Q,Ue),v[Q]=Ue,Q===n.DRAW_FRAMEBUFFER&&(v[n.FRAMEBUFFER]=Ue),Q===n.FRAMEBUFFER&&(v[n.DRAW_FRAMEBUFFER]=Ue),!0):!1}function tt(Q,Ue){let Ve=E,Ye=!1;if(Q){Ve=y.get(Ue),Ve===void 0&&(Ve=[],y.set(Ue,Ve));const Ie=Q.textures;if(Ve.length!==Ie.length||Ve[0]!==n.COLOR_ATTACHMENT0){for(let be=0,Ze=Ie.length;be<Ze;be++)Ve[be]=n.COLOR_ATTACHMENT0+be;Ve.length=Ie.length,Ye=!0}}else Ve[0]!==n.BACK&&(Ve[0]=n.BACK,Ye=!0);Ye&&n.drawBuffers(Ve)}function bt(Q){return b!==Q?(n.useProgram(Q),b=Q,!0):!1}const Mn={[Fo]:n.FUNC_ADD,[uV]:n.FUNC_SUBTRACT,[hV]:n.FUNC_REVERSE_SUBTRACT};Mn[dV]=n.MIN,Mn[fV]=n.MAX;const K={[pV]:n.ZERO,[mV]:n.ONE,[gV]:n.SRC_COLOR,[hv]:n.SRC_ALPHA,[TV]:n.SRC_ALPHA_SATURATE,[EV]:n.DST_COLOR,[vV]:n.DST_ALPHA,[_V]:n.ONE_MINUS_SRC_COLOR,[dv]:n.ONE_MINUS_SRC_ALPHA,[SV]:n.ONE_MINUS_DST_COLOR,[yV]:n.ONE_MINUS_DST_ALPHA,[xV]:n.CONSTANT_COLOR,[bV]:n.ONE_MINUS_CONSTANT_COLOR,[AV]:n.CONSTANT_ALPHA,[MV]:n.ONE_MINUS_CONSTANT_ALPHA};function Zt(Q,Ue,Ve,Ye,Ie,be,Ze,pt,Qt,Ut){if(Q===Ha){D===!0&&(Oe(n.BLEND),D=!1);return}if(D===!1&&(xe(n.BLEND),D=!0),Q!==cV){if(Q!==A||Ut!==M){if((T!==Fo||V!==Fo)&&(n.blendEquation(n.FUNC_ADD),T=Fo,V=Fo),Ut)switch(Q){case _c:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case gb:n.blendFunc(n.ONE,n.ONE);break;case _b:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case vb:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}else switch(Q){case _c:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case gb:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case _b:console.error("THREE.WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case vb:console.error("THREE.WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}P=null,k=null,j=null,q=null,U.set(0,0,0),N=0,A=Q,M=Ut}return}Ie=Ie||Ue,be=be||Ve,Ze=Ze||Ye,(Ue!==T||Ie!==V)&&(n.blendEquationSeparate(Mn[Ue],Mn[Ie]),T=Ue,V=Ie),(Ve!==P||Ye!==k||be!==j||Ze!==q)&&(n.blendFuncSeparate(K[Ve],K[Ye],K[be],K[Ze]),P=Ve,k=Ye,j=be,q=Ze),(pt.equals(U)===!1||Qt!==N)&&(n.blendColor(pt.r,pt.g,pt.b,Qt),U.copy(pt),N=Qt),A=Q,M=!1}function vt(Q,Ue){Q.side===Gs?Oe(n.CULL_FACE):xe(n.CULL_FACE);let Ve=Q.side===Yi;Ue&&(Ve=!Ve),ft(Ve),Q.blending===_c&&Q.transparent===!1?Zt(Ha):Zt(Q.blending,Q.blendEquation,Q.blendSrc,Q.blendDst,Q.blendEquationAlpha,Q.blendSrcAlpha,Q.blendDstAlpha,Q.blendColor,Q.blendAlpha,Q.premultipliedAlpha),c.setFunc(Q.depthFunc),c.setTest(Q.depthTest),c.setMask(Q.depthWrite),o.setMask(Q.colorWrite);const Ye=Q.stencilWrite;h.setTest(Ye),Ye&&(h.setMask(Q.stencilWriteMask),h.setFunc(Q.stencilFunc,Q.stencilRef,Q.stencilFuncMask),h.setOp(Q.stencilFail,Q.stencilZFail,Q.stencilZPass)),Je(Q.polygonOffset,Q.polygonOffsetFactor,Q.polygonOffsetUnits),Q.alphaToCoverage===!0?xe(n.SAMPLE_ALPHA_TO_COVERAGE):Oe(n.SAMPLE_ALPHA_TO_COVERAGE)}function ft(Q){w!==Q&&(Q?n.frontFace(n.CW):n.frontFace(n.CCW),w=Q)}function Ke(Q){Q!==oV?(xe(n.CULL_FACE),Q!==R&&(Q===mb?n.cullFace(n.BACK):Q===lV?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Oe(n.CULL_FACE),R=Q}function cn(Q){Q!==O&&(X&&n.lineWidth(Q),O=Q)}function Je(Q,Ue,Ve){Q?(xe(n.POLYGON_OFFSET_FILL),(L!==Ue||re!==Ve)&&(n.polygonOffset(Ue,Ve),L=Ue,re=Ve)):Oe(n.POLYGON_OFFSET_FILL)}function St(Q){Q?xe(n.SCISSOR_TEST):Oe(n.SCISSOR_TEST)}function yn(Q){Q===void 0&&(Q=n.TEXTURE0+oe-1),Ae!==Q&&(n.activeTexture(Q),Ae=Q)}function xn(Q,Ue,Ve){Ve===void 0&&(Ae===null?Ve=n.TEXTURE0+oe-1:Ve=Ae);let Ye=H[Ve];Ye===void 0&&(Ye={type:void 0,texture:void 0},H[Ve]=Ye),(Ye.type!==Q||Ye.texture!==Ue)&&(Ae!==Ve&&(n.activeTexture(Ve),Ae=Ve),n.bindTexture(Q,Ue||le[Q]),Ye.type=Q,Ye.texture=Ue)}function W(){const Q=H[Ae];Q!==void 0&&Q.type!==void 0&&(n.bindTexture(Q.type,null),Q.type=void 0,Q.texture=void 0)}function F(){try{n.compressedTexImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function ce(){try{n.compressedTexImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function ge(){try{n.texSubImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Se(){try{n.texSubImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function ve(){try{n.compressedTexSubImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Xe(){try{n.compressedTexSubImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Fe(){try{n.texStorage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function st(){try{n.texStorage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function et(){try{n.texImage2D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function De(){try{n.texImage3D(...arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function je(Q){Ee.equals(Q)===!1&&(n.scissor(Q.x,Q.y,Q.z,Q.w),Ee.copy(Q))}function ot(Q){Pe.equals(Q)===!1&&(n.viewport(Q.x,Q.y,Q.z,Q.w),Pe.copy(Q))}function nt(Q,Ue){let Ve=p.get(Ue);Ve===void 0&&(Ve=new WeakMap,p.set(Ue,Ve));let Ye=Ve.get(Q);Ye===void 0&&(Ye=n.getUniformBlockIndex(Ue,Q.name),Ve.set(Q,Ye))}function He(Q,Ue){const Ye=p.get(Ue).get(Q);d.get(Ue)!==Ye&&(n.uniformBlockBinding(Ue,Ye,Q.__bindingPointIndex),d.set(Ue,Ye))}function Tt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),c.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),g={},Ae=null,H={},v={},y=new WeakMap,E=[],b=null,D=!1,A=null,T=null,P=null,k=null,V=null,j=null,q=null,U=new Bt(0,0,0),N=0,M=!1,w=null,R=null,O=null,L=null,re=null,Ee.set(0,0,n.canvas.width,n.canvas.height),Pe.set(0,0,n.canvas.width,n.canvas.height),o.reset(),c.reset(),h.reset()}return{buffers:{color:o,depth:c,stencil:h},enable:xe,disable:Oe,bindFramebuffer:ht,drawBuffers:tt,useProgram:bt,setBlending:Zt,setMaterial:vt,setFlipSided:ft,setCullFace:Ke,setLineWidth:cn,setPolygonOffset:Je,setScissorTest:St,activeTexture:yn,bindTexture:xn,unbindTexture:W,compressedTexImage2D:F,compressedTexImage3D:ce,texImage2D:et,texImage3D:De,updateUBOMapping:nt,uniformBlockBinding:He,texStorage2D:Fe,texStorage3D:st,texSubImage2D:ge,texSubImage3D:Se,compressedTexSubImage2D:ve,compressedTexSubImage3D:Xe,scissor:je,viewport:ot,reset:Tt}}function lH(n,e,t,i,s,o,c){const h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new Nt,g=new WeakMap;let v;const y=new WeakMap;let E=!1;try{E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(W,F){return E?new OffscreenCanvas(W,F):fp("canvas")}function D(W,F,ce){let ge=1;const Se=xn(W);if((Se.width>ce||Se.height>ce)&&(ge=ce/Math.max(Se.width,Se.height)),ge<1)if(typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&W instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&W instanceof ImageBitmap||typeof VideoFrame<"u"&&W instanceof VideoFrame){const ve=Math.floor(ge*Se.width),Xe=Math.floor(ge*Se.height);v===void 0&&(v=b(ve,Xe));const Fe=F?b(ve,Xe):v;return Fe.width=ve,Fe.height=Xe,Fe.getContext("2d").drawImage(W,0,0,ve,Xe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Se.width+"x"+Se.height+") to ("+ve+"x"+Xe+")."),Fe}else return"data"in W&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Se.width+"x"+Se.height+")."),W;return W}function A(W){return W.generateMipmaps}function T(W){n.generateMipmap(W)}function P(W){return W.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:W.isWebGL3DRenderTarget?n.TEXTURE_3D:W.isWebGLArrayRenderTarget||W.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function k(W,F,ce,ge,Se=!1){if(W!==null){if(n[W]!==void 0)return n[W];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+W+"'")}let ve=F;if(F===n.RED&&(ce===n.FLOAT&&(ve=n.R32F),ce===n.HALF_FLOAT&&(ve=n.R16F),ce===n.UNSIGNED_BYTE&&(ve=n.R8)),F===n.RED_INTEGER&&(ce===n.UNSIGNED_BYTE&&(ve=n.R8UI),ce===n.UNSIGNED_SHORT&&(ve=n.R16UI),ce===n.UNSIGNED_INT&&(ve=n.R32UI),ce===n.BYTE&&(ve=n.R8I),ce===n.SHORT&&(ve=n.R16I),ce===n.INT&&(ve=n.R32I)),F===n.RG&&(ce===n.FLOAT&&(ve=n.RG32F),ce===n.HALF_FLOAT&&(ve=n.RG16F),ce===n.UNSIGNED_BYTE&&(ve=n.RG8)),F===n.RG_INTEGER&&(ce===n.UNSIGNED_BYTE&&(ve=n.RG8UI),ce===n.UNSIGNED_SHORT&&(ve=n.RG16UI),ce===n.UNSIGNED_INT&&(ve=n.RG32UI),ce===n.BYTE&&(ve=n.RG8I),ce===n.SHORT&&(ve=n.RG16I),ce===n.INT&&(ve=n.RG32I)),F===n.RGB_INTEGER&&(ce===n.UNSIGNED_BYTE&&(ve=n.RGB8UI),ce===n.UNSIGNED_SHORT&&(ve=n.RGB16UI),ce===n.UNSIGNED_INT&&(ve=n.RGB32UI),ce===n.BYTE&&(ve=n.RGB8I),ce===n.SHORT&&(ve=n.RGB16I),ce===n.INT&&(ve=n.RGB32I)),F===n.RGBA_INTEGER&&(ce===n.UNSIGNED_BYTE&&(ve=n.RGBA8UI),ce===n.UNSIGNED_SHORT&&(ve=n.RGBA16UI),ce===n.UNSIGNED_INT&&(ve=n.RGBA32UI),ce===n.BYTE&&(ve=n.RGBA8I),ce===n.SHORT&&(ve=n.RGBA16I),ce===n.INT&&(ve=n.RGBA32I)),F===n.RGB&&(ce===n.UNSIGNED_INT_5_9_9_9_REV&&(ve=n.RGB9_E5),ce===n.UNSIGNED_INT_10F_11F_11F_REV&&(ve=n.R11F_G11F_B10F)),F===n.RGBA){const Xe=Se?hp:tn.getTransfer(ge);ce===n.FLOAT&&(ve=n.RGBA32F),ce===n.HALF_FLOAT&&(ve=n.RGBA16F),ce===n.UNSIGNED_BYTE&&(ve=Xe===mn?n.SRGB8_ALPHA8:n.RGBA8),ce===n.UNSIGNED_SHORT_4_4_4_4&&(ve=n.RGBA4),ce===n.UNSIGNED_SHORT_5_5_5_1&&(ve=n.RGB5_A1)}return(ve===n.R16F||ve===n.R32F||ve===n.RG16F||ve===n.RG32F||ve===n.RGBA16F||ve===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ve}function V(W,F){let ce;return W?F===null||F===Jo||F===_h?ce=n.DEPTH24_STENCIL8:F===Xs?ce=n.DEPTH32F_STENCIL8:F===gh&&(ce=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):F===null||F===Jo||F===_h?ce=n.DEPTH_COMPONENT24:F===Xs?ce=n.DEPTH_COMPONENT32F:F===gh&&(ce=n.DEPTH_COMPONENT16),ce}function j(W,F){return A(W)===!0||W.isFramebufferTexture&&W.minFilter!==Br&&W.minFilter!==os?Math.log2(Math.max(F.width,F.height))+1:W.mipmaps!==void 0&&W.mipmaps.length>0?W.mipmaps.length:W.isCompressedTexture&&Array.isArray(W.image)?F.mipmaps.length:1}function q(W){const F=W.target;F.removeEventListener("dispose",q),N(F),F.isVideoTexture&&g.delete(F)}function U(W){const F=W.target;F.removeEventListener("dispose",U),w(F)}function N(W){const F=i.get(W);if(F.__webglInit===void 0)return;const ce=W.source,ge=y.get(ce);if(ge){const Se=ge[F.__cacheKey];Se.usedTimes--,Se.usedTimes===0&&M(W),Object.keys(ge).length===0&&y.delete(ce)}i.remove(W)}function M(W){const F=i.get(W);n.deleteTexture(F.__webglTexture);const ce=W.source,ge=y.get(ce);delete ge[F.__cacheKey],c.memory.textures--}function w(W){const F=i.get(W);if(W.depthTexture&&(W.depthTexture.dispose(),i.remove(W.depthTexture)),W.isWebGLCubeRenderTarget)for(let ge=0;ge<6;ge++){if(Array.isArray(F.__webglFramebuffer[ge]))for(let Se=0;Se<F.__webglFramebuffer[ge].length;Se++)n.deleteFramebuffer(F.__webglFramebuffer[ge][Se]);else n.deleteFramebuffer(F.__webglFramebuffer[ge]);F.__webglDepthbuffer&&n.deleteRenderbuffer(F.__webglDepthbuffer[ge])}else{if(Array.isArray(F.__webglFramebuffer))for(let ge=0;ge<F.__webglFramebuffer.length;ge++)n.deleteFramebuffer(F.__webglFramebuffer[ge]);else n.deleteFramebuffer(F.__webglFramebuffer);if(F.__webglDepthbuffer&&n.deleteRenderbuffer(F.__webglDepthbuffer),F.__webglMultisampledFramebuffer&&n.deleteFramebuffer(F.__webglMultisampledFramebuffer),F.__webglColorRenderbuffer)for(let ge=0;ge<F.__webglColorRenderbuffer.length;ge++)F.__webglColorRenderbuffer[ge]&&n.deleteRenderbuffer(F.__webglColorRenderbuffer[ge]);F.__webglDepthRenderbuffer&&n.deleteRenderbuffer(F.__webglDepthRenderbuffer)}const ce=W.textures;for(let ge=0,Se=ce.length;ge<Se;ge++){const ve=i.get(ce[ge]);ve.__webglTexture&&(n.deleteTexture(ve.__webglTexture),c.memory.textures--),i.remove(ce[ge])}i.remove(W)}let R=0;function O(){R=0}function L(){const W=R;return W>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+W+" texture units while this GPU supports only "+s.maxTextures),R+=1,W}function re(W){const F=[];return F.push(W.wrapS),F.push(W.wrapT),F.push(W.wrapR||0),F.push(W.magFilter),F.push(W.minFilter),F.push(W.anisotropy),F.push(W.internalFormat),F.push(W.format),F.push(W.type),F.push(W.generateMipmaps),F.push(W.premultiplyAlpha),F.push(W.flipY),F.push(W.unpackAlignment),F.push(W.colorSpace),F.join()}function oe(W,F){const ce=i.get(W);if(W.isVideoTexture&&St(W),W.isRenderTargetTexture===!1&&W.isExternalTexture!==!0&&W.version>0&&ce.__version!==W.version){const ge=W.image;if(ge===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ge.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(ce,W,F);return}}else W.isExternalTexture&&(ce.__webglTexture=W.sourceTexture?W.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,ce.__webglTexture,n.TEXTURE0+F)}function X(W,F){const ce=i.get(W);if(W.isRenderTargetTexture===!1&&W.version>0&&ce.__version!==W.version){le(ce,W,F);return}t.bindTexture(n.TEXTURE_2D_ARRAY,ce.__webglTexture,n.TEXTURE0+F)}function Z(W,F){const ce=i.get(W);if(W.isRenderTargetTexture===!1&&W.version>0&&ce.__version!==W.version){le(ce,W,F);return}t.bindTexture(n.TEXTURE_3D,ce.__webglTexture,n.TEXTURE0+F)}function J(W,F){const ce=i.get(W);if(W.version>0&&ce.__version!==W.version){xe(ce,W,F);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ce.__webglTexture,n.TEXTURE0+F)}const Ae={[Tv]:n.REPEAT,[Go]:n.CLAMP_TO_EDGE,[xv]:n.MIRRORED_REPEAT},H={[Br]:n.NEAREST,[OV]:n.NEAREST_MIPMAP_NEAREST,[lf]:n.NEAREST_MIPMAP_LINEAR,[os]:n.LINEAR,[s_]:n.LINEAR_MIPMAP_NEAREST,[jo]:n.LINEAR_MIPMAP_LINEAR},ee={[zV]:n.NEVER,[WV]:n.ALWAYS,[BV]:n.LESS,[pR]:n.LEQUAL,[HV]:n.EQUAL,[qV]:n.GEQUAL,[GV]:n.GREATER,[jV]:n.NOTEQUAL};function ye(W,F){if(F.type===Xs&&e.has("OES_texture_float_linear")===!1&&(F.magFilter===os||F.magFilter===s_||F.magFilter===lf||F.magFilter===jo||F.minFilter===os||F.minFilter===s_||F.minFilter===lf||F.minFilter===jo)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(W,n.TEXTURE_WRAP_S,Ae[F.wrapS]),n.texParameteri(W,n.TEXTURE_WRAP_T,Ae[F.wrapT]),(W===n.TEXTURE_3D||W===n.TEXTURE_2D_ARRAY)&&n.texParameteri(W,n.TEXTURE_WRAP_R,Ae[F.wrapR]),n.texParameteri(W,n.TEXTURE_MAG_FILTER,H[F.magFilter]),n.texParameteri(W,n.TEXTURE_MIN_FILTER,H[F.minFilter]),F.compareFunction&&(n.texParameteri(W,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(W,n.TEXTURE_COMPARE_FUNC,ee[F.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(F.magFilter===Br||F.minFilter!==lf&&F.minFilter!==jo||F.type===Xs&&e.has("OES_texture_float_linear")===!1)return;if(F.anisotropy>1||i.get(F).__currentAnisotropy){const ce=e.get("EXT_texture_filter_anisotropic");n.texParameterf(W,ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(F.anisotropy,s.getMaxAnisotropy())),i.get(F).__currentAnisotropy=F.anisotropy}}}function Ee(W,F){let ce=!1;W.__webglInit===void 0&&(W.__webglInit=!0,F.addEventListener("dispose",q));const ge=F.source;let Se=y.get(ge);Se===void 0&&(Se={},y.set(ge,Se));const ve=re(F);if(ve!==W.__cacheKey){Se[ve]===void 0&&(Se[ve]={texture:n.createTexture(),usedTimes:0},c.memory.textures++,ce=!0),Se[ve].usedTimes++;const Xe=Se[W.__cacheKey];Xe!==void 0&&(Se[W.__cacheKey].usedTimes--,Xe.usedTimes===0&&M(F)),W.__cacheKey=ve,W.__webglTexture=Se[ve].texture}return ce}function Pe(W,F,ce){return Math.floor(Math.floor(W/ce)/F)}function qe(W,F,ce,ge){const ve=W.updateRanges;if(ve.length===0)t.texSubImage2D(n.TEXTURE_2D,0,0,0,F.width,F.height,ce,ge,F.data);else{ve.sort((De,je)=>De.start-je.start);let Xe=0;for(let De=1;De<ve.length;De++){const je=ve[Xe],ot=ve[De],nt=je.start+je.count,He=Pe(ot.start,F.width,4),Tt=Pe(je.start,F.width,4);ot.start<=nt+1&&He===Tt&&Pe(ot.start+ot.count-1,F.width,4)===He?je.count=Math.max(je.count,ot.start+ot.count-je.start):(++Xe,ve[Xe]=ot)}ve.length=Xe+1;const Fe=n.getParameter(n.UNPACK_ROW_LENGTH),st=n.getParameter(n.UNPACK_SKIP_PIXELS),et=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,F.width);for(let De=0,je=ve.length;De<je;De++){const ot=ve[De],nt=Math.floor(ot.start/4),He=Math.ceil(ot.count/4),Tt=nt%F.width,Q=Math.floor(nt/F.width),Ue=He,Ve=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,Tt),n.pixelStorei(n.UNPACK_SKIP_ROWS,Q),t.texSubImage2D(n.TEXTURE_2D,0,Tt,Q,Ue,Ve,ce,ge,F.data)}W.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,Fe),n.pixelStorei(n.UNPACK_SKIP_PIXELS,st),n.pixelStorei(n.UNPACK_SKIP_ROWS,et)}}function le(W,F,ce){let ge=n.TEXTURE_2D;(F.isDataArrayTexture||F.isCompressedArrayTexture)&&(ge=n.TEXTURE_2D_ARRAY),F.isData3DTexture&&(ge=n.TEXTURE_3D);const Se=Ee(W,F),ve=F.source;t.bindTexture(ge,W.__webglTexture,n.TEXTURE0+ce);const Xe=i.get(ve);if(ve.version!==Xe.__version||Se===!0){t.activeTexture(n.TEXTURE0+ce);const Fe=tn.getPrimaries(tn.workingColorSpace),st=F.colorSpace===Oa?null:tn.getPrimaries(F.colorSpace),et=F.colorSpace===Oa||Fe===st?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,F.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,F.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,et);let De=D(F.image,!1,s.maxTextureSize);De=yn(F,De);const je=o.convert(F.format,F.colorSpace),ot=o.convert(F.type);let nt=k(F.internalFormat,je,ot,F.colorSpace,F.isVideoTexture);ye(ge,F);let He;const Tt=F.mipmaps,Q=F.isVideoTexture!==!0,Ue=Xe.__version===void 0||Se===!0,Ve=ve.dataReady,Ye=j(F,De);if(F.isDepthTexture)nt=V(F.format===yh,F.type),Ue&&(Q?t.texStorage2D(n.TEXTURE_2D,1,nt,De.width,De.height):t.texImage2D(n.TEXTURE_2D,0,nt,De.width,De.height,0,je,ot,null));else if(F.isDataTexture)if(Tt.length>0){Q&&Ue&&t.texStorage2D(n.TEXTURE_2D,Ye,nt,Tt[0].width,Tt[0].height);for(let Ie=0,be=Tt.length;Ie<be;Ie++)He=Tt[Ie],Q?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ie,0,0,He.width,He.height,je,ot,He.data):t.texImage2D(n.TEXTURE_2D,Ie,nt,He.width,He.height,0,je,ot,He.data);F.generateMipmaps=!1}else Q?(Ue&&t.texStorage2D(n.TEXTURE_2D,Ye,nt,De.width,De.height),Ve&&qe(F,De,je,ot)):t.texImage2D(n.TEXTURE_2D,0,nt,De.width,De.height,0,je,ot,De.data);else if(F.isCompressedTexture)if(F.isCompressedArrayTexture){Q&&Ue&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ye,nt,Tt[0].width,Tt[0].height,De.depth);for(let Ie=0,be=Tt.length;Ie<be;Ie++)if(He=Tt[Ie],F.format!==kr)if(je!==null)if(Q){if(Ve)if(F.layerUpdates.size>0){const Ze=Wb(He.width,He.height,F.format,F.type);for(const pt of F.layerUpdates){const Qt=He.data.subarray(pt*Ze/He.data.BYTES_PER_ELEMENT,(pt+1)*Ze/He.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ie,0,0,pt,He.width,He.height,1,je,Qt)}F.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ie,0,0,0,He.width,He.height,De.depth,je,He.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ie,nt,He.width,He.height,De.depth,0,He.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Q?Ve&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ie,0,0,0,He.width,He.height,De.depth,je,ot,He.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ie,nt,He.width,He.height,De.depth,0,je,ot,He.data)}else{Q&&Ue&&t.texStorage2D(n.TEXTURE_2D,Ye,nt,Tt[0].width,Tt[0].height);for(let Ie=0,be=Tt.length;Ie<be;Ie++)He=Tt[Ie],F.format!==kr?je!==null?Q?Ve&&t.compressedTexSubImage2D(n.TEXTURE_2D,Ie,0,0,He.width,He.height,je,He.data):t.compressedTexImage2D(n.TEXTURE_2D,Ie,nt,He.width,He.height,0,He.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Q?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ie,0,0,He.width,He.height,je,ot,He.data):t.texImage2D(n.TEXTURE_2D,Ie,nt,He.width,He.height,0,je,ot,He.data)}else if(F.isDataArrayTexture)if(Q){if(Ue&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ye,nt,De.width,De.height,De.depth),Ve)if(F.layerUpdates.size>0){const Ie=Wb(De.width,De.height,F.format,F.type);for(const be of F.layerUpdates){const Ze=De.data.subarray(be*Ie/De.data.BYTES_PER_ELEMENT,(be+1)*Ie/De.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,be,De.width,De.height,1,je,ot,Ze)}F.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,De.width,De.height,De.depth,je,ot,De.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,nt,De.width,De.height,De.depth,0,je,ot,De.data);else if(F.isData3DTexture)Q?(Ue&&t.texStorage3D(n.TEXTURE_3D,Ye,nt,De.width,De.height,De.depth),Ve&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,De.width,De.height,De.depth,je,ot,De.data)):t.texImage3D(n.TEXTURE_3D,0,nt,De.width,De.height,De.depth,0,je,ot,De.data);else if(F.isFramebufferTexture){if(Ue)if(Q)t.texStorage2D(n.TEXTURE_2D,Ye,nt,De.width,De.height);else{let Ie=De.width,be=De.height;for(let Ze=0;Ze<Ye;Ze++)t.texImage2D(n.TEXTURE_2D,Ze,nt,Ie,be,0,je,ot,null),Ie>>=1,be>>=1}}else if(Tt.length>0){if(Q&&Ue){const Ie=xn(Tt[0]);t.texStorage2D(n.TEXTURE_2D,Ye,nt,Ie.width,Ie.height)}for(let Ie=0,be=Tt.length;Ie<be;Ie++)He=Tt[Ie],Q?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ie,0,0,je,ot,He):t.texImage2D(n.TEXTURE_2D,Ie,nt,je,ot,He);F.generateMipmaps=!1}else if(Q){if(Ue){const Ie=xn(De);t.texStorage2D(n.TEXTURE_2D,Ye,nt,Ie.width,Ie.height)}Ve&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,je,ot,De)}else t.texImage2D(n.TEXTURE_2D,0,nt,je,ot,De);A(F)&&T(ge),Xe.__version=ve.version,F.onUpdate&&F.onUpdate(F)}W.__version=F.version}function xe(W,F,ce){if(F.image.length!==6)return;const ge=Ee(W,F),Se=F.source;t.bindTexture(n.TEXTURE_CUBE_MAP,W.__webglTexture,n.TEXTURE0+ce);const ve=i.get(Se);if(Se.version!==ve.__version||ge===!0){t.activeTexture(n.TEXTURE0+ce);const Xe=tn.getPrimaries(tn.workingColorSpace),Fe=F.colorSpace===Oa?null:tn.getPrimaries(F.colorSpace),st=F.colorSpace===Oa||Xe===Fe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,F.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,F.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,st);const et=F.isCompressedTexture||F.image[0].isCompressedTexture,De=F.image[0]&&F.image[0].isDataTexture,je=[];for(let be=0;be<6;be++)!et&&!De?je[be]=D(F.image[be],!0,s.maxCubemapSize):je[be]=De?F.image[be].image:F.image[be],je[be]=yn(F,je[be]);const ot=je[0],nt=o.convert(F.format,F.colorSpace),He=o.convert(F.type),Tt=k(F.internalFormat,nt,He,F.colorSpace),Q=F.isVideoTexture!==!0,Ue=ve.__version===void 0||ge===!0,Ve=Se.dataReady;let Ye=j(F,ot);ye(n.TEXTURE_CUBE_MAP,F);let Ie;if(et){Q&&Ue&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Ye,Tt,ot.width,ot.height);for(let be=0;be<6;be++){Ie=je[be].mipmaps;for(let Ze=0;Ze<Ie.length;Ze++){const pt=Ie[Ze];F.format!==kr?nt!==null?Q?Ve&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze,0,0,pt.width,pt.height,nt,pt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze,Tt,pt.width,pt.height,0,pt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Q?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze,0,0,pt.width,pt.height,nt,He,pt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze,Tt,pt.width,pt.height,0,nt,He,pt.data)}}}else{if(Ie=F.mipmaps,Q&&Ue){Ie.length>0&&Ye++;const be=xn(je[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Ye,Tt,be.width,be.height)}for(let be=0;be<6;be++)if(De){Q?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,0,0,je[be].width,je[be].height,nt,He,je[be].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,Tt,je[be].width,je[be].height,0,nt,He,je[be].data);for(let Ze=0;Ze<Ie.length;Ze++){const Qt=Ie[Ze].image[be].image;Q?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze+1,0,0,Qt.width,Qt.height,nt,He,Qt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze+1,Tt,Qt.width,Qt.height,0,nt,He,Qt.data)}}else{Q?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,0,0,nt,He,je[be]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,Tt,nt,He,je[be]);for(let Ze=0;Ze<Ie.length;Ze++){const pt=Ie[Ze];Q?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze+1,0,0,nt,He,pt.image[be]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ze+1,Tt,nt,He,pt.image[be])}}}A(F)&&T(n.TEXTURE_CUBE_MAP),ve.__version=Se.version,F.onUpdate&&F.onUpdate(F)}W.__version=F.version}function Oe(W,F,ce,ge,Se,ve){const Xe=o.convert(ce.format,ce.colorSpace),Fe=o.convert(ce.type),st=k(ce.internalFormat,Xe,Fe,ce.colorSpace),et=i.get(F),De=i.get(ce);if(De.__renderTarget=F,!et.__hasExternalTextures){const je=Math.max(1,F.width>>ve),ot=Math.max(1,F.height>>ve);Se===n.TEXTURE_3D||Se===n.TEXTURE_2D_ARRAY?t.texImage3D(Se,ve,st,je,ot,F.depth,0,Xe,Fe,null):t.texImage2D(Se,ve,st,je,ot,0,Xe,Fe,null)}t.bindFramebuffer(n.FRAMEBUFFER,W),Je(F)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ge,Se,De.__webglTexture,0,cn(F)):(Se===n.TEXTURE_2D||Se>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Se<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ge,Se,De.__webglTexture,ve),t.bindFramebuffer(n.FRAMEBUFFER,null)}function ht(W,F,ce){if(n.bindRenderbuffer(n.RENDERBUFFER,W),F.depthBuffer){const ge=F.depthTexture,Se=ge&&ge.isDepthTexture?ge.type:null,ve=V(F.stencilBuffer,Se),Xe=F.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Fe=cn(F);Je(F)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Fe,ve,F.width,F.height):ce?n.renderbufferStorageMultisample(n.RENDERBUFFER,Fe,ve,F.width,F.height):n.renderbufferStorage(n.RENDERBUFFER,ve,F.width,F.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Xe,n.RENDERBUFFER,W)}else{const ge=F.textures;for(let Se=0;Se<ge.length;Se++){const ve=ge[Se],Xe=o.convert(ve.format,ve.colorSpace),Fe=o.convert(ve.type),st=k(ve.internalFormat,Xe,Fe,ve.colorSpace),et=cn(F);ce&&Je(F)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,et,st,F.width,F.height):Je(F)?h.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,et,st,F.width,F.height):n.renderbufferStorage(n.RENDERBUFFER,st,F.width,F.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function tt(W,F){if(F&&F.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,W),!(F.depthTexture&&F.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ge=i.get(F.depthTexture);ge.__renderTarget=F,(!ge.__webglTexture||F.depthTexture.image.width!==F.width||F.depthTexture.image.height!==F.height)&&(F.depthTexture.image.width=F.width,F.depthTexture.image.height=F.height,F.depthTexture.needsUpdate=!0),oe(F.depthTexture,0);const Se=ge.__webglTexture,ve=cn(F);if(F.depthTexture.format===vh)Je(F)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Se,0,ve):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Se,0);else if(F.depthTexture.format===yh)Je(F)?h.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Se,0,ve):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Se,0);else throw new Error("Unknown depthTexture format")}function bt(W){const F=i.get(W),ce=W.isWebGLCubeRenderTarget===!0;if(F.__boundDepthTexture!==W.depthTexture){const ge=W.depthTexture;if(F.__depthDisposeCallback&&F.__depthDisposeCallback(),ge){const Se=()=>{delete F.__boundDepthTexture,delete F.__depthDisposeCallback,ge.removeEventListener("dispose",Se)};ge.addEventListener("dispose",Se),F.__depthDisposeCallback=Se}F.__boundDepthTexture=ge}if(W.depthTexture&&!F.__autoAllocateDepthBuffer){if(ce)throw new Error("target.depthTexture not supported in Cube render targets");const ge=W.texture.mipmaps;ge&&ge.length>0?tt(F.__webglFramebuffer[0],W):tt(F.__webglFramebuffer,W)}else if(ce){F.__webglDepthbuffer=[];for(let ge=0;ge<6;ge++)if(t.bindFramebuffer(n.FRAMEBUFFER,F.__webglFramebuffer[ge]),F.__webglDepthbuffer[ge]===void 0)F.__webglDepthbuffer[ge]=n.createRenderbuffer(),ht(F.__webglDepthbuffer[ge],W,!1);else{const Se=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ve=F.__webglDepthbuffer[ge];n.bindRenderbuffer(n.RENDERBUFFER,ve),n.framebufferRenderbuffer(n.FRAMEBUFFER,Se,n.RENDERBUFFER,ve)}}else{const ge=W.texture.mipmaps;if(ge&&ge.length>0?t.bindFramebuffer(n.FRAMEBUFFER,F.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,F.__webglFramebuffer),F.__webglDepthbuffer===void 0)F.__webglDepthbuffer=n.createRenderbuffer(),ht(F.__webglDepthbuffer,W,!1);else{const Se=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ve=F.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,ve),n.framebufferRenderbuffer(n.FRAMEBUFFER,Se,n.RENDERBUFFER,ve)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Mn(W,F,ce){const ge=i.get(W);F!==void 0&&Oe(ge.__webglFramebuffer,W,W.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ce!==void 0&&bt(W)}function K(W){const F=W.texture,ce=i.get(W),ge=i.get(F);W.addEventListener("dispose",U);const Se=W.textures,ve=W.isWebGLCubeRenderTarget===!0,Xe=Se.length>1;if(Xe||(ge.__webglTexture===void 0&&(ge.__webglTexture=n.createTexture()),ge.__version=F.version,c.memory.textures++),ve){ce.__webglFramebuffer=[];for(let Fe=0;Fe<6;Fe++)if(F.mipmaps&&F.mipmaps.length>0){ce.__webglFramebuffer[Fe]=[];for(let st=0;st<F.mipmaps.length;st++)ce.__webglFramebuffer[Fe][st]=n.createFramebuffer()}else ce.__webglFramebuffer[Fe]=n.createFramebuffer()}else{if(F.mipmaps&&F.mipmaps.length>0){ce.__webglFramebuffer=[];for(let Fe=0;Fe<F.mipmaps.length;Fe++)ce.__webglFramebuffer[Fe]=n.createFramebuffer()}else ce.__webglFramebuffer=n.createFramebuffer();if(Xe)for(let Fe=0,st=Se.length;Fe<st;Fe++){const et=i.get(Se[Fe]);et.__webglTexture===void 0&&(et.__webglTexture=n.createTexture(),c.memory.textures++)}if(W.samples>0&&Je(W)===!1){ce.__webglMultisampledFramebuffer=n.createFramebuffer(),ce.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ce.__webglMultisampledFramebuffer);for(let Fe=0;Fe<Se.length;Fe++){const st=Se[Fe];ce.__webglColorRenderbuffer[Fe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ce.__webglColorRenderbuffer[Fe]);const et=o.convert(st.format,st.colorSpace),De=o.convert(st.type),je=k(st.internalFormat,et,De,st.colorSpace,W.isXRRenderTarget===!0),ot=cn(W);n.renderbufferStorageMultisample(n.RENDERBUFFER,ot,je,W.width,W.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Fe,n.RENDERBUFFER,ce.__webglColorRenderbuffer[Fe])}n.bindRenderbuffer(n.RENDERBUFFER,null),W.depthBuffer&&(ce.__webglDepthRenderbuffer=n.createRenderbuffer(),ht(ce.__webglDepthRenderbuffer,W,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ve){t.bindTexture(n.TEXTURE_CUBE_MAP,ge.__webglTexture),ye(n.TEXTURE_CUBE_MAP,F);for(let Fe=0;Fe<6;Fe++)if(F.mipmaps&&F.mipmaps.length>0)for(let st=0;st<F.mipmaps.length;st++)Oe(ce.__webglFramebuffer[Fe][st],W,F,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,st);else Oe(ce.__webglFramebuffer[Fe],W,F,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0);A(F)&&T(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Xe){for(let Fe=0,st=Se.length;Fe<st;Fe++){const et=Se[Fe],De=i.get(et);let je=n.TEXTURE_2D;(W.isWebGL3DRenderTarget||W.isWebGLArrayRenderTarget)&&(je=W.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(je,De.__webglTexture),ye(je,et),Oe(ce.__webglFramebuffer,W,et,n.COLOR_ATTACHMENT0+Fe,je,0),A(et)&&T(je)}t.unbindTexture()}else{let Fe=n.TEXTURE_2D;if((W.isWebGL3DRenderTarget||W.isWebGLArrayRenderTarget)&&(Fe=W.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Fe,ge.__webglTexture),ye(Fe,F),F.mipmaps&&F.mipmaps.length>0)for(let st=0;st<F.mipmaps.length;st++)Oe(ce.__webglFramebuffer[st],W,F,n.COLOR_ATTACHMENT0,Fe,st);else Oe(ce.__webglFramebuffer,W,F,n.COLOR_ATTACHMENT0,Fe,0);A(F)&&T(Fe),t.unbindTexture()}W.depthBuffer&&bt(W)}function Zt(W){const F=W.textures;for(let ce=0,ge=F.length;ce<ge;ce++){const Se=F[ce];if(A(Se)){const ve=P(W),Xe=i.get(Se).__webglTexture;t.bindTexture(ve,Xe),T(ve),t.unbindTexture()}}}const vt=[],ft=[];function Ke(W){if(W.samples>0){if(Je(W)===!1){const F=W.textures,ce=W.width,ge=W.height;let Se=n.COLOR_BUFFER_BIT;const ve=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Xe=i.get(W),Fe=F.length>1;if(Fe)for(let et=0;et<F.length;et++)t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+et,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+et,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Xe.__webglMultisampledFramebuffer);const st=W.texture.mipmaps;st&&st.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Xe.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Xe.__webglFramebuffer);for(let et=0;et<F.length;et++){if(W.resolveDepthBuffer&&(W.depthBuffer&&(Se|=n.DEPTH_BUFFER_BIT),W.stencilBuffer&&W.resolveStencilBuffer&&(Se|=n.STENCIL_BUFFER_BIT)),Fe){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Xe.__webglColorRenderbuffer[et]);const De=i.get(F[et]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,De,0)}n.blitFramebuffer(0,0,ce,ge,0,0,ce,ge,Se,n.NEAREST),d===!0&&(vt.length=0,ft.length=0,vt.push(n.COLOR_ATTACHMENT0+et),W.depthBuffer&&W.resolveDepthBuffer===!1&&(vt.push(ve),ft.push(ve),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,ft)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,vt))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Fe)for(let et=0;et<F.length;et++){t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+et,n.RENDERBUFFER,Xe.__webglColorRenderbuffer[et]);const De=i.get(F[et]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Xe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+et,n.TEXTURE_2D,De,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Xe.__webglMultisampledFramebuffer)}else if(W.depthBuffer&&W.resolveDepthBuffer===!1&&d){const F=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[F])}}}function cn(W){return Math.min(s.maxSamples,W.samples)}function Je(W){const F=i.get(W);return W.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&F.__useRenderToTexture!==!1}function St(W){const F=c.render.frame;g.get(W)!==F&&(g.set(W,F),W.update())}function yn(W,F){const ce=W.colorSpace,ge=W.format,Se=W.type;return W.isCompressedTexture===!0||W.isVideoTexture===!0||ce!==Cc&&ce!==Oa&&(tn.getTransfer(ce)===mn?(ge!==kr||Se!==ms)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ce)),F}function xn(W){return typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement?(p.width=W.naturalWidth||W.width,p.height=W.naturalHeight||W.height):typeof VideoFrame<"u"&&W instanceof VideoFrame?(p.width=W.displayWidth,p.height=W.displayHeight):(p.width=W.width,p.height=W.height),p}this.allocateTextureUnit=L,this.resetTextureUnits=O,this.setTexture2D=oe,this.setTexture2DArray=X,this.setTexture3D=Z,this.setTextureCube=J,this.rebindTextures=Mn,this.setupRenderTarget=K,this.updateRenderTargetMipmap=Zt,this.updateMultisampleRenderTarget=Ke,this.setupDepthRenderbuffer=bt,this.setupFrameBufferTexture=Oe,this.useMultisampledRTT=Je}function cH(n,e){function t(i,s=Oa){let o;const c=tn.getTransfer(s);if(i===ms)return n.UNSIGNED_BYTE;if(i===u0)return n.UNSIGNED_SHORT_4_4_4_4;if(i===h0)return n.UNSIGNED_SHORT_5_5_5_1;if(i===lR)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===cR)return n.UNSIGNED_INT_10F_11F_11F_REV;if(i===aR)return n.BYTE;if(i===oR)return n.SHORT;if(i===gh)return n.UNSIGNED_SHORT;if(i===c0)return n.INT;if(i===Jo)return n.UNSIGNED_INT;if(i===Xs)return n.FLOAT;if(i===Vh)return n.HALF_FLOAT;if(i===uR)return n.ALPHA;if(i===hR)return n.RGB;if(i===kr)return n.RGBA;if(i===vh)return n.DEPTH_COMPONENT;if(i===yh)return n.DEPTH_STENCIL;if(i===dR)return n.RED;if(i===d0)return n.RED_INTEGER;if(i===fR)return n.RG;if(i===f0)return n.RG_INTEGER;if(i===p0)return n.RGBA_INTEGER;if(i===Hf||i===Gf||i===jf||i===qf)if(c===mn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(i===Hf)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Gf)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===jf)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===qf)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===Hf)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Gf)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===jf)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===qf)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===bv||i===Av||i===Mv||i===wv)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===bv)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Av)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Mv)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===wv)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===Rv||i===Cv||i===Iv)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(i===Rv||i===Cv)return c===mn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===Iv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===Dv||i===Nv||i===Pv||i===Uv||i===Lv||i===Ov||i===Vv||i===Fv||i===kv||i===zv||i===Bv||i===Hv||i===Gv||i===jv)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(i===Dv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===Nv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===Pv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===Uv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===Lv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===Ov)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===Vv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===Fv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===kv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===zv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===Bv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===Hv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===Gv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===jv)return c===mn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===qv||i===Wv||i===Xv)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(i===qv)return c===mn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===Wv)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===Xv)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===Yv||i===Kv||i===$v||i===Qv)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(i===Yv)return o.COMPRESSED_RED_RGTC1_EXT;if(i===Kv)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===$v)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===Qv)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===_h?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}const uH=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,hH=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class dH{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const i=new RR(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new Ka({vertexShader:uH,fragmentShader:hH,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Wi(new Fa(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class fH extends Vc{constructor(e,t){super();const i=this;let s=null,o=1,c=null,h="local-floor",d=1,p=null,g=null,v=null,y=null,E=null,b=null;const D=typeof XRWebGLBinding<"u",A=new dH,T={},P=t.getContextAttributes();let k=null,V=null;const j=[],q=[],U=new Nt;let N=null;const M=new Ar;M.viewport=new Vn;const w=new Ar;w.viewport=new Vn;const R=[M,w],O=new PF;let L=null,re=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let xe=j[le];return xe===void 0&&(xe=new R_,j[le]=xe),xe.getTargetRaySpace()},this.getControllerGrip=function(le){let xe=j[le];return xe===void 0&&(xe=new R_,j[le]=xe),xe.getGripSpace()},this.getHand=function(le){let xe=j[le];return xe===void 0&&(xe=new R_,j[le]=xe),xe.getHandSpace()};function oe(le){const xe=q.indexOf(le.inputSource);if(xe===-1)return;const Oe=j[xe];Oe!==void 0&&(Oe.update(le.inputSource,le.frame,p||c),Oe.dispatchEvent({type:le.type,data:le.inputSource}))}function X(){s.removeEventListener("select",oe),s.removeEventListener("selectstart",oe),s.removeEventListener("selectend",oe),s.removeEventListener("squeeze",oe),s.removeEventListener("squeezestart",oe),s.removeEventListener("squeezeend",oe),s.removeEventListener("end",X),s.removeEventListener("inputsourceschange",Z);for(let le=0;le<j.length;le++){const xe=q[le];xe!==null&&(q[le]=null,j[le].disconnect(xe))}L=null,re=null,A.reset();for(const le in T)delete T[le];e.setRenderTarget(k),E=null,y=null,v=null,s=null,V=null,qe.stop(),i.isPresenting=!1,e.setPixelRatio(N),e.setSize(U.width,U.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){o=le,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){h=le,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||c},this.setReferenceSpace=function(le){p=le},this.getBaseLayer=function(){return y!==null?y:E},this.getBinding=function(){return v===null&&D&&(v=new XRWebGLBinding(s,t)),v},this.getFrame=function(){return b},this.getSession=function(){return s},this.setSession=async function(le){if(s=le,s!==null){if(k=e.getRenderTarget(),s.addEventListener("select",oe),s.addEventListener("selectstart",oe),s.addEventListener("selectend",oe),s.addEventListener("squeeze",oe),s.addEventListener("squeezestart",oe),s.addEventListener("squeezeend",oe),s.addEventListener("end",X),s.addEventListener("inputsourceschange",Z),P.xrCompatible!==!0&&await t.makeXRCompatible(),N=e.getPixelRatio(),e.getSize(U),D&&"createProjectionLayer"in XRWebGLBinding.prototype){let Oe=null,ht=null,tt=null;P.depth&&(tt=P.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Oe=P.stencil?yh:vh,ht=P.stencil?_h:Jo);const bt={colorFormat:t.RGBA8,depthFormat:tt,scaleFactor:o};v=this.getBinding(),y=v.createProjectionLayer(bt),s.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),V=new el(y.textureWidth,y.textureHeight,{format:kr,type:ms,depthTexture:new wR(y.textureWidth,y.textureHeight,ht,void 0,void 0,void 0,void 0,void 0,void 0,Oe),stencilBuffer:P.stencil,colorSpace:e.outputColorSpace,samples:P.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}else{const Oe={antialias:P.antialias,alpha:!0,depth:P.depth,stencil:P.stencil,framebufferScaleFactor:o};E=new XRWebGLLayer(s,t,Oe),s.updateRenderState({baseLayer:E}),e.setPixelRatio(1),e.setSize(E.framebufferWidth,E.framebufferHeight,!1),V=new el(E.framebufferWidth,E.framebufferHeight,{format:kr,type:ms,colorSpace:e.outputColorSpace,stencilBuffer:P.stencil,resolveDepthBuffer:E.ignoreDepthValues===!1,resolveStencilBuffer:E.ignoreDepthValues===!1})}V.isXRRenderTarget=!0,this.setFoveation(d),p=null,c=await s.requestReferenceSpace(h),qe.setContext(s),qe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return A.getDepthTexture()};function Z(le){for(let xe=0;xe<le.removed.length;xe++){const Oe=le.removed[xe],ht=q.indexOf(Oe);ht>=0&&(q[ht]=null,j[ht].disconnect(Oe))}for(let xe=0;xe<le.added.length;xe++){const Oe=le.added[xe];let ht=q.indexOf(Oe);if(ht===-1){for(let bt=0;bt<j.length;bt++)if(bt>=q.length){q.push(Oe),ht=bt;break}else if(q[bt]===null){q[bt]=Oe,ht=bt;break}if(ht===-1)break}const tt=j[ht];tt&&tt.connect(Oe)}}const J=new he,Ae=new he;function H(le,xe,Oe){J.setFromMatrixPosition(xe.matrixWorld),Ae.setFromMatrixPosition(Oe.matrixWorld);const ht=J.distanceTo(Ae),tt=xe.projectionMatrix.elements,bt=Oe.projectionMatrix.elements,Mn=tt[14]/(tt[10]-1),K=tt[14]/(tt[10]+1),Zt=(tt[9]+1)/tt[5],vt=(tt[9]-1)/tt[5],ft=(tt[8]-1)/tt[0],Ke=(bt[8]+1)/bt[0],cn=Mn*ft,Je=Mn*Ke,St=ht/(-ft+Ke),yn=St*-ft;if(xe.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(yn),le.translateZ(St),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),tt[10]===-1)le.projectionMatrix.copy(xe.projectionMatrix),le.projectionMatrixInverse.copy(xe.projectionMatrixInverse);else{const xn=Mn+St,W=K+St,F=cn-yn,ce=Je+(ht-yn),ge=Zt*K/W*xn,Se=vt*K/W*xn;le.projectionMatrix.makePerspective(F,ce,ge,Se,xn,W),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function ee(le,xe){xe===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(xe.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(s===null)return;let xe=le.near,Oe=le.far;A.texture!==null&&(A.depthNear>0&&(xe=A.depthNear),A.depthFar>0&&(Oe=A.depthFar)),O.near=w.near=M.near=xe,O.far=w.far=M.far=Oe,(L!==O.near||re!==O.far)&&(s.updateRenderState({depthNear:O.near,depthFar:O.far}),L=O.near,re=O.far),O.layers.mask=le.layers.mask|6,M.layers.mask=O.layers.mask&3,w.layers.mask=O.layers.mask&5;const ht=le.parent,tt=O.cameras;ee(O,ht);for(let bt=0;bt<tt.length;bt++)ee(tt[bt],ht);tt.length===2?H(O,M,w):O.projectionMatrix.copy(M.projectionMatrix),ye(le,O,ht)};function ye(le,xe,Oe){Oe===null?le.matrix.copy(xe.matrixWorld):(le.matrix.copy(Oe.matrixWorld),le.matrix.invert(),le.matrix.multiply(xe.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(xe.projectionMatrix),le.projectionMatrixInverse.copy(xe.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=Jv*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(y===null&&E===null))return d},this.setFoveation=function(le){d=le,y!==null&&(y.fixedFoveation=le),E!==null&&E.fixedFoveation!==void 0&&(E.fixedFoveation=le)},this.hasDepthSensing=function(){return A.texture!==null},this.getDepthSensingMesh=function(){return A.getMesh(O)},this.getCameraTexture=function(le){return T[le]};let Ee=null;function Pe(le,xe){if(g=xe.getViewerPose(p||c),b=xe,g!==null){const Oe=g.views;E!==null&&(e.setRenderTargetFramebuffer(V,E.framebuffer),e.setRenderTarget(V));let ht=!1;Oe.length!==O.cameras.length&&(O.cameras.length=0,ht=!0);for(let K=0;K<Oe.length;K++){const Zt=Oe[K];let vt=null;if(E!==null)vt=E.getViewport(Zt);else{const Ke=v.getViewSubImage(y,Zt);vt=Ke.viewport,K===0&&(e.setRenderTargetTextures(V,Ke.colorTexture,Ke.depthStencilTexture),e.setRenderTarget(V))}let ft=R[K];ft===void 0&&(ft=new Ar,ft.layers.enable(K),ft.viewport=new Vn,R[K]=ft),ft.matrix.fromArray(Zt.transform.matrix),ft.matrix.decompose(ft.position,ft.quaternion,ft.scale),ft.projectionMatrix.fromArray(Zt.projectionMatrix),ft.projectionMatrixInverse.copy(ft.projectionMatrix).invert(),ft.viewport.set(vt.x,vt.y,vt.width,vt.height),K===0&&(O.matrix.copy(ft.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),ht===!0&&O.cameras.push(ft)}const tt=s.enabledFeatures;if(tt&&tt.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&D){v=i.getBinding();const K=v.getDepthInformation(Oe[0]);K&&K.isValid&&K.texture&&A.init(K,s.renderState)}if(tt&&tt.includes("camera-access")&&D){e.state.unbindTexture(),v=i.getBinding();for(let K=0;K<Oe.length;K++){const Zt=Oe[K].camera;if(Zt){let vt=T[Zt];vt||(vt=new RR,T[Zt]=vt);const ft=v.getCameraImage(Zt);vt.sourceTexture=ft}}}}for(let Oe=0;Oe<j.length;Oe++){const ht=q[Oe],tt=j[Oe];ht!==null&&tt!==void 0&&tt.update(ht,xe,p||c)}Ee&&Ee(le,xe),xe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:xe}),b=null}const qe=new DR;qe.setAnimationLoop(Pe),this.setAnimationLoop=function(le){Ee=le},this.dispose=function(){}}}const Uo=new qr,pH=new Dn;function mH(n,e){function t(A,T){A.matrixAutoUpdate===!0&&A.updateMatrix(),T.value.copy(A.matrix)}function i(A,T){T.color.getRGB(A.fogColor.value,TR(n)),T.isFog?(A.fogNear.value=T.near,A.fogFar.value=T.far):T.isFogExp2&&(A.fogDensity.value=T.density)}function s(A,T,P,k,V){T.isMeshBasicMaterial||T.isMeshLambertMaterial?o(A,T):T.isMeshToonMaterial?(o(A,T),v(A,T)):T.isMeshPhongMaterial?(o(A,T),g(A,T)):T.isMeshStandardMaterial?(o(A,T),y(A,T),T.isMeshPhysicalMaterial&&E(A,T,V)):T.isMeshMatcapMaterial?(o(A,T),b(A,T)):T.isMeshDepthMaterial?o(A,T):T.isMeshDistanceMaterial?(o(A,T),D(A,T)):T.isMeshNormalMaterial?o(A,T):T.isLineBasicMaterial?(c(A,T),T.isLineDashedMaterial&&h(A,T)):T.isPointsMaterial?d(A,T,P,k):T.isSpriteMaterial?p(A,T):T.isShadowMaterial?(A.color.value.copy(T.color),A.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function o(A,T){A.opacity.value=T.opacity,T.color&&A.diffuse.value.copy(T.color),T.emissive&&A.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(A.map.value=T.map,t(T.map,A.mapTransform)),T.alphaMap&&(A.alphaMap.value=T.alphaMap,t(T.alphaMap,A.alphaMapTransform)),T.bumpMap&&(A.bumpMap.value=T.bumpMap,t(T.bumpMap,A.bumpMapTransform),A.bumpScale.value=T.bumpScale,T.side===Yi&&(A.bumpScale.value*=-1)),T.normalMap&&(A.normalMap.value=T.normalMap,t(T.normalMap,A.normalMapTransform),A.normalScale.value.copy(T.normalScale),T.side===Yi&&A.normalScale.value.negate()),T.displacementMap&&(A.displacementMap.value=T.displacementMap,t(T.displacementMap,A.displacementMapTransform),A.displacementScale.value=T.displacementScale,A.displacementBias.value=T.displacementBias),T.emissiveMap&&(A.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,A.emissiveMapTransform)),T.specularMap&&(A.specularMap.value=T.specularMap,t(T.specularMap,A.specularMapTransform)),T.alphaTest>0&&(A.alphaTest.value=T.alphaTest);const P=e.get(T),k=P.envMap,V=P.envMapRotation;k&&(A.envMap.value=k,Uo.copy(V),Uo.x*=-1,Uo.y*=-1,Uo.z*=-1,k.isCubeTexture&&k.isRenderTargetTexture===!1&&(Uo.y*=-1,Uo.z*=-1),A.envMapRotation.value.setFromMatrix4(pH.makeRotationFromEuler(Uo)),A.flipEnvMap.value=k.isCubeTexture&&k.isRenderTargetTexture===!1?-1:1,A.reflectivity.value=T.reflectivity,A.ior.value=T.ior,A.refractionRatio.value=T.refractionRatio),T.lightMap&&(A.lightMap.value=T.lightMap,A.lightMapIntensity.value=T.lightMapIntensity,t(T.lightMap,A.lightMapTransform)),T.aoMap&&(A.aoMap.value=T.aoMap,A.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,A.aoMapTransform))}function c(A,T){A.diffuse.value.copy(T.color),A.opacity.value=T.opacity,T.map&&(A.map.value=T.map,t(T.map,A.mapTransform))}function h(A,T){A.dashSize.value=T.dashSize,A.totalSize.value=T.dashSize+T.gapSize,A.scale.value=T.scale}function d(A,T,P,k){A.diffuse.value.copy(T.color),A.opacity.value=T.opacity,A.size.value=T.size*P,A.scale.value=k*.5,T.map&&(A.map.value=T.map,t(T.map,A.uvTransform)),T.alphaMap&&(A.alphaMap.value=T.alphaMap,t(T.alphaMap,A.alphaMapTransform)),T.alphaTest>0&&(A.alphaTest.value=T.alphaTest)}function p(A,T){A.diffuse.value.copy(T.color),A.opacity.value=T.opacity,A.rotation.value=T.rotation,T.map&&(A.map.value=T.map,t(T.map,A.mapTransform)),T.alphaMap&&(A.alphaMap.value=T.alphaMap,t(T.alphaMap,A.alphaMapTransform)),T.alphaTest>0&&(A.alphaTest.value=T.alphaTest)}function g(A,T){A.specular.value.copy(T.specular),A.shininess.value=Math.max(T.shininess,1e-4)}function v(A,T){T.gradientMap&&(A.gradientMap.value=T.gradientMap)}function y(A,T){A.metalness.value=T.metalness,T.metalnessMap&&(A.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,A.metalnessMapTransform)),A.roughness.value=T.roughness,T.roughnessMap&&(A.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,A.roughnessMapTransform)),T.envMap&&(A.envMapIntensity.value=T.envMapIntensity)}function E(A,T,P){A.ior.value=T.ior,T.sheen>0&&(A.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),A.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(A.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,A.sheenColorMapTransform)),T.sheenRoughnessMap&&(A.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,A.sheenRoughnessMapTransform))),T.clearcoat>0&&(A.clearcoat.value=T.clearcoat,A.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(A.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,A.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(A.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,A.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(A.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,A.clearcoatNormalMapTransform),A.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===Yi&&A.clearcoatNormalScale.value.negate())),T.dispersion>0&&(A.dispersion.value=T.dispersion),T.iridescence>0&&(A.iridescence.value=T.iridescence,A.iridescenceIOR.value=T.iridescenceIOR,A.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],A.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(A.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,A.iridescenceMapTransform)),T.iridescenceThicknessMap&&(A.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,A.iridescenceThicknessMapTransform))),T.transmission>0&&(A.transmission.value=T.transmission,A.transmissionSamplerMap.value=P.texture,A.transmissionSamplerSize.value.set(P.width,P.height),T.transmissionMap&&(A.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,A.transmissionMapTransform)),A.thickness.value=T.thickness,T.thicknessMap&&(A.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,A.thicknessMapTransform)),A.attenuationDistance.value=T.attenuationDistance,A.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(A.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(A.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,A.anisotropyMapTransform))),A.specularIntensity.value=T.specularIntensity,A.specularColor.value.copy(T.specularColor),T.specularColorMap&&(A.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,A.specularColorMapTransform)),T.specularIntensityMap&&(A.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,A.specularIntensityMapTransform))}function b(A,T){T.matcap&&(A.matcap.value=T.matcap)}function D(A,T){const P=e.get(T).light;A.referencePosition.value.setFromMatrixPosition(P.matrixWorld),A.nearDistance.value=P.shadow.camera.near,A.farDistance.value=P.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function gH(n,e,t,i){let s={},o={},c=[];const h=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function d(P,k){const V=k.program;i.uniformBlockBinding(P,V)}function p(P,k){let V=s[P.id];V===void 0&&(b(P),V=g(P),s[P.id]=V,P.addEventListener("dispose",A));const j=k.program;i.updateUBOMapping(P,j);const q=e.render.frame;o[P.id]!==q&&(y(P),o[P.id]=q)}function g(P){const k=v();P.__bindingPointIndex=k;const V=n.createBuffer(),j=P.__size,q=P.usage;return n.bindBuffer(n.UNIFORM_BUFFER,V),n.bufferData(n.UNIFORM_BUFFER,j,q),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,k,V),V}function v(){for(let P=0;P<h;P++)if(c.indexOf(P)===-1)return c.push(P),P;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(P){const k=s[P.id],V=P.uniforms,j=P.__cache;n.bindBuffer(n.UNIFORM_BUFFER,k);for(let q=0,U=V.length;q<U;q++){const N=Array.isArray(V[q])?V[q]:[V[q]];for(let M=0,w=N.length;M<w;M++){const R=N[M];if(E(R,q,M,j)===!0){const O=R.__offset,L=Array.isArray(R.value)?R.value:[R.value];let re=0;for(let oe=0;oe<L.length;oe++){const X=L[oe],Z=D(X);typeof X=="number"||typeof X=="boolean"?(R.__data[0]=X,n.bufferSubData(n.UNIFORM_BUFFER,O+re,R.__data)):X.isMatrix3?(R.__data[0]=X.elements[0],R.__data[1]=X.elements[1],R.__data[2]=X.elements[2],R.__data[3]=0,R.__data[4]=X.elements[3],R.__data[5]=X.elements[4],R.__data[6]=X.elements[5],R.__data[7]=0,R.__data[8]=X.elements[6],R.__data[9]=X.elements[7],R.__data[10]=X.elements[8],R.__data[11]=0):(X.toArray(R.__data,re),re+=Z.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,O,R.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function E(P,k,V,j){const q=P.value,U=k+"_"+V;if(j[U]===void 0)return typeof q=="number"||typeof q=="boolean"?j[U]=q:j[U]=q.clone(),!0;{const N=j[U];if(typeof q=="number"||typeof q=="boolean"){if(N!==q)return j[U]=q,!0}else if(N.equals(q)===!1)return N.copy(q),!0}return!1}function b(P){const k=P.uniforms;let V=0;const j=16;for(let U=0,N=k.length;U<N;U++){const M=Array.isArray(k[U])?k[U]:[k[U]];for(let w=0,R=M.length;w<R;w++){const O=M[w],L=Array.isArray(O.value)?O.value:[O.value];for(let re=0,oe=L.length;re<oe;re++){const X=L[re],Z=D(X),J=V%j,Ae=J%Z.boundary,H=J+Ae;V+=Ae,H!==0&&j-H<Z.storage&&(V+=j-H),O.__data=new Float32Array(Z.storage/Float32Array.BYTES_PER_ELEMENT),O.__offset=V,V+=Z.storage}}}const q=V%j;return q>0&&(V+=j-q),P.__size=V,P.__cache={},this}function D(P){const k={boundary:0,storage:0};return typeof P=="number"||typeof P=="boolean"?(k.boundary=4,k.storage=4):P.isVector2?(k.boundary=8,k.storage=8):P.isVector3||P.isColor?(k.boundary=16,k.storage=12):P.isVector4?(k.boundary=16,k.storage=16):P.isMatrix3?(k.boundary=48,k.storage=48):P.isMatrix4?(k.boundary=64,k.storage=64):P.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",P),k}function A(P){const k=P.target;k.removeEventListener("dispose",A);const V=c.indexOf(k.__bindingPointIndex);c.splice(V,1),n.deleteBuffer(s[k.id]),delete s[k.id],delete o[k.id]}function T(){for(const P in s)n.deleteBuffer(s[P]);c=[],s={},o={}}return{bind:d,update:p,dispose:T}}class _H{constructor(e={}){const{canvas:t=YV(),context:i=null,depth:s=!0,stencil:o=!1,alpha:c=!1,antialias:h=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:p=!1,powerPreference:g="default",failIfMajorPerformanceCaveat:v=!1,reversedDepthBuffer:y=!1}=e;this.isWebGLRenderer=!0;let E;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");E=i.getContextAttributes().alpha}else E=c;const b=new Uint32Array(4),D=new Int32Array(4);let A=null,T=null;const P=[],k=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Ga,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const V=this;let j=!1;this._outputColorSpace=br;let q=0,U=0,N=null,M=-1,w=null;const R=new Vn,O=new Vn;let L=null;const re=new Bt(0);let oe=0,X=t.width,Z=t.height,J=1,Ae=null,H=null;const ee=new Vn(0,0,X,Z),ye=new Vn(0,0,X,Z);let Ee=!1;const Pe=new y0;let qe=!1,le=!1;const xe=new Dn,Oe=new he,ht=new Vn,tt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let bt=!1;function Mn(){return N===null?J:1}let K=i;function Zt(B,te){return t.getContext(B,te)}try{const B={alpha:!0,depth:s,stencil:o,antialias:h,premultipliedAlpha:d,preserveDrawingBuffer:p,powerPreference:g,failIfMajorPerformanceCaveat:v};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${l0}`),t.addEventListener("webglcontextlost",Ve,!1),t.addEventListener("webglcontextrestored",Ye,!1),t.addEventListener("webglcontextcreationerror",Ie,!1),K===null){const te="webgl2";if(K=Zt(te,B),K===null)throw Zt(te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}let vt,ft,Ke,cn,Je,St,yn,xn,W,F,ce,ge,Se,ve,Xe,Fe,st,et,De,je,ot,nt,He,Tt;function Q(){vt=new wB(K),vt.init(),nt=new cH(K,vt),ft=new EB(K,vt,e,nt),Ke=new oH(K,vt),ft.reversedDepthBuffer&&y&&Ke.buffers.depth.setReversed(!0),cn=new IB(K),Je=new Y4,St=new lH(K,vt,Ke,Je,ft,nt,cn),yn=new TB(V),xn=new MB(V),W=new OF(K),He=new vB(K,W),F=new RB(K,W,cn,He),ce=new NB(K,F,W,cn),De=new DB(K,ft,St),Fe=new SB(Je),ge=new X4(V,yn,xn,vt,ft,He,Fe),Se=new mH(V,Je),ve=new $4,Xe=new nH(vt),et=new _B(V,yn,xn,Ke,ce,E,d),st=new sH(V,ce,ft),Tt=new gH(K,cn,ft,Ke),je=new yB(K,vt,cn),ot=new CB(K,vt,cn),cn.programs=ge.programs,V.capabilities=ft,V.extensions=vt,V.properties=Je,V.renderLists=ve,V.shadowMap=st,V.state=Ke,V.info=cn}Q();const Ue=new fH(V,K);this.xr=Ue,this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.forceContextLoss=function(){const B=vt.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=vt.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(B){B!==void 0&&(J=B,this.setSize(X,Z,!1))},this.getSize=function(B){return B.set(X,Z)},this.setSize=function(B,te,pe=!0){if(Ue.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}X=B,Z=te,t.width=Math.floor(B*J),t.height=Math.floor(te*J),pe===!0&&(t.style.width=B+"px",t.style.height=te+"px"),this.setViewport(0,0,B,te)},this.getDrawingBufferSize=function(B){return B.set(X*J,Z*J).floor()},this.setDrawingBufferSize=function(B,te,pe){X=B,Z=te,J=pe,t.width=Math.floor(B*pe),t.height=Math.floor(te*pe),this.setViewport(0,0,B,te)},this.getCurrentViewport=function(B){return B.copy(R)},this.getViewport=function(B){return B.copy(ee)},this.setViewport=function(B,te,pe,me){B.isVector4?ee.set(B.x,B.y,B.z,B.w):ee.set(B,te,pe,me),Ke.viewport(R.copy(ee).multiplyScalar(J).round())},this.getScissor=function(B){return B.copy(ye)},this.setScissor=function(B,te,pe,me){B.isVector4?ye.set(B.x,B.y,B.z,B.w):ye.set(B,te,pe,me),Ke.scissor(O.copy(ye).multiplyScalar(J).round())},this.getScissorTest=function(){return Ee},this.setScissorTest=function(B){Ke.setScissorTest(Ee=B)},this.setOpaqueSort=function(B){Ae=B},this.setTransparentSort=function(B){H=B},this.getClearColor=function(B){return B.copy(et.getClearColor())},this.setClearColor=function(){et.setClearColor(...arguments)},this.getClearAlpha=function(){return et.getClearAlpha()},this.setClearAlpha=function(){et.setClearAlpha(...arguments)},this.clear=function(B=!0,te=!0,pe=!0){let me=0;if(B){let ie=!1;if(N!==null){const Ne=N.texture.format;ie=Ne===p0||Ne===f0||Ne===d0}if(ie){const Ne=N.texture.type,Ge=Ne===ms||Ne===Jo||Ne===gh||Ne===_h||Ne===u0||Ne===h0,$e=et.getClearColor(),ze=et.getClearAlpha(),lt=$e.r,mt=$e.g,rt=$e.b;Ge?(b[0]=lt,b[1]=mt,b[2]=rt,b[3]=ze,K.clearBufferuiv(K.COLOR,0,b)):(D[0]=lt,D[1]=mt,D[2]=rt,D[3]=ze,K.clearBufferiv(K.COLOR,0,D))}else me|=K.COLOR_BUFFER_BIT}te&&(me|=K.DEPTH_BUFFER_BIT),pe&&(me|=K.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),K.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ve,!1),t.removeEventListener("webglcontextrestored",Ye,!1),t.removeEventListener("webglcontextcreationerror",Ie,!1),et.dispose(),ve.dispose(),Xe.dispose(),Je.dispose(),yn.dispose(),xn.dispose(),ce.dispose(),He.dispose(),Tt.dispose(),ge.dispose(),Ue.dispose(),Ue.removeEventListener("sessionstart",Gt),Ue.removeEventListener("sessionend",Un),un.stop()};function Ve(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),j=!0}function Ye(){console.log("THREE.WebGLRenderer: Context Restored."),j=!1;const B=cn.autoReset,te=st.enabled,pe=st.autoUpdate,me=st.needsUpdate,ie=st.type;Q(),cn.autoReset=B,st.enabled=te,st.autoUpdate=pe,st.needsUpdate=me,st.type=ie}function Ie(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function be(B){const te=B.target;te.removeEventListener("dispose",be),Ze(te)}function Ze(B){pt(B),Je.remove(B)}function pt(B){const te=Je.get(B).programs;te!==void 0&&(te.forEach(function(pe){ge.releaseProgram(pe)}),B.isShaderMaterial&&ge.releaseShaderCache(B))}this.renderBufferDirect=function(B,te,pe,me,ie,Ne){te===null&&(te=tt);const Ge=ie.isMesh&&ie.matrixWorld.determinant()<0,$e=ur(B,te,pe,me,ie);Ke.setMaterial(me,Ge);let ze=pe.index,lt=1;if(me.wireframe===!0){if(ze=F.getWireframeAttribute(pe),ze===void 0)return;lt=2}const mt=pe.drawRange,rt=pe.attributes.position;let wt=mt.start*lt,jt=(mt.start+mt.count)*lt;Ne!==null&&(wt=Math.max(wt,Ne.start*lt),jt=Math.min(jt,(Ne.start+Ne.count)*lt)),ze!==null?(wt=Math.max(wt,0),jt=Math.min(jt,ze.count)):rt!=null&&(wt=Math.max(wt,0),jt=Math.min(jt,rt.count));const hn=jt-wt;if(hn<0||hn===1/0)return;He.setup(ie,me,$e,pe,ze);let Jt,Rt=je;if(ze!==null&&(Jt=W.get(ze),Rt=ot,Rt.setIndex(Jt)),ie.isMesh)me.wireframe===!0?(Ke.setLineWidth(me.wireframeLinewidth*Mn()),Rt.setMode(K.LINES)):Rt.setMode(K.TRIANGLES);else if(ie.isLine){let ct=me.linewidth;ct===void 0&&(ct=1),Ke.setLineWidth(ct*Mn()),ie.isLineSegments?Rt.setMode(K.LINES):ie.isLineLoop?Rt.setMode(K.LINE_LOOP):Rt.setMode(K.LINE_STRIP)}else ie.isPoints?Rt.setMode(K.POINTS):ie.isSprite&&Rt.setMode(K.TRIANGLES);if(ie.isBatchedMesh)if(ie._multiDrawInstances!==null)Eh("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Rt.renderMultiDrawInstances(ie._multiDrawStarts,ie._multiDrawCounts,ie._multiDrawCount,ie._multiDrawInstances);else if(vt.get("WEBGL_multi_draw"))Rt.renderMultiDraw(ie._multiDrawStarts,ie._multiDrawCounts,ie._multiDrawCount);else{const ct=ie._multiDrawStarts,_n=ie._multiDrawCounts,Lt=ie._multiDrawCount,Kn=ze?W.get(ze).bytesPerElement:1,Bi=Je.get(me).currentProgram.getUniforms();for(let hi=0;hi<Lt;hi++)Bi.setValue(K,"_gl_DrawID",hi),Rt.render(ct[hi]/Kn,_n[hi])}else if(ie.isInstancedMesh)Rt.renderInstances(wt,hn,ie.count);else if(pe.isInstancedBufferGeometry){const ct=pe._maxInstanceCount!==void 0?pe._maxInstanceCount:1/0,_n=Math.min(pe.instanceCount,ct);Rt.renderInstances(wt,hn,_n)}else Rt.render(wt,hn)};function Qt(B,te,pe){B.transparent===!0&&B.side===Gs&&B.forceSinglePass===!1?(B.side=Yi,B.needsUpdate=!0,lr(B,te,pe),B.side=Ya,B.needsUpdate=!0,lr(B,te,pe),B.side=Gs):lr(B,te,pe)}this.compile=function(B,te,pe=null){pe===null&&(pe=B),T=Xe.get(pe),T.init(te),k.push(T),pe.traverseVisible(function(ie){ie.isLight&&ie.layers.test(te.layers)&&(T.pushLight(ie),ie.castShadow&&T.pushShadow(ie))}),B!==pe&&B.traverseVisible(function(ie){ie.isLight&&ie.layers.test(te.layers)&&(T.pushLight(ie),ie.castShadow&&T.pushShadow(ie))}),T.setupLights();const me=new Set;return B.traverse(function(ie){if(!(ie.isMesh||ie.isPoints||ie.isLine||ie.isSprite))return;const Ne=ie.material;if(Ne)if(Array.isArray(Ne))for(let Ge=0;Ge<Ne.length;Ge++){const $e=Ne[Ge];Qt($e,pe,ie),me.add($e)}else Qt(Ne,pe,ie),me.add(Ne)}),T=k.pop(),me},this.compileAsync=function(B,te,pe=null){const me=this.compile(B,te,pe);return new Promise(ie=>{function Ne(){if(me.forEach(function(Ge){Je.get(Ge).currentProgram.isReady()&&me.delete(Ge)}),me.size===0){ie(B);return}setTimeout(Ne,10)}vt.get("KHR_parallel_shader_compile")!==null?Ne():setTimeout(Ne,10)})};let Ut=null;function zi(B){Ut&&Ut(B)}function Gt(){un.stop()}function Un(){un.start()}const un=new DR;un.setAnimationLoop(zi),typeof self<"u"&&un.setContext(self),this.setAnimationLoop=function(B){Ut=B,Ue.setAnimationLoop(B),B===null?un.stop():un.start()},Ue.addEventListener("sessionstart",Gt),Ue.addEventListener("sessionend",Un),this.render=function(B,te){if(te!==void 0&&te.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(j===!0)return;if(B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),te.parent===null&&te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),Ue.enabled===!0&&Ue.isPresenting===!0&&(Ue.cameraAutoUpdate===!0&&Ue.updateCamera(te),te=Ue.getCamera()),B.isScene===!0&&B.onBeforeRender(V,B,te,N),T=Xe.get(B,k.length),T.init(te),k.push(T),xe.multiplyMatrices(te.projectionMatrix,te.matrixWorldInverse),Pe.setFromProjectionMatrix(xe,ls,te.reversedDepth),le=this.localClippingEnabled,qe=Fe.init(this.clippingPlanes,le),A=ve.get(B,P.length),A.init(),P.push(A),Ue.enabled===!0&&Ue.isPresenting===!0){const Ne=V.xr.getDepthSensingMesh();Ne!==null&&Si(Ne,te,-1/0,V.sortObjects)}Si(B,te,0,V.sortObjects),A.finish(),V.sortObjects===!0&&A.sort(Ae,H),bt=Ue.enabled===!1||Ue.isPresenting===!1||Ue.hasDepthSensing()===!1,bt&&et.addToRenderList(A,B),this.info.render.frame++,qe===!0&&Fe.beginShadows();const pe=T.state.shadowsArray;st.render(pe,B,te),qe===!0&&Fe.endShadows(),this.info.autoReset===!0&&this.info.reset();const me=A.opaque,ie=A.transmissive;if(T.setupLights(),te.isArrayCamera){const Ne=te.cameras;if(ie.length>0)for(let Ge=0,$e=Ne.length;Ge<$e;Ge++){const ze=Ne[Ge];ol(me,ie,B,ze)}bt&&et.render(B);for(let Ge=0,$e=Ne.length;Ge<$e;Ge++){const ze=Ne[Ge];ta(A,B,ze,ze.viewport)}}else ie.length>0&&ol(me,ie,B,te),bt&&et.render(B),ta(A,B,te);N!==null&&U===0&&(St.updateMultisampleRenderTarget(N),St.updateRenderTargetMipmap(N)),B.isScene===!0&&B.onAfterRender(V,B,te),He.resetDefaultState(),M=-1,w=null,k.pop(),k.length>0?(T=k[k.length-1],qe===!0&&Fe.setGlobalState(V.clippingPlanes,T.state.camera)):T=null,P.pop(),P.length>0?A=P[P.length-1]:A=null};function Si(B,te,pe,me){if(B.visible===!1)return;if(B.layers.test(te.layers)){if(B.isGroup)pe=B.renderOrder;else if(B.isLOD)B.autoUpdate===!0&&B.update(te);else if(B.isLight)T.pushLight(B),B.castShadow&&T.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||Pe.intersectsSprite(B)){me&&ht.setFromMatrixPosition(B.matrixWorld).applyMatrix4(xe);const Ge=ce.update(B),$e=B.material;$e.visible&&A.push(B,Ge,$e,pe,ht.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(!B.frustumCulled||Pe.intersectsObject(B))){const Ge=ce.update(B),$e=B.material;if(me&&(B.boundingSphere!==void 0?(B.boundingSphere===null&&B.computeBoundingSphere(),ht.copy(B.boundingSphere.center)):(Ge.boundingSphere===null&&Ge.computeBoundingSphere(),ht.copy(Ge.boundingSphere.center)),ht.applyMatrix4(B.matrixWorld).applyMatrix4(xe)),Array.isArray($e)){const ze=Ge.groups;for(let lt=0,mt=ze.length;lt<mt;lt++){const rt=ze[lt],wt=$e[rt.materialIndex];wt&&wt.visible&&A.push(B,Ge,wt,pe,ht.z,rt)}}else $e.visible&&A.push(B,Ge,$e,pe,ht.z,null)}}const Ne=B.children;for(let Ge=0,$e=Ne.length;Ge<$e;Ge++)Si(Ne[Ge],te,pe,me)}function ta(B,te,pe,me){const ie=B.opaque,Ne=B.transmissive,Ge=B.transparent;T.setupLightsView(pe),qe===!0&&Fe.setGlobalState(V.clippingPlanes,pe),me&&Ke.viewport(R.copy(me)),ie.length>0&&Ki(ie,te,pe),Ne.length>0&&Ki(Ne,te,pe),Ge.length>0&&Ki(Ge,te,pe),Ke.buffers.depth.setTest(!0),Ke.buffers.depth.setMask(!0),Ke.buffers.color.setMask(!0),Ke.setPolygonOffset(!1)}function ol(B,te,pe,me){if((pe.isScene===!0?pe.overrideMaterial:null)!==null)return;T.state.transmissionRenderTarget[me.id]===void 0&&(T.state.transmissionRenderTarget[me.id]=new el(1,1,{generateMipmaps:!0,type:vt.has("EXT_color_buffer_half_float")||vt.has("EXT_color_buffer_float")?Vh:ms,minFilter:jo,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:tn.workingColorSpace}));const Ne=T.state.transmissionRenderTarget[me.id],Ge=me.viewport||R;Ne.setSize(Ge.z*V.transmissionResolutionScale,Ge.w*V.transmissionResolutionScale);const $e=V.getRenderTarget(),ze=V.getActiveCubeFace(),lt=V.getActiveMipmapLevel();V.setRenderTarget(Ne),V.getClearColor(re),oe=V.getClearAlpha(),oe<1&&V.setClearColor(16777215,.5),V.clear(),bt&&et.render(pe);const mt=V.toneMapping;V.toneMapping=Ga;const rt=me.viewport;if(me.viewport!==void 0&&(me.viewport=void 0),T.setupLightsView(me),qe===!0&&Fe.setGlobalState(V.clippingPlanes,me),Ki(B,pe,me),St.updateMultisampleRenderTarget(Ne),St.updateRenderTargetMipmap(Ne),vt.has("WEBGL_multisampled_render_to_texture")===!1){let wt=!1;for(let jt=0,hn=te.length;jt<hn;jt++){const Jt=te[jt],Rt=Jt.object,ct=Jt.geometry,_n=Jt.material,Lt=Jt.group;if(_n.side===Gs&&Rt.layers.test(me.layers)){const Kn=_n.side;_n.side=Yi,_n.needsUpdate=!0,to(Rt,pe,me,ct,_n,Lt),_n.side=Kn,_n.needsUpdate=!0,wt=!0}}wt===!0&&(St.updateMultisampleRenderTarget(Ne),St.updateRenderTargetMipmap(Ne))}V.setRenderTarget($e,ze,lt),V.setClearColor(re,oe),rt!==void 0&&(me.viewport=rt),V.toneMapping=mt}function Ki(B,te,pe){const me=te.isScene===!0?te.overrideMaterial:null;for(let ie=0,Ne=B.length;ie<Ne;ie++){const Ge=B[ie],$e=Ge.object,ze=Ge.geometry,lt=Ge.group;let mt=Ge.material;mt.allowOverride===!0&&me!==null&&(mt=me),$e.layers.test(pe.layers)&&to($e,te,pe,ze,mt,lt)}}function to(B,te,pe,me,ie,Ne){B.onBeforeRender(V,te,pe,me,ie,Ne),B.modelViewMatrix.multiplyMatrices(pe.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),ie.onBeforeRender(V,te,pe,me,B,Ne),ie.transparent===!0&&ie.side===Gs&&ie.forceSinglePass===!1?(ie.side=Yi,ie.needsUpdate=!0,V.renderBufferDirect(pe,te,me,ie,B,Ne),ie.side=Ya,ie.needsUpdate=!0,V.renderBufferDirect(pe,te,me,ie,B,Ne),ie.side=Gs):V.renderBufferDirect(pe,te,me,ie,B,Ne),B.onAfterRender(V,te,pe,me,ie,Ne)}function lr(B,te,pe){te.isScene!==!0&&(te=tt);const me=Je.get(B),ie=T.state.lights,Ne=T.state.shadowsArray,Ge=ie.state.version,$e=ge.getParameters(B,ie.state,Ne,te,pe),ze=ge.getProgramCacheKey($e);let lt=me.programs;me.environment=B.isMeshStandardMaterial?te.environment:null,me.fog=te.fog,me.envMap=(B.isMeshStandardMaterial?xn:yn).get(B.envMap||me.environment),me.envMapRotation=me.environment!==null&&B.envMap===null?te.environmentRotation:B.envMapRotation,lt===void 0&&(B.addEventListener("dispose",be),lt=new Map,me.programs=lt);let mt=lt.get(ze);if(mt!==void 0){if(me.currentProgram===mt&&me.lightsStateVersion===Ge)return cr(B,$e),mt}else $e.uniforms=ge.getUniforms(B),B.onBeforeCompile($e,V),mt=ge.acquireProgram($e,ze),lt.set(ze,mt),me.uniforms=$e.uniforms;const rt=me.uniforms;return(!B.isShaderMaterial&&!B.isRawShaderMaterial||B.clipping===!0)&&(rt.clippingPlanes=Fe.uniform),cr(B,$e),me.needsLights=ui(B),me.lightsStateVersion=Ge,me.needsLights&&(rt.ambientLightColor.value=ie.state.ambient,rt.lightProbe.value=ie.state.probe,rt.directionalLights.value=ie.state.directional,rt.directionalLightShadows.value=ie.state.directionalShadow,rt.spotLights.value=ie.state.spot,rt.spotLightShadows.value=ie.state.spotShadow,rt.rectAreaLights.value=ie.state.rectArea,rt.ltc_1.value=ie.state.rectAreaLTC1,rt.ltc_2.value=ie.state.rectAreaLTC2,rt.pointLights.value=ie.state.point,rt.pointLightShadows.value=ie.state.pointShadow,rt.hemisphereLights.value=ie.state.hemi,rt.directionalShadowMap.value=ie.state.directionalShadowMap,rt.directionalShadowMatrix.value=ie.state.directionalShadowMatrix,rt.spotShadowMap.value=ie.state.spotShadowMap,rt.spotLightMatrix.value=ie.state.spotLightMatrix,rt.spotLightMap.value=ie.state.spotLightMap,rt.pointShadowMap.value=ie.state.pointShadowMap,rt.pointShadowMatrix.value=ie.state.pointShadowMatrix),me.currentProgram=mt,me.uniformsList=null,mt}function Cr(B){if(B.uniformsList===null){const te=B.currentProgram.getUniforms();B.uniformsList=Wf.seqWithValue(te.seq,B.uniforms)}return B.uniformsList}function cr(B,te){const pe=Je.get(B);pe.outputColorSpace=te.outputColorSpace,pe.batching=te.batching,pe.batchingColor=te.batchingColor,pe.instancing=te.instancing,pe.instancingColor=te.instancingColor,pe.instancingMorph=te.instancingMorph,pe.skinning=te.skinning,pe.morphTargets=te.morphTargets,pe.morphNormals=te.morphNormals,pe.morphColors=te.morphColors,pe.morphTargetsCount=te.morphTargetsCount,pe.numClippingPlanes=te.numClippingPlanes,pe.numIntersection=te.numClipIntersection,pe.vertexAlphas=te.vertexAlphas,pe.vertexTangents=te.vertexTangents,pe.toneMapping=te.toneMapping}function ur(B,te,pe,me,ie){te.isScene!==!0&&(te=tt),St.resetTextureUnits();const Ne=te.fog,Ge=me.isMeshStandardMaterial?te.environment:null,$e=N===null?V.outputColorSpace:N.isXRRenderTarget===!0?N.texture.colorSpace:Cc,ze=(me.isMeshStandardMaterial?xn:yn).get(me.envMap||Ge),lt=me.vertexColors===!0&&!!pe.attributes.color&&pe.attributes.color.itemSize===4,mt=!!pe.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),rt=!!pe.morphAttributes.position,wt=!!pe.morphAttributes.normal,jt=!!pe.morphAttributes.color;let hn=Ga;me.toneMapped&&(N===null||N.isXRRenderTarget===!0)&&(hn=V.toneMapping);const Jt=pe.morphAttributes.position||pe.morphAttributes.normal||pe.morphAttributes.color,Rt=Jt!==void 0?Jt.length:0,ct=Je.get(me),_n=T.state.lights;if(qe===!0&&(le===!0||B!==w)){const bn=B===w&&me.id===M;Fe.setState(me,B,bn)}let Lt=!1;me.version===ct.__version?(ct.needsLights&&ct.lightsStateVersion!==_n.state.version||ct.outputColorSpace!==$e||ie.isBatchedMesh&&ct.batching===!1||!ie.isBatchedMesh&&ct.batching===!0||ie.isBatchedMesh&&ct.batchingColor===!0&&ie.colorTexture===null||ie.isBatchedMesh&&ct.batchingColor===!1&&ie.colorTexture!==null||ie.isInstancedMesh&&ct.instancing===!1||!ie.isInstancedMesh&&ct.instancing===!0||ie.isSkinnedMesh&&ct.skinning===!1||!ie.isSkinnedMesh&&ct.skinning===!0||ie.isInstancedMesh&&ct.instancingColor===!0&&ie.instanceColor===null||ie.isInstancedMesh&&ct.instancingColor===!1&&ie.instanceColor!==null||ie.isInstancedMesh&&ct.instancingMorph===!0&&ie.morphTexture===null||ie.isInstancedMesh&&ct.instancingMorph===!1&&ie.morphTexture!==null||ct.envMap!==ze||me.fog===!0&&ct.fog!==Ne||ct.numClippingPlanes!==void 0&&(ct.numClippingPlanes!==Fe.numPlanes||ct.numIntersection!==Fe.numIntersection)||ct.vertexAlphas!==lt||ct.vertexTangents!==mt||ct.morphTargets!==rt||ct.morphNormals!==wt||ct.morphColors!==jt||ct.toneMapping!==hn||ct.morphTargetsCount!==Rt)&&(Lt=!0):(Lt=!0,ct.__version=me.version);let Kn=ct.currentProgram;Lt===!0&&(Kn=lr(me,te,ie));let Bi=!1,hi=!1,En=!1;const Ft=Kn.getUniforms(),Hn=ct.uniforms;if(Ke.useProgram(Kn.program)&&(Bi=!0,hi=!0,En=!0),me.id!==M&&(M=me.id,hi=!0),Bi||w!==B){Ke.buffers.depth.getReversed()&&B.reversedDepth!==!0&&(B._reversedDepth=!0,B.updateProjectionMatrix()),Ft.setValue(K,"projectionMatrix",B.projectionMatrix),Ft.setValue(K,"viewMatrix",B.matrixWorldInverse);const Ct=Ft.map.cameraPosition;Ct!==void 0&&Ct.setValue(K,Oe.setFromMatrixPosition(B.matrixWorld)),ft.logarithmicDepthBuffer&&Ft.setValue(K,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&Ft.setValue(K,"isOrthographic",B.isOrthographicCamera===!0),w!==B&&(w=B,hi=!0,En=!0)}if(ie.isSkinnedMesh){Ft.setOptional(K,ie,"bindMatrix"),Ft.setOptional(K,ie,"bindMatrixInverse");const bn=ie.skeleton;bn&&(bn.boneTexture===null&&bn.computeBoneTexture(),Ft.setValue(K,"boneTexture",bn.boneTexture,St))}ie.isBatchedMesh&&(Ft.setOptional(K,ie,"batchingTexture"),Ft.setValue(K,"batchingTexture",ie._matricesTexture,St),Ft.setOptional(K,ie,"batchingIdTexture"),Ft.setValue(K,"batchingIdTexture",ie._indirectTexture,St),Ft.setOptional(K,ie,"batchingColorTexture"),ie._colorsTexture!==null&&Ft.setValue(K,"batchingColorTexture",ie._colorsTexture,St));const Fn=pe.morphAttributes;if((Fn.position!==void 0||Fn.normal!==void 0||Fn.color!==void 0)&&De.update(ie,pe,Kn),(hi||ct.receiveShadow!==ie.receiveShadow)&&(ct.receiveShadow=ie.receiveShadow,Ft.setValue(K,"receiveShadow",ie.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(Hn.envMap.value=ze,Hn.flipEnvMap.value=ze.isCubeTexture&&ze.isRenderTargetTexture===!1?-1:1),me.isMeshStandardMaterial&&me.envMap===null&&te.environment!==null&&(Hn.envMapIntensity.value=te.environmentIntensity),hi&&(Ft.setValue(K,"toneMappingExposure",V.toneMappingExposure),ct.needsLights&&hr(Hn,En),Ne&&me.fog===!0&&Se.refreshFogUniforms(Hn,Ne),Se.refreshMaterialUniforms(Hn,me,J,Z,T.state.transmissionRenderTarget[B.id]),Wf.upload(K,Cr(ct),Hn,St)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(Wf.upload(K,Cr(ct),Hn,St),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&Ft.setValue(K,"center",ie.center),Ft.setValue(K,"modelViewMatrix",ie.modelViewMatrix),Ft.setValue(K,"normalMatrix",ie.normalMatrix),Ft.setValue(K,"modelMatrix",ie.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){const bn=me.uniformsGroups;for(let Ct=0,Ir=bn.length;Ct<Ir;Ct++){const Gn=bn[Ct];Tt.update(Gn,Kn),Tt.bind(Gn,Kn)}}return Kn}function hr(B,te){B.ambientLightColor.needsUpdate=te,B.lightProbe.needsUpdate=te,B.directionalLights.needsUpdate=te,B.directionalLightShadows.needsUpdate=te,B.pointLights.needsUpdate=te,B.pointLightShadows.needsUpdate=te,B.spotLights.needsUpdate=te,B.spotLightShadows.needsUpdate=te,B.rectAreaLights.needsUpdate=te,B.hemisphereLights.needsUpdate=te}function ui(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&B.lights===!0}this.getActiveCubeFace=function(){return q},this.getActiveMipmapLevel=function(){return U},this.getRenderTarget=function(){return N},this.setRenderTargetTextures=function(B,te,pe){const me=Je.get(B);me.__autoAllocateDepthBuffer=B.resolveDepthBuffer===!1,me.__autoAllocateDepthBuffer===!1&&(me.__useRenderToTexture=!1),Je.get(B.texture).__webglTexture=te,Je.get(B.depthTexture).__webglTexture=me.__autoAllocateDepthBuffer?void 0:pe,me.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(B,te){const pe=Je.get(B);pe.__webglFramebuffer=te,pe.__useDefaultFramebuffer=te===void 0};const Rn=K.createFramebuffer();this.setRenderTarget=function(B,te=0,pe=0){N=B,q=te,U=pe;let me=!0,ie=null,Ne=!1,Ge=!1;if(B){const ze=Je.get(B);if(ze.__useDefaultFramebuffer!==void 0)Ke.bindFramebuffer(K.FRAMEBUFFER,null),me=!1;else if(ze.__webglFramebuffer===void 0)St.setupRenderTarget(B);else if(ze.__hasExternalTextures)St.rebindTextures(B,Je.get(B.texture).__webglTexture,Je.get(B.depthTexture).__webglTexture);else if(B.depthBuffer){const rt=B.depthTexture;if(ze.__boundDepthTexture!==rt){if(rt!==null&&Je.has(rt)&&(B.width!==rt.image.width||B.height!==rt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");St.setupDepthRenderbuffer(B)}}const lt=B.texture;(lt.isData3DTexture||lt.isDataArrayTexture||lt.isCompressedArrayTexture)&&(Ge=!0);const mt=Je.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(Array.isArray(mt[te])?ie=mt[te][pe]:ie=mt[te],Ne=!0):B.samples>0&&St.useMultisampledRTT(B)===!1?ie=Je.get(B).__webglMultisampledFramebuffer:Array.isArray(mt)?ie=mt[pe]:ie=mt,R.copy(B.viewport),O.copy(B.scissor),L=B.scissorTest}else R.copy(ee).multiplyScalar(J).floor(),O.copy(ye).multiplyScalar(J).floor(),L=Ee;if(pe!==0&&(ie=Rn),Ke.bindFramebuffer(K.FRAMEBUFFER,ie)&&me&&Ke.drawBuffers(B,ie),Ke.viewport(R),Ke.scissor(O),Ke.setScissorTest(L),Ne){const ze=Je.get(B.texture);K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_CUBE_MAP_POSITIVE_X+te,ze.__webglTexture,pe)}else if(Ge){const ze=te;for(let lt=0;lt<B.textures.length;lt++){const mt=Je.get(B.textures[lt]);K.framebufferTextureLayer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0+lt,mt.__webglTexture,pe,ze)}}else if(B!==null&&pe!==0){const ze=Je.get(B.texture);K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,ze.__webglTexture,pe)}M=-1},this.readRenderTargetPixels=function(B,te,pe,me,ie,Ne,Ge,$e=0){if(!(B&&B.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ze=Je.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&Ge!==void 0&&(ze=ze[Ge]),ze){Ke.bindFramebuffer(K.FRAMEBUFFER,ze);try{const lt=B.textures[$e],mt=lt.format,rt=lt.type;if(!ft.textureFormatReadable(mt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!ft.textureTypeReadable(rt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}te>=0&&te<=B.width-me&&pe>=0&&pe<=B.height-ie&&(B.textures.length>1&&K.readBuffer(K.COLOR_ATTACHMENT0+$e),K.readPixels(te,pe,me,ie,nt.convert(mt),nt.convert(rt),Ne))}finally{const lt=N!==null?Je.get(N).__webglFramebuffer:null;Ke.bindFramebuffer(K.FRAMEBUFFER,lt)}}},this.readRenderTargetPixelsAsync=async function(B,te,pe,me,ie,Ne,Ge,$e=0){if(!(B&&B.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ze=Je.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&Ge!==void 0&&(ze=ze[Ge]),ze)if(te>=0&&te<=B.width-me&&pe>=0&&pe<=B.height-ie){Ke.bindFramebuffer(K.FRAMEBUFFER,ze);const lt=B.textures[$e],mt=lt.format,rt=lt.type;if(!ft.textureFormatReadable(mt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ft.textureTypeReadable(rt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const wt=K.createBuffer();K.bindBuffer(K.PIXEL_PACK_BUFFER,wt),K.bufferData(K.PIXEL_PACK_BUFFER,Ne.byteLength,K.STREAM_READ),B.textures.length>1&&K.readBuffer(K.COLOR_ATTACHMENT0+$e),K.readPixels(te,pe,me,ie,nt.convert(mt),nt.convert(rt),0);const jt=N!==null?Je.get(N).__webglFramebuffer:null;Ke.bindFramebuffer(K.FRAMEBUFFER,jt);const hn=K.fenceSync(K.SYNC_GPU_COMMANDS_COMPLETE,0);return K.flush(),await KV(K,hn,4),K.bindBuffer(K.PIXEL_PACK_BUFFER,wt),K.getBufferSubData(K.PIXEL_PACK_BUFFER,0,Ne),K.deleteBuffer(wt),K.deleteSync(hn),Ne}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(B,te=null,pe=0){const me=Math.pow(2,-pe),ie=Math.floor(B.image.width*me),Ne=Math.floor(B.image.height*me),Ge=te!==null?te.x:0,$e=te!==null?te.y:0;St.setTexture2D(B,0),K.copyTexSubImage2D(K.TEXTURE_2D,pe,0,0,Ge,$e,ie,Ne),Ke.unbindTexture()};const no=K.createFramebuffer(),na=K.createFramebuffer();this.copyTextureToTexture=function(B,te,pe=null,me=null,ie=0,Ne=null){Ne===null&&(ie!==0?(Eh("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ne=ie,ie=0):Ne=0);let Ge,$e,ze,lt,mt,rt,wt,jt,hn;const Jt=B.isCompressedTexture?B.mipmaps[Ne]:B.image;if(pe!==null)Ge=pe.max.x-pe.min.x,$e=pe.max.y-pe.min.y,ze=pe.isBox3?pe.max.z-pe.min.z:1,lt=pe.min.x,mt=pe.min.y,rt=pe.isBox3?pe.min.z:0;else{const Fn=Math.pow(2,-ie);Ge=Math.floor(Jt.width*Fn),$e=Math.floor(Jt.height*Fn),B.isDataArrayTexture?ze=Jt.depth:B.isData3DTexture?ze=Math.floor(Jt.depth*Fn):ze=1,lt=0,mt=0,rt=0}me!==null?(wt=me.x,jt=me.y,hn=me.z):(wt=0,jt=0,hn=0);const Rt=nt.convert(te.format),ct=nt.convert(te.type);let _n;te.isData3DTexture?(St.setTexture3D(te,0),_n=K.TEXTURE_3D):te.isDataArrayTexture||te.isCompressedArrayTexture?(St.setTexture2DArray(te,0),_n=K.TEXTURE_2D_ARRAY):(St.setTexture2D(te,0),_n=K.TEXTURE_2D),K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,te.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,te.unpackAlignment);const Lt=K.getParameter(K.UNPACK_ROW_LENGTH),Kn=K.getParameter(K.UNPACK_IMAGE_HEIGHT),Bi=K.getParameter(K.UNPACK_SKIP_PIXELS),hi=K.getParameter(K.UNPACK_SKIP_ROWS),En=K.getParameter(K.UNPACK_SKIP_IMAGES);K.pixelStorei(K.UNPACK_ROW_LENGTH,Jt.width),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,Jt.height),K.pixelStorei(K.UNPACK_SKIP_PIXELS,lt),K.pixelStorei(K.UNPACK_SKIP_ROWS,mt),K.pixelStorei(K.UNPACK_SKIP_IMAGES,rt);const Ft=B.isDataArrayTexture||B.isData3DTexture,Hn=te.isDataArrayTexture||te.isData3DTexture;if(B.isDepthTexture){const Fn=Je.get(B),bn=Je.get(te),Ct=Je.get(Fn.__renderTarget),Ir=Je.get(bn.__renderTarget);Ke.bindFramebuffer(K.READ_FRAMEBUFFER,Ct.__webglFramebuffer),Ke.bindFramebuffer(K.DRAW_FRAMEBUFFER,Ir.__webglFramebuffer);for(let Gn=0;Gn<ze;Gn++)Ft&&(K.framebufferTextureLayer(K.READ_FRAMEBUFFER,K.COLOR_ATTACHMENT0,Je.get(B).__webglTexture,ie,rt+Gn),K.framebufferTextureLayer(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0,Je.get(te).__webglTexture,Ne,hn+Gn)),K.blitFramebuffer(lt,mt,Ge,$e,wt,jt,Ge,$e,K.DEPTH_BUFFER_BIT,K.NEAREST);Ke.bindFramebuffer(K.READ_FRAMEBUFFER,null),Ke.bindFramebuffer(K.DRAW_FRAMEBUFFER,null)}else if(ie!==0||B.isRenderTargetTexture||Je.has(B)){const Fn=Je.get(B),bn=Je.get(te);Ke.bindFramebuffer(K.READ_FRAMEBUFFER,no),Ke.bindFramebuffer(K.DRAW_FRAMEBUFFER,na);for(let Ct=0;Ct<ze;Ct++)Ft?K.framebufferTextureLayer(K.READ_FRAMEBUFFER,K.COLOR_ATTACHMENT0,Fn.__webglTexture,ie,rt+Ct):K.framebufferTexture2D(K.READ_FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,Fn.__webglTexture,ie),Hn?K.framebufferTextureLayer(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0,bn.__webglTexture,Ne,hn+Ct):K.framebufferTexture2D(K.DRAW_FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_2D,bn.__webglTexture,Ne),ie!==0?K.blitFramebuffer(lt,mt,Ge,$e,wt,jt,Ge,$e,K.COLOR_BUFFER_BIT,K.NEAREST):Hn?K.copyTexSubImage3D(_n,Ne,wt,jt,hn+Ct,lt,mt,Ge,$e):K.copyTexSubImage2D(_n,Ne,wt,jt,lt,mt,Ge,$e);Ke.bindFramebuffer(K.READ_FRAMEBUFFER,null),Ke.bindFramebuffer(K.DRAW_FRAMEBUFFER,null)}else Hn?B.isDataTexture||B.isData3DTexture?K.texSubImage3D(_n,Ne,wt,jt,hn,Ge,$e,ze,Rt,ct,Jt.data):te.isCompressedArrayTexture?K.compressedTexSubImage3D(_n,Ne,wt,jt,hn,Ge,$e,ze,Rt,Jt.data):K.texSubImage3D(_n,Ne,wt,jt,hn,Ge,$e,ze,Rt,ct,Jt):B.isDataTexture?K.texSubImage2D(K.TEXTURE_2D,Ne,wt,jt,Ge,$e,Rt,ct,Jt.data):B.isCompressedTexture?K.compressedTexSubImage2D(K.TEXTURE_2D,Ne,wt,jt,Jt.width,Jt.height,Rt,Jt.data):K.texSubImage2D(K.TEXTURE_2D,Ne,wt,jt,Ge,$e,Rt,ct,Jt);K.pixelStorei(K.UNPACK_ROW_LENGTH,Lt),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,Kn),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Bi),K.pixelStorei(K.UNPACK_SKIP_ROWS,hi),K.pixelStorei(K.UNPACK_SKIP_IMAGES,En),Ne===0&&te.generateMipmaps&&K.generateMipmap(_n),Ke.unbindTexture()},this.initRenderTarget=function(B){Je.get(B).__webglFramebuffer===void 0&&St.setupRenderTarget(B)},this.initTexture=function(B){B.isCubeTexture?St.setTextureCube(B,0):B.isData3DTexture?St.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?St.setTexture2DArray(B,0):St.setTexture2D(B,0),Ke.unbindTexture()},this.resetState=function(){q=0,U=0,N=null,Ke.reset(),He.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ls}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=tn._getDrawingBufferColorSpace(e),t.unpackColorSpace=tn._getUnpackColorSpace()}}const vH="_container_16zru_3",yH="_header_16zru_31",EH="_roomTitle_16zru_51",SH="_roomIcon_16zru_71",TH="_controls_16zru_79",xH="_deviceCount_16zru_93",bH="_cameraControls_16zru_105",AH="_controlBtn_16zru_117",MH="_canvas_16zru_169",wH="_instructions_16zru_253",xr={container:vH,header:yH,roomTitle:EH,roomIcon:SH,controls:TH,deviceCount:xH,cameraControls:bH,controlBtn:AH,canvas:MH,instructions:wH},RH=({room:n,devices:e,onDeviceSelect:t})=>{const i=Le.useRef(null),s=Le.useRef(null),o=Le.useRef(null),c=Le.useRef(null),h=Le.useRef([]),d=Le.useRef(null),p=Le.useRef(null),g=Le.useRef(null),[v,y]=Le.useState(null),[E,b]=Le.useState({rotation:{x:-.3,y:0},zoom:1}),[D,A]=Le.useState(!1),T=e.filter(R=>R.roomId===n.id),P=Le.useCallback(R=>{const oe=new Fa(8,6),X=new Bb({color:n.color?new Bt(n.color):15658734}),Z=new Wi(oe,X);Z.rotation.x=-Math.PI/2,Z.receiveShadow=!0,R.add(Z);const J=new Bb({color:15790320,transparent:!0,opacity:.8}),Ae=new Wi(new Fa(8,3),J);Ae.position.set(0,3/2,-6/2),R.add(Ae);const H=new Wi(new Fa(6,3),J);H.rotation.y=Math.PI/2,H.position.set(-8/2,3/2,0),R.add(H);const ee=new Wi(new Fa(6,3),J);ee.rotation.y=-Math.PI/2,ee.position.set(8/2,3/2,0),R.add(ee)},[n.color]),k=R=>{switch(R.category){case"light":return new S0(.2,16,16);case"switch":return new tl(.3,.3,.15);case"sensor":return new E0(.15,.4,8);case"garden":return new kp(.15,.2,.5,8);default:return new tl(.25,.25,.25)}},V=R=>{const O=R.status?.some(re=>(re.code==="switch_1"||re.code==="switch_led")&&re.value===!0);let L=R.online?O?4906624:7041664:15680580;return R.category==="light"&&O?new zb({color:L,emissive:3355392,shininess:100}):new zb({color:L})},j=(R,O)=>{const L=document.createElement("canvas"),re=L.getContext("2d");if(!re)return null;L.width=256,L.height=64,re.fillStyle="rgba(0, 0, 0, 0.8)",re.fillRect(0,0,L.width,L.height),re.fillStyle="white",re.font="16px Arial",re.textAlign="center",re.fillText(R.customName||R.name,128,40);const oe=new MF(L),X=new AR({map:oe,transparent:!0}),Z=new TF(X);return Z.position.copy(O),Z.position.y+=.5,Z.scale.set(1,.25,1),Z},q=Le.useCallback(()=>{s.current&&(h.current.forEach(({mesh:R,label:O})=>{s.current?.remove(R),s.current?.remove(O)}),h.current=[],T.forEach((R,O)=>{const L=k(R),re=V(R),oe=new Wi(L,re),X=O/T.length*2*Math.PI,Z=2,J=new he(Math.cos(X)*Z,.3,Math.sin(X)*Z);oe.position.copy(J),oe.castShadow=!0,oe.userData={deviceId:R.id,device:R},s.current?.add(oe);const Ae=j(R,J);Ae&&(s.current?.add(Ae),h.current.push({id:R.id,mesh:oe,label:Ae,device:R}))}),console.log(`Created ${h.current.length} 3D devices`))},[T]),U=Le.useCallback(R=>{if(!i.current||!p.current)return;const O=i.current.getBoundingClientRect();if(p.current.x=(R.clientX-O.left)/O.width*2-1,p.current.y=-((R.clientY-O.top)/O.height)*2+1,D){const L=R.movementX*.01,re=R.movementY*.01;b(oe=>({rotation:{x:Math.max(-Math.PI/2,Math.min(Math.PI/2,oe.rotation.x+re)),y:oe.rotation.y+L},zoom:oe.zoom}))}},[D]),N=Le.useCallback(R=>{if(!d.current||!p.current||!c.current)return;d.current.setFromCamera(p.current,c.current);const O=d.current.intersectObjects(h.current.map(L=>L.mesh));if(O.length>0){const L=O[0].object.userData.deviceId;y(L);const re=h.current.find(oe=>oe.id===L);re&&t?.(re.device)}else A(!0),y(null),t?.(null)},[t]),M=Le.useCallback(()=>{A(!1)},[]),w=Le.useCallback(()=>{o.current&&s.current&&c.current&&(h.current.forEach(({mesh:R,id:O})=>{O===v?(R.scale.setScalar(1.2),R.material.emissive.setHex(4473924)):(R.scale.setScalar(1),R.material.emissive.setHex(0))}),o.current.render(s.current,c.current)),g.current=requestAnimationFrame(w)},[v]);return Le.useEffect(()=>{if(!c.current)return;const R=8*E.zoom;c.current.position.x=Math.sin(E.rotation.y)*Math.cos(E.rotation.x)*R,c.current.position.y=Math.sin(E.rotation.x)*R+3,c.current.position.z=Math.cos(E.rotation.y)*Math.cos(E.rotation.x)*R,c.current.lookAt(0,0,0)},[E]),Le.useEffect(()=>{if(!i.current)return;try{const O=new EF;O.background=new Bt(16316922),s.current=O;const L=new Ar(75,i.current.clientWidth/i.current.clientHeight,.1,1e3);L.position.set(0,5,8),c.current=L;const re=new _H({antialias:!0});re.setSize(i.current.clientWidth,i.current.clientHeight),re.shadowMap.enabled=!0,re.shadowMap.type=rR,i.current.appendChild(re.domElement),o.current=re,d.current=new UF,p.current=new Nt;const oe=new NF(4210752,.4);O.add(oe);const X=new DF(16777215,.8);X.position.set(5,10,5),X.castShadow=!0,O.add(X),P(O),q(),w(),console.log("3D visualization initialized successfully")}catch(O){console.error("3D initialization error:",O)}const R=o.current?.domElement;return R&&(R.addEventListener("mousemove",U),R.addEventListener("mousedown",N),R.addEventListener("mouseup",M)),()=>{g.current&&cancelAnimationFrame(g.current),R&&(R.removeEventListener("mousemove",U),R.removeEventListener("mousedown",N),R.removeEventListener("mouseup",M))}},[P,q,w,U,N,M]),Le.useEffect(()=>{q()},[q]),x.jsxs("div",{className:xr.container,children:[x.jsxs("div",{className:xr.header,children:[x.jsxs("h3",{className:xr.roomTitle,children:[n.icon&&x.jsx("span",{className:xr.roomIcon,children:n.icon}),n.name," - 3D Pohled"]}),x.jsxs("div",{className:xr.controls,children:[x.jsxs("span",{className:xr.deviceCount,children:[T.length," zařízení"]}),x.jsxs("div",{className:xr.cameraControls,children:[x.jsx("button",{onClick:()=>b(R=>({...R,zoom:Math.max(.5,R.zoom-.2)})),className:xr.controlBtn,children:"🔍+"}),x.jsx("button",{onClick:()=>b(R=>({...R,zoom:Math.min(2,R.zoom+.2)})),className:xr.controlBtn,children:"🔍-"}),x.jsx("button",{onClick:()=>b({rotation:{x:-.3,y:0},zoom:1}),className:xr.controlBtn,children:"🎯 Reset"})]})]})]}),x.jsx("div",{ref:i,className:xr.canvas,style:{minHeight:"500px",width:"100%",cursor:D?"grabbing":"grab"}}),x.jsxs("div",{className:xr.instructions,children:[x.jsx("p",{children:"Tažením otáčejte kameru • Klik pro výběr zařízení"}),v&&x.jsxs("p",{children:["Vybráno: ",h.current.find(R=>R.id===v)?.device.customName||"Zařízení"]})]})]})},CH=[{date:"1.1.",name:"Nový rok / Den obnovy samostatného českého státu"},{date:"7.4.",name:"Velikonoční pondělí"},{date:"1.5.",name:"Svátek práce"},{date:"8.5.",name:"Den vítězství"},{date:"5.7.",name:"Den slovanských věrozvěstů Cyrila a Metoděje"},{date:"6.7.",name:"Den upálení mistra Jana Husa"},{date:"28.9.",name:"Den české státnosti"},{date:"28.10.",name:"Den vzniku samostatného československého státu"},{date:"17.11.",name:"Den boje za svobodu a demokracii"},{date:"24.12.",name:"Štědrý den"},{date:"25.12.",name:"1. svátek vánoční"},{date:"26.12.",name:"2. svátek vánoční"}],IH=[{day:"1.1",name:"Nový rok"},{day:"2.1",name:"Karina"},{day:"3.1",name:"Radmila"},{day:"4.1",name:"Diana"},{day:"5.1",name:"Dalimil"},{day:"6.1",name:"Tři králové"},{day:"7.1",name:"Vilma"},{day:"8.1",name:"Čestmír"},{day:"9.1",name:"Vladan"},{day:"10.1",name:"Břetislav"},{day:"11.1",name:"Bohdana"},{day:"12.1",name:"Pravoslav"},{day:"13.1",name:"Edita"},{day:"14.1",name:"Radovan"},{day:"15.1",name:"Alice"},{day:"16.1",name:"Ctirad"},{day:"17.1",name:"Drahoslav"},{day:"18.1",name:"Vladislav"},{day:"19.1",name:"Doubravka"},{day:"20.1",name:"Ilona"},{day:"21.1",name:"Běla"},{day:"22.1",name:"Slavomír"},{day:"23.1",name:"Zdeněk"},{day:"24.1",name:"Milena"},{day:"25.1",name:"Miloš"},{day:"26.1",name:"Zora"},{day:"27.1",name:"Ingrid"},{day:"28.1",name:"Otýlie"},{day:"29.1",name:"Zdislava"},{day:"30.1",name:"Robin"},{day:"31.1",name:"Marika"},{day:"1.2",name:"Hynek"},{day:"2.2",name:"Nela"},{day:"3.2",name:"Blažej"},{day:"4.2",name:"Jarmila"},{day:"5.2",name:"Dobromila"},{day:"6.2",name:"Vanda"},{day:"7.2",name:"Veronika"},{day:"23.9.",name:"Berta"},{day:"24.9.",name:"Jaromír"},{day:"25.9.",name:"Zlata"},{day:"26.9.",name:"Andrea"},{day:"27.9.",name:"Jonáš"},{day:"28.9.",name:"Václav"},{day:"29.9.",name:"Michal"},{day:"30.9.",name:"Jeroným"},{day:"24.12.",name:"Adam a Eva"},{day:"25.12.",name:"Boží hod vánoční"},{day:"26.12.",name:"Štěpán"},{day:"31.12.",name:"Silvestr"}],DH=async n=>new Promise(e=>{const t=CH.map(i=>{const[s,o]=i.date.split("."),c=`${n}-${o.padStart(2,"0")}-${s.padStart(2,"0")}`;return{id:`holiday-${n}-${o}-${s}`,name:i.name,date:new Date(c),type:"national",isPublic:!0}});e(t)}),NH=async n=>new Promise(e=>{const t=IH.map(i=>{const[s,o]=i.day.split("."),c=`${n}-${o.padStart(2,"0")}-${s.padStart(2,"0")}`,h=i.name.split(", ");return{id:`nameday-${c}`,name:h[0],date:new Date(c),names:h}});e(t)}),F_=[{month:1,name:"Zimní klid",backgroundImage:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",primaryColor:"#667eea",secondaryColor:"#764ba2",textColor:"#ffffff"},{month:2,name:"Sněhové království",backgroundImage:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",primaryColor:"#f093fb",secondaryColor:"#f5576c",textColor:"#ffffff"},{month:3,name:"Jarní probuzení",backgroundImage:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",primaryColor:"#4facfe",secondaryColor:"#00f2fe",textColor:"#ffffff"},{month:4,name:"Květinové louky",backgroundImage:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",primaryColor:"#43e97b",secondaryColor:"#38f9d7",textColor:"#ffffff"},{month:5,name:"Májová zeleň",backgroundImage:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",primaryColor:"#fa709a",secondaryColor:"#fee140",textColor:"#ffffff"},{month:6,name:"Letní začátek",backgroundImage:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)",primaryColor:"#a8edea",secondaryColor:"#fed6e3",textColor:"#333333"},{month:7,name:"Slunečné prázdniny",backgroundImage:"linear-gradient(135deg, #ffd89b 0%, #19547b 100%)",primaryColor:"#ffd89b",secondaryColor:"#19547b",textColor:"#333333"},{month:8,name:"Léto v plném proudu",backgroundImage:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",primaryColor:"#667eea",secondaryColor:"#764ba2",textColor:"#ffffff"},{month:9,name:"Podzimní barvy",backgroundImage:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",primaryColor:"#f093fb",secondaryColor:"#f5576c",textColor:"#ffffff"},{month:10,name:"Zlatý říjen",backgroundImage:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",primaryColor:"#4facfe",secondaryColor:"#00f2fe",textColor:"#ffffff"},{month:11,name:"Mlhavý listopad",backgroundImage:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",primaryColor:"#43e97b",secondaryColor:"#38f9d7",textColor:"#ffffff"},{month:12,name:"Vánoční čas",backgroundImage:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",primaryColor:"#fa709a",secondaryColor:"#fee140",textColor:"#ffffff"}],OR=Le.createContext(void 0),kc=()=>{const n=Le.useContext(OR);if(!n)throw new Error("useCalendar must be used within a CalendarProvider");return n},PH=({children:n,initialEvents:e=[],onEventsChange:t})=>{const[i,s]=Le.useState(new Date),[o,c]=Le.useState("month"),[h,d]=Le.useState([]),[p,g]=Le.useState([]),[v,y]=Le.useState(e),[E,b]=Le.useState({theme:"light",firstDayOfWeek:1,timeFormat:"24h",showWeekNumbers:!1,showHolidays:!0,showNamedays:!0,defaultView:"month",reminderSettings:{email:!0,push:!0,defaultTime:"15min"},familyView:!0});Le.useEffect(()=>{const R=localStorage.getItem("calendar-settings");if(R)try{const L=JSON.parse(R);b(re=>({...re,...L}))}catch(L){console.error("Chyba při načítání nastavení kalendáře:",L)}const O=localStorage.getItem("calendar-events");if(O)try{const L=JSON.parse(O).map(re=>({...re,date:new Date(re.date)}));y(L)}catch(L){console.error("Chyba při načítání událostí kalendáře:",L)}},[]),Le.useEffect(()=>{(async()=>{try{const O=await DH(i.getFullYear()),L=await NH(i.getFullYear());d(O),g(L)}catch(O){console.error("Chyba při načítání dat:",O)}})()},[i.getFullYear()]),Le.useEffect(()=>{localStorage.setItem("calendar-events",JSON.stringify(v)),t?.(v)},[v,t]),Le.useEffect(()=>{localStorage.setItem("calendar-settings",JSON.stringify(E))},[E]);const D=R=>{y(O=>[...O,R])},A=(R,O)=>{y(L=>L.map(re=>re.id===R?{...re,...O}:re))},T=R=>{y(O=>O.filter(L=>L.id!==R))},P=R=>v.filter(O=>N(O.date,R)),k=R=>h.find(O=>N(O.date,R))||null,V=R=>p.find(O=>N(O.date,R))||null,j=R=>{b(O=>({...O,...R}))},q=()=>{const R=i.getMonth()+1;return F_.find(O=>O.month===R)||F_[0]},U=R=>N(R,new Date),N=(R,O)=>R.getDate()===O.getDate()&&R.getMonth()===O.getMonth()&&R.getFullYear()===O.getFullYear(),w={currentDate:i,setCurrentDate:s,currentView:o,setCurrentView:c,events:v,addEvent:D,updateEvent:A,deleteEvent:T,getEventsByDate:P,holidays:h,namedays:p,getHolidayByDate:k,getNamedayByDate:V,settings:E,updateSettings:j,monthThemes:F_,getCurrentMonthTheme:q,isToday:U,isSameDay:N,formatDate:(R,O="DD.MM.YYYY")=>{const L=R.getDate().toString().padStart(2,"0"),re=(R.getMonth()+1).toString().padStart(2,"0"),oe=R.getFullYear(),X=R.toLocaleDateString("cs-CZ",{weekday:"long"});switch(O){case"DD.MM.YYYY":return`${L}.${re}.${oe}`;case"DD.MM":return`${L}.${re}`;case"WEEKDAY":return X;case"FULL":return`${X} ${L}.${re}.${oe}`;default:return R.toLocaleDateString("cs-CZ")}}};return x.jsx(OR.Provider,{value:w,children:n})},UH=({currentDate:n,onDateClick:e,onEventClick:t,familyMembers:i,onAddEventFor:s})=>{const{isToday:o,getEventsByDate:c,getHolidayByDate:h,getNamedayByDate:d,formatDate:p}=kc(),g=Le.useRef(new Map);Le.useEffect(()=>{const E=new Date,b=new Date(E.getFullYear(),E.getMonth(),E.getDate()).toISOString(),D=g.current.get(b);D&&D.scrollIntoView({behavior:"smooth",block:"center"})},[n]);const v=Le.useMemo(()=>{const E=n.getFullYear(),b=n.getMonth(),A=new Date(E,b+1,0).getDate(),T=[];for(let P=1;P<=A;P++)T.push(new Date(E,b,P));return T},[n]),y=Le.useCallback((E,b)=>{const D=c(E).filter(A=>A.familyMember===b.id);return x.jsx("div",{className:"events-in-cell",children:D.map(A=>x.jsx("div",{className:"family-event-item",style:{backgroundColor:b.color},onClick:T=>{T.stopPropagation(),t(A)},title:A.title,children:A.title},A.id))})},[c,t]);return x.jsxs("div",{className:"month-view new-family-layout",children:[x.jsxs("div",{className:"new-family-header",children:[x.jsx("div",{className:"day-info-header-cell",children:"Den"}),i.map(E=>x.jsxs("div",{className:"member-header-cell",style:{color:E.color},children:[E.icon&&x.jsx("span",{className:"member-icon",children:E.icon}),x.jsx("span",{children:E.name})]},E.id))]}),x.jsx("div",{className:"new-family-body",children:v.map(E=>{const b=h(E),D=d(E),A=i.filter(P=>P.birthday?.getDate()===E.getDate()&&P.birthday?.getMonth()===E.getMonth()),T=new Date(E.getFullYear(),E.getMonth(),E.getDate()).toISOString();return x.jsxs("div",{className:`day-row ${o(E)?"today":""}`,ref:P=>{g.current.set(T,P)},children:[x.jsxs("div",{className:"day-info-cell",children:[x.jsxs("div",{className:"day-date",children:[x.jsx("span",{className:"day-number",children:E.getDate()}),x.jsx("span",{className:"day-name",children:p(E,"WEEKDAY")})]}),x.jsxs("div",{className:"day-special-events",children:[D&&x.jsx("div",{className:"special-event nameday",title:D.names.join(", "),children:D.name}),b&&x.jsx("div",{className:"special-event holiday",title:b.name,children:b.name}),A.map(P=>x.jsxs("div",{className:"special-event birthday",title:`Narozeniny: ${P.name}`,children:["🎈 ",P.name]},P.id))]})]}),i.map(P=>x.jsxs("div",{className:"member-day-cell",onClick:()=>e(E),children:[y(E,P),x.jsx("button",{className:"add-event-button-cell",onClick:k=>{k.stopPropagation(),s(E,P.id)}})]},P.id))]},E.toISOString())})})]})},LH=({currentDate:n,onDateClick:e,onEventClick:t,familyMembers:i})=>{const{isToday:s,getEventsByDate:o}=kc(),c=()=>{const E=new Date(n),b=E.getDay(),D=b===0?-6:1-b;E.setDate(E.getDate()+D);const A=[];for(let T=0;T<7;T++){const P=new Date(E);P.setDate(E.getDate()+T),A.push(P)}return A},h=()=>{const E=[];for(let b=6;b<=23;b++)E.push(`${b.toString().padStart(2,"0")}:00`);return E},d=c(),p=h(),g=E=>i.find(D=>D.id===E)?.color||"#667eea",v=(E,b)=>o(E).filter(A=>A.time?A.time.split(":")[0]===b.split(":")[0]:!1),y=E=>{const b=E.familyMember?g(E.familyMember):E.color||"#667eea";return x.jsxs("div",{className:"week-event",style:{background:b,color:"white"},onClick:D=>{D.stopPropagation(),t(E)},title:`${E.title}${E.description?`
${E.description}`:""}`,children:[x.jsx("div",{className:"event-time",children:E.time}),x.jsx("div",{className:"event-title",children:E.title})]},E.id)};return x.jsxs("div",{className:"week-view",children:[x.jsxs("div",{className:"week-header",children:[x.jsx("div",{className:"time-column"}),d.map(E=>x.jsxs("div",{className:`week-day-header ${s(E)?"today":""}`,onClick:()=>e(E),children:[x.jsx("div",{className:"week-day-name",children:E.toLocaleDateString("cs-CZ",{weekday:"short"})}),x.jsx("div",{className:"week-day-number",children:E.getDate()})]},E.toISOString()))]}),x.jsx("div",{className:"week-grid",children:p.map(E=>x.jsxs(_A.Fragment,{children:[x.jsx("div",{className:"hour-label",children:E}),d.map(b=>{const D=v(b,E);return x.jsx("div",{className:"hour-slot",onClick:()=>e(b),children:D.map(y)},`${b.toISOString()}-${E}`)})]},E))})]})},OH=({currentDate:n,onEventClick:e,familyMembers:t})=>{const{getEventsByDate:i,getHolidayByDate:s,getNamedayByDate:o,formatDate:c}=kc(),h=i(n),d=s(n),p=o(n),g=h.sort((P,k)=>!P.time&&!k.time?0:P.time?k.time?P.time.localeCompare(k.time):-1:1),v=g.filter(P=>P.time),y=g.filter(P=>!P.time),b=(()=>{const P=[];for(let k=6;k<=23;k++)P.push(`${k.toString().padStart(2,"0")}:00`),P.push(`${k.toString().padStart(2,"0")}:30`);return P})(),D=P=>t.find(V=>V.id===P)?.color||"#667eea",A=P=>v.filter(k=>{if(!k.time)return!1;const V=k.time,j=P.split(":")[0],q=P.split(":")[1],U=V.split(":")[0],N=V.split(":")[1];return U===j&&Math.abs(parseInt(N)-parseInt(q))<30}),T=(P,k=!1)=>{const V=P.familyMember?D(P.familyMember):P.color||"#667eea",j=P.familyMember?t.find(q=>q.id===P.familyMember)?.name:null;return x.jsxs("div",{className:`day-event ${k?"all-day":""}`,style:{background:`linear-gradient(135deg, ${V}, ${V}dd)`,borderLeft:`4px solid ${V}`},onClick:()=>e(P),children:[P.time&&!k&&x.jsxs("div",{className:"event-time",children:[P.time,P.endTime&&` - ${P.endTime}`]}),x.jsx("div",{className:"event-title",children:P.title}),P.description&&x.jsx("div",{className:"event-description",children:P.description}),j&&x.jsxs("div",{className:"event-member",children:["👤 ",j]}),P.attachments&&P.attachments.length>0&&x.jsxs("div",{className:"event-attachments",children:["📎 ",P.attachments.length," příloha",P.attachments.length>1?"y":""]})]},P.id)};return x.jsxs("div",{className:"day-view",children:[x.jsxs("div",{className:"day-view-header",children:[x.jsx("div",{className:"day-view-title",children:c(n,"WEEKDAY")}),x.jsx("div",{className:"day-view-date",children:c(n,"FULL")}),x.jsxs("div",{className:"day-special-events",children:[d&&x.jsxs("div",{className:"special-event holiday",children:["🎉 ",d.name]}),p&&x.jsxs("div",{className:"special-event nameday",children:["🎂 Svátek: ",p.names.join(", ")]})]})]}),y.length>0&&x.jsxs("div",{className:"all-day-events",children:[x.jsx("h3",{className:"section-title",children:"Celodenní události"}),x.jsx("div",{className:"all-day-events-list",children:y.map(P=>T(P,!0))})]}),x.jsxs("div",{className:"day-schedule",children:[x.jsx("div",{className:"day-times",children:b.map(P=>x.jsx("div",{className:"time-slot",children:P},P))}),x.jsx("div",{className:"day-events-column",children:b.map(P=>{const k=A(P);return x.jsxs("div",{className:"time-slot-events",children:[k.map(V=>T(V)),k.length===0&&P.endsWith(":00")&&x.jsx("div",{className:"empty-slot"})]},P)})})]}),x.jsx("div",{className:"day-summary",children:x.jsxs("div",{className:"day-stats",children:[x.jsxs("div",{className:"stat-item",children:[x.jsx("span",{className:"stat-number",children:h.length}),x.jsx("span",{className:"stat-label",children:"událostí"})]}),x.jsxs("div",{className:"stat-item",children:[x.jsx("span",{className:"stat-number",children:v.length}),x.jsx("span",{className:"stat-label",children:"s časem"})]}),x.jsxs("div",{className:"stat-item",children:[x.jsx("span",{className:"stat-number",children:y.length}),x.jsx("span",{className:"stat-label",children:"celodenních"})]})]})})]})},VH=({currentDate:n,currentView:e,onDateChange:t,onViewChange:i,onAddEvent:s,showMiniCalendar:o=!1})=>{const c=g=>{const v=new Date(n);switch(e){case"month":v.setMonth(v.getMonth()+(g==="next"?1:-1));break;case"week":v.setDate(v.getDate()+(g==="next"?7:-7));break;case"day":v.setDate(v.getDate()+(g==="next"?1:-1));break}t(v)},h=()=>{t(new Date)},d=()=>{const g={};switch(e){case"month":g.month="long",g.year="numeric";break;case"week":const v=new Date(n),y=v.getDay(),E=y===0?-6:1-y;v.setDate(v.getDate()+E);const b=new Date(v);return b.setDate(v.getDate()+6),v.getMonth()===b.getMonth()?`${v.getDate()}.–${b.getDate()}. ${v.toLocaleDateString("cs-CZ",{month:"long",year:"numeric"})}`:`${v.getDate()}. ${v.toLocaleDateString("cs-CZ",{month:"short"})} – ${b.getDate()}. ${b.toLocaleDateString("cs-CZ",{month:"short",year:"numeric"})}`;case"day":g.weekday="long",g.day="numeric",g.month="long",g.year="numeric";break}return n.toLocaleDateString("cs-CZ",g)},p={month:"Měsíc",week:"Týden",day:"Den"};return x.jsxs("div",{className:"calendar-header",children:[x.jsxs("div",{className:"calendar-title-section",children:[x.jsx("h2",{className:"calendar-title",children:d()}),!o&&x.jsxs("div",{className:"calendar-navigation",children:[x.jsx("button",{className:"nav-button",onClick:()=>c("prev"),title:"Předchozí",children:"◀"}),x.jsx("button",{className:"nav-button today-button",onClick:h,title:"Dnes",children:"Dnes"}),x.jsx("button",{className:"nav-button",onClick:()=>c("next"),title:"Další",children:"▶"})]})]}),!o&&x.jsxs("div",{className:"calendar-controls",children:[x.jsx("div",{className:"view-selector",children:Object.keys(p).map(g=>x.jsx("button",{className:`view-button ${e===g?"active":""}`,onClick:()=>i(g),children:p[g]},g))}),x.jsxs("button",{className:"add-event-button",onClick:s,title:"Přidat událost",children:[x.jsx("span",{children:"+"}),"Přidat událost"]})]})]})},FH=({familyMembers:n=[],onAddEvent:e,onEditEvent:t})=>{const{currentDate:i,setCurrentDate:s,currentView:o,setCurrentView:c,getCurrentMonthTheme:h}=kc(),d=v=>{o!=="day"&&(c("day"),s(v))},p=()=>{switch(o){case"month":return x.jsx(UH,{currentDate:i,onDateClick:d,onEventClick:t,familyMembers:n,onAddEventFor:(v,y)=>e(v,y)});case"week":return x.jsx(LH,{currentDate:i,onDateClick:d,onEventClick:t,familyMembers:n});case"day":return x.jsx(OH,{currentDate:i,onEventClick:t,familyMembers:n});default:return null}},g=h();return x.jsxs("div",{className:"calendar-widget",children:[x.jsx("div",{className:"calendar-header",style:{backgroundImage:g.backgroundImage},children:x.jsx(VH,{currentDate:i,currentView:o,onDateChange:s,onViewChange:c,onAddEvent:()=>e(i)})}),x.jsx("div",{className:"calendar-content",children:p()})]})},kH=({event:n,date:e,familyMembers:t,onSave:i,onDelete:s,onClose:o,defaultMemberId:c})=>{const[h,d]=Le.useState({title:"",description:"",date:e||new Date,time:"",endTime:"",type:"personal",familyMember:"",color:"#667eea",reminder:"none",isAllDay:!1});Le.useEffect(()=>{n&&d({title:n.title,description:n.description||"",date:n.date,time:n.time||"",endTime:n.endTime||"",type:n.type,familyMember:n.familyMember||"",color:n.color||"#667eea",reminder:n.reminder||"none",isAllDay:n.isAllDay||!1})},[n]),Le.useEffect(()=>{!n&&c&&d(b=>({...b,familyMember:c}))},[n,c]);const p=[{value:"personal",label:"Osobní",icon:"👤"},{value:"work",label:"Pracovní",icon:"💼"},{value:"family",label:"Rodina",icon:"👨‍👩‍👧‍👦"},{value:"birthday",label:"Narozeniny",icon:"🎂"},{value:"reminder",label:"Připomínka",icon:"⏰"}],g=[{value:"none",label:"Bez připomínky"},{value:"5min",label:"5 minut před"},{value:"15min",label:"15 minut před"},{value:"30min",label:"30 minut před"},{value:"1hour",label:"1 hodinu před"},{value:"1day",label:"1 den před"},{value:"1week",label:"1 týden před"},{value:"email",label:"Email"},{value:"push",label:"Push notifikace"}],v=["#667eea","#764ba2","#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#feca57","#ff9ff3","#54a0ff","#5f27cd","#00d2d3","#ff9f43","#8395a7","#10ac84","#ee5a24","#0abde3"],y=b=>{b.preventDefault(),h.title.trim()&&i({...h,date:h.date,time:h.isAllDay?void 0:h.time,endTime:h.isAllDay?void 0:h.endTime})},E=(b,D)=>{d(A=>({...A,[b]:D}))};return x.jsx("div",{className:"event-form-overlay",onClick:o,children:x.jsxs("div",{className:"event-form",onClick:b=>b.stopPropagation(),children:[x.jsxs("div",{className:"event-form-header",children:[x.jsx("h3",{className:"event-form-title",children:n?"Upravit událost":"Nová událost"}),x.jsx("button",{className:"close-button",onClick:o,children:"×"})]}),x.jsxs("form",{onSubmit:y,children:[x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Název události *"}),x.jsx("input",{type:"text",className:"form-input",value:h.title,onChange:b=>E("title",b.target.value),placeholder:"Zadejte název události",required:!0})]}),x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Popis"}),x.jsx("textarea",{className:"form-textarea",value:h.description,onChange:b=>E("description",b.target.value),placeholder:"Zadejte popis události",rows:3})]}),x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Datum"}),x.jsx("input",{type:"date",className:"form-input",value:h.date.toISOString().split("T")[0],onChange:b=>E("date",new Date(b.target.value))})]}),x.jsx("div",{className:"form-group",children:x.jsxs("label",{className:"form-label",children:[x.jsx("input",{type:"checkbox",checked:h.isAllDay,onChange:b=>E("isAllDay",b.target.checked),style:{marginRight:"8px"}}),"Celodenní událost"]})}),!h.isAllDay&&x.jsxs("div",{className:"form-row",children:[x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Začátek"}),x.jsx("input",{type:"time",className:"form-input",value:h.time,onChange:b=>E("time",b.target.value)})]}),x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Konec"}),x.jsx("input",{type:"time",className:"form-input",value:h.endTime,onChange:b=>E("endTime",b.target.value)})]})]}),x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Typ události"}),x.jsx("select",{className:"form-select",value:h.type,onChange:b=>E("type",b.target.value),children:p.map(b=>x.jsxs("option",{value:b.value,children:[b.icon," ",b.label]},b.value))})]}),t.length>0&&x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Člen rodiny"}),x.jsxs("div",{className:"family-member-selector",children:[x.jsx("button",{type:"button",className:`family-member-option ${h.familyMember?"":"selected"}`,onClick:()=>E("familyMember",""),children:"Nikdo"}),t.map(b=>x.jsx("button",{type:"button",className:`family-member-option ${h.familyMember===b.id?"selected":""}`,style:{backgroundColor:h.familyMember===b.id?b.color:"transparent",borderColor:b.color,color:h.familyMember===b.id?"white":b.color},onClick:()=>E("familyMember",b.id),children:b.name},b.id))]})]}),x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Barva"}),x.jsx("div",{className:"color-picker",children:v.map(b=>x.jsx("button",{type:"button",className:`color-option ${h.color===b?"selected":""}`,style:{backgroundColor:b},onClick:()=>E("color",b),title:b},b))})]}),x.jsxs("div",{className:"form-group",children:[x.jsx("label",{className:"form-label",children:"Připomínka"}),x.jsx("div",{className:"reminder-options",children:g.map(b=>x.jsx("button",{type:"button",className:`reminder-option ${h.reminder===b.value?"selected":""}`,onClick:()=>E("reminder",b.value),children:b.label},b.value))})]}),x.jsxs("div",{className:"form-actions",children:[s&&x.jsx("button",{type:"button",className:"btn btn-danger",onClick:s,children:"🗑️ Smazat"}),x.jsx("button",{type:"button",className:"btn btn-outline",onClick:o,children:"Zrušit"}),x.jsxs("button",{type:"submit",className:"btn btn-primary",children:["💾 ",n?"Uložit":"Vytvořit"]})]})]})]})})},zH=({isOpen:n,onClose:e,familyMembers:t=[]})=>{const{addEvent:i,updateEvent:s,deleteEvent:o}=kc(),[c,h]=Le.useState(!1),[d,p]=Le.useState(null),[g,v]=Le.useState(null),[y,E]=Le.useState(void 0);if(Le.useEffect(()=>{const P=k=>{k.key==="Escape"&&(c?h(!1):e())};return n&&(document.addEventListener("keydown",P),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",P),document.body.style.overflow="unset"}},[n,e,c]),!n)return null;const b=(P,k)=>{p(null),v(P),E(k),h(!0)},D=P=>{p(P),v(P.date),E(P.familyMember),h(!0)},A=P=>{d?s(d.id,P):i({id:Date.now().toString(),title:P.title||"",date:P.date||g||new Date,type:"personal",...P}),h(!1)},T=P=>{o(P),h(!1)};return x.jsxs("div",{className:"calendar-modal-overlay",onClick:e,children:[x.jsx("div",{className:"calendar-modal-content",onClick:P=>P.stopPropagation(),children:x.jsx(FH,{familyMembers:t,onAddEvent:b,onEditEvent:D})}),c&&x.jsx(kH,{event:d,date:g,familyMembers:t,onSave:A,onDelete:d?()=>T(d.id):void 0,onClose:()=>h(!1),defaultMemberId:y})]})},BH=({familyMembers:n=[]})=>{const[e,t]=Le.useState(!1),{getEventsByDate:i,getHolidayByDate:s,getNamedayByDate:o,formatDate:c}=kc(),h=new Date,d=i(h),p=s(h),g=o(h),y=(()=>{const D=[];for(let A=1;A<=7;A++){const T=new Date;T.setDate(h.getDate()+A),i(T).forEach(k=>{D.push({...k,displayDate:T})})}return D.slice(0,3)})(),b=n.filter(D=>D.birthday?D.birthday.getMonth()===h.getMonth():!1);return x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"calendar-mini-widget",onClick:()=>t(!0),children:[x.jsxs("div",{className:"mini-widget-header",children:[x.jsx("div",{className:"widget-title",children:"📅 Kalendář"}),x.jsx("div",{className:"current-date",children:c(h,"FULL")})]}),x.jsxs("div",{className:"mini-section",children:[x.jsxs("h3",{className:"mini-section-title",children:["Dnes (",c(h,"DD.MM"),")"]}),p&&x.jsxs("div",{className:"mini-event holiday-event",children:[x.jsx("span",{className:"event-icon",children:"🎉"}),x.jsx("span",{className:"event-text",children:p.name})]}),g&&x.jsxs("div",{className:"mini-event nameday-event",children:[x.jsx("span",{className:"event-icon",children:"🎂"}),x.jsxs("span",{className:"event-text",children:["Svátek: ",g.names.join(", ")]})]}),d.length>0?d.slice(0,2).map(D=>x.jsxs("div",{className:"mini-event user-event",children:[x.jsx("span",{className:"event-icon",children:"📝"}),x.jsxs("div",{className:"event-details",children:[x.jsx("span",{className:"event-text",children:D.title}),D.time&&x.jsx("span",{className:"event-time",children:D.time})]})]},D.id)):x.jsxs("div",{className:"mini-event no-events",children:[x.jsx("span",{className:"event-icon",children:"✨"}),x.jsx("span",{className:"event-text",children:"Žádné události"})]}),d.length>2&&x.jsx("div",{className:"mini-event more-events",children:x.jsxs("span",{className:"event-text",children:["+",d.length-2," dalších událostí"]})})]}),y.length>0&&x.jsxs("div",{className:"mini-section",children:[x.jsx("h3",{className:"mini-section-title",children:"Nadcházející"}),y.map(D=>x.jsxs("div",{className:"mini-event upcoming-event",children:[x.jsx("span",{className:"event-icon",children:"⏰"}),x.jsxs("div",{className:"event-details",children:[x.jsx("span",{className:"event-text",children:D.title}),x.jsx("span",{className:"event-date",children:c(D.displayDate,"DD.MM")})]})]},`${D.id}-${D.displayDate}`))]}),b.length>0&&x.jsxs("div",{className:"mini-section",children:[x.jsxs("h3",{className:"mini-section-title",children:["Narozeniny v ",c(h,"MONTH")]}),b.map(D=>x.jsxs("div",{className:"mini-event birthday-event",children:[x.jsx("span",{className:"event-icon",children:"🎈"}),x.jsxs("div",{className:"event-details",children:[x.jsx("span",{className:"event-text",children:D.name}),x.jsxs("span",{className:"event-date",children:[D.birthday?.getDate(),".",(D.birthday?.getMonth()||0)+1,"."]})]})]},D.id))]}),x.jsx("div",{className:"mini-widget-footer",children:x.jsx("span",{className:"click-hint",children:"👆 Klikněte pro otevření kalendáře"})})]}),e&&x.jsx(zH,{isOpen:e,onClose:()=>t(!1),familyMembers:n})]})},HH=n=>{const e={switch:"🔌",light:"💡",sensor:"📱",garden:"🌱",thermostat:"🌡️",camera:"📷",assistant:"🏠",default:"📱"};return e[n.category]||e.default};function GH(){const{currentUser:n,logout:e}=Op(),{devices:t,loading:i,error:s,syncDevices:o}=UO(),{rooms:c,selectedRoomId:h,selectedRoom:d,getRoomDevices:p,getUnassignedDevices:g,addDeviceToRoom:v,removeDeviceFromRoom:y,loading:E}=nR(),[b,D]=Le.useState([]),[A,T]=Le.useState(!1),[P,k]=Le.useState(null),[V,j]=Le.useState(null),[q,U]=Le.useState("all"),[N,M]=Le.useState(null),[w,R]=Le.useState(!1);if(Le.useEffect(()=>{localStorage.getItem("theme")==="dark"&&document.documentElement.classList.add("dark-theme")},[]),!n)return x.jsx(LO,{});const O=async()=>new Promise(H=>{setTimeout(()=>{const ee=[{id:"bf631b96e11e658088nljp",name:"Chytrá zásuvka - Obývák",local_key:"mock_key_1",category:"switch",product_id:"mock_product_1",product_name:"Smart Socket",sub:!1,uuid:"mock_uuid_1",owner_id:"mock_owner_1",online:!0,status:[{code:"switch_1",value:Math.random()>.5},{code:"cur_power",value:Math.round(Math.random()*100)}],lastUpdated:Date.now(),isVisible:!0,customName:"Zásuvka u TV",customColor:"#007bff"},{id:"bf631b96e11e658088nljq",name:"LED pásek - Kuchyň",local_key:"mock_key_2",category:"light",product_id:"mock_product_2",product_name:"LED Strip",sub:!1,uuid:"mock_uuid_2",owner_id:"mock_owner_2",online:Math.random()>.2,status:[{code:"switch_led",value:Math.random()>.3},{code:"bright_value",value:Math.round(Math.random()*100)},{code:"colour_data",value:"#ff6600"}],lastUpdated:Date.now(),isVisible:!0},{id:"bf631b96e11e658088nljr",name:"Teplotní senzor - Ložnice",local_key:"mock_key_3",category:"sensor",product_id:"mock_product_3",product_name:"Temperature Sensor",sub:!1,uuid:"mock_uuid_3",owner_id:"mock_owner_3",online:!0,status:[{code:"temp_current",value:Math.round(Math.random()*10+20)},{code:"humidity_value",value:Math.round(Math.random()*40+40)}],lastUpdated:Date.now(),isVisible:!0,customName:"Senzor u postele"},{id:"bf631b96e11e658088nljs",name:"Chytrý vypínač - Zahrada",local_key:"mock_key_4",category:"garden",product_id:"mock_product_4",product_name:"Garden Switch",sub:!1,uuid:"mock_uuid_4",owner_id:"mock_owner_4",online:Math.random()>.1,status:[{code:"switch_1",value:Math.random()>.6},{code:"timer_1",value:"08:00"}],lastUpdated:Date.now(),isVisible:!0,notes:"Ovládá zahradní osvětlení"}];H(ee)},1e3)}),L=async()=>{if(n)try{T(!0),k(null),M("Synchronizuji zařízení..."),R(!0),console.log("Synchronizing with Tuya API...");const H=await O();console.log("Saving to Firebase..."),await o(H),M("✓ Synchronizace dokončena"),setTimeout(()=>{R(!1),setTimeout(()=>M(null),300)},3e3)}catch(H){console.error("Sync error:",H),k(H.message||"Nepodařilo se synchronizovat data"),M("✗ Chyba při synchronizaci"),setTimeout(()=>R(!1),5e3)}finally{T(!1)}},re=async(H,ee)=>{if(n){j(H);try{console.log("Controlling device:",H,"Commands:",ee),await new Promise(Pe=>setTimeout(Pe,1e3));const ye=t.map(Pe=>{if(Pe.id===H){const qe=Pe.status?.map(le=>{const xe=ee.find(Oe=>Oe.code===le.code);return xe?{...le,value:xe.value}:le})||null;return{...Pe,status:qe,lastUpdated:Date.now()}}return Pe});await Oi.saveUserDevices(n.uid,ye);const Ee=document.querySelector(`[data-device-id="${H}"]`);Ee&&(Ee.classList.add("action-success"),setTimeout(()=>Ee.classList.remove("action-success"),600)),console.log("Device controlled successfully")}catch(ye){console.error("Error controlling device:",ye);const Ee=ye instanceof Error?ye.message:String(ye);alert(`Chyba při ovládání zařízení: ${Ee}`)}finally{j(null)}}},oe=async(H,ee,ye)=>{await re(H,[{code:ee,value:!ye}])},X=async(H,ee)=>{try{const ye=b.find(Pe=>Pe.id===H);ye?.roomId&&await y(ye.roomId,H),ee&&await v(ee,H);const Ee=b.map(Pe=>Pe.id===H?{...Pe,roomId:ee||void 0}:Pe);D(Ee),console.log("Device room changed successfully")}catch(ye){console.error("Error changing device room:",ye),alert("Chyba při změně místnosti")}},Z=_A.useCallback(async(H,ee)=>{if(!n){console.error("No current user for position update");return}console.log("=== POSITION UPDATE START ==="),console.log("Device ID:",H),console.log("New position:",ee),console.log("Current user:",n.uid);const ye=`${H}-${ee.x}-${ee.y}`;if(window.lastPositionUpdate===ye){console.log("Duplicate position update prevented");return}window.lastPositionUpdate=ye;try{await Oi.updateDevicePosition(n.uid,H,ee),console.log("Firebase update successful"),D(Ee=>{const Pe=Ee.map(qe=>qe.id===H?{...qe,position:ee}:qe);return console.log("Local state updated:",Pe.find(qe=>qe.id===H)?.position),Pe}),console.log("=== POSITION UPDATE SUCCESS ==="),setTimeout(()=>{window.lastPositionUpdate===ye&&(window.lastPositionUpdate=null)},1e3)}catch(Ee){console.error("=== POSITION UPDATE ERROR ==="),console.error("Error details:",Ee),window.lastPositionUpdate=null,alert(`Chyba při ukládání pozice: ${Ee}`)}},[n]);Le.useEffect(()=>{n&&t&&t.length>0&&(D(t),T(!1))},[n,t,i]);const Ae=(()=>{switch(q){case"all":return b;case"room":case"2d-view":return h?p(h,b):[];case"unassigned":return g(b);default:return b}})();return E?x.jsx("div",{className:"app-layout",children:x.jsxs("div",{className:"modern-loading-state",children:[x.jsxs("div",{className:"loading-animation",children:[x.jsx("div",{className:"loading-spinner-large"}),x.jsxs("div",{className:"loading-dots",children:[x.jsx("span",{}),x.jsx("span",{}),x.jsx("span",{})]})]}),x.jsx("h2",{className:"loading-title",children:"Načítám místnosti..."}),x.jsx("p",{className:"loading-description",children:"Připravujeme váš smart home dashboard"})]})}):P||s?x.jsx("div",{className:"app-layout",children:x.jsxs("div",{className:"modern-error-state",children:[x.jsxs("div",{className:"error-animation",children:[x.jsx("div",{className:"error-icon",children:"⚠️"}),x.jsx("div",{className:"error-pulse"})]}),x.jsx("h2",{className:"error-title",children:"Něco se pokazilo"}),x.jsxs("p",{className:"error-description",children:["Nepodařilo se načíst data: ",P||s]}),x.jsxs("div",{className:"error-actions",children:[x.jsxs("button",{onClick:L,className:"btn btn-modern btn-primary error-retry-btn",children:[x.jsx("span",{className:"btn-icon",children:"🔄"}),"Zkusit znovu"]}),x.jsxs("button",{onClick:()=>window.location.reload(),className:"btn btn-modern btn-outline-secondary",children:[x.jsx("span",{className:"btn-icon",children:"↻"}),"Obnovit stránku"]})]})]})}):x.jsxs("div",{className:"app-layout",children:[x.jsxs("header",{className:"app-header modern-header",children:[x.jsxs("div",{className:"header-brand",children:[x.jsxs("div",{className:"brand-logo",children:[x.jsx("span",{className:"logo-icon",children:"🏠"}),x.jsx("h1",{className:"brand-title",children:"IoTuyApp"})]}),x.jsx("p",{className:"brand-subtitle",children:"Smart Home Dashboard"})]}),x.jsxs("div",{className:"header-actions",children:[x.jsxs("div",{className:"user-info",children:[x.jsx("div",{className:"user-avatar",children:x.jsx("span",{className:"avatar-icon",children:"👤"})}),x.jsxs("div",{className:"user-details",children:[x.jsx("span",{className:"user-name",children:n.displayName||"Uživatel"}),x.jsx("span",{className:"user-email",children:n.email})]})]}),x.jsx("button",{onClick:()=>{document.documentElement.classList.toggle("dark-theme");const H=document.documentElement.classList.contains("dark-theme");localStorage.setItem("theme",H?"dark":"light")},className:"btn btn-modern btn-theme-toggle",title:"Přepnout tmavý/světlý režim",children:x.jsx("span",{className:"btn-icon",children:"��"})}),x.jsxs("button",{onClick:e,className:"btn btn-modern btn-logout",children:[x.jsx("span",{className:"btn-icon",children:"↗"}),"Odhlásit"]})]})]}),x.jsxs("div",{className:"dashboard-container",children:[x.jsxs("div",{className:"dashboard-header",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"dashboard-title",children:"Smart Home Dashboard"}),x.jsx("p",{className:"dashboard-subtitle",children:"Ovládejte svůj chytrý domov"})]}),x.jsxs("div",{className:"dashboard-quick-actions",children:[x.jsxs("button",{className:"quick-action-btn",title:"Přidat zařízení",children:[x.jsx("span",{children:"➕"}),"Přidat zařízení"]}),x.jsxs("button",{className:"quick-action-btn",title:"Synchronizovat",children:[x.jsx("span",{children:"🔄"}),"Synchronizovat"]})]})]}),x.jsx(OO,{onCreateRoom:()=>console.log("create room")}),x.jsxs("div",{className:"dashboard-grid",children:[x.jsxs("div",{className:"dashboard-card weather-card",children:[x.jsxs("div",{className:"card-header",children:[x.jsx("h3",{className:"card-title",children:"Počasí"}),x.jsx("span",{className:"weather-icon",children:"☀️"})]}),x.jsx("div",{className:"weather-info",children:x.jsxs("div",{children:[x.jsx("h2",{className:"weather-temp",children:"22°C"}),x.jsx("p",{className:"weather-desc",children:"Slunečno"})]})})]}),x.jsxs("div",{className:"dashboard-card",children:[x.jsxs("div",{className:"card-header",children:[x.jsx("h3",{className:"card-title",children:"Zařízení v místnosti"}),x.jsx("span",{className:"card-icon",children:"🏠"})]}),x.jsx("div",{className:"device-tiles",children:t.map(H=>x.jsxs("div",{className:`device-tile ${H.online?"active":""}`,children:[x.jsx("span",{className:"device-tile-icon",children:HH(H)}),x.jsx("h4",{className:"device-tile-name",children:H.name}),x.jsx("p",{className:"device-tile-status",children:H.online?"Online":"Offline"})]},H.id))})]}),x.jsxs("div",{className:"dashboard-card family-card",children:[x.jsxs("div",{className:"card-header",children:[x.jsx("h3",{className:"card-title",children:"Rodinné události"}),x.jsx("span",{className:"card-icon",children:"👨‍👩‍👧‍👦"})]}),x.jsx("div",{className:"family-event",children:x.jsxs("div",{className:"event-info",children:[x.jsx("h4",{children:"Narozeniny - Jana"}),x.jsx("p",{children:"Zítra"})]})})]}),x.jsx(PH,{children:x.jsx("div",{className:"calendar-section",children:x.jsx(BH,{familyMembers:[{id:"1",name:"Mamka",color:"#ff6b6b",icon:"❤️"},{id:"2",name:"Taťka",color:"#4ecdc4",icon:"🦸‍♂️"},{id:"3",name:"Johanka",color:"#45b7d1",icon:"🎨"},{id:"4",name:"Jareček",color:"#96ceb4",icon:"📱"}]})})}),x.jsxs("div",{className:"dashboard-card",children:[x.jsxs("div",{className:"card-header",children:[x.jsx("h3",{className:"card-title",children:"Kamery"}),x.jsx("span",{className:"card-icon",children:"📹"})]}),x.jsxs("div",{className:"cameras-grid",children:[x.jsx("div",{className:"camera-preview",children:"Hlavní vchod"}),x.jsx("div",{className:"camera-preview",children:"Zahrada"})]})]})]})]}),x.jsx("div",{className:"compact-navigation",children:x.jsxs("div",{className:"nav-quick-tabs",children:[x.jsxs("button",{onClick:()=>U("all"),className:`nav-quick-tab ${q==="all"?"active":""}`,children:[x.jsx("span",{children:"📋"}),"Všechna zařízení",x.jsx("span",{className:"nav-badge",children:b.length})]}),x.jsxs("button",{onClick:()=>U("unassigned"),className:`nav-quick-tab ${q==="unassigned"?"active":""}`,children:[x.jsx("span",{children:"📦"}),"Nepřiřazená",x.jsx("span",{className:"nav-badge",children:g(b).length})]}),d&&x.jsxs("button",{onClick:()=>U("room"),className:`nav-quick-tab ${q==="room"?"active":""}`,children:[x.jsx("span",{children:"🏠"}),d.name,x.jsx("span",{className:"nav-badge",children:p(d.id,b).length})]})]})}),x.jsx("div",{className:"devices-container",children:q==="2d-view"?d?x.jsx(aV,{room:d,devices:b,onDevicePositionChange:Z,onDeviceSelect:H=>{console.log("Device selected:",H)}}):x.jsxs("div",{className:"no-devices",children:[x.jsx("h3",{children:"Vyberte místnost pro 2D pohled"}),x.jsx("p",{children:"Pro zobrazení 2D vizualizace vyberte místnost v levém panelu."})]}):q==="3d-view"?d?x.jsxs(x.Fragment,{children:[console.log("=== 3D VIEW DEBUG ===",{selectedRoom:d,allDevices:b.length,roomDevices:p(d.id,b),devicesWithRoomId:b.filter(H=>H.roomId===d.id)}),x.jsx(RH,{room:d,devices:b,onDevicePositionChange:(H,ee)=>Z(H,{x:ee.x,y:ee.z}),onDeviceSelect:H=>{console.log("3D Device selected:",H)}})]}):x.jsxs("div",{className:"no-devices",children:[x.jsx("h3",{children:"Vyberte místnost pro 3D pohled"}),x.jsx("p",{children:"Pro zobrazení 3D vizualizace vyberte místnost v levém panelu."})]}):Ae.length===0?x.jsx("main",{className:"content-area",children:x.jsxs("div",{className:"empty-state",children:[x.jsx("div",{className:"empty-state-icon",children:q==="room"&&d?d.icon||"🏠":q==="unassigned"?"📦":"🔍"}),x.jsx("h3",{className:"empty-state-title",children:q==="room"&&d?"Místnost je prázdná":q==="unassigned"?"Vše je organizované":"Žádná zařízení"}),x.jsx("p",{className:"empty-state-description",children:q==="room"&&d?`V místnosti "${d.name}" nejsou žádná zařízení. Přidejte zařízení pomocí správy místností.`:q==="unassigned"?"Všechna zařízení jsou přiřazená do místností. Skvělá práce s organizací!":"Proveďte synchronizaci nebo zkontrolujte připojení k Tuya Cloud."}),x.jsx("div",{className:"empty-state-actions",children:q==="room"?x.jsxs("button",{onClick:()=>U("all"),className:"btn btn-modern btn-primary",children:[x.jsx("span",{className:"btn-icon",children:"📋"}),"Zobrazit všechna zařízení"]}):x.jsxs("button",{onClick:L,className:"btn btn-modern btn-primary",children:[x.jsx("span",{className:"btn-icon",children:"🔄"}),"Synchronizovat"]})})]})}):x.jsxs("main",{className:"content-area",children:[x.jsxs("div",{className:"content-header",children:[x.jsx("h2",{className:"content-title",children:q==="room"&&d?`${d.icon} ${d.name}`:q==="unassigned"?"📦 Nepřiřazená zařízení":q==="all"?"📋 Všechna zařízení":"Zařízení"}),x.jsxs("div",{className:"content-stats",children:[x.jsxs("span",{className:"stats-item",children:[x.jsx("span",{className:"stats-value",children:Ae.length}),x.jsx("span",{className:"stats-label",children:"zařízení"})]}),x.jsxs("span",{className:"stats-item",children:[x.jsx("span",{className:"stats-value",children:Ae.filter(H=>H.online).length}),x.jsx("span",{className:"stats-label",children:"online"})]})]})]}),x.jsx("div",{className:"devices-modern-grid",children:A?Array.from({length:4}).map((H,ee)=>x.jsxs("div",{className:"device-skeleton",children:[x.jsxs("div",{className:"skeleton-header",children:[x.jsx("div",{className:"skeleton-badge"}),x.jsx("div",{className:"skeleton-status"})]}),x.jsx("div",{className:"skeleton-title"}),x.jsx("div",{className:"skeleton-select"}),x.jsx("div",{className:"skeleton-button"}),x.jsx("div",{className:"skeleton-footer"})]},`skeleton-${ee}`)):Ae.map(H=>x.jsx(VO,{device:H,isControlling:V===H.id,onControl:re,onToggleSwitch:oe,className:"device-modern-card",rooms:c,onRoomChange:X},H.id))})]})}),N&&x.jsxs("div",{className:`modern-notification ${w?"show":""}`,children:[x.jsxs("div",{className:"notification-content",children:[x.jsx("span",{className:"notification-icon",children:"✓"}),x.jsx("span",{className:"notification-text",children:N})]}),x.jsx("div",{className:"notification-progress"})]})]})}_C.createRoot(document.getElementById("root")).render(x.jsx(Le.StrictMode,{children:x.jsx(NO,{children:x.jsx(GH,{})})}));
